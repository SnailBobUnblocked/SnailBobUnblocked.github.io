var CRENDER_DEBUG=!1;"undefined"==typeof window.console&&(window.console={log:function(){}});window.Utils||(window.Utils={});var Utils=Utils;Utils.detectMobileBrowser=function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)};
Utils.getTouchStartEvent=function(){return Utils.isWindowsPhone()?"mspointerdown":"touchstart"};Utils.getTouchMoveEvent=function(){return Utils.isWindowsPhone()?"mspointermove":"touchmove"};Utils.getTouchEndEvent=function(){return Utils.isWindowsPhone()?"mspointerup":"touchend"};Utils.touchScreen=Utils.detectMobileBrowser();Utils.globalScale=1;Utils.globalPixelScale=1;Utils.isWindowHidden=!1;Utils.DOMMainContainerId="main_container";Utils.DOMProgressContainerId="progress_container";
Utils.DOMProgressId="progress";Utils.DOMScreenBackgroundContainerId="screen_background_container";Utils.DOMScreenBackgroundWrapperId="screen_background_wrapper";Utils.DOMScreenBackgroundId="screen_background";Utils.DOMScreenContainerId="screen_container";Utils.DOMScreenWrapperId="screen_wrapper";Utils.DOMScreenId="screen";Utils.DOMP2lContainerId="p2l_container";Utils.DOMP2lId="p2l";Utils.DOMMarkId="mark";
Utils.setCookie=function(a,c){try{window.localStorage.setItem(a,c)}catch(d){var e=new Date;e.setDate(e.getDate()+3650);document.cookie=a+"="+c+"; expires="+e.toUTCString()}};Utils.getCookie=function(a){var c;try{c=window.localStorage.getItem(a)}catch(d){a+="=";c=document.cookie.indexOf(a);if(-1==c)return null;var e=document.cookie.indexOf(";",c+a.length);-1==e&&(e=document.cookie.length);c=unescape(document.cookie.substring(c+a.length,e))}return c};
Utils.bindEvent=function(a,c,d){a.addEventListener?a.addEventListener(c,d,!1):a.attachEvent&&a.attachEvent("on"+c,d)};Utils.unbindEvent=function(a,c,d){a.removeEventListener?a.removeEventListener(c,d,!1):a.detachEvent&&a.detachEvent("on"+c,d)};Utils.getObjectLeft=function(a){var c=a.offsetLeft;a.offsetParent&&(c+=Utils.getObjectLeft(a.offsetParent));return c};Utils.getObjectTop=function(a){var c=a.offsetTop;a.offsetParent&&(c+=Utils.getObjectTop(a.offsetParent));return c};
Utils.parseGet=function(){var a={},c=window.location.toString(),d=window.location.toString().indexOf("?");if(0<=d)for(var c=c.substr(d+1,c.length),d=c.split("&"),e=0;e<d.length;e++)c=d[e].split("="),a[c[0]]=c[1];return a};
Utils.getMouseCoord=function(a,c){var d=a||window.event;d.touches&&(d=d.touches[0]);if(!d)return{x:0,y:0};var e=0,f=0,g=0,h=0;c&&(e=Utils.getObjectLeft(c),f=Utils.getObjectTop(c));if(d.pageX||d.pageY)g=d.pageX,h=d.pageY;else if(d.clientX||d.clientY)g=d.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-document.documentElement.clientLeft,h=d.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-document.documentElement.clientTop;return{x:g-e,y:h-f}};
Utils.removeFromArray=function(a,c){for(var d=[],e=0;e<a.length;e++)a[e]!=c&&d.push(a[e]);return d};Utils.showLoadProgress=function(a){var c=Utils.globalScale,d;d="Loading: "+a+"%<br><br>";d+='<div style="display: block; background: #000; width: '+a*c*2+"px; height: "+10*c+'px;">&nbsp;</div>';document.getElementById(Utils.DOMProgressId).innerHTML=d};Utils.hideAddressBarLock=!1;Utils.mobileHideAddressBar=function(){Utils.hideAddressBarLock||window.scrollTo(0,1)};
Utils.mobileCheckIphone4=function(){return Utils.touchScreen&&0<=navigator.userAgent.indexOf("iPhone")&&2==window.devicePixelRatio};Utils.mobileCheckBrokenAndroid=function(){return Utils.touchScreen&&Utils.isAndroid()&&!Utils.isChrome()&&!Utils.isFirefox()};Utils.mobileCheckSlowDevice=function(){return Utils.mobileCheckBrokenAndroid()&&0<=navigator.userAgent.toLowerCase().indexOf("sm-t310")||Utils.touchScreen&&Utils.isAndroid()&&Utils.isFirefox()&&0<=navigator.userAgent.toLowerCase().indexOf("sm-t310")};
Utils.isChrome=function(){var a=!1;0<=navigator.userAgent.toLowerCase().indexOf("chrome")&&(a=!0,Utils.isAndroid()&&22>(parseInt((/Chrome\/([0-9]+)/.exec(navigator.appVersion)||0)[1],10)||0)&&(a=!1));return a};Utils.isAndroid=function(){return 0<=navigator.userAgent.toLowerCase().indexOf("android")};Utils.isIOS=function(){return navigator.userAgent.toLowerCase().match(/(ipad|iphone|ipod)/g)?!0:!1};Utils.isPlayFreeBrowser=function(){return 0<=navigator.userAgent.toLowerCase().indexOf("playfreebrowser")};
Utils.isFirefox=function(){return 0<=navigator.userAgent.toLowerCase().indexOf("firefox")};Utils.isWindowsPhone=function(){return 0<=navigator.userAgent.toLowerCase().indexOf("windows phone")};Utils.disableCorrectPixelRatio=!1;
Utils.mobileCorrectPixelRatio=function(){for(var a=document.getElementsByTagName("head")[0].getElementsByTagName("meta"),c=!0,d=null,e="",f=0;f<a.length;f++)if("viewport"==a[f].name){d=a[f];c=!1;break}c&&(d=document.createElement("meta"),d.name="viewport");e+="target-densitydpi=device-dpi, user-scalable=0";Utils.isPlayFreeBrowser()&&(e+=", width=device-width, height=device-height");a=1/(window.devicePixelRatio?window.devicePixelRatio:1);a=a.toFixed(2);Utils.disableCorrectPixelRatio&&(a=1);d.content=
e+(", initial-scale="+a+", maximum-scale="+a+", minimum-scale="+a);c&&document.getElementsByTagName("head")[0].appendChild(d)};
Utils.getMobileScreenResolution=function(a){var c=1,d=window.innerWidth,e=window.innerHeight;d&&e||(d=screen.width,e=screen.height);c=1;Utils.disableCorrectPixelRatio&&(c=window.devicePixelRatio?window.devicePixelRatio:1);var d=d*c,e=e*c,f=[{scale:1,width:320,height:480},{scale:1.5,width:480,height:720},{scale:2,width:640,height:960}],g={width:0,height:0},h="";Utils.touchScreen?(g.width=Math.min(d,e),g.height=Math.max(d,e)):(a&&(f=[{scale:1,width:480,height:320},{scale:1.5,width:720,height:480},{scale:2,
width:960,height:640}]),g.width=d,g.height=e);h="height";d=Number.MAX_VALUE;for(e=0;e<f.length;e++){var k=Math.abs(g[h]-f[e][h]);d>k&&(d=k,c=f[e].scale)}return Utils.getScaleScreenResolution(c,a)};Utils.getScaleScreenResolution=function(a,c){var d=Math.round(320*a),e=Math.round(480*a);return{width:c?e:d,height:c?d:e,scale:a}};Utils.imagesRoot="images";Utils.initialResolution={width:320,height:480,scale:1};Utils.ignoreMobileHeightCorrection=!1;
Utils.createLayout=function(a,c,d,e){var f=Utils.globalScale;Utils.initialResolution=c;d=window.innerHeight;document.body.style.overflow="hidden";var g;g=""+('<div id="'+Utils.DOMProgressContainerId+'" align="center" style="width: 100%; height: '+d+'px; display: block; width: 100%; position: absolute; left: 0px; top: 0px;">');g+='<table cellspacing="0" cellpadding="0" border="0"><tr><td id="'+Utils.DOMProgressId+'" align="center" valign="middle" style="width: '+c.width+"px; height: "+c.height+"px; color: #000; background: #fff; font-weight: bold; font-family: Verdana; font-size: "+
12*f+'px; vertical-align: middle; box-sizing: border-box"></td></tr></table>';g=g+"</div>"+('<div id="'+Utils.DOMScreenBackgroundContainerId+'" style="width: 100%; height: '+d+'px; position: absolute; left: 0px; top: 0px; display: none; z-index: 2;">');g+='<div id="'+Utils.DOMScreenBackgroundWrapperId+'" style="width: '+c.width+"px; height: "+c.height+'px; position: relative; left: 0px; overflow: hidden;">';e||(g+='<canvas id="'+Utils.DOMScreenBackgroundId+'" width="'+c.width+'" height="'+c.height+
'"></canvas>');g+="</div>";g+="</div>";g+='<div id="'+Utils.DOMScreenContainerId+'" style="width: 100%; height: '+d+'px; position: absolute; left: 0px; top: 0px; display: none; z-index: 3;">';g+='<div id="'+Utils.DOMScreenWrapperId+'" width="'+c.width+'" height="'+c.height+'" style="width: '+c.width+"px; height: "+c.height+'px; position: relative; left: 0px; overflow: hidden;">';e||(g+='<canvas id="'+Utils.DOMScreenId+'" style="position: absolute; left: 0px; top: 0px;" width="'+c.width+'" height="'+
c.height+'">You browser does not support this application :(</canvas>');g+="</div>";g+="</div>";a.innerHTML=g;a=document.createElement("div");a.setAttribute("id",Utils.DOMP2lContainerId);a.setAttribute("align","center");a.setAttribute("style","width: 100%; height: "+d+"px; position: absolute; left: 0px; top: 0px; visibility: hidden; z-index: 1000; background-color: #fff; background-image: url("+Utils.imagesRoot+"/p2l.jpg); background-repeat: no-repeat; background-position: center center");c=document.createElement("img");
c.setAttribute("id",Utils.DOMP2lId);c.width=1;c.height=1;c.style.display="none";a.appendChild(c);document.body.appendChild(a);a=document.createElement("div");a.setAttribute("id",Utils.DOMMarkId);a.style.position="fixed";a.style.right="0px";a.style.bottom="0px";a.style.width="1px";a.style.height="1px";a.style.background="";a.style.zIndex="100000";document.body.appendChild(a);Utils.fitLayoutToScreen()};
Utils.showMainLayoutContent=function(){document.getElementById(Utils.DOMProgressContainerId).style.display="none";document.getElementById(Utils.DOMScreenContainerId).style.display="block";document.getElementById(Utils.DOMScreenBackgroundContainerId).style.display="block"};Utils.preventEvent=function(a){a.preventDefault();a.stopPropagation();a.cancelBubble=!0;return a.returnValue=!1};Utils.touchStartEventDisabled=!1;
Utils.preventTouchStart=function(){Utils.touchStartEventDisabled&&Utils.bindEvent(document.body,Utils.getTouchStartEvent(),Utils.preventEvent)};Utils.removePreventTouchStart=function(){Utils.touchStartEventDisabled&&Utils.unbindEvent(document.body,Utils.getTouchStartEvent(),Utils.preventEvent)};
Utils.addMobileListeners=function(a,c){if(c||!navigator.userAgent.match(/(iPad|iPhone|iPod).*CPU.*OS 7_\d/i))Utils.touchStartEventDisabled=!0,Utils.preventTouchStart();Utils.isPlayFreeBrowser()||Utils.bindEvent(window,"scroll",function(a){setTimeout(Utils.mobileHideAddressBar,300)});document.addEventListener(Utils.getVisibiltyProps().visibilityChange,Utils.handleVisibilityChange,!1);setInterval("Utils.checkOrientation("+(a?"true":"false")+")",500);setTimeout(Utils.mobileHideAddressBar,500)};
Utils.handleVisibilityChange=function(){Utils.isWindowHidden=document[Utils.getVisibiltyProps().hidden];Utils.dispatchEvent(Utils.isWindowHidden?"hidewindow":"showwindow")};
Utils.getVisibiltyProps=function(){var a,c;"undefined"!==typeof document.hidden?(a="hidden",c="visibilitychange"):"undefined"!==typeof document.mozHidden?(a="mozHidden",c="mozvisibilitychange"):"undefined"!==typeof document.msHidden?(a="msHidden",c="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(a="webkitHidden",c="webkitvisibilitychange");return{hidden:a,visibilityChange:c}};Utils.staticWindowRect=null;Utils.setWindowRect=function(a,c){Utils.staticWindowRect={width:a,height:c}};
Utils.getWindowRect=function(){var a=document.getElementById(Utils.DOMMarkId);return Utils.isAndroid()&&a?{width:window.innerWidth,height:a.offsetTop+1}:{width:window.innerWidth,height:window.innerHeight}};Utils.storeOrient=null;Utils.noCheckOrient=!1;
Utils.checkOrientation=function(a){if(Utils.touchScreen&&document.getElementById(Utils.DOMScreenContainerId)&&!Utils.noCheckOrient&&1!=Utils.parseGet().nocheckorient){var c=Utils.getWindowRect(),c=c.width>c.height;Utils.storeOrient!==c&&(Utils.storeOrient=c,c!=a?(Utils.dispatchEvent("lockscreen"),document.getElementById(Utils.DOMP2lContainerId).style.visibility="visible",document.getElementById(Utils.DOMProgressContainerId).style.visibility="hidden",document.getElementById(Utils.DOMScreenBackgroundContainerId).style.display=
"none",document.getElementById(Utils.DOMScreenContainerId).style.display="none"):(Utils.dispatchEvent("unlockscreen"),document.getElementById(Utils.DOMP2lContainerId).style.visibility="hidden",document.getElementById(Utils.DOMProgressContainerId).style.visibility="visible",document.getElementById(Utils.DOMScreenBackgroundContainerId).style.display="block",document.getElementById(Utils.DOMScreenContainerId).style.display="block"),setTimeout(Utils.mobileHideAddressBar,900),setTimeout(Utils.fitLayoutToScreen,
1E3))}};Utils.fitLayoutTimer=null;Utils.addFitLayoutListeners=function(){Utils.fitLayoutTimer=setInterval(Utils.fitLayoutToScreen,500)};Utils.removeFitLayoutListeners=function(){clearInterval(Utils.fitLayoutTimer)};Utils.fitLayoutLock=!1;Utils.fitLayoutCorrectHeight=0;Utils.fitLayoutAlign="center";Utils.fitLayoutVerticalAlign="top";Utils.layoutMargin={left:0,right:0,top:0,bottom:0};
Utils.fitLayoutToScreen=function(a){if(!Utils.fitLayoutLock){var c,d,e,f,g;g=Utils.getWindowRect();"object"==typeof a&&a.width||(f=Utils.staticWindowRect?Utils.staticWindowRect:g,d=f.width,e=f.height,e+=Utils.fitLayoutCorrectHeight,e-=Utils.layoutMargin.top,e-=Utils.layoutMargin.bottom,d-=Utils.layoutMargin.left,d-=Utils.layoutMargin.right,a={width:d,height:e});if(c=document.getElementById(Utils.DOMScreenWrapperId)){c.initWidth||(c.initWidth=Utils.initialResolution.width,c.initHeight=Utils.initialResolution.height);
d=c.initWidth;e=c.initHeight;var h=1,h=a.width/d,k=a.height/e,h=h<k?h:k;Utils.globalPixelScale=h;d=Math.floor(d*h);e=Math.floor(e*h);if(c.lastWidth!=a.width||c.lastHeight!=a.height||c.lastRealWidth!=g.width||c.lastRealHeight!=g.height)c.lastWidth=a.width,c.lastHeight=a.height,c.lastRealWidth=g.width,c.lastRealHeight=g.height,Utils.resizeElement(Utils.DOMScreenId,d,e),Utils.resizeElement(Utils.DOMScreenBackgroundId,d,e),Utils.resizeElement(Utils.DOMProgressContainerId,f.width,f.height),Utils.resizeElement(Utils.DOMProgressId,
d,e),c=Utils.resizeElement(Utils.DOMScreenWrapperId,d,e),Utils.alignElement(c,g,d,e),c=Utils.resizeElement(Utils.DOMScreenBackgroundWrapperId,d,e),Utils.alignElement(c,g,d,e),Utils.resizeElement(Utils.DOMP2lContainerId,f.width,f.height),Utils.resizeElement(Utils.DOMScreenContainerId,f.width,f.height),Utils.resizeElement(Utils.DOMScreenBackgroundContainerId,f.width,f.height),Utils.dispatchEvent("fitlayout"),Utils.isPlayFreeBrowser()&&window.scrollTo(1,2),setTimeout(Utils.mobileHideAddressBar,10)}}};
Utils.alignElement=function(a,c,d,e){a&&(a.style.left="left"==Utils.fitLayoutAlign?Utils.layoutMargin.left+"px":"right"==Utils.fitLayoutAlign?Math.floor(c.width-d-Utils.layoutMargin.right)+"px":Math.floor((c.width-d-Utils.layoutMargin.left-Utils.layoutMargin.right)/2)+"px",a.style.top="top"==Utils.fitLayoutVerticalAlign?Utils.layoutMargin.top+"px":"bottom"==Utils.fitLayoutVerticalAlign?Math.floor(c.height-e-Utils.layoutMargin.bottom)+"px":Math.floor((c.height-e-Utils.layoutMargin.top-Utils.layoutMargin.bottom)/
2)+"px")};Utils.resizeElement=function(a,c,d){a=document.getElementById(a);if(!a)return null;a.style.width=Math.floor(c)+"px";a.style.height=Math.floor(d)+"px";return a};Utils.drawIphoneLimiter=function(a,c){c?a.drawRectangle(240,295,480,54,"#f00",!0,.5,!0):a.drawRectangle(160,448,320,64,"#f00",!0,.5,!0)};
Utils.drawGrid=function(a,c,d){"undefined"==typeof c&&(c=!1);"undefined"==typeof d&&(d="#FFF");var e=c?480:320;c=c?320:480;for(var f=10;f<e;f+=10){var g=.1+(f-10)/10%10*.1;a.drawLine(f,0,f,c,1,d,g)}for(f=10;f<c;f+=10)g=.1+(f-10)/10%10*.1,a.drawLine(0,f,e,f,1,d,g)};
Utils.drawScaleFix=function(a,c){.75==Utils.globalScale&&(c?a.drawRectangle(507,160,54,320,"#000",!0,1,!0):a.drawRectangle(160,507,320,54,"#000",!0,1,!0));1.5==Utils.globalScale&&(c?a.drawRectangle(510,160,60,320,"#000",!0,1,!0):a.drawRectangle(160,510,320,60,"#000",!0,1,!0))};Utils.grad2radian=function(a){return a/(180/Math.PI)};Utils.radian2grad=function(a){return 180/Math.PI*a};Utils.eventsListeners=[];Utils.onlockscreen=null;Utils.onunlockscreen=null;Utils.onhidewindow=null;
Utils.onshowwindow=null;Utils.onfitlayout=null;Utils.addEventListener=function(a,c){EventsManager.addEvent(Utils,a,c)};Utils.removeEventListener=function(a,c){EventsManager.removeEvent(Utils,a,c)};Utils.dispatchEvent=function(a,c){return EventsManager.dispatchEvent(Utils,a,c)};Utils.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};Utils.isPlainObject=function(a){return a&&a.constructor?a.constructor===Object:!1};
Utils.getFunctionArguments=function(a,c){"undefined"==typeof c&&(c=0);return[].slice.call(a,c)};Utils.proxy=function(a,c){var d=Utils.getFunctionArguments(arguments,2);return function(){return a.apply(c||this,Utils.getFunctionArguments(arguments,0).concat(d))}};Utils.extend=function(a,c){var d=function(){};d.prototype=c.prototype;a.prototype=new d;a.prototype.constructor=a;a.superclass=c.prototype};
Utils.callSuperConstructor=function(a,c){a.superclass.constructor.apply(c,Utils.getFunctionArguments(arguments,2))};Utils.callSuperMethod=function(a,c,d){return a.superclass[d].apply(c,Utils.getFunctionArguments(arguments,3))};
Utils.copyObjectProps=function(a,c){for(var d in a)if(a.hasOwnProperty(d))if(Utils.isArray(a[d])){c[d]=[];for(var e=0;e<a[d].length;e++)"object"==typeof a[d][e]&&(c[d][e]=Utils.cloneEmptyObject(a[d][e])),Utils.copyObjectProps(a[d][e],c[d][e])}else Utils.isPlainObject(a[d])?(c[d]={},Utils.copyObjectProps(a[d],c[d])):c[d]=a[d]};Utils.cloneEmptyObject=function(a){return a.constructor?new a.constructor:{}};
Utils.clone=function(a){if(!a||"object"!=typeof a)return a;var c=Utils.cloneEmptyObject(a);Utils.copyObjectProps(a,c);return c};Utils.switchToTimeMode=function(a){Tween.STEP_TYPE=Tween.STEP_BY_TIME;StageTimer.TIMEOUT_TYPE=StageTimer.TIMEOUT_BY_TIME;Sprite.CHANGE_FRAME_TYPE=Sprite.CHANGE_FRAME_BY_TIME;Sprite.CHANGE_FRAME_DELAY=a};
Utils.getGameID=function(){if(window.GAME_ID&&"my_game"!=window.GAME_ID)return window.GAME_ID;for(var a=window.location.toString().split("/"),c="";!c;)c=a.pop(),1<c.split(".").length&&(c=""),0==a.length&&(c="my_game");return c};
Utils.ajax=function(a,c,d,e,f,g){var h;h=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");h.onreadystatechange=function(){if(4==h.readyState)if(200==h.status){var a=h.responseText;"json"==e&&(a=JSON.parse(a));"xml"==e&&(a=Utils.parseXMLString(a));f&&f(a,h)}else g&&g(h.status,h)};if(d){var k=[],l;for(l in d)k.push(encodeURIComponent(l)+"="+encodeURIComponent(d[l]));d=k.join("&")}else d="";c||(c="GET");h.open(c,a+("GET"==c?"?"+d:""),!0);"POST"==c&&h.setRequestHeader("Content-type",
"application/x-www-form-urlencoded");h.send("GET"!=c?d:null)};Utils.get=function(a,c,d,e,f){Utils.ajax(a,"GET",c,d,e,f)};Utils.post=function(a,c,d,e,f){Utils.ajax(a,"POST",c,d,e,f)};Utils.getBezierBasis=function(a,c,d){function e(a){return 1>=a?1:a*e(a-1)}return e(c)/(e(a)*e(c-a))*Math.pow(d,a)*Math.pow(1-d,c-a)};
Utils.getBezierCurve=function(a,c){"undefined"==typeof c&&(c=.1);var d=[];c/=a.length;for(var e=0;e<1+c;e+=c){1<e&&(e=1);var f=d.length;d[f]={x:0,y:0};for(var g=0;g<a.length;g++){var h=Utils.getBezierBasis(g,a.length-1,e);d[f].x+=a[g].x*h;d[f].y+=a[g].y*h}}return d};
Utils.parseXMLString=function(a){var c=null;if("undefined"!=typeof window.DOMParser)c=(new window.DOMParser).parseFromString(a,"text/xml");else if("undefined"!=typeof window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM"))c=new window.ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(a);else throw Error("No XML parser found");return c};
Utils.gotoFullScreen=function(){var a=document.documentElement;a.requestFullscreen&&a.requestFullscreen();a.webkitRequestFullscreen&&a.webkitRequestFullscreen();a.mozRequestFullscreen&&a.mozRequestFullscreen();a.msRequestFullscreen&&a.msRequestFullscreen()};
Utils.cancelFullScreen=function(){document.cancelFullScreen&&document.cancelFullScreen();document.webkitCancelFullScreen&&document.webkitCancelFullScreen();document.mozCancelFullScreen&&document.mozCancelFullScreen();document.msExitFullscreen&&document.msExitFullscreen()};Utils.isFullScreen=function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)};
Utils.isFullScreenEnabled=function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullscreenEnabled||document.msFullscreenEnabled)};Utils.toggleFullScreen=function(){Utils.isFullScreen()?Utils.cancelFullScreen():Utils.gotoFullScreen()};Utils.sign=function(a){return 0==a?0:0<a?1:-1};
function ImagesPreloader(){this.curItem=-1;this.loadedImages={};this.processCallback=this.endCallback=this.data=null;this.minProgressVal=0;this.maxProgressVal=100;this.wait=Utils.proxy(this.wait,this)}ImagesPreloader.prototype.load=function(a,c,d){this.data=a;this.endCallback=c;this.processCallback=d;for(a=0;a<this.data.length;a++)c=this.data[a],d=new Image,d.src=c.src,this.loadedImages[c.name]=d;this.wait()};
ImagesPreloader.prototype.wait=function(){var a=0,c=0,d;for(d in this.loadedImages)this.loadedImages[d].complete&&a++,c++;a>=c?this.endCallback&&this.endCallback(this.loadedImages):(this.processCallback&&this.processCallback(Math.floor(a/c*this.maxProgressVal+this.minProgressVal)),setTimeout(this.wait,50))};function SoundsPreloader(a,c,d){this.sounds=a;this.endCallback=c;this.progressCallback=d;this.minProgressVal=this.loadedCount=0;this.maxProgressVal=100}
SoundsPreloader.prototype.isMp3Support=function(){return""!=document.createElement("audio").canPlayType("audio/mpeg")};SoundsPreloader.prototype.isWebAudio=function(){return Boolean(window.AudioMixer)&&AudioMixer.isWebAudioSupport()};
SoundsPreloader.prototype.load=function(a,c,d){a&&(this.sounds=a);c&&(this.endCallback=c);d&&(this.progressCallback=d);if(!this.sounds||1>this.sounds.length||!this.isWebAudio())this.endCallback&&this.endCallback();else{a=this.isMp3Support()?"mp3":"ogg";var e;this.loadedCount=0;var f=this;for(d=0;d<this.sounds.length;d++)c=this.sounds[d]+"."+a,this.isWebAudio()?(e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),e.open("GET",c,!0),e.responseType="arraybuffer",e.onreadystatechange=
function(){if(4==this.readyState&&200==this.status){var a=this.soundSrc;AudioMixer.waContext||(AudioMixer.waContext=new AudioContext);AudioMixer.waContext.decodeAudioData(this.response,function(c){AudioMixer.buffer[a]=c;f.soundIsLoaded(null,f)},function(a){f.soundIsLoaded(null,f)})}},e.soundSrc=c,e.send()):(e=document.createElement("audio"),e.src=c,e.type="mp3"==a?"audio/mpeg":"audio/ogg",e.preload="auto",e.load(),e.addEventListener("canplay",Utils.proxy(this.soundIsLoaded,e,this)),e.addEventListener("canplaythrough",
Utils.proxy(this.soundIsLoaded,e,this)))}};SoundsPreloader.prototype.soundIsLoaded=function(a,c){if(this.nodeName&&"audio"==this.nodeName.toLowerCase()){if(this.alreadyLoaded)return;this.alreadyLoaded=!0}c.loadedCount++;c.progressCallback&&c.progressCallback(Math.floor(c.loadedCount/c.sounds.length*c.maxProgressVal+c.minProgressVal));c.loadedCount>=c.sounds.length&&c.endCallback&&c.endCallback()};
function Asset(a,c,d,e,f,g){this.name=a+"";this.src=c+"";this.width=d;this.height=e;this.frames=f;this.layers=g;this.object=this.bitmap=null;this.ready=!(!this.width||!this.height);this.spriteClass=null}Asset.prototype.detectSize=function(){if(!this.bitmap)return!1;try{isNaN(this.width)&&(this.width=this.bitmap.width?parseInt(this.bitmap.width):0),isNaN(this.height)&&(this.height=this.bitmap.height?parseInt(this.bitmap.height):0)}catch(a){CRENDER_DEBUG&&console.log(a)}return!isNaN(this.width)&&!isNaN(this.height)};
Asset.prototype.normalize=function(a){if(!this.ready&&this.detectSize()){if(isNaN(this.frames)||1>this.frames)this.frames=1;if(isNaN(this.layers)||1>this.layers)this.layers=1;this.width=Math.ceil(this.width/this.layers/a);this.height=Math.ceil(this.height/this.frames/a);this.ready=!0}};
function AssetsLibrary(a,c,d){this.path="images";this.scale=1;this.items={};this.bitmaps={};this.loaded=!1;this.onloadprogress=this.onload=null;this.spriteClass=Sprite;this.onLoadHandler=Utils.proxy(this.onLoadHandler,this);this.onLoadProgressHandler=Utils.proxy(this.onLoadProgressHandler,this);this.init(a,c);this.addAssets(d)}AssetsLibrary.prototype.init=function(a,c){"undefined"!=typeof a&&(this.path=a+"");"undefined"!=typeof c&&(this.scale=parseFloat(c),isNaN(this.scale)&&(this.scale=1))};
AssetsLibrary.prototype.load=function(a,c,d,e){this.onload=a;this.onloadprogress=c;a=new ImagesPreloader;c=[];for(var f in this.items)c.push(this.items[f]);"undefined"!=typeof d&&(a.minProgressVal=d);"undefined"!=typeof e&&(a.maxProgressVal=e);a.load(c,this.onLoadHandler,this.onLoadProgressHandler)};AssetsLibrary.prototype.onLoadProgressHandler=function(a){if("function"==typeof this.onloadprogress)this.onloadprogress(a)};
AssetsLibrary.prototype.onLoadHandler=function(a){this.loaded=!0;for(var c in a){var d=this.items[c];d.bitmap=a[c];d.normalize(this.scale)}if("function"==typeof this.onload)this.onload(this.items)};AssetsLibrary.prototype.addAssets=function(a){if("undefined"!=typeof a&&"object"==typeof a)for(var c=0;c<a.length;c++){var d=a[c];d.noscale="undefined"==typeof d.noscale?!1:d.noscale;d.noscale||(d.src="%SCALE%/"+d.src);this.addAsset(d)}};
AssetsLibrary.prototype.addAsset=function(a,c,d,e,f,g){var h=null;"object"==typeof a&&1==arguments.length&&(c=a.name,d=a.width||NaN,e=a.height||NaN,f=a.frames||1,g=a.layers||1,h=a.spriteClass||null,properties=a.properties||null,a=a.src);a=a.replace("%SCALE%","%PATH%/"+this.scale);a=a.replace("%PATH%",this.path);if("undefined"==typeof c){var k=a.split("/"),k=k.pop(),k=k.split(".");c=k=k.shift()+""}k=new Asset(c,a,d,e,f,g);k.spriteClass=h;if(properties)for(var l in properties)"undefined"==typeof k[l]&&
(k[l]=properties[l]);return this.items[c]=k};AssetsLibrary.prototype.addObject=function(a){var c=this.addAsset("%SCALE%/"+a.image,a.name,a.width*this.scale,a.height*this.scale,a.frames,a.layers);c&&(c.object=a);return c};AssetsLibrary.prototype.getAsset=function(a,c){var d=null;"undefined"!=typeof this.items[a]&&this.items[a].bitmap&&(d="undefined"!=typeof c&&!c||this.items[a].ready?this.items[a]:null);if(!d)throw Error('Trying to get undefined asset "'+a+'"');return d};
AssetsLibrary.prototype.getSprite=function(a,c,d){var e=null,e=null;try{e=this.getAsset(a,!0)}catch(f){e=new Asset}if((d=d||e.spriteClass||this.spriteClass||window.Sprite)&&"function"==typeof d||"function"==typeof window[d])d="function"==typeof d?d:window[d];e=d.create&&"function"==typeof d.create?d.create(e,this):new d(e.bitmap,e.width,e.height,e.frames,e.layers);if(c&&"object"==typeof c)for(var g in c)e[g]=c[g];return e};AssetsLibrary.prototype.getBitmap=function(a){try{return this.getAsset(a,!0).bitmap}catch(c){return null}};
function Vector(a,c){"undefined"==typeof a&&(a=0);this.x=a;"undefined"==typeof c&&(c=0);this.y=c}Vector.prototype.isZero=function(){return 0==this.x&&0==this.y};Vector.prototype.clone=function(){return new Vector(this.x,this.y)};Vector.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};Vector.prototype.subtract=function(a){this.x-=a.x;this.y-=a.y;return this};Vector.prototype.mult=function(a){this.x*=a;this.y*=a;return this};Vector.prototype.invert=function(){this.mult(-1);return this};
Vector.prototype.rotate=function(a,c){"undefined"==typeof c&&(c=new Vector(0,0));var d=this.clone();d.subtract(c);d.x=this.x*Math.cos(a)+this.y*Math.sin(a);d.y=this.x*-Math.sin(a)+this.y*Math.cos(a);d.add(c);this.x=d.x;this.y=d.y;return this};Vector.prototype.normalize=function(a,c){"undefined"==typeof c&&(c=new Vector(0,0));this.subtract(c);this.rotate(-a);return this};Vector.prototype.getLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};
Vector.prototype.distanceTo=function(a){p2=this.clone();p2.subtract(a);return p2.getLength()};function Rectangle(a,c,d,e,f){this.center=new Vector(a,c);this.width=d;this.height=e;this.angle=f;this.vertices=[];this.AABB=[];this.refreshVertices()}Rectangle.prototype.clone=function(){return new Rectangle(this.center.x,this.center.y,this.width,this.height,this.angle)};
Rectangle.prototype.refreshVertices=function(){var a=this.width/2,c=this.height/2;this.vertices=[];this.vertices.push(new Vector(-a,c));this.vertices.push(new Vector(a,c));this.vertices.push(new Vector(a,-c));this.vertices.push(new Vector(-a,-c));this.AABB=[this.center.clone(),this.center.clone()];for(a=0;4>a;a++)this.vertices[a].rotate(-this.angle,this.center),this.vertices[a].x<this.AABB[0].x&&(this.AABB[0].x=this.vertices[a].x),this.vertices[a].x>this.AABB[1].x&&(this.AABB[1].x=this.vertices[a].x),
this.vertices[a].y<this.AABB[0].y&&(this.AABB[0].y=this.vertices[a].y),this.vertices[a].y>this.AABB[1].y&&(this.AABB[1].y=this.vertices[a].y)};Rectangle.prototype.move=function(a,c){this.center.add(new Vector(a,c));this.refreshVertices()};Rectangle.prototype.rotate=function(a){this.angle+=a;this.refreshVertices()};Rectangle.prototype.hitTestPoint=function(a){a=a.clone();a.normalize(-this.angle,this.center);return Math.abs(a.x)<=this.width/2&&Math.abs(a.y)<=this.height/2};
Rectangle.prototype.hitTestRectangle=function(a){var c=this.clone();a=a.clone();var d,e,f;c.move(-this.center.x,-this.center.y);a.move(-this.center.x,-this.center.y);a.center.rotate(this.angle);c.rotate(-this.angle);a.rotate(-this.angle);d=Math.max(c.AABB[0].x,c.AABB[1].x,a.AABB[0].x,a.AABB[1].x)-Math.min(c.AABB[0].x,c.AABB[1].x,a.AABB[0].x,a.AABB[1].x);e=c.AABB[1].x-c.AABB[0].x;f=a.AABB[1].x-a.AABB[0].x;if(d>e+f)return!1;d=Math.max(c.AABB[0].y,c.AABB[1].y,a.AABB[0].y,a.AABB[1].y)-Math.min(c.AABB[0].y,
c.AABB[1].y,a.AABB[0].y,a.AABB[1].y);e=c.AABB[1].y-c.AABB[0].y;f=a.AABB[1].y-a.AABB[0].y;if(d>e+f)return!1;c.move(-a.center.x,-a.center.y);a.move(-a.center.x,-a.center.y);c.center.rotate(a.angle);c.refreshVertices();c.rotate(-a.angle);a.rotate(-a.angle);d=Math.max(c.AABB[0].x,c.AABB[1].x,a.AABB[0].x,a.AABB[1].x)-Math.min(c.AABB[0].x,c.AABB[1].x,a.AABB[0].x,a.AABB[1].x);e=c.AABB[1].x-c.AABB[0].x;f=a.AABB[1].x-a.AABB[0].x;if(d>e+f)return!1;d=Math.max(c.AABB[0].y,c.AABB[1].y,a.AABB[0].y,a.AABB[1].y)-
Math.min(c.AABB[0].y,c.AABB[1].y,a.AABB[0].y,a.AABB[1].y);e=c.AABB[1].y-c.AABB[0].y;f=a.AABB[1].y-a.AABB[0].y;return d>e+f?!1:!0};
var EventsManager={addEvent:function(a,c,d){if(a.eventsListeners){for(var e=0;e<a.eventsListeners.length;e++)if(a.eventsListeners[e].type===c&&a.eventsListeners[e].callback===d)return;a.eventsListeners.push({type:c,callback:d})}},removeEvent:function(a,c,d){if(a.eventsListeners)for(var e=0;e<a.eventsListeners.length;e++)if(a.eventsListeners[e].type===c&&a.eventsListeners[e].callback===d){a.eventsListeners=Utils.removeFromArray(a.eventsListeners,a.eventsListeners[e]);break}},dispatchEvent:function(a,
c,d){if(a.eventsListeners){var e;if("function"==typeof a["on"+c]&&(e=a["on"+c](d),!1===e))return!1;for(var f=0;f<a.eventsListeners.length;f++)if(a.eventsListeners[f].type===c&&(e=a.eventsListeners[f].callback(d),!1===e))return!1}},hasEventListener:function(a,c){if(a.eventsListeners){for(var d=0;d<a.eventsListeners.length;d++)if(a.eventsListeners[d].type===c)return!0;return!1}},removeAllEventListeners:function(a,c){if(a.eventsListeners){"undefined"==typeof c&&(a.eventsListeners=[]);for(var d=[],e=
0;e<a.eventsListeners.length;e++)a.eventsListeners[e].type!==c&&d.push(a.eventsListeners[e]);a.eventsListeners=d}}};function EventsProxy(){this.eventsListeners=[]}EventsProxy.prototype.addEventListener=function(a,c){EventsManager.addEvent(this,a,c)};EventsProxy.prototype.removeEventListener=function(a,c){EventsManager.removeEvent(this,a,c)};EventsProxy.prototype.dispatchEvent=function(a,c){return EventsManager.dispatchEvent(this,a,c)};
EventsProxy.prototype.hasEventListener=function(a){return EventsManager.hasEventListener(this,a)};EventsProxy.prototype.removeAllEventListeners=function(a){EventsManager.removeAllEventListeners(this,a)};
var Easing={back:{easeIn:function(a,c,d,e){return d*(a/=e)*a*(2.70158*a-1.70158)+c},easeOut:function(a,c,d,e){return d*((a=a/e-1)*a*(2.70158*a+1.70158)+1)+c},easeInOut:function(a,c,d,e){var f=1.70158;return 1>(a/=e/2)?d/2*a*a*(((f*=1.525)+1)*a-f)+c:d/2*((a-=2)*a*(((f*=1.525)+1)*a+f)+2)+c}},bounce:{easeIn:function(a,c,d,e){return d-Easing.bounce.easeOut(e-a,0,d,e)+c},easeOut:function(a,c,d,e){return(a/=e)<1/2.75?7.5625*d*a*a+c:a<2/2.75?d*(7.5625*(a-=1.5/2.75)*a+.75)+c:a<2.5/2.75?d*(7.5625*(a-=2.25/
2.75)*a+.9375)+c:d*(7.5625*(a-=2.625/2.75)*a+.984375)+c},easeInOut:function(a,c,d,e){return a<e/2?.5*Easing.bounce.easeIn(2*a,0,d,e)+c:.5*Easing.bounce.easeOut(2*a-e,0,d,e)+.5*d+c}},circular:{easeIn:function(a,c,d,e){return-d*(Math.sqrt(1-(a/=e)*a)-1)+c},easeOut:function(a,c,d,e){return d*Math.sqrt(1-(a=a/e-1)*a)+c},easeInOut:function(a,c,d,e){return 1>(a/=e/2)?-d/2*(Math.sqrt(1-a*a)-1)+c:d/2*(Math.sqrt(1-(a-=2)*a)+1)+c}},cubic:{easeIn:function(a,c,d,e){return d*(a/=e)*a*a+c},easeOut:function(a,c,
d,e){return d*((a=a/e-1)*a*a+1)+c},easeInOut:function(a,c,d,e){return 1>(a/=e/2)?d/2*a*a*a+c:d/2*((a-=2)*a*a+2)+c}},exponential:{easeIn:function(a,c,d,e){return 0==a?c:d*Math.pow(2,10*(a/e-1))+c},easeOut:function(a,c,d,e){return a==e?c+d:d*(-Math.pow(2,-10*a/e)+1)+c},easeInOut:function(a,c,d,e){return 0==a?c:a==e?c+d:1>(a/=e/2)?d/2*Math.pow(2,10*(a-1))+c:d/2*(-Math.pow(2,-10*--a)+2)+c}},linear:{easeIn:function(a,c,d,e){return d*a/e+c},easeOut:function(a,c,d,e){return d*a/e+c},easeInOut:function(a,
c,d,e){return d*a/e+c}},quadratic:{easeIn:function(a,c,d,e){return d*(a/=e)*a+c},easeOut:function(a,c,d,e){return-d*(a/=e)*(a-2)+c},easeInOut:function(a,c,d,e){return 1>(a/=e/2)?d/2*a*a+c:-d/2*(--a*(a-2)-1)+c}},quartic:{easeIn:function(a,c,d,e){return d*(a/=e)*a*a*a+c},easeOut:function(a,c,d,e){return-d*((a=a/e-1)*a*a*a-1)+c},easeInOut:function(a,c,d,e){return 1>(a/=e/2)?d/2*a*a*a*a+c:-d/2*((a-=2)*a*a*a-2)+c}},quintic:{easeIn:function(a,c,d,e){return d*(a/=e)*a*a*a*a+c},easeOut:function(a,c,d,e){return d*
((a=a/e-1)*a*a*a*a+1)+c},easeInOut:function(a,c,d,e){return 1>(a/=e/2)?d/2*a*a*a*a*a+c:d/2*((a-=2)*a*a*a*a+2)+c}},sine:{easeIn:function(a,c,d,e){return-d*Math.cos(a/e*(Math.PI/2))+d+c},easeOut:function(a,c,d,e){return d*Math.sin(a/e*(Math.PI/2))+c},easeInOut:function(a,c,d,e){return-d/2*(Math.cos(Math.PI*a/e)-1)+c}},smoothstep:{easeIn:function(a,c,d,e){a=a/e/2;return 2*a*a*(3-2*a)*d+c},easeOut:function(a,c,d,e){a=(a/e+1)/2;return(2*a*a*(3-2*a)-1)*d+c},easeInOut:function(a,c,d,e){a/=e;return a*a*(3-
2*a)*d+c}}};
function Tween(a,c,d,e,f,g){Utils.callSuperConstructor(Tween,this);"object"!=typeof a&&(a=null);if(a){if("undefined"==typeof a[c])throw Error('Trying to tween undefined property "'+c+'"');if(isNaN(a[c]))throw Error("Tweened value can not be "+typeof a[c]);}else if(isNaN(c))throw Error("Tweened value can not be "+typeof c);"function"!=typeof g&&(g=Easing.linear.easeIn);this.obj=a;this.prop=c;this.onfinish=this.onchange=null;this.start=d;this.end=e;this.duration=~~f;this.callback=g;this.playing=!1;
this._pos=-1;this.newly=!0;this.eventsListeners=[]}Utils.extend(Tween,EventsProxy);Tween.prototype.play=function(){this.playing=!0;this.tick(0)};Tween.prototype.pause=function(){this.playing=!1};Tween.prototype.rewind=function(){this._pos=-1};Tween.prototype.forward=function(){this._pos=this.duration};Tween.prototype.stop=function(){this.pause();this.rewind()};Tween.prototype.updateValue=function(a){this.obj?this.obj[this.prop]=a:this.prop=a};
Tween.prototype.tick=function(a){if(!this.playing)return!1;a||(a=0);Tween.STEP_TYPE==Tween.STEP_BY_FRAME?this._pos++:this._pos+=a;if(0>this._pos)return!1;if(this._pos>this.duration)return this.finish();a=this.callback;a=a(this._pos,this.start,this.end-this.start,this.duration);this.updateValue(a);this.dispatchEvent("change",{target:this,value:a});return!1};
Tween.prototype.finish=function(){this.stop();this.updateValue(this.end);return!1===this.dispatchEvent("finish",{target:this,value:this.end})?!1:!0};Tween.STEP_BY_FRAME=0;Tween.STEP_BY_TIME=1;Tween.STEP_TYPE=Tween.STEP_BY_FRAME;function DisplayObjectContainer(){Utils.callSuperConstructor(DisplayObjectContainer,this);this.objects=[];this.anchor={x:0,y:0}}Utils.extend(DisplayObjectContainer,EventsProxy);DisplayObjectContainer.prototype.objectsCounter=0;DisplayObjectContainer.prototype.scaleX=1;
DisplayObjectContainer.prototype.scaleY=1;DisplayObjectContainer.prototype.opacity=1;DisplayObjectContainer.prototype.x=0;DisplayObjectContainer.prototype.y=0;DisplayObjectContainer.prototype.width=0;DisplayObjectContainer.prototype.height=0;DisplayObjectContainer.prototype.skewX=0;DisplayObjectContainer.prototype.skewY=0;DisplayObjectContainer.prototype.rotation=0;DisplayObjectContainer.prototype.parent=null;DisplayObjectContainer.prototype.hitArea=null;
DisplayObjectContainer.prototype.fillColor=null;DisplayObjectContainer.prototype.fillLinearGradient=null;DisplayObjectContainer.prototype.fillRadialGradient=null;DisplayObjectContainer.prototype.fillPattern=null;DisplayObjectContainer.prototype.getAbsoluteRotation=function(){return this.rotation+(this.parent?this.parent.getAbsoluteRotation():0)};DisplayObjectContainer.prototype.getAbsoluteOpacity=function(){return this.opacity*(this.parent?this.parent.getAbsoluteOpacity():1)};
DisplayObjectContainer.prototype.getAbsoluteScaleX=function(){return this.scaleX*(this.parent?this.parent.getAbsoluteScaleX():1)};DisplayObjectContainer.prototype.getAbsoluteScaleY=function(){return this.scaleY*(this.parent?this.parent.getAbsoluteScaleY():1)};DisplayObjectContainer.prototype.getAbsoluteSkewX=function(){return this.skewX+(this.parent?this.parent.getAbsoluteSkewX():0)};
DisplayObjectContainer.prototype.getAbsoluteSkewY=function(){return this.skewY+(this.parent?this.parent.getAbsoluteSkewY():0)};DisplayObjectContainer.prototype.render=function(a,c,d){for(var e=0;e<this.objects.length;e++)obj=this.objects[e],obj.destroy?(this.removeChild(obj),e--):obj.visible&&0!=obj.opacity&&obj.render(a,c,d)};DisplayObjectContainer.prototype.getX=function(){return Math.round(this.x*Utils.globalScale)};DisplayObjectContainer.prototype.getY=function(){return Math.round(this.y*Utils.globalScale)};
DisplayObjectContainer.prototype.getWidth=function(){return this.width*Math.abs(this.getAbsoluteScaleX())*Utils.globalScale};DisplayObjectContainer.prototype.getHeight=function(){return this.height*Math.abs(this.getAbsoluteScaleY())*Utils.globalScale};DisplayObjectContainer.prototype.getPosition=function(){return{x:this.x,y:this.y}};
DisplayObjectContainer.prototype.setPosition=function(a,c){if("undefined"==typeof c&&"undefined"!=typeof a.x&&"undefined"!=typeof a.y)return this.setPosition(a.x,a.y);this.x=parseFloat(a);this.y=parseFloat(c)};DisplayObjectContainer.prototype.setPropScale=function(a){this.scaleX=this.scaleY=1*a};DisplayObjectContainer.prototype.getAnchor=function(){return this.anchor};
DisplayObjectContainer.prototype.setAnchor=function(a,c){if("undefined"==typeof c&&"undefined"!=typeof a.x&&"undefined"!=typeof a.y)return this.setAnchor(a.x,a.y);this.anchor.x=parseFloat(a);this.anchor.y=parseFloat(c)};
DisplayObjectContainer.prototype.alignAnchor=function(a,c){a=parseInt(a);isNaN(a)&&(a=DisplayObjectContainer.ANCHOR_ALIGN_CENTER);0>a&&(a=DisplayObjectContainer.ANCHOR_ALIGN_LEFT);0<a&&(a=DisplayObjectContainer.ANCHOR_ALIGN_RIGHT);c=parseInt(c);isNaN(c)&&(c=DisplayObjectContainer.ANCHOR_VALIGN_MIDDLE);0>c&&(c=DisplayObjectContainer.ANCHOR_VALIGN_TOP);0<c&&(c=DisplayObjectContainer.ANCHOR_VALIGN_BOTTOM);this.anchor.x=this.width*a/2;this.anchor.y=this.height*c/2;return this.getAnchor()};
DisplayObjectContainer.prototype.getAbsoluteAnchor=function(){return this.getPosition()};DisplayObjectContainer.prototype.getRelativeCenter=function(){var a=this.getAnchor(),c=this.getAbsoluteRotation(),a={x:a.x,y:a.y};0!=c?(a=new Vector(-a.x*this.getAbsoluteScaleX(),-a.y*this.getAbsoluteScaleY()),a.rotate(-c)):(a.x=-(a.x*this.getAbsoluteScaleX()),a.y=-(a.y*this.getAbsoluteScaleY()));return a};
DisplayObjectContainer.prototype.getAbsolutePosition=function(){var a={x:this.x,y:this.y};if(this.parent){var c=this.parent.getAbsolutePosition(),d=this.parent.getAbsoluteRotation();if(0!=d){var e=new Vector(a.x*this.parent.getAbsoluteScaleX(),a.y*this.parent.getAbsoluteScaleY());e.rotate(-d);a.x=c.x+e.x;a.y=c.y+e.y}else a.x=c.x+a.x*this.parent.getAbsoluteScaleX(),a.y=c.y+a.y*this.parent.getAbsoluteScaleY()}return a};
DisplayObjectContainer.prototype.getAbsoluteCenter=function(){var a=this.getAbsolutePosition(),c=this.getRelativeCenter();a.x+=c.x;a.y+=c.y;return a};DisplayObjectContainer.prototype.getCenter=function(){return this.getAbsoluteCenter()};
DisplayObjectContainer.prototype.getHitAreaRectangle=function(){if(!this.hitArea)return this.getDrawRectangle();var a=this.getAbsoluteRotation(),c=this.getAbsoluteScaleX(),d=this.getAbsoluteScaleY(),e=this.getCenter(),f=new Rectangle(0,0,this.hitArea.width*Math.abs(c),this.hitArea.height*Math.abs(d),a);0!=a?(c=new Vector(this.hitArea.x*c,this.hitArea.y*d),c.rotate(-a),f.move(e.x+c.x,e.y+c.y)):f.move(e.x+this.hitArea.x*c,e.y+this.hitArea.x*d);return f};
DisplayObjectContainer.prototype.getDrawRectangle=function(){var a=this.getCenter(),c=new Rectangle(0,0,this.width*Math.abs(this.getAbsoluteScaleX()),this.height*Math.abs(this.getAbsoluteScaleY()),this.getAbsoluteRotation());c.move(a.x,a.y);return c};DisplayObjectContainer.prototype.getAABBRectangle=function(){var a=this.getDrawRectangle(),c=a.AABB[1].x-a.AABB[0].x,d=a.AABB[1].y-a.AABB[0].y;return new Rectangle(a.AABB[0].x+c/2,a.AABB[0].y+d/2,c,d,0)};
DisplayObjectContainer.prototype.localToGlobal=function(a,c){var d="object"==typeof a&&"undefined"!=typeof a.x&&"undefined"!=typeof a.y?new Vector(a.x+0,a.y+0):new Vector(a,c);d.rotate(this.getAbsoluteRotation()).add(this.getAbsolutePosition());return d};
DisplayObjectContainer.prototype.globalToLocal=function(a,c){var d="object"==typeof a&&"undefined"!=typeof a.x&&"undefined"!=typeof a.y?new Vector(a.x+0,a.y+0):new Vector(a,c);d.subtract(this.getAbsolutePosition()).rotate(this.getAbsoluteRotation());return d};DisplayObjectContainer.prototype.findMaxZIndex=function(){for(var a=-1,c=!1,d=0;d<this.objects.length;d++)this.objects[d].zIndex>a&&(a=this.objects[d].zIndex,c=d);return{index:c,zIndex:a}};
DisplayObjectContainer.prototype.findMinZIndex=function(){for(var a=-1,c=!1,d=0;d<this.objects.length;d++)0==d&&(a=this.objects[d].zIndex,c=0),this.objects[d].zIndex<a&&(a=this.objects[d].zIndex,c=d);return{index:c,zIndex:a}};
DisplayObjectContainer.prototype.addChild=function(a){var c=this.findMaxZIndex(),d=a.zIndex;a.zIndex=!1!==c.index?c.zIndex+1:0;this.objectsCounter++;a.uid=this.objectsCounter;a.parent=this;a.setStage(this.stage);this.objects.push(a);0!=d&&this.setChildZIndex(a,~~d);a.dispatchEvent("add",{target:a});return a};DisplayObjectContainer.prototype.setStage=function(a){this.stage=a;for(var c=0;c<this.objects.length;c++)this.objects[c].setStage(a)};
DisplayObjectContainer.prototype.removeChild=function(a){a&&0<=this.objects.indexOf(a)&&(a.clear(),a.removeAllEventListeners(),a.dispatchEvent("remove",{target:a}),a.parent=null,this.objects=Utils.removeFromArray(this.objects,a))};DisplayObjectContainer.prototype.setChildZIndex=function(a,c){a.zIndex=c;this.objects=this.objects.sort(function(a,c){return a.zIndex==c.zIndex?a.uid>c.uid?1:-1:a.zIndex>c.zIndex?1:-1})};
DisplayObjectContainer.prototype.getHitArea=function(){return this.hitArea?this.hitArea:{x:0,y:0,width:this.width,height:this.height}};
DisplayObjectContainer.prototype.hitTest=function(a,c){c||(c=this);if(0==a.getAbsoluteRotation()&&0==c.getAbsoluteRotation()){var d=a.getCenter(),e=c.getCenter(),f=a.width*Math.abs(a.getAbsoluteScaleX()),g=a.height*Math.abs(a.getAbsoluteScaleY()),h=c.width*Math.abs(c.getAbsoluteScaleX()),k=c.height*Math.abs(c.getAbsoluteScaleY()),l=d.x-f/2,d=d.y-g/2,q=e.x-h/2,v=e.y-k/2,w=Math.max(d,v),e=Math.max(l,q),f=Math.min(l+f,q+h),g=Math.min(d+g,v+k)-w;return 0<f-e&&0<g}g=a.getDrawRectangle();k=c.getDrawRectangle();
return g.hitTestRectangle(k)};
DisplayObjectContainer.prototype.hitTestPointObject=function(a,c,d,e,f){var g,h,k,l,q,v,w;"boolean"==typeof a.pixelCheck&&(e=a.pixelCheck);w=a.getHitArea();k=w.width*Math.abs(a.getAbsoluteScaleX());l=w.height*Math.abs(a.getAbsoluteScaleY());q=a.getAbsoluteCenter();g=q.x+w.x-k/2;h=q.y+w.y-l/2;q=c;v=d;a.ignoreViewport||(q+=this.stage.viewport.x,v+=this.stage.viewport.y);w=!1;0==a.getAbsoluteRotation()?g<=q&&h<=v&&g+k>=q&&h+l>=v&&(w=!0):(g=a.getHitAreaRectangle(),g.hitTestPoint(new Vector(q,v))&&(w=
!0));w&&e&&(this.stage.buffer.width=this.stage.canvas.width,this.stage.buffer.height=this.stage.canvas.height,this.stage.clearScreen(this.stage.buffer),a.render(this.stage.buffer,a.static,0),c=this.stage.buffer.ctx.getImageData(Math.floor(c*Utils.globalScale),Math.floor(d*Utils.globalScale),1,1),0==c.data[3]&&(w=!1));!w&&f&&a.dragged&&(w=!0);return w};
DisplayObjectContainer.prototype.getObjectsStackByCoord=function(a,c,d,e){for(var f,g=[],h=this.objects.length-1;0<=h;h--)this.objects[h].visible&&(f=this.objects[h],f.objects&&f.objects.length&&(g=g.concat(f.getObjectsStackByCoord(a,c,d,e))),this.hitTestPointObject(f,a,c,d,e)&&g.push(f));return g};
DisplayObjectContainer.prototype.doDrag=function(a,c){for(var d=0;d<this.objects.length;d++)this.objects[d].doDrag(a,c);if(this.dragged){var d=a,e=c;this.ignoreViewport||(d+=this.stage.viewport.x,e+=this.stage.viewport.y);d-=this.dragX;e-=this.dragY;d=this.parent.globalToLocal(d,e);this.x=d.x;this.y=d.y}};
DisplayObjectContainer.prototype.checkMouseOut=function(a,c){for(var d=this.objects.length-1;0<=d;d--)if(!1===this.objects[d].checkMouseOut(a,c))return;if(this.mouseOn&&0>a.indexOf(this))return this.mouseOn=!1,d=this.stage.finalizeMouseCoords(this,c),this.dispatchEvent("mouseout",{target:this,x:d.x,y:d.y})};DisplayObjectContainer.prototype.getMaxZIndexInStack=function(a){for(var c=-1,d=0,e=0;e<a.length;e++)a[e].zIndex>c&&(c=a[e].zIndex,d=e);return d};
DisplayObjectContainer.prototype.sortStack=function(a,c){return a.sort(function(a,e){a.zIndex==e.zIndex?c?a.uid<e.uid?1:-1:a.uid>e.uid?1:-1:c?a.zIndex<e.zIndex?1:-1:a.zIndex>e.zIndex?1:-1})};DisplayObjectContainer.prototype.clear=function(){for(;this.objects.length;)this.removeChild(this.objects[0])};
DisplayObjectContainer.prototype.getFillStyle=function(a){var c=null;if(this.fillLinearGradient){a=a.ctx.createLinearGradient(this.fillLinearGradient.x0*Utils.globalScale,this.fillLinearGradient.y0*Utils.globalScale,this.fillLinearGradient.x1*Utils.globalScale,this.fillLinearGradient.y1*Utils.globalScale);for(c=0;c<this.fillLinearGradient.points.length;c++)a.addColorStop(this.fillLinearGradient.points[c].point,this.fillLinearGradient.points[c].color);c=a}else if(this.fillRadialGradient){a=a.ctx.createRadialGradient(this.fillRadialGradient.x0*
Utils.globalScale,this.fillRadialGradient.y0*Utils.globalScale,this.fillRadialGradient.r0*Utils.globalScale,this.fillRadialGradient.x1*Utils.globalScale,this.fillRadialGradient.y1*Utils.globalScale,this.fillRadialGradient.r1*Utils.globalScale);for(c=0;c<this.fillRadialGradient.points.length;c++)a.addColorStop(this.fillRadialGradient.points[c].point,this.fillRadialGradient.points[c].color);c=a}else c=this.fillPattern?a.ctx.createPattern(this.fillPattern.img,this.fillPattern.repeat):this.fillColor;
return c};DisplayObjectContainer.ANCHOR_ALIGN_LEFT=-1;DisplayObjectContainer.ANCHOR_ALIGN_CENTER=0;DisplayObjectContainer.ANCHOR_ALIGN_RIGHT=1;DisplayObjectContainer.ANCHOR_VALIGN_TOP=-1;DisplayObjectContainer.ANCHOR_VALIGN_MIDDLE=0;DisplayObjectContainer.ANCHOR_VALIGN_BOTTOM=1;
var ANCHOR_ALIGN_LEFT=DisplayObjectContainer.ANCHOR_ALIGN_LEFT,ANCHOR_ALIGN_CENTER=DisplayObjectContainer.ANCHOR_ALIGN_CENTER,ANCHOR_ALIGN_RIGHT=DisplayObjectContainer.ANCHOR_ALIGN_RIGHT,ANCHOR_VALIGN_TOP=DisplayObjectContainer.ANCHOR_VALIGN_TOP,ANCHOR_VALIGN_MIDDLE=DisplayObjectContainer.ANCHOR_VALIGN_MIDDLE,ANCHOR_VALIGN_BOTTOM=DisplayObjectContainer.ANCHOR_VALIGN_BOTTOM;function DisplayObject(){Utils.callSuperConstructor(DisplayObject,this)}Utils.extend(DisplayObject,DisplayObjectContainer);
DisplayObject.prototype.uid=0;DisplayObject.prototype.stage=null;DisplayObject.prototype.shadowColor=null;DisplayObject.prototype.shadowOffsetX=0;DisplayObject.prototype.shadowOffsetY=0;DisplayObject.prototype.shadowBlur=0;DisplayObject.prototype.zIndex=0;DisplayObject.prototype.visible=!0;DisplayObject.prototype.static=!1;DisplayObject.prototype.ignoreViewport=!1;DisplayObject.prototype.destroy=!1;DisplayObject.prototype.dragged=!1;DisplayObject.prototype.dragX=0;DisplayObject.prototype.dragY=0;
DisplayObject.prototype.mouseOn=!1;DisplayObject.prototype.allowDebugDrawing=!0;DisplayObject.prototype.pixelCheck=null;DisplayObject.prototype.onmouseover=null;DisplayObject.prototype.onmouseout=null;DisplayObject.prototype.onmousedown=null;DisplayObject.prototype.onmouseup=null;DisplayObject.prototype.onclick=null;DisplayObject.prototype.oncontextmenu=null;DisplayObject.prototype.onmousemove=null;DisplayObject.prototype.onprerender=null;DisplayObject.prototype.onenterframe=null;
DisplayObject.prototype.onrender=null;DisplayObject.prototype.onadd=null;DisplayObject.prototype.onremove=null;DisplayObject.prototype.onbox2dsync=null;DisplayObject.prototype.setStatic=function(a,c){a=Boolean(a);if(!c)for(var d=0;d<this.objects.length;d++)this.objects[d].setStatic(a);return this.static!=a?(this.static=a,this.stage&&this.stage.refreshBackground(),!0):!1};DisplayObject.prototype.startDrag=function(a,c){this.dragged=!0;this.dragX=a;this.dragY=c};
DisplayObject.prototype.stopDrag=function(){this.dragged=!1;this.dragY=this.dragX=0};DisplayObject.prototype.removeTweens=function(){this.stage&&this.stage.clearObjectTweens(this)};DisplayObject.prototype.addTween=function(a,c,d,e,f,g){if(this.stage){var h=this[a];if(!isNaN(h))return a=this.stage.createTween(this,a,h,c,d,e),a.onchange=g,a.onfinish=f,a}};
DisplayObject.prototype.moveTo=function(a,c,d,e,f,g){d=~~d;0>=d?this.setPosition(a,c):((a=this.addTween("x",a,d,e))&&a.play(),(c=this.addTween("y",c,d,e,f,g))&&c.play());return this};DisplayObject.prototype.moveBy=function(a,c,d,e,f,g){return this.moveTo(this.x+a,this.y+c,d,e,f,g)};DisplayObject.prototype.fadeTo=function(a,c,d,e,f){c=~~c;0>=c?this.opacity=a:(a=this.addTween("opacity",a,c,d,e,f))&&a.play();return this};
DisplayObject.prototype.fadeBy=function(a,c,d,e,f){a=Math.max(0,Math.min(1,this.opacity+a));return this.fadeTo(a,c,d,e,f)};DisplayObject.prototype.rotateTo=function(a,c,d,e,f){c=~~c;0>=c?this.rotation=a:(a=this.addTween("rotation",a,c,d,e,f))&&a.play();return this};DisplayObject.prototype.rotateBy=function(a,c,d,e,f){return this.rotateTo(this.rotation+a,c,d,e,f)};DisplayObject.prototype.skewXTo=function(a,c,d,e,f){c=~~c;0>=c?this.skewX=a:(a=this.addTween("skewX",a,c,d,e,f))&&a.play();return this};
DisplayObject.prototype.skewXBy=function(a,c,d,e,f){return this.skewXTo(this.skewX+a,c,d,e,f)};DisplayObject.prototype.skewYTo=function(a,c,d,e,f){c=~~c;0>=c?this.skewY=a:(a=this.addTween("skewY",a,c,d,e,f))&&a.play();return this};DisplayObject.prototype.skewYBy=function(a,c,d,e,f){return this.skewYTo(this.skewY+a,c,d,e,f)};
DisplayObject.prototype.scaleTo=function(a,c,d,e,f){c=~~c;if(0>=c)this.scaleX=this.scaleY=a;else{var g=this.addTween("scaleX",a,c,d,e,f);g&&g.play();(a=this.addTween("scaleY",a,c,d,g?null:e,g?null:f))&&a.play()}return this};DisplayObject.prototype.setZIndex=function(a){this.zIndex=~~a;this.parent&&this.parent.setChildZIndex(this,this.zIndex)};DisplayObject.prototype.hitTestPoint=function(a,c,d,e,f){return this.stage?this.stage.hitTestPointObject(this,a,c,d,e,f):!1};
DisplayObject.prototype.setRelativePosition=function(a,c,d,e){switch(d){case "right":a=this.stage.screenWidth-a;break;case "left":break;default:a=this.stage.screenWidth/2+a}switch(e){case "bottom":c=this.stage.screenHeight-c;break;case "top":break;default:c=this.stage.screenHeight/2+c}this.setPosition(a,c)};
DisplayObject.prototype.debugDraw=function(){if(this.visible&&this.allowDebugDrawing){var a=this.getAbsolutePosition(),c=this.getCenter(),d=this.getDrawRectangle(),e=this.getAABBRectangle();stage.drawCircle(a.x,a.y,1,1,"rgba(255,0,0,0.9)");stage.drawCircle(c.x,c.y,1,1,"rgba(0,255,0,0.9)");stage.drawLine(a.x,a.y,c.x,c.y,1,"rgba(255,255,255,0.5)");stage.drawPolygon(d.vertices,.5,"rgba(255,0,255,0.5)",1);stage.drawLine(e.vertices[0].x,e.vertices[0].y,e.vertices[2].x,e.vertices[2].y,1,"rgba(255,255,255,0.5)");
stage.drawLine(e.vertices[2].x,e.vertices[0].y,e.vertices[0].x,e.vertices[2].y,1,"rgba(255,255,255,0.5)");stage.drawPolygon(e.vertices,.5,"rgba(255,255,255,0.5)")}};DisplayObject.prototype.fixChildrenParent=function(a){for(a=0;a<this.objects.length;a++)this.objects[a].parent=this,this.objects[a].fixChildrenParent()};DisplayObject.prototype.clone=function(){var a=Utils.clone(this);a.fixChildrenParent();return a};function Graphics(){Utils.callSuperConstructor(Graphics,this)}Utils.extend(Graphics,DisplayObject);
Graphics.prototype.x=0;Graphics.prototype.y=0;Graphics.prototype.color="#000";Graphics.prototype.lineWidth=1;Graphics.prototype.render=function(a,c,d){!!this.static==!!c&&this.dispatchEvent("render",{target:this,canvas:a,delta:d});Utils.callSuperMethod(Graphics,this,"render",a,c,d)};
Graphics.prototype.prepareCanvas=function(a,c){c.ctx.save();this.ignoreViewport||(a.x-=this.stage.viewport.x,a.y-=this.stage.viewport.y);a.x*=Utils.globalScale;a.y*=Utils.globalScale;c.ctx.translate(a.x,a.y);var d=this.getAbsoluteRotation();c.ctx.rotate(d);c.ctx.scale(this.getAbsoluteScaleX(),this.getAbsoluteScaleY());var e=this.getAbsoluteSkewX(),f=this.getAbsoluteSkewY();0==e&&0==f||c.ctx.transform(1,e,f,1,0,0);this.shadowColor&&(c.ctx.shadowColor=this.shadowColor,0!=d?(e=new Vector(this.shadowOffsetX*
Utils.globalScale,this.shadowOffsetY*Utils.globalScale),e.rotate(-d),c.ctx.shadowOffsetX=e.x,c.ctx.shadowOffsetY=e.y):(c.ctx.shadowOffsetX=this.shadowOffsetX*Utils.globalScale,c.ctx.shadowOffsetY=this.shadowOffsetY*Utils.globalScale),c.ctx.shadowBlur=this.shadowBlur*Utils.globalScale)};
Graphics.prototype.preparePath=function(a){a.ctx.beginPath();a.ctx.strokeStyle=0<this.lineWidth?this.color:"transparent";a.ctx.lineWidth=this.lineWidth*Utils.globalScale;a.ctx.globalAlpha=this.getAbsoluteOpacity();a.ctx.fillStyle=this.getFillStyle(a)};Graphics.prototype.finalizeCanvas=function(a){(this.fillColor||this.fillLinearGradient||this.fillRadialGradient||this.fillPattern)&&a.ctx.fill();a.ctx.stroke()};Graphics.prototype.restoreCanvas=function(a){a.ctx.restore()};
Graphics.circle=function(a,c,d){Utils.callSuperConstructor(Graphics.circle,this);this.x=a;this.y=c;this.radius=d;this.width=2*d;this.height=2*d};Utils.extend(Graphics.circle,Graphics);Graphics.circle.prototype.render=function(a,c,d){!!this.static==!!c&&(this.prepareCanvas(this.getAbsoluteCenter(),a),this.preparePath(a),a.ctx.arc(0,0,this.radius*Utils.globalScale,0,2*Math.PI),this.finalizeCanvas(a),this.restoreCanvas(a));Utils.callSuperMethod(Graphics.circle,this,"render",a,c,d)};
Graphics.line=function(a,c,d,e){Utils.callSuperConstructor(Graphics.line,this);this.x1=a;this.x2=d;this.y1=c;this.y2=e};Utils.extend(Graphics.line,Graphics);
Graphics.line.prototype.render=function(a,c,d){!!this.static==!!c&&(this.prepareCanvas(this.getAbsoluteCenter(),a),this.preparePath(a),a.ctx.moveTo(this.x1*Utils.globalScale,this.y1*Utils.globalScale),a.ctx.lineTo(this.x2*Utils.globalScale,this.y2*Utils.globalScale),this.finalizeCanvas(a),this.restoreCanvas(a));Utils.callSuperMethod(Graphics.line,this,"render",a,c,d)};
Graphics.rectangle=function(a,c,d,e){Utils.callSuperConstructor(Graphics.rectangle,this);this.x=a;this.y=c;this.width=d;this.height=e};Utils.extend(Graphics.rectangle,Graphics);
Graphics.rectangle.prototype.render=function(a,c,d){!!this.static==!!c&&(this.prepareCanvas(this.getAbsoluteCenter(),a),this.preparePath(a),a.ctx.rect(-this.width/2*Utils.globalScale,-this.height/2*Utils.globalScale,this.width*Utils.globalScale,this.height*Utils.globalScale),this.finalizeCanvas(a),this.restoreCanvas(a));Utils.callSuperMethod(Graphics.rectangle,this,"render",a,c,d)};
Graphics.arc=function(a,c,d,e,f,g){Utils.callSuperConstructor(Graphics.arc,this);this.x=a;this.y=c;this.radius=d;this.startAngle=e;this.endAngle=f;this.antiClockWise=g;this.width=2*d;this.height=2*d};Utils.extend(Graphics.arc,Graphics);
Graphics.arc.prototype.render=function(a,c,d){!!this.static==!!c&&(this.prepareCanvas(this.getAbsoluteCenter(),a),this.preparePath(a),a.ctx.arc(0,0,this.radius*Utils.globalScale,this.startAngle,this.endAngle,this.antiClockWise),this.finalizeCanvas(a),this.restoreCanvas(a));Utils.callSuperMethod(Graphics.arc,this,"render",a,c,d)};
Graphics.polygon=function(a){if(!a||2>a.length)throw Error("Invalid parameters");Utils.callSuperConstructor(Graphics.polygon,this);this.points=a;for(var c=Number.MAX_VALUE,d=Number.MAX_VALUE,e=Number.MIN_VALUE,f=Number.MIN_VALUE,g=0;g<a.length;g++)a[g].x<c&&(c=a[g].x),a[g].y<d&&(d=a[g].y),a[g].x>e&&(e=a[g].x),a[g].y>f&&(f=a[g].y);this.width=e-c;this.height=f-d};Utils.extend(Graphics.polygon,Graphics);
Graphics.polygon.prototype.render=function(a,c,d){if(!!this.static==!!c){this.prepareCanvas(this.getAbsoluteCenter(),a);this.preparePath(a);a.ctx.moveTo(this.points[0].x*Utils.globalScale,this.points[0].y*Utils.globalScale);for(var e=1;e<this.points.length;e++)a.ctx.lineTo(this.points[e].x*Utils.globalScale,this.points[e].y*Utils.globalScale);a.ctx.lineTo(this.points[0].x*Utils.globalScale,this.points[0].y*Utils.globalScale);this.finalizeCanvas(a);this.restoreCanvas(a)}Utils.callSuperMethod(Graphics.polygon,
this,"render",a,c,d)};Graphics.text=function(a,c,d){Utils.callSuperConstructor(Graphics.text,this);this.x=a;this.y=c;this.text=d;this.align=Graphics.text.ALIGN_LEFT;this.valign=Graphics.text.VALIGN_MIDDLE;this.style="normal";this.size=10;this.font="sans-serif"};Utils.extend(Graphics.text,Graphics);Graphics.text.ALIGN_LEFT="left";Graphics.text.ALIGN_CENTER="center";Graphics.text.ALIGN_RIGHT="right";Graphics.text.VALIGN_TOP="top";Graphics.text.VALIGN_MIDDLE="middle";Graphics.text.VALIGN_BOTTOM="bottom";
Graphics.text.prototype.getRect=function(a){return a.ctx.measureText(this.text)};
Graphics.text.prototype.render=function(a,c,d){!!this.static==!!c&&(this.prepareCanvas(this.getAbsoluteCenter(),a),this.preparePath(a),a.ctx.font=this.style+" "+Math.floor(this.size*Utils.globalScale)+"px "+this.font,a.ctx.textAlign=this.align,a.ctx.textBaseline=this.valign,this.fillColor&&a.ctx.fillText(this.text,0,0),a.ctx.strokeText(this.text,0,0),this.finalizeCanvas(a),this.restoreCanvas(a));Utils.callSuperMethod(Graphics.text,this,"render",a,c,d)};
Graphics.free=function(){this.commands=[];Utils.callSuperConstructor(Graphics.free,this)};Utils.extend(Graphics.free,Graphics);Graphics.free.prototype.clear=function(){this.commands=[];Utils.callSuperMethod(Graphics.free,this,"clear")};Graphics.free.prototype.beginPath=function(){this.commands.push({command:"beginPath"});return this};Graphics.free.prototype.stroke=function(){this.commands.push({command:"stroke"});return this};
Graphics.free.prototype.setStrokeStyle=function(a){this.commands.push({command:"setStrokeStyle",style:a});return this};Graphics.free.prototype.setFillStyle=function(a){this.commands.push({command:"setFillStyle",style:a});return this};Graphics.free.prototype.fill=function(){this.commands.push({command:"fill"});return this};Graphics.free.prototype.moveTo=function(a,c){this.commands.push({command:"moveTo",x:a,y:c});return this};
Graphics.free.prototype.lineTo=function(a,c){this.commands.push({command:"lineTo",x:a,y:c});return this};Graphics.free.prototype.arc=function(a,c,d,e,f,g){this.commands.push({command:"arc",x:a,y:c,radius:d,startAngle:e,endAngle:f,antiClockWise:g});return this};Graphics.free.prototype.circle=function(a,c,d){this.commands.push({command:"circle",x:a,y:c,radius:d});return this};Graphics.free.prototype.rect=function(a,c,d,e){this.commands.push({command:"circle",x:a,y:c,width:d,height:e});return this};
Graphics.free.prototype.polygon=function(a){this.commands.push({command:"polygon",points:a});return this};
Graphics.free.prototype.executeCommand=function(a,c){switch(c.command){case "beginPath":a.ctx.beginPath();break;case "stroke":a.ctx.stroke();break;case "fill":a.ctx.fill();break;case "setStrokeStyle":a.ctx.strokeStyle=0<this.lineWidth?c.style:"transparent";break;case "setFillStyle":a.ctx.fillStyle=c.style;break;case "moveTo":a.ctx.moveTo(c.x*Utils.globalScale,c.y*Utils.globalScale);break;case "lineTo":a.ctx.lineTo(c.x*Utils.globalScale,c.y*Utils.globalScale);break;case "arc":a.ctx.arc(c.x*Utils.globalScale,
c.y*Utils.globalScale,c.radius*Utils.globalScale,c.startAngle,c.endAngle,c.antiClockWise);break;case "circle":a.ctx.arc(c.x*Utils.globalScale,c.y*Utils.globalScale,c.radius*Utils.globalScale,0,2*Math.PI);break;case "rect":a.ctx.rect((c.x-c.width/2)*Utils.globalScale,(c.y-c.height/2)*Utils.globalScale,c.width*Utils.globalScale,\u0441.height*Utils.globalScale);break;case "polygon":a.ctx.moveTo(c.points[0].x*Utils.globalScale,c.points[0].y*Utils.globalScale);for(var d=1;d<c.points.length;d++)a.ctx.lineTo(c.points[d].x*
Utils.globalScale,c.points[d].y*Utils.globalScale);a.ctx.lineTo(c.points[0].x*Utils.globalScale,c.points[0].y*Utils.globalScale)}};Graphics.free.prototype.executeCommands=function(a){for(var c=0;c<this.commands.length;c++)this.executeCommand(a,this.commands[c])};
Graphics.free.prototype.render=function(a,c,d){!!this.static==!!c&&(this.prepareCanvas(this.getAbsoluteCenter(),a),this.preparePath(a),this.executeCommands(a),this.finalizeCanvas(a),this.restoreCanvas(a));Utils.callSuperMethod(Graphics.free,this,"render",a,c,d)};
var BitmapsCache={bitmaps:{},cache:function(a){if(!(a&&a instanceof Image))return a;if(BitmapsCache.bitmaps[a.src])return BitmapsCache.bitmaps[a.src];cns=document.createElement("canvas");cns.width=a.width;cns.height=a.height;ctx=cns.getContext("2d");ctx.drawImage(a,0,0,a.width,a.height,0,0,a.width,a.height);return BitmapsCache.bitmaps[a.src]=cns}};
function Sprite(a,c,d,e,f){Utils.callSuperConstructor(Sprite,this);this.offset={left:0,top:0};this.width=c;this.height=d;this.totalFrames=Math.max(1,~~e);1>=this.totalFrames&&(this.animated=!1);this.totalLayers=Math.max(1,~~f);this.bitmap=a;this.changeFrameDelay=Sprite.CHANGE_FRAME_DELAY;this.cacheBitmap=Sprite.CACHE_BITMAPS}Utils.extend(Sprite,DisplayObject);Sprite.prototype.animated=!0;Sprite.prototype.animDirection=1;Sprite.prototype.currentFrame=0;Sprite.prototype.totalFrames=1;
Sprite.prototype.currentLayer=0;Sprite.prototype.totalLayers=1;Sprite.prototype.bitmap=null;Sprite.prototype.mask=null;Sprite.prototype.isMask=!1;Sprite.prototype.maskParent=null;Sprite.prototype.maskInvert=!1;Sprite.prototype.animStep=0;Sprite.prototype.animDelay=1;Sprite.prototype.changeFrameDelay=1E3/24;Sprite.prototype.changeFrameTime=0;Sprite.prototype.onchangeframe=null;Sprite.prototype.cacheBitmap=!1;
Sprite.create=function(a,c){if("string"==typeof a){c=c||window.library;if(!c)throw Error("Could not create sprite from asset '%s'. Library not found.",a);a=c.getAsset(a)}return new Sprite(a.bitmap,a.width||1,a.height||1,a.frames||1,a.layers||1)};Sprite.prototype.play=function(){this.animated=!0};Sprite.prototype.stop=function(){this.animated=!1};Sprite.prototype.gotoAndStop=function(a){this.currentFrame=a;this.stop()};Sprite.prototype.gotoAndPlay=function(a){this.currentFrame=a;this.play()};
Sprite.prototype.nextFrame=function(a){this.dispatchEvent("enterframe",{target:this,delta:a});var c=1;if(Sprite.CHANGE_FRAME_TYPE==Sprite.CHANGE_FRAME_BY_TIME)if(this.changeFrameTime+=a,this.changeFrameTime>=this.changeFrameDelay*this.animDelay)c=Math.floor(this.changeFrameTime/(this.changeFrameDelay*this.animDelay)),this.changeFrameTime-=Math.abs(c)*this.changeFrameDelay*this.animDelay;else return;else this.animStep++;if(this.animStep>=this.animDelay||Sprite.CHANGE_FRAME_TYPE==Sprite.CHANGE_FRAME_BY_TIME){for(var d=
0;d<c;d++)this.animated&&(this.currentFrame+=this.animDirection),0<this.animDirection&&this.currentFrame>=this.totalFrames&&(this.currentFrame=0),0>this.animDirection&&0>this.currentFrame&&(this.currentFrame=this.totalFrames-1),this.dispatchEvent("changeframe",{target:this,delta:a});this.animStep=0}};Sprite.prototype.setMask=function(a){this.mask=a;this.mask.isMask=!0;this.mask.stage=this.stage;this.mask.maskParent=this};
Sprite.prototype.renderBack=function(a,c,d,e,f,g){c&&(a.ctx.fillStyle=c,a.ctx.strokeStyle=c,a.ctx.fillRect(d,e,f,g))};
Sprite.prototype.renderBitmap=function(a,c,d,e,f){var g={x:0,y:0,width:e,height:f};if(this.bitmap){var h=this.bitmap.width,k=this.bitmap.height,l=this.currentLayer*e+this.offset.left*Utils.globalScale,q=this.currentFrame*f+this.offset.top*Utils.globalScale;if(l<h&&q<k){var v=e,w=f;l+v>h&&(v=h-l);q+w>k&&(w=k-q);Sprite.FLOOR_VALUES_ON_RENDER&&(l=~~l,q=~~q,v=~~v,w=~~w,c=~~c,d=~~d,e=~~e,f=~~f);0<v&&0<w&&0<e&&0<f&&a.ctx.drawImage(this.cacheBitmap?BitmapsCache.cache(this.bitmap):this.bitmap,l,q,v,w,c,d,
e,f);g.x=l;g.y=q;g.width=v;g.height=w}}return g};
Sprite.prototype.render=function(a,c,d,e){if(!this.isMask||e){if(!!this.static==!!c){d||(d=0);this.nextFrame(d);if(!1===this.dispatchEvent("prerender",{target:this,canvas:a,delta:d})||!this.stage)return;var f=this.getAbsoluteCenter();if(e){var f={x:this.x-this.getAnchor().x,y:this.y-this.getAnchor().y},g=this.parent?this.parent:this.maskParent;g&&(f.x+=g.getAnchor().x+g.width/2,f.y+=g.getAnchor().y+g.height/2)}e=this.width*Utils.globalScale;var h=this.height*Utils.globalScale,k=f.x*Utils.globalScale-
e/2,f=f.y*Utils.globalScale-h/2,l=this.getAbsoluteRotation(),g=this.getAbsoluteScaleX(),q=this.getAbsoluteScaleY(),v=this.getAbsoluteSkewX(),w=this.getAbsoluteSkewY(),y=this.getFillStyle(a),r=Boolean(0!=l||1!=g||1!=q||this.shadowColor||y||0!=v||0!=w);this.ignoreViewport||(k-=this.stage.viewport.x*Utils.globalScale,f-=this.stage.viewport.y*Utils.globalScale);r&&(a.ctx.save(),a.ctx.translate(k+e/2,f+h/2),a.ctx.rotate(l),a.ctx.scale(g,q),0==v&&0==w||a.ctx.transform(1,v,w,1,0,0),k=-(e/2),f=-(h/2),this.shadowColor&&
(0!=l?(g=new Vector(this.shadowOffsetX*Utils.globalScale,this.shadowOffsetY*Utils.globalScale),g.rotate(-l),a.ctx.shadowOffsetX=g.x,a.ctx.shadowOffsetY=g.y):(a.ctx.shadowOffsetX=this.shadowOffsetX*Utils.globalScale,a.ctx.shadowOffsetY=this.shadowOffsetY*Utils.globalScale),a.ctx.shadowColor=this.shadowColor,a.ctx.shadowBlur=this.shadowBlur*Utils.globalScale));a.ctx.globalAlpha=this.getAbsoluteOpacity();this.ceilSizes&&(e=Math.ceil(e),h=Math.ceil(h));this.mask?(this.stage.buffer.ctx.save(),this.stage.buffer.ctx.clearRect(0,
0,e,h),this.renderBack(this.stage.buffer,y,0,0,e,h),l=this.renderBitmap(this.stage.buffer,0,0,e,h),this.stage.buffer.ctx.globalCompositeOperation=this.maskInvert?"destination-out":"destination-in",this.mask.render?this.mask.render(this.stage.buffer,c,d,!0):this.stage.buffer.ctx.drawImage(this.mask,this.mask.x?this.mask.x:0,this.mask.y?this.mask.y:0),Sprite.FLOOR_VALUES_ON_RENDER?a.ctx.drawImage(this.stage.buffer,0,0,l.width,l.height,~~k,~~f,~~e,~~h):a.ctx.drawImage(this.stage.buffer,0,0,l.width,l.height,
k,f,e,h),this.stage.buffer.ctx.restore()):(this.renderBack(a,y,k,f,e,h),this.renderBitmap(a,k,f,e,h));r&&a.ctx.restore();this.stage.allowDebugDrawing&&this.allowDebugDrawing&&(!this.stage.allowStaticDebugDrawing&&this.static||this.debugDraw());this.dispatchEvent("render",{target:this,canvas:a,delta:d})}Utils.callSuperMethod(Sprite,this,"render",a,c,d)}};Sprite.CHANGE_FRAME_BY_FRAME=0;Sprite.CHANGE_FRAME_BY_TIME=1;Sprite.CHANGE_FRAME_DELAY=1E3/24;Sprite.CHANGE_FRAME_TYPE=Sprite.CHANGE_FRAME_BY_FRAME;
Sprite.FLOOR_VALUES_ON_RENDER=!0;Sprite.CACHE_BITMAPS=Utils.isIOS();function StageTimer(a,c,d){Utils.callSuperConstructor(StageTimer,this);this.repeat=d;this.timeout=this.initialTimeout=c;this.onend=a;this.ontick=null;this.destroy=!1;this.newly=!0;this.paused=!1}Utils.extend(StageTimer,EventsProxy);
StageTimer.prototype.update=function(a){if(this.destroy)return!0;if(this.paused)return!1;StageTimer.TIMEOUT_TYPE==StageTimer.TIMEOUT_BY_FRAME?this.timeout--:this.timeout-=a;if(0>=this.timeout)if("string"==typeof this.onend?eval(this.onend):this.dispatchEvent("end",{target:this}),this.repeat)this.rewind();else return!0;this.dispatchEvent("tick",{target:this,delta:a});return!1};StageTimer.prototype.rewind=function(){this.timeout=this.initialTimeout};
StageTimer.prototype.resume=function(){this.paused=!1};StageTimer.prototype.pause=function(){this.paused=!0};StageTimer.TIMEOUT_BY_FRAME=0;StageTimer.TIMEOUT_BY_TIME=1;StageTimer.TIMEOUT_TYPE=StageTimer.TIMEOUT_BY_FRAME;
function Stage(a,c,d){Utils.callSuperConstructor(Stage,this);this.canvas=null;a&&(this.canvas="string"==typeof a?document.getElementById(a):a,this.canvas.ctx=this.canvas.getContext("2d"));this.backgroundCanvas=null;this.needToRebuildBack=!1;this.screenWidth=c;this.screenHeight=d;this.viewport={x:0,y:0};this.buffer=null;try{this.buffer=document.createElement("canvas"),this.buffer.width=c*Utils.globalScale,this.buffer.height=d*Utils.globalScale,this.buffer.ctx=this.buffer.getContext("2d")}catch(e){this.buffer=
this.canvas}this.delay=40;this.started=!1;this.lastFPS=this.fps=0;this.ceilSizes=this.pixelMouseMoveEvent=this.pixelMouseDownEvent=this.pixelMouseUpEvent=this.pixelClickEvent=this.showFPS=!1;this.tmFPS=this.tmMain=null;this.allowStaticDebugDrawing=this.allowDebugDrawing=this.clearLock=!1;this.drawBackAlways=Utils.mobileCheckBrokenAndroid();this.tweens=[];this.timers=[];this.eventsListeners=[];this.lastTick=0;this.onmousemove=this.oncontextmenu=this.onclick=this.onmouseup=this.onmousedown=this.onposttick=
this.prerender=this.onpretick=this.inputController=null;this.canvas&&this.addInputListeners(this.canvas);this.tick=Utils.proxy(this.tick,this);this.clearFPS=Utils.proxy(this.clearFPS,this);this.stage=this;this.drawScene=this.render}Utils.extend(Stage,DisplayObjectContainer);Stage.prototype.refreshBackground=function(){this.needToRebuildBack=!0};Stage.prototype.setBackgroundCanvas=function(a){a&&(this.backgroundCanvas="string"==typeof a?document.getElementById(a):a,this.backgroundCanvas.ctx=this.backgroundCanvas.getContext("2d"))};
Stage.prototype.destroy=function(){clearTimeout(this.tmMain);clearTimeout(this.tmFPS);this.stop();this.clear();this.clearScreen(this.canvas);this.backgroundCanvas&&this.clearScreen(this.backgroundCanvas);this.removeInputListeners(this.stage)};Stage.prototype.clearScreen=function(a){this.clearLock||a.ctx.clearRect(0,0,Math.floor(a.width),Math.floor(a.height))};Stage.prototype.addChild=function(a){a.stage=this;return Utils.callSuperMethod(Stage,this,"addChild",a)};
Stage.prototype.setZIndex=function(a,c){this.setChildZIndex(a,c)};Stage.prototype.removeChild=function(a){a&&0<=this.objects.indexOf(a)&&(this.clearObjectTweens(a),a.stage=null,Utils.callSuperMethod(Stage,this,"removeChild",a))};Stage.prototype.finalizeMouseCoords=function(a,c){if(!a)return c;var d=this.prepareMouseCoord(c.x),e=this.prepareMouseCoord(c.y);a.ignoreViewport||(d+=this.viewport.x,e+=this.viewport.y);var f=a.getAbsolutePosition(),d=d-f.x,e=e-f.y;return{x:d,y:e}};
Stage.prototype.prepareMouseCoord=function(a){return a/Utils.globalScale/Utils.globalPixelScale};Stage.prototype.processMouseEvent=function(a,c,d){a=Utils.getMouseCoord(a,this.inputController);d=this.getObjectsStackByCoord(this.prepareMouseCoord(a.x),this.prepareMouseCoord(a.y),d,!1);for(var e,f=0;f<d.length;f++)if(e=this.finalizeMouseCoords(d[f],a),e=d[f].dispatchEvent(c,{target:d[f],x:e.x,y:e.y}),!1===e)return;this.dispatchEvent(c,{target:this,x:Math.floor(this.prepareMouseCoord(a.x)),y:Math.floor(this.prepareMouseCoord(a.y))})};
Stage.prototype.checkClick=function(a){this.processMouseEvent(a,"click",this.pixelClickEvent)};Stage.prototype.checkContextMenu=function(a){this.processMouseEvent(a,"contextmenu",this.pixelClickEvent)};
Stage.prototype.checkMouseMove=function(a){a=Utils.getMouseCoord(a,this.inputController);this.doDrag(this.prepareMouseCoord(a.x),this.prepareMouseCoord(a.y));var c=this.getObjectsStackByCoord(this.prepareMouseCoord(a.x),this.prepareMouseCoord(a.y),this.pixelMouseMoveEvent),d,e,f,g=[];if(0<c.length){for(d=0;d<c.length&&(g.push(c[d]),f=this.finalizeMouseCoords(c[d],a),c[d].mouseOn||(e=c[d].dispatchEvent("mouseover",{target:c[d],x:f.x,y:f.y})),c[d].mouseOn=!0,!1!==e);d++);e=!0;for(d=0;d<c.length&&(f=
this.finalizeMouseCoords(c[d],a),e=c[d].dispatchEvent("mousemove",{target:c[d],x:f.x,y:f.y}),!1!==e);d++);!1!==e&&this.dispatchEvent("mousemove",{target:this,x:Math.floor(this.prepareMouseCoord(a.x)),y:Math.floor(this.prepareMouseCoord(a.y))})}this.checkMouseOut(g,a)};Stage.prototype.checkMouseDown=function(a){this.processMouseEvent(a,"mousedown",this.pixelMouseDownEvent)};Stage.prototype.checkMouseUp=function(a){this.processMouseEvent(a,"mouseup",this.pixelMouseUpEvent)};
Stage.prototype.clear=function(){this.tweens=[];this.timers=[];this.eventsListeners=[];this.objectsCounter=0;Utils.callSuperMethod(Stage,this,"clear")};Stage.prototype.getCenter=function(){return{x:this.screenWidth/2,y:this.screenHeight/2}};
Stage.prototype.drawRectangle=function(a,c,d,e,f,g,h,k){var l=this.canvas;l.ctx.globalAlpha="undefined"!=typeof h?h:1;l.ctx.fillStyle=f;l.ctx.strokeStyle=f;k||(a-=this.viewport.x,c-=this.viewport.y);a*=Utils.globalScale;c*=Utils.globalScale;d*=Utils.globalScale;e*=Utils.globalScale;g?l.ctx.fillRect(a-d/2,c-e/2,d,e):l.ctx.strokeRect(a-d/2,c-e/2,d,e)};Stage.prototype.drawCircle=function(a,c,d,e,f,g,h){this.drawArc(a,c,d,0,2*Math.PI,!1,e,f,g,h)};
Stage.prototype.drawArc=function(a,c,d,e,f,g,h,k,l,q){var v=this.canvas,w=v.ctx.lineWidth;"undefined"==typeof k&&(k="#000");v.ctx.strokeStyle=k;"undefined"==typeof h&&(h=1);v.ctx.lineWidth=h*Utils.globalScale;"undefined"==typeof l&&(l=1);v.ctx.globalAlpha=l;q||(a-=this.viewport.x,c-=this.viewport.y);a*=Utils.globalScale;c*=Utils.globalScale;d*=Utils.globalScale;v.ctx.beginPath();v.ctx.arc(a,c,d,e,f,g);v.ctx.stroke();v.ctx.lineWidth=w};
Stage.prototype.drawPolygon=function(a,c,d,e,f){if("object"==typeof a&&a instanceof Array&&!(2>a.length)){for(var g=0;g<a.length-1;g++)this.drawLine(a[g].x,a[g].y,a[g+1].x,a[g+1].y,c,d,e,f);this.drawLine(a[g].x,a[g].y,a[0].x,a[0].y,c,d,e,f)}};
Stage.prototype.drawLine=function(a,c,d,e,f,g,h,k){var l=this.canvas,q=l.ctx.lineWidth;l.ctx.strokeStyle=g?g:"#000";l.ctx.lineWidth=f?f*Utils.globalScale:1*Utils.globalScale;l.ctx.globalAlpha=h?h:1;k||(a-=this.viewport.x,c-=this.viewport.y,d-=this.viewport.x,e-=this.viewport.y);a*=Utils.globalScale;c*=Utils.globalScale;d*=Utils.globalScale;e*=Utils.globalScale;l.ctx.beginPath();l.ctx.moveTo(a,c);l.ctx.lineTo(d,e);l.ctx.stroke();l.ctx.lineWidth=q};
Stage.prototype.start=function(){this.started||(this.started=!0,this.clearFPS(),this.tick())};Stage.prototype.forceRender=function(){this.started&&this.tick()};Stage.prototype.stop=function(){this.started=!1};Stage.prototype.clearFPS=function(){this.lastFPS=this.fps;this.fps=0;this.started&&(this.tmFPS=setTimeout(this.clearFPS,1E3))};
Stage.prototype.setTextStyle=function(a,c,d,e,f,g){g=g?g:this.canvas;g.ctx.fillStyle=e;g.ctx.strokeStyle=f;e="";d&&(e+=d+" ");c&&(e+=Math.floor(c*Utils.globalScale)+"px ");a&&(e+=a);g.ctx.font=e};Stage.prototype.drawText=function(a,c,d,e,f,g,h){h=h?h:this.canvas;h.ctx.globalAlpha="undefined"==typeof e?1:e;f||(c-=this.viewport.x,d-=this.viewport.y);c*=Utils.globalScale;d*=Utils.globalScale;g&&(c-=this.getTextWidth(a)/2);h.ctx.fillText(a,c,d)};
Stage.prototype.strokeText=function(a,c,d,e,f,g,h){h=h?h:this.canvas;h.ctx.globalAlpha="undefined"==typeof e?1:e;f||(c-=this.viewport.x,d-=this.viewport.y);c*=Utils.globalScale;d*=Utils.globalScale;g&&(c-=this.getTextWidth(a)/2);h.ctx.strokeText(a,c,d)};Stage.prototype.getTextWidth=function(a,c){return(c?c:this.canvas).ctx.measureText(a).width};
Stage.prototype.render=function(a,c,d,e){a&&(e||(e=0),a&&!a.ctx&&(a.ctx=a.getContext("2d")),d||((d=this.getFillStyle(a))?(a.ctx.fillStyle=d,a.ctx.fillRect(0,0,a.width,a.height)):this.clearLock||this.clearScreen(a)),Utils.callSuperMethod(Stage,this,"render",a,c,e))};Stage.prototype.createTween=function(a,c,d,e,f,g){a=new Tween(a,c,d,e,f,g);this.tweens.push(a);return a};
Stage.prototype.removeTween=function(a){var c=null;if(isNaN(a))for(var d=0;d<this.tweens.length;d++){if(this.tweens[d]===a){c=d;break}}else c=a;isNaN(c)||(this.tweens[c]&&this.tweens[c].pause(),this.tweens.splice(c,1));return c};Stage.prototype.clearObjectTweens=function(a){for(var c=0;c<this.tweens.length;c++)this.tweens[c].obj===a&&(this.tweens[c].destroy=!0)};
Stage.prototype.updateTweens=function(a){for(var c,d=0;d<this.tweens.length;d++)c=this.tweens[d],c.destroy&&(d=this.removeTween(d),d--);for(d=0;d<this.tweens.length;d++)c=this.tweens[d],!c.newly&&c.tick(a)&&(c.destroy=!0),c.newly=!1};Stage.prototype.setTimeout=function(a,c){var d=new StageTimer(a,c);this.timers.push(d);return d};Stage.prototype.clearTimeout=function(a){a&&(a.destroy=!0)};Stage.prototype.setInterval=function(a,c){var d=new StageTimer(a,c,!0);this.timers.push(d);return d};
Stage.prototype.clearInterval=function(a){this.clearTimeout(a)};Stage.prototype.removeTimer=function(a){this.timers=Utils.removeFromArray(this.timers,a)};Stage.prototype.updateTimers=function(a){for(var c,d=0;d<this.timers.length;d++)c=this.timers[d],c.destroy&&(this.removeTimer(c),d--);for(d=0;d<this.timers.length;d++)c=this.timers[d],!c.newly&&c.update(a)&&(c.destroy=!0),c.newly=!1};
Stage.prototype.tick=function(){clearTimeout(this.tmMain);var a;if(Utils.isWindowHidden)this.lastTick=0,a=this.delay;else{a=(new Date).getTime();var c=Math.min(Stage.MIN_DELTA,a-this.lastTick);this.lastTick=a;this.dispatchEvent("pretick",{target:this,delta:c});if(!this.started){this.lastTick=0;return}this.updateTweens(c);if(!this.started){this.lastTick=0;return}this.updateTimers(c);if(!this.started){this.lastTick=0;return}this.dispatchEvent("prerender",{target:this,delta:c});var d=!1;this.drawBackAlways?
(this.render(this.canvas,!0,!1,c),d=!0):this.needToRebuildBack&&(this.needToRebuildBack=!1,this.backgroundCanvas&&this.render(this.backgroundCanvas,!0));this.render(this.canvas,!1,d,c);this.showFPS&&(this.setTextStyle("sans-serif",10,"bold","#fff","#000"),this.drawText("FPS: "+this.lastFPS,2,10,1,!0));this.dispatchEvent("posttick",{target:this,delta:c});a=(new Date).getTime()-a;a=this.delay-a;1>a&&(a=1);this.fps++}this.started?this.tmMain=setTimeout(this.tick,a):this.lastTick=0};
Stage.prototype.box2dSync=function(a){for(b=a.m_bodyList;b;b=b.m_next)b.sprite&&(b.sprite.rotation=b.GetRotation(),a=b.GetPosition(),b.sprite.x=a.x,b.sprite.y=a.y,b.sprite.dispatchEvent("box2dsync",{target:b.sprite}))};Stage.prototype.processTouchEvent=function(a,c){for(var d=0;d<a.length;d++)this[c]({clientX:a[d].clientX,clientY:a[d].clientY})};Stage.prototype.prepareEventTouches=function(a,c){a[c]||(a[c]=[{clientX:a.clientX,clientY:a.clientY}]);return a[c]};
Stage.prototype.addInputListeners=function(a){this.inputController=a;Utils.touchScreen?(a["on"+Utils.getTouchStartEvent()]=Utils.proxy(function(a){this.processTouchEvent(this.prepareEventTouches(a,"changedTouches"),"checkMouseDown");this.processTouchEvent(this.prepareEventTouches(a,"changedTouches"),"checkClick");a.preventDefault()},this),a["on"+Utils.getTouchMoveEvent()]=Utils.proxy(function(a){this.processTouchEvent(this.prepareEventTouches(a,"changedTouches"),"checkMouseMove");a.preventDefault()},
this),a["on"+Utils.getTouchEndEvent()]=Utils.proxy(function(a){this.processTouchEvent(this.prepareEventTouches(a,"changedTouches"),"checkMouseUp");a.preventDefault()},this)):(a.onclick=Utils.proxy(function(a){this.checkClick(a)},this),a.onmousemove=Utils.proxy(function(a){this.checkMouseMove(a)},this),a.onmousedown=Utils.proxy(function(a){0==a.button&&this.checkMouseDown(a)},this),a.onmouseup=Utils.proxy(function(a){0==a.button&&this.checkMouseUp(a)},this),a.oncontextmenu=Utils.proxy(function(a){this.checkContextMenu(a)},
this))};Stage.prototype.removeInputListeners=function(a){a.ontouchstart=null;a.ontouchmove=null;a.ontouchend=null;a.onmspointerdown=null;a.onmspointermove=null;a.onmspointerup=null;a.onclick=null;a.onmousemove=null;a.onmousedown=null;a.onmouseup=null;a.oncontextmenu=null};Stage.MIN_DELTA=500;
function AudioPlayer(){this.disabled=!1;this.basePath="";this.mp3Support=!0;this.delayPlay=!1;this.audioWrapper=null;this.busy=this.locked=!1;this.startPlayTime=0;this.onend=null;this.controlPlay=Utils.proxy(this.controlPlay,this)}AudioPlayer.prototype.createNewAudio=function(){if(AudioMixer.isWebAudioSupport()){var a=AudioMixer.waContext.createBufferSource();a.connect(AudioMixer.waContext.destination);return a}return document.createElement("audio")};
AudioPlayer.prototype.init=function(a){this.basePath=a?a:"";this.delayPlay="ontouchstart"in window;this.audioWrapper=this.createNewAudio();a=document.createElement("audio");a.canPlayType?this.mp3Support=""!=a.canPlayType("audio/mpeg"):this.disabled=!0;return!this.disabled};
AudioPlayer.prototype.play=function(a,c){if(this.disabled)return!1;var d=this.basePath+"/"+a+(this.mp3Support?".mp3":".ogg");this.stop();this.audioWrapper=this.createNewAudio();this.audioWrapper.doLoop=c?!0:!1;this.audioWrapper.fileName=a;if(AudioMixer.isWebAudioSupport()){var e=this;this.loadSound(d,function(a){e.audioWrapper.buffer=a;e.audioWrapper.noteOn?e.audioWrapper.noteOn(0):e.audioWrapper.start(0);e.startPlayTime=(new Date).getTime();e.audioWrapper.loop=c;"undefined"!=typeof e.audioWrapper.playbackState?
e.waCheckInterval=setInterval(function(){e.audioWrapper?e.audioWrapper.playbackState==e.audioWrapper.FINISHED_STATE&&e.controlPlay():clearInterval(e.waCheckInterval)},100):e.audioWrapper.onended=e.controlPlay})}else this.audioWrapper.src=d,this.audioWrapper.type=this.mp3Support?"audio/mpeg":"audio/ogg",this.audioWrapper.loop=!1,this.audioWrapper.preload="auto",this.audioWrapper.load(),this.delayPlay?(this.audioWrapper.addEventListener("canplay",this.readyToPlay),this.audioWrapper.addEventListener("canplaythrough",
this.readyToPlay)):this.audioWrapper.play(),this.audioWrapper.addEventListener("ended",this.controlPlay,!1);this.busy=!0;this.startPlayTime=(new Date).getTime()};AudioPlayer.prototype.loadSound=function(a,c){if(AudioMixer.buffer[a])c&&c(AudioMixer.buffer[a]);else{var d=new XMLHttpRequest;d.open("GET",a,!0);d.responseType="arraybuffer";d.onload=function(){AudioMixer.waContext.decodeAudioData(this.response,function(d){AudioMixer.buffer[a]=d;c&&c(d)})};d.send()}};
AudioPlayer.prototype.readyToPlay=function(a){a.currentTarget.alreadyLoaded||(a.currentTarget.alreadyLoaded=!0,a.currentTarget.play())};
AudioPlayer.prototype.stop=function(){this.busy=!1;try{AudioMixer.isWebAudioSupport()?this.audioWrapper.noteOff?this.audioWrapper.noteOff(0):this.audioWrapper.stop(0):(this.audioWrapper.removeEventListener("canplay",this.readyToPlay),this.audioWrapper.removeEventListener("canplaythrough",this.readyToPlay),this.audioWrapper.pause(),this.audioWrapper.currentTime=0),this.audioWrapper=null}catch(a){}};
AudioPlayer.prototype.pause=function(){AudioMixer.isWebAudioSupport()?this.audioWrapper&&this.audioWrapper.disconnect():this.audioWrapper.pause()};AudioPlayer.prototype.resume=function(){if(AudioMixer.isWebAudioSupport()){if(this.audioWrapper)try{this.audioWrapper.connect(AudioMixer.waContext.destination)}catch(a){}}else this.audioWrapper.play()};
AudioPlayer.prototype.controlPlay=function(){if(this.audioWrapper)if(this.audioWrapper.doLoop)AudioMixer.isWebAudioSupport()||(Utils.isFirefox()?this.play(this.audioWrapper.fileName,!0):(this.audioWrapper.currentTime=0,this.audioWrapper.play()));else{this.busy=!1;if("function"==typeof this.onend)this.onend();this.waCheckInterval&&clearInterval(this.waCheckInterval)}};
AudioPlayer.prototype.getPosition=function(){if(AudioMixer.isWebAudioSupport()){if(!this.startPlayTime)return 0;var a=this.getDuration();if(!a)return 0;var c=((new Date).getTime()-this.startPlayTime)/1E3;return c<=a?c:this.audioWrapper.doLoop?c-Math.floor(c/a)*a:a}return this.audioWrapper.currentTime?this.audioWrapper.currentTime:0};
AudioPlayer.prototype.getDuration=function(){return AudioMixer.isWebAudioSupport()?this.audioWrapper.buffer?this.audioWrapper.buffer.duration:0:this.audioWrapper.duration?this.audioWrapper.duration:0};function AudioMixer(a,c){this.singleChannelMode=!1;this.channels=[];this.init(a,c)}
AudioMixer.prototype.init=function(a,c){if(AudioMixer.isWebAudioSupport()){AudioMixer.waContext=new window.AudioContext;var d=AudioMixer.waContext.createBuffer(1,1,22050),e=AudioMixer.waContext.createBufferSource();e.buffer=d;e.connect(AudioMixer.waContext.destination);e.noteOn?e.noteOn(0):e.start(0)}AudioMixer.isWebAudioSupport()||-1==navigator.userAgent.toLowerCase().indexOf("mac")||(this.singleChannelMode=!0,c=1);this.path=a;this.channels=[];for(d=0;d<c;d++)this.channels[d]=new AudioPlayer,this.channels[d].init(a);
Utils.addEventListener("hidewindow",Utils.proxy(this.pauseOnHide,this));Utils.addEventListener("showwindow",Utils.proxy(this.resumeOnShow,this))};AudioMixer.prototype.pauseOnHide=function(){for(var a=0;a<this.channels.length;a++)this.channels[a].pause()};AudioMixer.prototype.resumeOnShow=function(){for(var a=0;a<this.channels.length;a++)this.channels[a].resume()};
AudioMixer.prototype.play=function(a,c,d,e){var f=-1,f="number"==typeof e?e:this.getFreeChannel(d);0<=f&&f<this.channels.length&&(this.channels[f].stop(),this.channels[f].play(a,c));return this.channels[f]};AudioMixer.prototype.stop=function(a){0<=a&&a<this.channels.length&&this.channels[a].stop()};
AudioMixer.prototype.getFreeChannel=function(a){for(var c=-1,d=[],e=-1,f=-1,g=0,h=0;h<this.channels.length;h++)this.channels[h].locked||(this.channels[h].busy?(g=(new Date).getTime(),g-=this.channels[h].startPlayTime,g>f&&(f=g,e=h)):d.push(h));0==d.length?!a&&0<=e&&(c=e):c=d[0];return c};AudioMixer.isWebAudioSupport=function(){return Boolean(window.AudioContext)};window.AudioContext=window.AudioContext||window.webkitAudioContext;AudioMixer.buffer={};AudioMixer.waContext=null;
function SimpleText(a,c,d,e){this.font=a;this.y=this.x=0;this.width=c;this.height=d;this.align=SimpleText.ALIGN_LEFT;this.charSpacing=this.rotation=0;this.opacity=this.scale=1;this.static=!1;this.charMap="0123456789".split("");this.charWidth=[];this.sprites=[];this.text="";this.parent=this.stage=window.stage;this.ALIGN_LEFT=SimpleText.ALIGN_LEFT;this.ALIGN_RIGHT=SimpleText.ALIGN_RIGHT;this.ALIGN_CENTER=SimpleText.ALIGN_CENTER;this.ignoreViewport=e}
SimpleText.prototype.manageSprites=function(a){var c,d=a.length,e=this.sprites.length;if(e<d)for(a=0;a<d-e;a++)c=new window[SimpleText.spriteClass](this.font,this.width,this.height,this.charMap.length),this.sprites.push(c),this.parent.addChild(c);if(e>d){for(a=0;a<e-d;a++)this.parent.removeChild(this.sprites[a]);this.sprites.splice(0,e-d)}};SimpleText.prototype.getCharIx=function(a){for(var c=0;c<this.charMap.length;c++)if(this.charMap[c]==a)return c;return-1};
SimpleText.prototype.getCharWidth=function(a){a=this.getCharIx(a);return 0<=a?this.charWidth[a]?this.charWidth[a]:this.width:this.width};SimpleText.prototype.getWidth=function(){for(var a=0,c=0;c<this.text.length;c++)a+=this.getCharWidth(this.text.substr(c,1))+this.charSpacing;return a};
SimpleText.prototype.write=function(a){var c,d,e,f;this.text=a+="";this.manageSprites(a);c=this.x;this.align==SimpleText.ALIGN_CENTER&&(c=this.x-this.getWidth()/2*this.scale+this.getCharWidth(this.text.substr(0,1))/2*this.scale);this.align==SimpleText.ALIGN_RIGHT&&(c=this.x-this.getWidth()*this.scale);e=new Vector(c-this.x,0);e.rotate(-this.rotation);c=e.x+this.x;d=e.y+this.y;e=new Vector(0,0);for(var g=0;g<a.length;g++)if(this.sprites[g].visible=!0,f=this.charMap.indexOf(a.substr(g,1)),0>f)this.sprites[g].visible=
!1;else{var h=this.getCharWidth(this.text.substr(g,1));this.sprites[g].scaleX=this.sprites[g].scaleY=this.scale;this.sprites[g].gotoAndStop(f);f=e.clone();f.x*=this.scale;f.rotate(-this.rotation);this.sprites[g].x=f.x+(","==this.text.substr(g,1)?c-h/2:c);this.sprites[g].y=f.y+d;this.sprites[g].rotation=this.rotation;this.sprites[g].static=this.static;this.sprites[g].opacity=this.opacity;this.sprites[g].ignoreViewport=this.ignoreViewport;this.sprites[g].gx=this.sprites[g].x;this.sprites[g].gy=this.sprites[g].y;
this.sprites[g].gscaleX=this.sprites[g].scaleX;this.sprites[g].gscaleY=this.sprites[g].scaleY;this.sprites[g].grotation=this.sprites[g].rotation;this.sprites[g].gopacity=this.sprites[g].opacity;e.x+=h+this.charSpacing}};SimpleText.prototype.refresh=function(){this.write(this.text)};SimpleText.prototype.addToGroup=function(a){for(var c=0;c<this.sprites.length;c++)this.sprites[c].gx=this.sprites[c].x/2,this.sprites[c].gy=this.sprites[c].y,a.addChild(this.sprites[c],!1)};
SimpleText.prototype.putToGroup=function(a){for(var c=0;c<this.sprites.length;c++)this.sprites[c].gx=this.sprites[c].x,this.sprites[c].gy=this.sprites[c].y,a.addChild(this.sprites[c],!1)};SimpleText.prototype.refreshOnTween=function(a){a.target.obj.refresh()};SimpleText.prototype.setPosition=function(a,c){this.x=a;this.y=c;this.refresh()};SimpleText.prototype.removeTweens=function(){this.stage&&this.stage.clearObjectTweens(this)};
SimpleText.prototype.addTween=function(a,c,d,e,f,g){if(this.stage){var h=this[a];if(!isNaN(h))return a=this.stage.createTween(this,a,h,c,d,e),a.onchange=g,a.onfinish=f,a}};SimpleText.prototype.moveTo=function(a,c,d,e,f,g){d=~~d;if(0>=d)this.setPosition(a,c);else{if(a=this.addTween("x",a,d,e,f,g))a.play(),a.addEventListener("change",this.refreshOnTween);(c=this.addTween("y",c,d,e,a?null:f,a?null:g))&&c.play();c&&!a&&c.addEventListener("change",this.refreshOnTween)}return this};
SimpleText.prototype.moveBy=function(a,c,d,e,f,g){return this.moveTo(this.x+a,this.y+c,d,e,f,g)};SimpleText.prototype.fadeTo=function(a,c,d,e,f){c=~~c;if(0>=c)this.opacity=a;else if(a=this.addTween("opacity",a,c,d,e,f))a.play(),a.addEventListener("change",this.refreshOnTween);return this};SimpleText.prototype.fadeBy=function(a,c,d,e,f){a=Math.max(0,Math.min(1,this.opacity+a));return this.fadeTo(a,c,d,e,f)};
SimpleText.prototype.rotateTo=function(a,c,d,e,f){c=~~c;if(0>=c)this.rotation=a;else if(a=this.addTween("rotation",a,c,d,e,f))a.play(),a.addEventListener("change",this.refreshOnTween);return this};SimpleText.prototype.rotateBy=function(a,c,d,e,f){return this.rotateTo(this.rotation+a,c,d,e,f)};SimpleText.prototype.scaleTo=function(a,c,d,e,f){c=~~c;if(0>=c)this.scale=a;else if(a=this.addTween("scale",a,c,d,e,f))a.play(),a.addEventListener("change",this.refreshOnTween);return this};
SimpleText.spriteClass="Sprite";SimpleText.ALIGN_LEFT=0;SimpleText.ALIGN_RIGHT=1;SimpleText.ALIGN_CENTER=2;function Animation(a,c,d){this.obj=a;this.sequence=c;this.currentAnimation=-1;this.currentTweens=[];this.ended=!1;this.endTimer=this.startTimer=null;this.playNext=Utils.proxy(this.playNext,this);this.play=Utils.proxy(this.play,this);this.onfinish=d}Animation.prototype.play=function(){this.playNext()};
Animation.prototype.playNext=function(){if(0<=this.currentAnimation){var a=this.sequence[this.currentAnimation];if(a.onfinish)a.onfinish({target:this});"undefined"!=typeof a.loop&&(this.currentAnimation=a.loop-1)}this.currentAnimation++;if(this.currentAnimation>=this.sequence.length){if(this.ended=!0,"function"==typeof this.onfinish)this.onfinish({target:this})}else{var a=this.sequence[this.currentAnimation],c,d,e,f,g,h,k;e=a.tweens;Utils.isArray(e)||(e=[e]);c=a.duration||0;this.currentTweens=[];
for(var l=null,q=0;q<e.length;q++)f=e[q],d=f.duration,"undefined"==typeof d&&(d=c),g=f.from,"undefined"==typeof g&&(g=this.obj[f.prop]),h=f.to,"undefined"==typeof h&&(h=this.obj[f.prop]),k=f.ease||a.ease||null,g=Animation.stage.createTween(this.obj,f.prop,g,h,d,k),"undefined"!=typeof f.onchange&&(g.onchange=f.onchange),"undefined"!=typeof f.onfinish&&(g.onfinish=f.onfinish),g.play(),this.currentTweens.push(g),d==c&&(l=g);if(l){var v=this,w=l.onfinish;l.onfinish=function(a){"function"==typeof w&&w(a);
v.playNext()}}else this.endTimer=Animation.stage.setTimeout(this.playNext,c)}};Animation.prototype.executeTweensMethod=function(a){for(var c=0;c<this.currentTweens.length;c++)this.currentTweens[c][a]()};Animation.prototype.clearTweens=function(){for(var a=0;a<this.currentTweens.length;a++)this.currentTweens[a].destroy=!0;this.currentTweens=[]};
Animation.prototype.stop=function(){this.ended||(this.executeTweensMethod("stop"),this.startTimer&&Animation.stage.clearTimeout(this.startTimer),this.endTimer&&Animation.stage.clearTimeout(this.endTimer))};Animation.prototype.pause=function(){this.ended||(this.executeTweensMethod("pause"),this.startTimer&&this.startTimer.pause(),this.endTimer&&this.endTimer.pause())};
Animation.prototype.resume=function(){this.ended||(this.executeTweensMethod("play"),this.startTimer&&this.startTimer.resume(),this.endTimer&&this.endTimer.resume())};Animation.stage=null;Animation.play=function(a,c,d,e){if(a&&c)return a.stage&&(Animation.stage=a.stage),Animation.stage||(Animation.stage=window.stage),a=new Animation(a,c,d),e?a.startTimer=Animation.stage.setTimeout(a.play,e):a.play(),a};
function PathTween(a,c,d,e){this.obj=a;this.path=c;this.loop=!!e;d&&(this.path=Utils.getBezierCurve(c));this.pathLen=this.getPathLen();this.position=0;this.startTimer=this.tween=null}PathTween.prototype.getPathLen=function(){for(var a,c,d=0,e=0;e<this.path.length-1;e++)a=this.path[e].x-this.path[e+1].x,c=this.path[e].y-this.path[e+1].y,d+=Math.sqrt(a*a+c*c);return d};
PathTween.prototype.getPoint=function(a){for(var c,d,e=c=0,f=0,g=this.path[0].x,h=this.path[0].y;;){f++;if(f>=this.path.length)return{x:this.path[this.path.length-1].x,y:this.path[this.path.length-1].y};c=g-this.path[f].x;d=h-this.path[f].y;c=Math.sqrt(c*c+d*d);if(e+c>=a)return f=Math.atan2(this.path[f].y-h,this.path[f].x-g),c=a-e,g+=Math.cos(f)*c,h+=Math.sin(f)*c,{x:g,y:h};e+=c;g=this.path[f].x;h=this.path[f].y}};
PathTween.prototype.start=function(a,c,d,e,f){function g(){h.position=0;h.tween&&(h.tween.stop(),h.tween.destroy=!0);h.tween=h.obj.stage.createTween(h,"position",0,h.pathLen,a,c);h.tween.addEventListener("finish",h.updateOnFinish);h.tween.addEventListener("change",h.updateOnTween);d&&h.tween.addEventListener("finish",d);e&&h.tween.addEventListener("change",e);h.tween.play();h.startTimer=null}var h=this;f?this.startTimer=this.obj.stage.setTimeout(g,f):g()};
PathTween.prototype.pause=function(){this.tween&&this.tween.pause();this.startTimer&&this.startTimer.pause()};PathTween.prototype.play=function(){this.tween&&this.tween.play();this.startTimer&&this.startTimer.pause()};PathTween.prototype.rewind=function(){this.tween&&this.tween.rewind();this.startTimer&&this.startTimer.rewind()};PathTween.prototype.forward=function(){this.tween&&this.tween.forward();this.startTimer&&(this.startTimer.pause(),this.startTimer.destroy=!0)};
PathTween.prototype.stop=function(){this.tween&&this.tween.stop();this.startTimer&&(this.startTimer.pause(),this.startTimer.destroy=!0)};PathTween.prototype.updateOnFinish=function(a){a=a.target.obj;var c=a.path[a.path.length-1];a.obj.x=c.x;a.obj.y=c.y;if(a.loop)return a.rewind(),a.play(),!1};PathTween.prototype.updateOnTween=function(a){a=a.target.obj;var c=a.getPoint(a.position);a.obj.x=c.x;a.obj.y=c.y};
function TilesSprite(a,c,d,e,f,g){TilesSprite.superclass.constructor.call(this,a,c,d,f,g);this.framesCount=e;this.animated=1<e;this.addEventListener("changeframe",TilesSprite.changeStep);this.addEventListener("prerender",TilesSprite.sync)}Utils.extend(TilesSprite,Sprite);TilesSprite.prototype.currentFrameX=0;
TilesSprite.create=function(a,c){if("string"==typeof a){c=c||window.library;if(!c)throw Error("Could not create sprite from asset '%s'. Library not found.",a);a=c.getAsset(a)}return new TilesSprite(a.bitmap,a.width||1,a.height||1,a.framesCount||(a.frames||1)*(a.layers||1),a.frames||1,a.layers||1)};TilesSprite.prototype.gotoAndStop=function(a){this.currentFrameX=a;this.stop()};TilesSprite.prototype.gotoAndPlay=function(a){this.currentFrameX=a;this.play()};
TilesSprite.changeStep=function(a){a=a.target;a.animated&&(a.currentFrameX+=a.animDirection,0<a.animDirection&&a.currentFrameX>=a.framesCount&&(a.currentFrameX=0),0>a.animDirection&&0>a.currentFrameX&&(a.currentFrameX=a.framesCount-1))};TilesSprite.sync=function(a){a=a.target;a.currentLayer=Math.floor(a.currentFrameX/a.totalFrames);a.currentFrame=a.currentFrameX-a.currentLayer*a.totalFrames};
function JointsDrawer(a){Utils.callSuperConstructor(JointsDrawer,this,null,1,1);this.world=a;this.ignoreList=[];this.revoluteColor="#ff0000";this.distanceColor="#264f05";this.prismaticColor="#FF00FF";this.minJointLength=20;this.addEventListener("render",Utils.proxy(this.draw,this))}Utils.extend(JointsDrawer,Sprite);
JointsDrawer.prototype.draw=function(){for(var a=this.stage,c=this.world.GetJointList();c;c=c.m_next){var d=c.GetAnchorA(),e=c.GetAnchorB();if(!(this.ignoreList&&0<=this.ignoreList.indexOf(c)))if(c.sprite)c.sprite.x=d.x,c.sprite.y=d.y;else if(c.m_type==Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint&&a.drawCircle(d.x*box2d.SCALE,d.y*box2d.SCALE,1,1,this.revoluteColor),c.m_type==Box2D.Dynamics.Joints.b2Joint.e_distanceJoint){var f=d.x-e.x,g=d.y-e.y;Math.sqrt(f*f+g*g)>=this.minJointLength/box2d.SCALE&&
a.drawLine(d.x*box2d.SCALE,d.y*box2d.SCALE,e.x*box2d.SCALE,e.y*box2d.SCALE,1,this.distanceColor)}}};var Box2D={};
(function(a,c){function d(){}!(Object.prototype.defineProperty instanceof Function)&&Object.prototype.__defineGetter__ instanceof Function&&Object.prototype.__defineSetter__ instanceof Function&&(Object.defineProperty=function(a,c,d){d.get instanceof Function&&a.__defineGetter__(c,d.get);d.set instanceof Function&&a.__defineSetter__(c,d.set)});a.inherit=function(a,c){d.prototype=c.prototype;a.prototype=new d;a.prototype.constructor=a};a.generateCallback=function(a,c){return function(){c.apply(a,arguments)}};
a.NVector=function(a){a===c&&(a=0);for(var d=Array(a||0),g=0;g<a;++g)d[g]=0;return d};a.is=function(a,d){return null===a?!1:d instanceof Function&&a instanceof d||a.constructor.__implements!=c&&a.constructor.__implements[d]?!0:!1};a.parseUInt=function(a){return Math.abs(parseInt(a))}})(Box2D);var Vector2=Array,Vector_a2j_Number=Box2D.NVector;"undefined"===typeof Box2D&&(Box2D={});"undefined"===typeof Box2D.Collision&&(Box2D.Collision={});
"undefined"===typeof Box2D.Collision.Shapes&&(Box2D.Collision.Shapes={});"undefined"===typeof Box2D.Common&&(Box2D.Common={});"undefined"===typeof Box2D.Common.Math&&(Box2D.Common.Math={});"undefined"===typeof Box2D.Dynamics&&(Box2D.Dynamics={});"undefined"===typeof Box2D.Dynamics.Contacts&&(Box2D.Dynamics.Contacts={});"undefined"===typeof Box2D.Dynamics.Controllers&&(Box2D.Dynamics.Controllers={});"undefined"===typeof Box2D.Dynamics.Joints&&(Box2D.Dynamics.Joints={});
(function(){function a(){a.b2AABB.apply(this,arguments)}function c(){c.b2Bound.apply(this,arguments)}function d(){d.b2BoundValues.apply(this,arguments);this.constructor===d&&this.b2BoundValues.apply(this,arguments)}function e(){e.b2Collision.apply(this,arguments)}function f(){f.b2ContactID.apply(this,arguments);this.constructor===f&&this.b2ContactID.apply(this,arguments)}function g(){g.b2ContactPoint.apply(this,arguments)}function h(){h.b2Distance.apply(this,arguments)}function k(){k.b2DistanceInput.apply(this,
arguments)}function l(){l.b2DistanceOutput.apply(this,arguments)}function q(){q.b2DistanceProxy.apply(this,arguments)}function v(){v.b2DynamicTree.apply(this,arguments);this.constructor===v&&this.b2DynamicTree.apply(this,arguments)}function w(){w.b2DynamicTreeBroadPhase.apply(this,arguments)}function y(){y.b2DynamicTreeNode.apply(this,arguments)}function r(){r.b2DynamicTreePair.apply(this,arguments)}function z(){z.b2Manifold.apply(this,arguments);this.constructor===z&&this.b2Manifold.apply(this,arguments)}
function A(){A.b2ManifoldPoint.apply(this,arguments);this.constructor===A&&this.b2ManifoldPoint.apply(this,arguments)}function n(){n.b2Point.apply(this,arguments)}function C(){C.b2RayCastInput.apply(this,arguments);this.constructor===C&&this.b2RayCastInput.apply(this,arguments)}function F(){F.b2RayCastOutput.apply(this,arguments)}function J(){J.b2Segment.apply(this,arguments)}function H(){H.b2SeparationFunction.apply(this,arguments)}function L(){L.b2Simplex.apply(this,arguments);this.constructor===
L&&this.b2Simplex.apply(this,arguments)}function D(){D.b2SimplexCache.apply(this,arguments)}function N(){N.b2SimplexVertex.apply(this,arguments)}function I(){I.b2TimeOfImpact.apply(this,arguments)}function K(){K.b2TOIInput.apply(this,arguments)}function O(){O.b2WorldManifold.apply(this,arguments);this.constructor===O&&this.b2WorldManifold.apply(this,arguments)}function M(){M.ClipVertex.apply(this,arguments)}function p(){p.Features.apply(this,arguments)}function t(){t.b2CircleShape.apply(this,arguments);
this.constructor===t&&this.b2CircleShape.apply(this,arguments)}function B(){B.b2EdgeChainDef.apply(this,arguments);this.constructor===B&&this.b2EdgeChainDef.apply(this,arguments)}function x(){x.b2EdgeShape.apply(this,arguments);this.constructor===x&&this.b2EdgeShape.apply(this,arguments)}function G(){G.b2MassData.apply(this,arguments)}function P(){P.b2PolygonShape.apply(this,arguments);this.constructor===P&&this.b2PolygonShape.apply(this,arguments)}function Q(){Q.b2Shape.apply(this,arguments);this.constructor===
Q&&this.b2Shape.apply(this,arguments)}function u(){u.b2Color.apply(this,arguments);this.constructor===u&&this.b2Color.apply(this,arguments)}function m(){m.b2Settings.apply(this,arguments)}function E(){E.b2Mat22.apply(this,arguments);this.constructor===E&&this.b2Mat22.apply(this,arguments)}function R(){R.b2Mat33.apply(this,arguments);this.constructor===R&&this.b2Mat33.apply(this,arguments)}function Da(){Da.b2Math.apply(this,arguments)}function Ea(){Ea.b2Sweep.apply(this,arguments)}function S(){S.b2Transform.apply(this,
arguments);this.constructor===S&&this.b2Transform.apply(this,arguments)}function T(){T.b2Vec2.apply(this,arguments);this.constructor===T&&this.b2Vec2.apply(this,arguments)}function U(){U.b2Vec3.apply(this,arguments);this.constructor===U&&this.b2Vec3.apply(this,arguments)}function V(){V.b2Body.apply(this,arguments);this.constructor===V&&this.b2Body.apply(this,arguments)}function W(){W.b2BodyDef.apply(this,arguments);this.constructor===W&&this.b2BodyDef.apply(this,arguments)}function Fa(){Fa.b2ContactFilter.apply(this,
arguments)}function Ga(){Ga.b2ContactImpulse.apply(this,arguments)}function Ha(){Ha.b2ContactListener.apply(this,arguments)}function X(){X.b2ContactManager.apply(this,arguments);this.constructor===X&&this.b2ContactManager.apply(this,arguments)}function Y(){Y.b2DebugDraw.apply(this,arguments);this.constructor===Y&&this.b2DebugDraw.apply(this,arguments)}function Ia(){Ia.b2DestructionListener.apply(this,arguments)}function Ja(){Ja.b2FilterData.apply(this,arguments)}function Z(){Z.b2Fixture.apply(this,
arguments);this.constructor===Z&&this.b2Fixture.apply(this,arguments)}function aa(){aa.b2FixtureDef.apply(this,arguments);this.constructor===aa&&this.b2FixtureDef.apply(this,arguments)}function ba(){ba.b2Island.apply(this,arguments);this.constructor===ba&&this.b2Island.apply(this,arguments)}function Ka(){Ka.b2TimeStep.apply(this,arguments)}function ca(){ca.b2World.apply(this,arguments);this.constructor===ca&&this.b2World.apply(this,arguments)}function La(){La.b2CircleContact.apply(this,arguments)}
function da(){da.b2Contact.apply(this,arguments);this.constructor===da&&this.b2Contact.apply(this,arguments)}function ea(){ea.b2ContactConstraint.apply(this,arguments);this.constructor===ea&&this.b2ContactConstraint.apply(this,arguments)}function Ma(){Ma.b2ContactConstraintPoint.apply(this,arguments)}function Na(){Na.b2ContactEdge.apply(this,arguments)}function fa(){fa.b2ContactFactory.apply(this,arguments);this.constructor===fa&&this.b2ContactFactory.apply(this,arguments)}function Oa(){Oa.b2ContactRegister.apply(this,
arguments)}function Pa(){Pa.b2ContactResult.apply(this,arguments)}function ga(){ga.b2ContactSolver.apply(this,arguments);this.constructor===ga&&this.b2ContactSolver.apply(this,arguments)}function Qa(){Qa.b2EdgeAndCircleContact.apply(this,arguments)}function ha(){ha.b2NullContact.apply(this,arguments);this.constructor===ha&&this.b2NullContact.apply(this,arguments)}function Ra(){Ra.b2PolyAndCircleContact.apply(this,arguments)}function Sa(){Sa.b2PolyAndEdgeContact.apply(this,arguments)}function Ta(){Ta.b2PolygonContact.apply(this,
arguments)}function ia(){ia.b2PositionSolverManifold.apply(this,arguments);this.constructor===ia&&this.b2PositionSolverManifold.apply(this,arguments)}function Ua(){Ua.b2BuoyancyController.apply(this,arguments)}function Va(){Va.b2ConstantAccelController.apply(this,arguments)}function Wa(){Wa.b2ConstantForceController.apply(this,arguments)}function Xa(){Xa.b2Controller.apply(this,arguments)}function Ya(){Ya.b2ControllerEdge.apply(this,arguments)}function Za(){Za.b2GravityController.apply(this,arguments)}
function $a(){$a.b2TensorDampingController.apply(this,arguments)}function ja(){ja.b2DistanceJoint.apply(this,arguments);this.constructor===ja&&this.b2DistanceJoint.apply(this,arguments)}function ka(){ka.b2DistanceJointDef.apply(this,arguments);this.constructor===ka&&this.b2DistanceJointDef.apply(this,arguments)}function la(){la.b2FrictionJoint.apply(this,arguments);this.constructor===la&&this.b2FrictionJoint.apply(this,arguments)}function ma(){ma.b2FrictionJointDef.apply(this,arguments);this.constructor===
ma&&this.b2FrictionJointDef.apply(this,arguments)}function na(){na.b2GearJoint.apply(this,arguments);this.constructor===na&&this.b2GearJoint.apply(this,arguments)}function oa(){oa.b2GearJointDef.apply(this,arguments);this.constructor===oa&&this.b2GearJointDef.apply(this,arguments)}function ab(){ab.b2Jacobian.apply(this,arguments)}function pa(){pa.b2Joint.apply(this,arguments);this.constructor===pa&&this.b2Joint.apply(this,arguments)}function qa(){qa.b2JointDef.apply(this,arguments);this.constructor===
qa&&this.b2JointDef.apply(this,arguments)}function bb(){bb.b2JointEdge.apply(this,arguments)}function ra(){ra.b2LineJoint.apply(this,arguments);this.constructor===ra&&this.b2LineJoint.apply(this,arguments)}function sa(){sa.b2LineJointDef.apply(this,arguments);this.constructor===sa&&this.b2LineJointDef.apply(this,arguments)}function ta(){ta.b2MouseJoint.apply(this,arguments);this.constructor===ta&&this.b2MouseJoint.apply(this,arguments)}function ua(){ua.b2MouseJointDef.apply(this,arguments);this.constructor===
ua&&this.b2MouseJointDef.apply(this,arguments)}function va(){va.b2PrismaticJoint.apply(this,arguments);this.constructor===va&&this.b2PrismaticJoint.apply(this,arguments)}function wa(){wa.b2PrismaticJointDef.apply(this,arguments);this.constructor===wa&&this.b2PrismaticJointDef.apply(this,arguments)}function xa(){xa.b2PulleyJoint.apply(this,arguments);this.constructor===xa&&this.b2PulleyJoint.apply(this,arguments)}function ya(){ya.b2PulleyJointDef.apply(this,arguments);this.constructor===ya&&this.b2PulleyJointDef.apply(this,
arguments)}function za(){za.b2RevoluteJoint.apply(this,arguments);this.constructor===za&&this.b2RevoluteJoint.apply(this,arguments)}function Aa(){Aa.b2RevoluteJointDef.apply(this,arguments);this.constructor===Aa&&this.b2RevoluteJointDef.apply(this,arguments)}function Ba(){Ba.b2WeldJoint.apply(this,arguments);this.constructor===Ba&&this.b2WeldJoint.apply(this,arguments)}function Ca(){Ca.b2WeldJointDef.apply(this,arguments);this.constructor===Ca&&this.b2WeldJointDef.apply(this,arguments)}Box2D.Collision.IBroadPhase=
"Box2D.Collision.IBroadPhase";Box2D.Collision.b2AABB=a;Box2D.Collision.b2Bound=c;Box2D.Collision.b2BoundValues=d;Box2D.Collision.b2Collision=e;Box2D.Collision.b2ContactID=f;Box2D.Collision.b2ContactPoint=g;Box2D.Collision.b2Distance=h;Box2D.Collision.b2DistanceInput=k;Box2D.Collision.b2DistanceOutput=l;Box2D.Collision.b2DistanceProxy=q;Box2D.Collision.b2DynamicTree=v;Box2D.Collision.b2DynamicTreeBroadPhase=w;Box2D.Collision.b2DynamicTreeNode=y;Box2D.Collision.b2DynamicTreePair=r;Box2D.Collision.b2Manifold=
z;Box2D.Collision.b2ManifoldPoint=A;Box2D.Collision.b2Point=n;Box2D.Collision.b2RayCastInput=C;Box2D.Collision.b2RayCastOutput=F;Box2D.Collision.b2Segment=J;Box2D.Collision.b2SeparationFunction=H;Box2D.Collision.b2Simplex=L;Box2D.Collision.b2SimplexCache=D;Box2D.Collision.b2SimplexVertex=N;Box2D.Collision.b2TimeOfImpact=I;Box2D.Collision.b2TOIInput=K;Box2D.Collision.b2WorldManifold=O;Box2D.Collision.ClipVertex=M;Box2D.Collision.Features=p;Box2D.Collision.Shapes.b2CircleShape=t;Box2D.Collision.Shapes.b2EdgeChainDef=
B;Box2D.Collision.Shapes.b2EdgeShape=x;Box2D.Collision.Shapes.b2MassData=G;Box2D.Collision.Shapes.b2PolygonShape=P;Box2D.Collision.Shapes.b2Shape=Q;Box2D.Common.b2internal="Box2D.Common.b2internal";Box2D.Common.b2Color=u;Box2D.Common.b2Settings=m;Box2D.Common.Math.b2Mat22=E;Box2D.Common.Math.b2Mat33=R;Box2D.Common.Math.b2Math=Da;Box2D.Common.Math.b2Sweep=Ea;Box2D.Common.Math.b2Transform=S;Box2D.Common.Math.b2Vec2=T;Box2D.Common.Math.b2Vec3=U;Box2D.Dynamics.b2Body=V;Box2D.Dynamics.b2BodyDef=W;Box2D.Dynamics.b2ContactFilter=
Fa;Box2D.Dynamics.b2ContactImpulse=Ga;Box2D.Dynamics.b2ContactListener=Ha;Box2D.Dynamics.b2ContactManager=X;Box2D.Dynamics.b2DebugDraw=Y;Box2D.Dynamics.b2DestructionListener=Ia;Box2D.Dynamics.b2FilterData=Ja;Box2D.Dynamics.b2Fixture=Z;Box2D.Dynamics.b2FixtureDef=aa;Box2D.Dynamics.b2Island=ba;Box2D.Dynamics.b2TimeStep=Ka;Box2D.Dynamics.b2World=ca;Box2D.Dynamics.Contacts.b2CircleContact=La;Box2D.Dynamics.Contacts.b2Contact=da;Box2D.Dynamics.Contacts.b2ContactConstraint=ea;Box2D.Dynamics.Contacts.b2ContactConstraintPoint=
Ma;Box2D.Dynamics.Contacts.b2ContactEdge=Na;Box2D.Dynamics.Contacts.b2ContactFactory=fa;Box2D.Dynamics.Contacts.b2ContactRegister=Oa;Box2D.Dynamics.Contacts.b2ContactResult=Pa;Box2D.Dynamics.Contacts.b2ContactSolver=ga;Box2D.Dynamics.Contacts.b2EdgeAndCircleContact=Qa;Box2D.Dynamics.Contacts.b2NullContact=ha;Box2D.Dynamics.Contacts.b2PolyAndCircleContact=Ra;Box2D.Dynamics.Contacts.b2PolyAndEdgeContact=Sa;Box2D.Dynamics.Contacts.b2PolygonContact=Ta;Box2D.Dynamics.Contacts.b2PositionSolverManifold=
ia;Box2D.Dynamics.Controllers.b2BuoyancyController=Ua;Box2D.Dynamics.Controllers.b2ConstantAccelController=Va;Box2D.Dynamics.Controllers.b2ConstantForceController=Wa;Box2D.Dynamics.Controllers.b2Controller=Xa;Box2D.Dynamics.Controllers.b2ControllerEdge=Ya;Box2D.Dynamics.Controllers.b2GravityController=Za;Box2D.Dynamics.Controllers.b2TensorDampingController=$a;Box2D.Dynamics.Joints.b2DistanceJoint=ja;Box2D.Dynamics.Joints.b2DistanceJointDef=ka;Box2D.Dynamics.Joints.b2FrictionJoint=la;Box2D.Dynamics.Joints.b2FrictionJointDef=
ma;Box2D.Dynamics.Joints.b2GearJoint=na;Box2D.Dynamics.Joints.b2GearJointDef=oa;Box2D.Dynamics.Joints.b2Jacobian=ab;Box2D.Dynamics.Joints.b2Joint=pa;Box2D.Dynamics.Joints.b2JointDef=qa;Box2D.Dynamics.Joints.b2JointEdge=bb;Box2D.Dynamics.Joints.b2LineJoint=ra;Box2D.Dynamics.Joints.b2LineJointDef=sa;Box2D.Dynamics.Joints.b2MouseJoint=ta;Box2D.Dynamics.Joints.b2MouseJointDef=ua;Box2D.Dynamics.Joints.b2PrismaticJoint=va;Box2D.Dynamics.Joints.b2PrismaticJointDef=wa;Box2D.Dynamics.Joints.b2PulleyJoint=
xa;Box2D.Dynamics.Joints.b2PulleyJointDef=ya;Box2D.Dynamics.Joints.b2RevoluteJoint=za;Box2D.Dynamics.Joints.b2RevoluteJointDef=Aa;Box2D.Dynamics.Joints.b2WeldJoint=Ba;Box2D.Dynamics.Joints.b2WeldJointDef=Ca})();Box2D.postDefs=[];
(function(){var a=Box2D.Collision.Shapes.b2CircleShape,c=Box2D.Collision.Shapes.b2PolygonShape,d=Box2D.Collision.Shapes.b2Shape,e=Box2D.Common.b2Settings,f=Box2D.Common.Math.b2Math,g=Box2D.Common.Math.b2Sweep,h=Box2D.Common.Math.b2Transform,k=Box2D.Common.Math.b2Vec2,l=Box2D.Collision.b2AABB,q=Box2D.Collision.b2Bound,v=Box2D.Collision.b2BoundValues,w=Box2D.Collision.b2Collision,y=Box2D.Collision.b2ContactID,r=Box2D.Collision.b2ContactPoint,z=Box2D.Collision.b2Distance,A=Box2D.Collision.b2DistanceInput,
n=Box2D.Collision.b2DistanceOutput,C=Box2D.Collision.b2DistanceProxy,F=Box2D.Collision.b2DynamicTree,J=Box2D.Collision.b2DynamicTreeBroadPhase,H=Box2D.Collision.b2DynamicTreeNode,L=Box2D.Collision.b2DynamicTreePair,D=Box2D.Collision.b2Manifold,N=Box2D.Collision.b2ManifoldPoint,I=Box2D.Collision.b2Point,K=Box2D.Collision.b2RayCastInput,O=Box2D.Collision.b2RayCastOutput,M=Box2D.Collision.b2Segment,p=Box2D.Collision.b2SeparationFunction,t=Box2D.Collision.b2Simplex,B=Box2D.Collision.b2SimplexCache,x=
Box2D.Collision.b2SimplexVertex,G=Box2D.Collision.b2TimeOfImpact,P=Box2D.Collision.b2TOIInput,Q=Box2D.Collision.b2WorldManifold,u=Box2D.Collision.ClipVertex,m=Box2D.Collision.Features,E=Box2D.Collision.IBroadPhase;l.b2AABB=function(){this.lowerBound=new k;this.upperBound=new k};l.prototype.IsValid=function(){var a=this.upperBound.y-this.lowerBound.y;return a=(a=0<=this.upperBound.x-this.lowerBound.x&&0<=a)&&this.lowerBound.IsValid()&&this.upperBound.IsValid()};l.prototype.GetCenter=function(){return new k((this.lowerBound.x+
this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)};l.prototype.GetExtents=function(){return new k((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)};l.prototype.Contains=function(a){var c;return c=(c=(c=(c=this.lowerBound.x<=a.lowerBound.x)&&this.lowerBound.y<=a.lowerBound.y)&&a.upperBound.x<=this.upperBound.x)&&a.upperBound.y<=this.upperBound.y};l.prototype.RayCast=function(a,c){var d=-Number.MAX_VALUE,e=Number.MAX_VALUE,f=c.p1.x,u=c.p1.y,g=c.p2.x-c.p1.x,
m=c.p2.y-c.p1.y,p=Math.abs(g),k=Math.abs(m),t=a.normal,x=0,E=0,n=x=0,n=0;if(p<Number.MIN_VALUE){if(f<this.lowerBound.x||this.upperBound.x<f)return!1}else if(x=1/g,E=(this.lowerBound.x-f)*x,x*=this.upperBound.x-f,n=-1,E>x&&(n=E,E=x,x=n,n=1),E>d&&(t.x=n,t.y=0,d=E),e=Math.min(e,x),d>e)return!1;if(k<Number.MIN_VALUE){if(u<this.lowerBound.y||this.upperBound.y<u)return!1}else if(x=1/m,E=(this.lowerBound.y-u)*x,x*=this.upperBound.y-u,n=-1,E>x&&(n=E,E=x,x=n,n=1),E>d&&(t.y=n,t.x=0,d=E),e=Math.min(e,x),d>e)return!1;
a.fraction=d;return!0};l.prototype.TestOverlap=function(a){var c=a.lowerBound.y-this.upperBound.y,d=this.lowerBound.y-a.upperBound.y;return 0<a.lowerBound.x-this.upperBound.x||0<c||0<this.lowerBound.x-a.upperBound.x||0<d?!1:!0};l.Combine=function(a,c){var d=new l;d.Combine(a,c);return d};l.prototype.Combine=function(a,c){this.lowerBound.x=Math.min(a.lowerBound.x,c.lowerBound.x);this.lowerBound.y=Math.min(a.lowerBound.y,c.lowerBound.y);this.upperBound.x=Math.max(a.upperBound.x,c.upperBound.x);this.upperBound.y=
Math.max(a.upperBound.y,c.upperBound.y)};q.b2Bound=function(){};q.prototype.IsLower=function(){return 0==(this.value&1)};q.prototype.IsUpper=function(){return 1==(this.value&1)};q.prototype.Swap=function(a){var c=this.value,d=this.proxy,e=this.stabbingCount;this.value=a.value;this.proxy=a.proxy;this.stabbingCount=a.stabbingCount;a.value=c;a.proxy=d;a.stabbingCount=e};v.b2BoundValues=function(){};v.prototype.b2BoundValues=function(){this.lowerValues=new Vector_a2j_Number;this.lowerValues[0]=0;this.lowerValues[1]=
0;this.upperValues=new Vector_a2j_Number;this.upperValues[0]=0;this.upperValues[1]=0};w.b2Collision=function(){};w.ClipSegmentToLine=function(a,c,d,e){void 0===e&&(e=0);var f,u=0;f=c[0];var g=f.v;f=c[1];var m=f.v,p=d.x*g.x+d.y*g.y-e;f=d.x*m.x+d.y*m.y-e;0>=p&&a[u++].Set(c[0]);0>=f&&a[u++].Set(c[1]);0>p*f&&(d=p/(p-f),f=a[u],f=f.v,f.x=g.x+d*(m.x-g.x),f.y=g.y+d*(m.y-g.y),f=a[u],f.id=(0<p?c[0]:c[1]).id,++u);return u};w.EdgeSeparation=function(a,c,d,e,f){void 0===d&&(d=0);parseInt(a.m_vertexCount);var u=
a.m_vertices;a=a.m_normals;var g=parseInt(e.m_vertexCount),m=e.m_vertices,p,k;p=c.R;k=a[d];a=p.col1.x*k.x+p.col2.x*k.y;e=p.col1.y*k.x+p.col2.y*k.y;p=f.R;var t=p.col1.x*a+p.col1.y*e;p=p.col2.x*a+p.col2.y*e;for(var x=0,E=Number.MAX_VALUE,n=0;n<g;++n)k=m[n],k=k.x*t+k.y*p,k<E&&(E=k,x=n);k=u[d];p=c.R;d=c.position.x+(p.col1.x*k.x+p.col2.x*k.y);c=c.position.y+(p.col1.y*k.x+p.col2.y*k.y);k=m[x];p=f.R;u=f.position.x+(p.col1.x*k.x+p.col2.x*k.y);f=f.position.y+(p.col1.y*k.x+p.col2.y*k.y);return(u-d)*a+(f-c)*
e};w.FindMaxSeparation=function(a,c,d,e,f){var u=parseInt(c.m_vertexCount),g=c.m_normals,p,m;m=f.R;p=e.m_centroid;var k=f.position.x+(m.col1.x*p.x+m.col2.x*p.y),t=f.position.y+(m.col1.y*p.x+m.col2.y*p.y);m=d.R;p=c.m_centroid;k-=d.position.x+(m.col1.x*p.x+m.col2.x*p.y);t-=d.position.y+(m.col1.y*p.x+m.col2.y*p.y);m=k*d.R.col1.x+t*d.R.col1.y;for(var t=k*d.R.col2.x+t*d.R.col2.y,k=0,x=-Number.MAX_VALUE,E=0;E<u;++E)p=g[E],p=p.x*m+p.y*t,p>x&&(x=p,k=E);g=w.EdgeSeparation(c,d,k,e,f);p=parseInt(0<=k-1?k-1:
u-1);m=w.EdgeSeparation(c,d,p,e,f);var t=parseInt(k+1<u?k+1:0),x=w.EdgeSeparation(c,d,t,e,f),n=E=0,h=0;if(m>g&&m>x)h=-1,E=p,n=m;else if(x>g)h=1,E=t,n=x;else return a[0]=k,g;for(;;)if(k=-1==h?0<=E-1?E-1:u-1:E+1<u?E+1:0,g=w.EdgeSeparation(c,d,k,e,f),g>n)E=k,n=g;else break;a[0]=E;return n};w.FindIncidentEdge=function(a,c,d,e,f,u){void 0===e&&(e=0);parseInt(c.m_vertexCount);var g=c.m_normals,p=parseInt(f.m_vertexCount);c=f.m_vertices;f=f.m_normals;var m;m=d.R;d=g[e];var g=m.col1.x*d.x+m.col2.x*d.y,k=
m.col1.y*d.x+m.col2.y*d.y;m=u.R;d=m.col1.x*g+m.col1.y*k;k=m.col2.x*g+m.col2.y*k;g=d;m=0;for(var t=Number.MAX_VALUE,x=0;x<p;++x)d=f[x],d=g*d.x+k*d.y,d<t&&(t=d,m=x);f=parseInt(m);g=parseInt(f+1<p?f+1:0);p=a[0];d=c[f];m=u.R;p.v.x=u.position.x+(m.col1.x*d.x+m.col2.x*d.y);p.v.y=u.position.y+(m.col1.y*d.x+m.col2.y*d.y);p.id.features.referenceEdge=e;p.id.features.incidentEdge=f;p.id.features.incidentVertex=0;p=a[1];d=c[g];m=u.R;p.v.x=u.position.x+(m.col1.x*d.x+m.col2.x*d.y);p.v.y=u.position.y+(m.col1.y*
d.x+m.col2.y*d.y);p.id.features.referenceEdge=e;p.id.features.incidentEdge=g;p.id.features.incidentVertex=1};w.MakeClipPointVector=function(){var a=new Vector2(2);a[0]=new u;a[1]=new u;return a};w.CollidePolygons=function(a,c,d,f,u){var g;a.m_pointCount=0;var p=c.m_radius+f.m_radius;w.s_edgeAO[0]=0;var m=w.FindMaxSeparation(w.s_edgeAO,c,d,f,u);g=w.s_edgeAO[0];if(!(m>p)){var k;w.s_edgeBO[0]=0;var t=w.FindMaxSeparation(w.s_edgeBO,f,u,c,d);k=w.s_edgeBO[0];if(!(t>p)){var x=0,E=0;t>.98*m+.001?(m=f,f=c,
c=u,x=k,a.m_type=D.e_faceB,E=1):(m=c,c=d,d=u,x=g,a.m_type=D.e_faceA,E=0);g=w.s_incidentEdge;w.FindIncidentEdge(g,m,c,x,f,d);k=parseInt(m.m_vertexCount);u=m.m_vertices;var m=u[x],n;n=x+1<k?u[parseInt(x+1)]:u[0];x=w.s_localTangent;x.Set(n.x-m.x,n.y-m.y);x.Normalize();u=w.s_localNormal;u.x=x.y;u.y=-x.x;f=w.s_planePoint;f.Set(.5*(m.x+n.x),.5*(m.y+n.y));t=w.s_tangent;k=c.R;t.x=k.col1.x*x.x+k.col2.x*x.y;t.y=k.col1.y*x.x+k.col2.y*x.y;var h=w.s_tangent2;h.x=-t.x;h.y=-t.y;x=w.s_normal;x.x=t.y;x.y=-t.x;var B=
w.s_v11,G=w.s_v12;B.x=c.position.x+(k.col1.x*m.x+k.col2.x*m.y);B.y=c.position.y+(k.col1.y*m.x+k.col2.y*m.y);G.x=c.position.x+(k.col1.x*n.x+k.col2.x*n.y);G.y=c.position.y+(k.col1.y*n.x+k.col2.y*n.y);c=x.x*B.x+x.y*B.y;k=t.x*G.x+t.y*G.y+p;n=w.s_clipPoints1;m=w.s_clipPoints2;G=0;G=w.ClipSegmentToLine(n,g,h,-t.x*B.x-t.y*B.y+p);if(!(2>G||(G=w.ClipSegmentToLine(m,n,t,k),2>G))){a.m_localPlaneNormal.SetV(u);a.m_localPoint.SetV(f);for(f=u=0;f<e.b2_maxManifoldPoints;++f)g=m[f],x.x*g.v.x+x.y*g.v.y-c<=p&&(t=a.m_points[u],
k=d.R,h=g.v.x-d.position.x,B=g.v.y-d.position.y,t.m_localPoint.x=h*k.col1.x+B*k.col1.y,t.m_localPoint.y=h*k.col2.x+B*k.col2.y,t.m_id.Set(g.id),t.m_id.features.flip=E,++u);a.m_pointCount=u}}}};w.CollideCircles=function(a,c,d,e,f){a.m_pointCount=0;var u,g;u=d.R;g=c.m_p;var m=d.position.x+(u.col1.x*g.x+u.col2.x*g.y);d=d.position.y+(u.col1.y*g.x+u.col2.y*g.y);u=f.R;g=e.m_p;m=f.position.x+(u.col1.x*g.x+u.col2.x*g.y)-m;f=f.position.y+(u.col1.y*g.x+u.col2.y*g.y)-d;u=c.m_radius+e.m_radius;m*m+f*f>u*u||(a.m_type=
D.e_circles,a.m_localPoint.SetV(c.m_p),a.m_localPlaneNormal.SetZero(),a.m_pointCount=1,a.m_points[0].m_localPoint.SetV(e.m_p),a.m_points[0].m_id.key=0)};w.CollidePolygonAndCircle=function(a,c,d,e,f){var u=a.m_pointCount=0,g=0,m,p;p=f.R;m=e.m_p;var k=f.position.y+(p.col1.y*m.x+p.col2.y*m.y),u=f.position.x+(p.col1.x*m.x+p.col2.x*m.y)-d.position.x,g=k-d.position.y;p=d.R;d=u*p.col1.x+g*p.col1.y;p=u*p.col2.x+g*p.col2.y;var t=0,k=-Number.MAX_VALUE;f=c.m_radius+e.m_radius;var x=parseInt(c.m_vertexCount),
E=c.m_vertices;c=c.m_normals;for(var n=0;n<x;++n){m=E[n];u=d-m.x;g=p-m.y;m=c[n];u=m.x*u+m.y*g;if(u>f)return;u>k&&(k=u,t=n)}u=parseInt(t);g=parseInt(u+1<x?u+1:0);m=E[u];E=E[g];k<Number.MIN_VALUE?(a.m_pointCount=1,a.m_type=D.e_faceA,a.m_localPlaneNormal.SetV(c[t]),a.m_localPoint.x=.5*(m.x+E.x),a.m_localPoint.y=.5*(m.y+E.y),a.m_points[0].m_localPoint.SetV(e.m_p),a.m_points[0].m_id.key=0):(k=(d-E.x)*(m.x-E.x)+(p-E.y)*(m.y-E.y),0>=(d-m.x)*(E.x-m.x)+(p-m.y)*(E.y-m.y)?(d-m.x)*(d-m.x)+(p-m.y)*(p-m.y)>f*f||
(a.m_pointCount=1,a.m_type=D.e_faceA,a.m_localPlaneNormal.x=d-m.x,a.m_localPlaneNormal.y=p-m.y,a.m_localPlaneNormal.Normalize(),a.m_localPoint.SetV(m),a.m_points[0].m_localPoint.SetV(e.m_p),a.m_points[0].m_id.key=0):0>=k?(d-E.x)*(d-E.x)+(p-E.y)*(p-E.y)>f*f||(a.m_pointCount=1,a.m_type=D.e_faceA,a.m_localPlaneNormal.x=d-E.x,a.m_localPlaneNormal.y=p-E.y,a.m_localPlaneNormal.Normalize(),a.m_localPoint.SetV(E),a.m_points[0].m_localPoint.SetV(e.m_p),a.m_points[0].m_id.key=0):(t=.5*(m.x+E.x),m=.5*(m.y+E.y),
k=(d-t)*c[u].x+(p-m)*c[u].y,k>f||(a.m_pointCount=1,a.m_type=D.e_faceA,a.m_localPlaneNormal.x=c[u].x,a.m_localPlaneNormal.y=c[u].y,a.m_localPlaneNormal.Normalize(),a.m_localPoint.Set(t,m),a.m_points[0].m_localPoint.SetV(e.m_p),a.m_points[0].m_id.key=0)))};w.TestOverlap=function(a,c){var d=c.lowerBound,e=a.upperBound,f=d.x-e.x,u=d.y-e.y,d=a.lowerBound,e=c.upperBound,g=d.y-e.y;return 0<f||0<u||0<d.x-e.x||0<g?!1:!0};Box2D.postDefs.push(function(){Box2D.Collision.b2Collision.s_incidentEdge=w.MakeClipPointVector();
Box2D.Collision.b2Collision.s_clipPoints1=w.MakeClipPointVector();Box2D.Collision.b2Collision.s_clipPoints2=w.MakeClipPointVector();Box2D.Collision.b2Collision.s_edgeAO=new Vector_a2j_Number(1);Box2D.Collision.b2Collision.s_edgeBO=new Vector_a2j_Number(1);Box2D.Collision.b2Collision.s_localTangent=new k;Box2D.Collision.b2Collision.s_localNormal=new k;Box2D.Collision.b2Collision.s_planePoint=new k;Box2D.Collision.b2Collision.s_normal=new k;Box2D.Collision.b2Collision.s_tangent=new k;Box2D.Collision.b2Collision.s_tangent2=
new k;Box2D.Collision.b2Collision.s_v11=new k;Box2D.Collision.b2Collision.s_v12=new k;Box2D.Collision.b2Collision.b2CollidePolyTempVec=new k;Box2D.Collision.b2Collision.b2_nullFeature=255});y.b2ContactID=function(){this.features=new m};y.prototype.b2ContactID=function(){this.features._m_id=this};y.prototype.Set=function(a){this.key=a._key};y.prototype.Copy=function(){var a=new y;a.key=this.key;return a};Object.defineProperty(y.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this._key}});
Object.defineProperty(y.prototype,"key",{enumerable:!1,configurable:!0,set:function(a){void 0===a&&(a=0);this._key=a;this.features._referenceEdge=this._key&255;this.features._incidentEdge=(this._key&65280)>>8&255;this.features._incidentVertex=(this._key&16711680)>>16&255;this.features._flip=(this._key&4278190080)>>24&255}});r.b2ContactPoint=function(){this.position=new k;this.velocity=new k;this.normal=new k;this.id=new y};z.b2Distance=function(){};z.Distance=function(a,c,d){++z.b2_gjkCalls;var u=
d.proxyA,g=d.proxyB,m=d.transformA,p=d.transformB,t=z.s_simplex;t.ReadCache(c,u,m,g,p);var x=t.m_vertices,E=z.s_saveA,n=z.s_saveB,h=0;t.GetClosestPoint().LengthSquared();for(var B=0,G,Q=0;20>Q;){h=t.m_count;for(B=0;B<h;B++)E[B]=x[B].indexA,n[B]=x[B].indexB;switch(t.m_count){case 1:break;case 2:t.Solve2();break;case 3:t.Solve3();break;default:e.b2Assert(!1)}if(3==t.m_count)break;G=t.GetClosestPoint();G.LengthSquared();B=t.GetSearchDirection();if(B.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;
G=x[t.m_count];G.indexA=u.GetSupport(f.MulTMV(m.R,B.GetNegative()));G.wA=f.MulX(m,u.GetVertex(G.indexA));G.indexB=g.GetSupport(f.MulTMV(p.R,B));G.wB=f.MulX(p,g.GetVertex(G.indexB));G.w=f.SubtractVV(G.wB,G.wA);++Q;++z.b2_gjkIters;for(var l=!1,B=0;B<h;B++)if(G.indexA==E[B]&&G.indexB==n[B]){l=!0;break}if(l)break;++t.m_count}z.b2_gjkMaxIters=f.Max(z.b2_gjkMaxIters,Q);t.GetWitnessPoints(a.pointA,a.pointB);a.distance=f.SubtractVV(a.pointA,a.pointB).Length();a.iterations=Q;t.WriteCache(c);d.useRadii&&(c=
u.m_radius,g=g.m_radius,a.distance>c+g&&a.distance>Number.MIN_VALUE?(a.distance-=c+g,d=f.SubtractVV(a.pointB,a.pointA),d.Normalize(),a.pointA.x+=c*d.x,a.pointA.y+=c*d.y,a.pointB.x-=g*d.x,a.pointB.y-=g*d.y):(G=new k,G.x=.5*(a.pointA.x+a.pointB.x),G.y=.5*(a.pointA.y+a.pointB.y),a.pointA.x=a.pointB.x=G.x,a.pointA.y=a.pointB.y=G.y,a.distance=0))};Box2D.postDefs.push(function(){Box2D.Collision.b2Distance.s_simplex=new t;Box2D.Collision.b2Distance.s_saveA=new Vector_a2j_Number(3);Box2D.Collision.b2Distance.s_saveB=
new Vector_a2j_Number(3)});A.b2DistanceInput=function(){};n.b2DistanceOutput=function(){this.pointA=new k;this.pointB=new k};C.b2DistanceProxy=function(){};C.prototype.Set=function(f){switch(f.GetType()){case d.e_circleShape:f=f instanceof a?f:null;this.m_vertices=new Vector2(1,!0);this.m_vertices[0]=f.m_p;this.m_count=1;this.m_radius=f.m_radius;break;case d.e_polygonShape:f=f instanceof c?f:null;this.m_vertices=f.m_vertices;this.m_count=f.m_vertexCount;this.m_radius=f.m_radius;break;default:e.b2Assert(!1)}};
C.prototype.GetSupport=function(a){for(var c=0,d=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,e=1;e<this.m_count;++e){var f=this.m_vertices[e].x*a.x+this.m_vertices[e].y*a.y;f>d&&(c=e,d=f)}return c};C.prototype.GetSupportVertex=function(a){for(var c=0,d=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,e=1;e<this.m_count;++e){var f=this.m_vertices[e].x*a.x+this.m_vertices[e].y*a.y;f>d&&(c=e,d=f)}return this.m_vertices[c]};C.prototype.GetVertexCount=function(){return this.m_count};C.prototype.GetVertex=
function(a){void 0===a&&(a=0);e.b2Assert(0<=a&&a<this.m_count);return this.m_vertices[a]};F.b2DynamicTree=function(){};F.prototype.b2DynamicTree=function(){this.m_freeList=this.m_root=null;this.m_insertionCount=this.m_path=0};F.prototype.CreateProxy=function(a,c){var d=this.AllocateNode(),f=e.b2_aabbExtension,u=e.b2_aabbExtension;d.aabb.lowerBound.x=a.lowerBound.x-f;d.aabb.lowerBound.y=a.lowerBound.y-u;d.aabb.upperBound.x=a.upperBound.x+f;d.aabb.upperBound.y=a.upperBound.y+u;d.userData=c;this.InsertLeaf(d);
return d};F.prototype.DestroyProxy=function(a){this.RemoveLeaf(a);this.FreeNode(a)};F.prototype.MoveProxy=function(a,c,d){e.b2Assert(a.IsLeaf());if(a.aabb.Contains(c))return!1;this.RemoveLeaf(a);var f=e.b2_aabbExtension+e.b2_aabbMultiplier*(0<d.x?d.x:-d.x);d=e.b2_aabbExtension+e.b2_aabbMultiplier*(0<d.y?d.y:-d.y);a.aabb.lowerBound.x=c.lowerBound.x-f;a.aabb.lowerBound.y=c.lowerBound.y-d;a.aabb.upperBound.x=c.upperBound.x+f;a.aabb.upperBound.y=c.upperBound.y+d;this.InsertLeaf(a);return!0};F.prototype.Rebalance=
function(a){void 0===a&&(a=0);if(null!=this.m_root)for(var c=0;c<a;c++){for(var d=this.m_root,e=0;0==d.IsLeaf();)d=this.m_path>>e&1?d.child2:d.child1,e=e+1&31;++this.m_path;this.RemoveLeaf(d);this.InsertLeaf(d)}};F.prototype.GetFatAABB=function(a){return a.aabb};F.prototype.GetUserData=function(a){return a.userData};F.prototype.Query=function(a,c){if(null!=this.m_root){var d=new Vector2,e=0;for(d[e++]=this.m_root;0<e;){var f=d[--e];if(f.aabb.TestOverlap(c))if(f.IsLeaf()){if(!a(f))break}else d[e++]=
f.child1,d[e++]=f.child2}}};F.prototype.RayCast=function(a,c){if(null!=this.m_root){var d=c.p1,e=c.p2,u=f.SubtractVV(d,e);u.Normalize();var u=f.CrossFV(1,u),g=f.AbsV(u),m=c.maxFraction,p=new l,k=0,t=0,k=d.x+m*(e.x-d.x),t=d.y+m*(e.y-d.y);p.lowerBound.x=Math.min(d.x,k);p.lowerBound.y=Math.min(d.y,t);p.upperBound.x=Math.max(d.x,k);p.upperBound.y=Math.max(d.y,t);var x=new Vector2,E=0;for(x[E++]=this.m_root;0<E;)if(m=x[--E],0!=m.aabb.TestOverlap(p)&&(k=m.aabb.GetCenter(),t=m.aabb.GetExtents(),!(0<Math.abs(u.x*
(d.x-k.x)+u.y*(d.y-k.y))-g.x*t.x-g.y*t.y)))if(m.IsLeaf()){k=new K;k.p1=c.p1;k.p2=c.p2;k.maxFraction=c.maxFraction;m=a(k,m);if(0==m)break;0<m&&(k=d.x+m*(e.x-d.x),t=d.y+m*(e.y-d.y),p.lowerBound.x=Math.min(d.x,k),p.lowerBound.y=Math.min(d.y,t),p.upperBound.x=Math.max(d.x,k),p.upperBound.y=Math.max(d.y,t))}else x[E++]=m.child1,x[E++]=m.child2}};F.prototype.AllocateNode=function(){if(this.m_freeList){var a=this.m_freeList;this.m_freeList=a.parent;a.parent=null;a.child1=null;a.child2=null;return a}return new H};
F.prototype.FreeNode=function(a){a.parent=this.m_freeList;this.m_freeList=a};F.prototype.InsertLeaf=function(a){++this.m_insertionCount;if(null==this.m_root)this.m_root=a,this.m_root.parent=null;else{var c=a.aabb.GetCenter(),d=this.m_root;if(0==d.IsLeaf()){do var e=d.child1,d=d.child2,f=Math.abs((e.aabb.lowerBound.x+e.aabb.upperBound.x)/2-c.x)+Math.abs((e.aabb.lowerBound.y+e.aabb.upperBound.y)/2-c.y),u=Math.abs((d.aabb.lowerBound.x+d.aabb.upperBound.x)/2-c.x)+Math.abs((d.aabb.lowerBound.y+d.aabb.upperBound.y)/
2-c.y),d=f<u?e:d;while(0==d.IsLeaf())}c=d.parent;e=this.AllocateNode();e.parent=c;e.userData=null;e.aabb.Combine(a.aabb,d.aabb);if(c){d.parent.child1==d?c.child1=e:c.child2=e;e.child1=d;e.child2=a;d.parent=e;a.parent=e;do{if(c.aabb.Contains(e.aabb))break;c.aabb.Combine(c.child1.aabb,c.child2.aabb);e=c;c=c.parent}while(c)}else e.child1=d,e.child2=a,d.parent=e,this.m_root=a.parent=e}};F.prototype.RemoveLeaf=function(a){if(a==this.m_root)this.m_root=null;else{var c=a.parent,d=c.parent;a=c.child1==a?
c.child2:c.child1;if(d)for(d.child1==c?d.child1=a:d.child2=a,a.parent=d,this.FreeNode(c);d;){c=d.aabb;d.aabb=l.Combine(d.child1.aabb,d.child2.aabb);if(c.Contains(d.aabb))break;d=d.parent}else this.m_root=a,a.parent=null,this.FreeNode(c)}};J.b2DynamicTreeBroadPhase=function(){this.m_tree=new F;this.m_moveBuffer=new Vector2;this.m_pairBuffer=new Vector2;this.m_pairCount=0};J.prototype.CreateProxy=function(a,c){var d=this.m_tree.CreateProxy(a,c);++this.m_proxyCount;this.BufferMove(d);return d};J.prototype.DestroyProxy=
function(a){this.UnBufferMove(a);--this.m_proxyCount;this.m_tree.DestroyProxy(a)};J.prototype.MoveProxy=function(a,c,d){this.m_tree.MoveProxy(a,c,d)&&this.BufferMove(a)};J.prototype.TestOverlap=function(a,c){var d=this.m_tree.GetFatAABB(a),e=this.m_tree.GetFatAABB(c);return d.TestOverlap(e)};J.prototype.GetUserData=function(a){return this.m_tree.GetUserData(a)};J.prototype.GetFatAABB=function(a){return this.m_tree.GetFatAABB(a)};J.prototype.GetProxyCount=function(){return this.m_proxyCount};J.prototype.UpdatePairs=
function(a){for(var c=this,d=c.m_pairCount=0,e,d=0;d<c.m_moveBuffer.length;++d){e=c.m_moveBuffer[d];var f=c.m_tree.GetFatAABB(e);c.m_tree.Query(function(a){if(a==e)return!0;c.m_pairCount==c.m_pairBuffer.length&&(c.m_pairBuffer[c.m_pairCount]=new L);var d=c.m_pairBuffer[c.m_pairCount];d.proxyA=a<e?a:e;d.proxyB=a>=e?a:e;++c.m_pairCount;return!0},f)}for(d=c.m_moveBuffer.length=0;d<c.m_pairCount;){var f=c.m_pairBuffer[d],u=c.m_tree.GetUserData(f.proxyA),g=c.m_tree.GetUserData(f.proxyB);a(u,g);for(++d;d<
c.m_pairCount;){u=c.m_pairBuffer[d];if(u.proxyA!=f.proxyA||u.proxyB!=f.proxyB)break;++d}}};J.prototype.Query=function(a,c){this.m_tree.Query(a,c)};J.prototype.RayCast=function(a,c){this.m_tree.RayCast(a,c)};J.prototype.Validate=function(){};J.prototype.Rebalance=function(a){void 0===a&&(a=0);this.m_tree.Rebalance(a)};J.prototype.BufferMove=function(a){this.m_moveBuffer[this.m_moveBuffer.length]=a};J.prototype.UnBufferMove=function(a){a=parseInt(this.m_moveBuffer.indexOf(a));this.m_moveBuffer.splice(a,
1)};J.prototype.ComparePairs=function(a,c){return 0};J.__implements={};J.__implements[E]=!0;H.b2DynamicTreeNode=function(){this.aabb=new l};H.prototype.IsLeaf=function(){return null==this.child1};L.b2DynamicTreePair=function(){};D.b2Manifold=function(){this.m_pointCount=0};D.prototype.b2Manifold=function(){this.m_points=new Vector2(e.b2_maxManifoldPoints);for(var a=0;a<e.b2_maxManifoldPoints;a++)this.m_points[a]=new N;this.m_localPlaneNormal=new k;this.m_localPoint=new k};D.prototype.Reset=function(){for(var a=
0;a<e.b2_maxManifoldPoints;a++)(this.m_points[a]instanceof N?this.m_points[a]:null).Reset();this.m_localPlaneNormal.SetZero();this.m_localPoint.SetZero();this.m_pointCount=this.m_type=0};D.prototype.Set=function(a){this.m_pointCount=a.m_pointCount;for(var c=0;c<e.b2_maxManifoldPoints;c++)(this.m_points[c]instanceof N?this.m_points[c]:null).Set(a.m_points[c]);this.m_localPlaneNormal.SetV(a.m_localPlaneNormal);this.m_localPoint.SetV(a.m_localPoint);this.m_type=a.m_type};D.prototype.Copy=function(){var a=
new D;a.Set(this);return a};Box2D.postDefs.push(function(){Box2D.Collision.b2Manifold.e_circles=1;Box2D.Collision.b2Manifold.e_faceA=2;Box2D.Collision.b2Manifold.e_faceB=4});N.b2ManifoldPoint=function(){this.m_localPoint=new k;this.m_id=new y};N.prototype.b2ManifoldPoint=function(){this.Reset()};N.prototype.Reset=function(){this.m_localPoint.SetZero();this.m_tangentImpulse=this.m_normalImpulse=0;this.m_id.key=0};N.prototype.Set=function(a){this.m_localPoint.SetV(a.m_localPoint);this.m_normalImpulse=
a.m_normalImpulse;this.m_tangentImpulse=a.m_tangentImpulse;this.m_id.Set(a.m_id)};I.b2Point=function(){this.p=new k};I.prototype.Support=function(a,c,d){return this.p};I.prototype.GetFirstVertex=function(a){return this.p};K.b2RayCastInput=function(){this.p1=new k;this.p2=new k};K.prototype.b2RayCastInput=function(a,c,d){void 0===a&&(a=null);void 0===c&&(c=null);void 0===d&&(d=1);a&&this.p1.SetV(a);c&&this.p2.SetV(c);this.maxFraction=d};O.b2RayCastOutput=function(){this.normal=new k};M.b2Segment=function(){this.p1=
new k;this.p2=new k};M.prototype.TestSegment=function(a,c,d,e){void 0===e&&(e=0);var f=d.p1,u=d.p2.x-f.x,g=d.p2.y-f.y;d=this.p2.y-this.p1.y;var m=-(this.p2.x-this.p1.x),p=100*Number.MIN_VALUE,k=-(u*d+g*m);if(k>p){var t=f.x-this.p1.x,x=f.y-this.p1.y,f=t*d+x*m;if(0<=f&&f<=e*k&&(e=-u*x+g*t,-p*k<=e&&e<=k*(1+p)))return f/=k,e=Math.sqrt(d*d+m*m),a[0]=f,c.Set(d/e,m/e),!0}return!1};M.prototype.Extend=function(a){this.ExtendForward(a);this.ExtendBackward(a)};M.prototype.ExtendForward=function(a){var c=this.p2.x-
this.p1.x,d=this.p2.y-this.p1.y;a=Math.min(0<c?(a.upperBound.x-this.p1.x)/c:0>c?(a.lowerBound.x-this.p1.x)/c:Number.POSITIVE_INFINITY,0<d?(a.upperBound.y-this.p1.y)/d:0>d?(a.lowerBound.y-this.p1.y)/d:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+c*a;this.p2.y=this.p1.y+d*a};M.prototype.ExtendBackward=function(a){var c=-this.p2.x+this.p1.x,d=-this.p2.y+this.p1.y;a=Math.min(0<c?(a.upperBound.x-this.p2.x)/c:0>c?(a.lowerBound.x-this.p2.x)/c:Number.POSITIVE_INFINITY,0<d?(a.upperBound.y-this.p2.y)/d:0>
d?(a.lowerBound.y-this.p2.y)/d:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+c*a;this.p1.y=this.p2.y+d*a};p.b2SeparationFunction=function(){this.m_localPoint=new k;this.m_axis=new k};p.prototype.Initialize=function(a,c,d,u,g){this.m_proxyA=c;this.m_proxyB=u;var m=parseInt(a.count);e.b2Assert(0<m&&3>m);var t,x,E,n,B=n=E=u=c=0,h=0,B=0;1==m?(this.m_type=p.e_points,t=this.m_proxyA.GetVertex(a.indexA[0]),x=this.m_proxyB.GetVertex(a.indexB[0]),m=t,a=d.R,c=d.position.x+(a.col1.x*m.x+a.col2.x*m.y),u=d.position.y+
(a.col1.y*m.x+a.col2.y*m.y),m=x,a=g.R,E=g.position.x+(a.col1.x*m.x+a.col2.x*m.y),n=g.position.y+(a.col1.y*m.x+a.col2.y*m.y),this.m_axis.x=E-c,this.m_axis.y=n-u,this.m_axis.Normalize()):(a.indexB[0]==a.indexB[1]?(this.m_type=p.e_faceA,c=this.m_proxyA.GetVertex(a.indexA[0]),u=this.m_proxyA.GetVertex(a.indexA[1]),x=this.m_proxyB.GetVertex(a.indexB[0]),this.m_localPoint.x=.5*(c.x+u.x),this.m_localPoint.y=.5*(c.y+u.y),this.m_axis=f.CrossVF(f.SubtractVV(u,c),1),this.m_axis.Normalize(),m=this.m_axis,a=d.R,
B=a.col1.x*m.x+a.col2.x*m.y,h=a.col1.y*m.x+a.col2.y*m.y,m=this.m_localPoint,a=d.R,c=d.position.x+(a.col1.x*m.x+a.col2.x*m.y),u=d.position.y+(a.col1.y*m.x+a.col2.y*m.y),m=x,a=g.R,E=g.position.x+(a.col1.x*m.x+a.col2.x*m.y),n=g.position.y+(a.col1.y*m.x+a.col2.y*m.y),B=(E-c)*B+(n-u)*h):a.indexA[0]==a.indexA[0]?(this.m_type=p.e_faceB,E=this.m_proxyB.GetVertex(a.indexB[0]),n=this.m_proxyB.GetVertex(a.indexB[1]),t=this.m_proxyA.GetVertex(a.indexA[0]),this.m_localPoint.x=.5*(E.x+n.x),this.m_localPoint.y=
.5*(E.y+n.y),this.m_axis=f.CrossVF(f.SubtractVV(n,E),1),this.m_axis.Normalize(),m=this.m_axis,a=g.R,B=a.col1.x*m.x+a.col2.x*m.y,h=a.col1.y*m.x+a.col2.y*m.y,m=this.m_localPoint,a=g.R,E=g.position.x+(a.col1.x*m.x+a.col2.x*m.y),n=g.position.y+(a.col1.y*m.x+a.col2.y*m.y),m=t,a=d.R,c=d.position.x+(a.col1.x*m.x+a.col2.x*m.y),u=d.position.y+(a.col1.y*m.x+a.col2.y*m.y),B=(c-E)*B+(u-n)*h):(c=this.m_proxyA.GetVertex(a.indexA[0]),u=this.m_proxyA.GetVertex(a.indexA[1]),E=this.m_proxyB.GetVertex(a.indexB[0]),
n=this.m_proxyB.GetVertex(a.indexB[1]),f.MulX(d,t),t=f.MulMV(d.R,f.SubtractVV(u,c)),f.MulX(g,x),B=f.MulMV(g.R,f.SubtractVV(n,E)),g=t.x*t.x+t.y*t.y,x=B.x*B.x+B.y*B.y,a=f.SubtractVV(B,t),d=t.x*a.x+t.y*a.y,a=B.x*a.x+B.y*a.y,t=t.x*B.x+t.y*B.y,h=g*x-t*t,B=0,0!=h&&(B=f.Clamp((t*a-d*x)/h,0,1)),0>(t*B+a)/x&&(B=f.Clamp((t-d)/g,0,1)),t=new k,t.x=c.x+B*(u.x-c.x),t.y=c.y+B*(u.y-c.y),x=new k,x.x=E.x+B*(n.x-E.x),x.y=E.y+B*(n.y-E.y),0==B||1==B?(this.m_type=p.e_faceB,this.m_axis=f.CrossVF(f.SubtractVV(n,E),1),this.m_axis.Normalize(),
this.m_localPoint=x):(this.m_type=p.e_faceA,this.m_axis=f.CrossVF(f.SubtractVV(u,c),1),this.m_localPoint=t)),0>B&&this.m_axis.NegativeSelf())};p.prototype.Evaluate=function(a,c){var d,u,g=0;switch(this.m_type){case p.e_points:return d=f.MulTMV(a.R,this.m_axis),u=f.MulTMV(c.R,this.m_axis.GetNegative()),d=this.m_proxyA.GetSupportVertex(d),u=this.m_proxyB.GetSupportVertex(u),d=f.MulX(a,d),u=f.MulX(c,u),g=(u.x-d.x)*this.m_axis.x+(u.y-d.y)*this.m_axis.y;case p.e_faceA:return g=f.MulMV(a.R,this.m_axis),
d=f.MulX(a,this.m_localPoint),u=f.MulTMV(c.R,g.GetNegative()),u=this.m_proxyB.GetSupportVertex(u),u=f.MulX(c,u),g=(u.x-d.x)*g.x+(u.y-d.y)*g.y;case p.e_faceB:return g=f.MulMV(c.R,this.m_axis),u=f.MulX(c,this.m_localPoint),d=f.MulTMV(a.R,g.GetNegative()),d=this.m_proxyA.GetSupportVertex(d),d=f.MulX(a,d),g=(d.x-u.x)*g.x+(d.y-u.y)*g.y;default:return e.b2Assert(!1),0}};Box2D.postDefs.push(function(){Box2D.Collision.b2SeparationFunction.e_points=1;Box2D.Collision.b2SeparationFunction.e_faceA=2;Box2D.Collision.b2SeparationFunction.e_faceB=
4});t.b2Simplex=function(){this.m_v1=new x;this.m_v2=new x;this.m_v3=new x;this.m_vertices=new Vector2(3)};t.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3};t.prototype.ReadCache=function(a,c,d,u,g){e.b2Assert(0<=a.count&&3>=a.count);var m,p;this.m_count=a.count;for(var k=this.m_vertices,t=0;t<this.m_count;t++){var x=k[t];x.indexA=a.indexA[t];x.indexB=a.indexB[t];m=c.GetVertex(x.indexA);p=u.GetVertex(x.indexB);x.wA=f.MulX(d,m);
x.wB=f.MulX(g,p);x.w=f.SubtractVV(x.wB,x.wA);x.a=0}1<this.m_count&&(a=a.metric,m=this.GetMetric(),m<.5*a||2*a<m||m<Number.MIN_VALUE)&&(this.m_count=0);0==this.m_count&&(x=k[0],x.indexA=0,x.indexB=0,m=c.GetVertex(0),p=u.GetVertex(0),x.wA=f.MulX(d,m),x.wB=f.MulX(g,p),x.w=f.SubtractVV(x.wB,x.wA),this.m_count=1)};t.prototype.WriteCache=function(a){a.metric=this.GetMetric();a.count=Box2D.parseUInt(this.m_count);for(var c=this.m_vertices,d=0;d<this.m_count;d++)a.indexA[d]=Box2D.parseUInt(c[d].indexA),a.indexB[d]=
Box2D.parseUInt(c[d].indexB)};t.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var a=f.SubtractVV(this.m_v2.w,this.m_v1.w);return 0<f.CrossVV(a,this.m_v1.w.GetNegative())?f.CrossFV(1,a):f.CrossVF(a,1);default:return e.b2Assert(!1),new k}};t.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:return e.b2Assert(!1),new k;case 1:return this.m_v1.w;case 2:return new k(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*
this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return e.b2Assert(!1),new k}};t.prototype.GetWitnessPoints=function(a,c){switch(this.m_count){case 0:e.b2Assert(!1);break;case 1:a.SetV(this.m_v1.wA);c.SetV(this.m_v1.wB);break;case 2:a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x;a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;c.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;c.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:c.x=a.x=this.m_v1.a*this.m_v1.wA.x+
this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x;c.y=a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:e.b2Assert(!1)}};t.prototype.GetMetric=function(){switch(this.m_count){case 0:return e.b2Assert(!1),0;case 1:return 0;case 2:return f.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return f.CrossVV(f.SubtractVV(this.m_v2.w,this.m_v1.w),f.SubtractVV(this.m_v3.w,this.m_v1.w));default:return e.b2Assert(!1),0}};t.prototype.Solve2=function(){var a=
this.m_v1.w,c=this.m_v2.w,d=f.SubtractVV(c,a),a=-(a.x*d.x+a.y*d.y);0>=a?this.m_count=this.m_v1.a=1:(c=c.x*d.x+c.y*d.y,0>=c?(this.m_count=this.m_v2.a=1,this.m_v1.Set(this.m_v2)):(d=1/(c+a),this.m_v1.a=c*d,this.m_v2.a=a*d,this.m_count=2))};t.prototype.Solve3=function(){var a=this.m_v1.w,c=this.m_v2.w,d=this.m_v3.w,e=f.SubtractVV(c,a),u=f.Dot(a,e),g=f.Dot(c,e),u=-u,m=f.SubtractVV(d,a),p=f.Dot(a,m),k=f.Dot(d,m),p=-p,t=f.SubtractVV(d,c),x=f.Dot(c,t),t=f.Dot(d,t),x=-x,m=f.CrossVV(e,m),e=m*f.CrossVV(c,d),
d=m*f.CrossVV(d,a),a=m*f.CrossVV(a,c);0>=u&&0>=p?this.m_count=this.m_v1.a=1:0<g&&0<u&&0>=a?(k=1/(g+u),this.m_v1.a=g*k,this.m_v2.a=u*k,this.m_count=2):0<k&&0<p&&0>=d?(g=1/(k+p),this.m_v1.a=k*g,this.m_v3.a=p*g,this.m_count=2,this.m_v2.Set(this.m_v3)):0>=g&&0>=x?(this.m_count=this.m_v2.a=1,this.m_v1.Set(this.m_v2)):0>=k&&0>=t?(this.m_count=this.m_v3.a=1,this.m_v1.Set(this.m_v3)):0<t&&0<x&&0>=e?(g=1/(t+x),this.m_v2.a=t*g,this.m_v3.a=x*g,this.m_count=2,this.m_v1.Set(this.m_v3)):(g=1/(e+d+a),this.m_v1.a=
e*g,this.m_v2.a=d*g,this.m_v3.a=a*g,this.m_count=3)};B.b2SimplexCache=function(){this.indexA=new Vector_a2j_Number(3);this.indexB=new Vector_a2j_Number(3)};x.b2SimplexVertex=function(){};x.prototype.Set=function(a){this.wA.SetV(a.wA);this.wB.SetV(a.wB);this.w.SetV(a.w);this.a=a.a;this.indexA=a.indexA;this.indexB=a.indexB};G.b2TimeOfImpact=function(){};G.TimeOfImpact=function(a){++G.b2_toiCalls;var c=a.proxyA,d=a.proxyB,u=a.sweepA,g=a.sweepB;e.b2Assert(u.t0==g.t0);e.b2Assert(1-u.t0>Number.MIN_VALUE);
var m=c.m_radius+d.m_radius;a=a.tolerance;var p=0,k=0,t=0;G.s_cache.count=0;for(G.s_distanceInput.useRadii=!1;;){u.GetTransform(G.s_xfA,p);g.GetTransform(G.s_xfB,p);G.s_distanceInput.proxyA=c;G.s_distanceInput.proxyB=d;G.s_distanceInput.transformA=G.s_xfA;G.s_distanceInput.transformB=G.s_xfB;z.Distance(G.s_distanceOutput,G.s_cache,G.s_distanceInput);if(0>=G.s_distanceOutput.distance){p=1;break}G.s_fcn.Initialize(G.s_cache,c,G.s_xfA,d,G.s_xfB);var x=G.s_fcn.Evaluate(G.s_xfA,G.s_xfB);if(0>=x){p=1;break}0==
k&&(t=x>m?f.Max(m-a,.75*m):f.Max(x-a,.02*m));if(x-t<.5*a){if(0==k){p=1;break}break}var E=p,n=p,B=1;u.GetTransform(G.s_xfA,B);g.GetTransform(G.s_xfB,B);var h=G.s_fcn.Evaluate(G.s_xfA,G.s_xfB);if(h>=t){p=1;break}for(var Q=0;;){var l=0,l=Q&1?n+(t-x)*(B-n)/(h-x):.5*(n+B);u.GetTransform(G.s_xfA,l);g.GetTransform(G.s_xfB,l);var P=G.s_fcn.Evaluate(G.s_xfA,G.s_xfB);if(f.Abs(P-t)<.025*a){E=l;break}P>t?(n=l,x=P):(B=l,h=P);++Q;++G.b2_toiRootIters;if(50==Q)break}G.b2_toiMaxRootIters=f.Max(G.b2_toiMaxRootIters,
Q);if(E<(1+100*Number.MIN_VALUE)*p)break;p=E;k++;++G.b2_toiIters;if(1E3==k)break}G.b2_toiMaxIters=f.Max(G.b2_toiMaxIters,k);return p};Box2D.postDefs.push(function(){Box2D.Collision.b2TimeOfImpact.b2_toiCalls=0;Box2D.Collision.b2TimeOfImpact.b2_toiIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiRootIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0;Box2D.Collision.b2TimeOfImpact.s_cache=new B;Box2D.Collision.b2TimeOfImpact.s_distanceInput=new A;
Box2D.Collision.b2TimeOfImpact.s_xfA=new h;Box2D.Collision.b2TimeOfImpact.s_xfB=new h;Box2D.Collision.b2TimeOfImpact.s_fcn=new p;Box2D.Collision.b2TimeOfImpact.s_distanceOutput=new n});P.b2TOIInput=function(){this.proxyA=new C;this.proxyB=new C;this.sweepA=new g;this.sweepB=new g};Q.b2WorldManifold=function(){this.m_normal=new k};Q.prototype.b2WorldManifold=function(){this.m_points=new Vector2(e.b2_maxManifoldPoints);for(var a=0;a<e.b2_maxManifoldPoints;a++)this.m_points[a]=new k};Q.prototype.Initialize=
function(a,c,d,e,f){void 0===d&&(d=0);void 0===f&&(f=0);if(0!=a.m_pointCount){var u=0,g,m,p=0,k=0,t=0,x=0,E=0;g=0;switch(a.m_type){case D.e_circles:m=c.R;g=a.m_localPoint;u=c.position.x+m.col1.x*g.x+m.col2.x*g.y;c=c.position.y+m.col1.y*g.x+m.col2.y*g.y;m=e.R;g=a.m_points[0].m_localPoint;a=e.position.x+m.col1.x*g.x+m.col2.x*g.y;e=e.position.y+m.col1.y*g.x+m.col2.y*g.y;g=a-u;m=e-c;p=g*g+m*m;p>Number.MIN_VALUE*Number.MIN_VALUE?(p=Math.sqrt(p),this.m_normal.x=g/p,this.m_normal.y=m/p):(this.m_normal.x=
1,this.m_normal.y=0);g=c+d*this.m_normal.y;e-=f*this.m_normal.y;this.m_points[0].x=.5*(u+d*this.m_normal.x+(a-f*this.m_normal.x));this.m_points[0].y=.5*(g+e);break;case D.e_faceA:m=c.R;g=a.m_localPlaneNormal;p=m.col1.x*g.x+m.col2.x*g.y;k=m.col1.y*g.x+m.col2.y*g.y;m=c.R;g=a.m_localPoint;t=c.position.x+m.col1.x*g.x+m.col2.x*g.y;x=c.position.y+m.col1.y*g.x+m.col2.y*g.y;this.m_normal.x=p;this.m_normal.y=k;for(u=0;u<a.m_pointCount;u++)m=e.R,g=a.m_points[u].m_localPoint,E=e.position.x+m.col1.x*g.x+m.col2.x*
g.y,g=e.position.y+m.col1.y*g.x+m.col2.y*g.y,this.m_points[u].x=E+.5*(d-(E-t)*p-(g-x)*k-f)*p,this.m_points[u].y=g+.5*(d-(E-t)*p-(g-x)*k-f)*k;break;case D.e_faceB:for(m=e.R,g=a.m_localPlaneNormal,p=m.col1.x*g.x+m.col2.x*g.y,k=m.col1.y*g.x+m.col2.y*g.y,m=e.R,g=a.m_localPoint,t=e.position.x+m.col1.x*g.x+m.col2.x*g.y,x=e.position.y+m.col1.y*g.x+m.col2.y*g.y,this.m_normal.x=-p,this.m_normal.y=-k,u=0;u<a.m_pointCount;u++)m=c.R,g=a.m_points[u].m_localPoint,E=c.position.x+m.col1.x*g.x+m.col2.x*g.y,g=c.position.y+
m.col1.y*g.x+m.col2.y*g.y,this.m_points[u].x=E+.5*(f-(E-t)*p-(g-x)*k-d)*p,this.m_points[u].y=g+.5*(f-(E-t)*p-(g-x)*k-d)*k}}};u.ClipVertex=function(){this.v=new k;this.id=new y};u.prototype.Set=function(a){this.v.SetV(a.v);this.id.Set(a.id)};m.Features=function(){};Object.defineProperty(m.prototype,"referenceEdge",{enumerable:!1,configurable:!0,get:function(){return this._referenceEdge}});Object.defineProperty(m.prototype,"referenceEdge",{enumerable:!1,configurable:!0,set:function(a){void 0===a&&(a=
0);this._referenceEdge=a;this._m_id._key=this._m_id._key&4294967040|this._referenceEdge&255}});Object.defineProperty(m.prototype,"incidentEdge",{enumerable:!1,configurable:!0,get:function(){return this._incidentEdge}});Object.defineProperty(m.prototype,"incidentEdge",{enumerable:!1,configurable:!0,set:function(a){void 0===a&&(a=0);this._incidentEdge=a;this._m_id._key=this._m_id._key&4294902015|this._incidentEdge<<8&65280}});Object.defineProperty(m.prototype,"incidentVertex",{enumerable:!1,configurable:!0,
get:function(){return this._incidentVertex}});Object.defineProperty(m.prototype,"incidentVertex",{enumerable:!1,configurable:!0,set:function(a){void 0===a&&(a=0);this._incidentVertex=a;this._m_id._key=this._m_id._key&4278255615|this._incidentVertex<<16&16711680}});Object.defineProperty(m.prototype,"flip",{enumerable:!1,configurable:!0,get:function(){return this._flip}});Object.defineProperty(m.prototype,"flip",{enumerable:!1,configurable:!0,set:function(a){void 0===a&&(a=0);this._flip=a;this._m_id._key=
this._m_id._key&16777215|this._flip<<24&4278190080}})})();
(function(){var a=Box2D.Common.b2Settings,c=Box2D.Collision.Shapes.b2CircleShape,d=Box2D.Collision.Shapes.b2EdgeChainDef,e=Box2D.Collision.Shapes.b2EdgeShape,f=Box2D.Collision.Shapes.b2MassData,g=Box2D.Collision.Shapes.b2PolygonShape,h=Box2D.Collision.Shapes.b2Shape,k=Box2D.Common.Math.b2Mat22,l=Box2D.Common.Math.b2Math,q=Box2D.Common.Math.b2Transform,v=Box2D.Common.Math.b2Vec2,w=Box2D.Collision.b2Distance,y=Box2D.Collision.b2DistanceInput,r=Box2D.Collision.b2DistanceOutput,z=Box2D.Collision.b2DistanceProxy,
A=Box2D.Collision.b2SimplexCache;Box2D.inherit(c,Box2D.Collision.Shapes.b2Shape);c.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;c.b2CircleShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);this.m_p=new v};c.prototype.Copy=function(){var a=new c;a.Set(this);return a};c.prototype.Set=function(a){this.__super.Set.call(this,a);Box2D.is(a,c)&&this.m_p.SetV((a instanceof c?a:null).m_p)};c.prototype.TestPoint=function(a,c){var d=a.R,e=a.position.x+(d.col1.x*this.m_p.x+
d.col2.x*this.m_p.y),d=a.position.y+(d.col1.y*this.m_p.x+d.col2.y*this.m_p.y),e=c.x-e,d=c.y-d;return e*e+d*d<=this.m_radius*this.m_radius};c.prototype.RayCast=function(a,c,d){var e=d.R,f=c.p1.x-(d.position.x+(e.col1.x*this.m_p.x+e.col2.x*this.m_p.y));d=c.p1.y-(d.position.y+(e.col1.y*this.m_p.x+e.col2.y*this.m_p.y));var e=c.p2.x-c.p1.x,g=c.p2.y-c.p1.y,k=f*e+d*g,h=e*e+g*g,l=k*k-h*(f*f+d*d-this.m_radius*this.m_radius);if(0>l||h<Number.MIN_VALUE)return!1;k=-(k+Math.sqrt(l));return 0<=k&&k<=c.maxFraction*
h?(k/=h,a.fraction=k,a.normal.x=f+k*e,a.normal.y=d+k*g,a.normal.Normalize(),!0):!1};c.prototype.ComputeAABB=function(a,c){var d=c.R,e=c.position.x+(d.col1.x*this.m_p.x+d.col2.x*this.m_p.y),d=c.position.y+(d.col1.y*this.m_p.x+d.col2.y*this.m_p.y);a.lowerBound.Set(e-this.m_radius,d-this.m_radius);a.upperBound.Set(e+this.m_radius,d+this.m_radius)};c.prototype.ComputeMass=function(c,d){void 0===d&&(d=0);c.mass=d*a.b2_pi*this.m_radius*this.m_radius;c.center.SetV(this.m_p);c.I=c.mass*(.5*this.m_radius*
this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))};c.prototype.ComputeSubmergedArea=function(a,c,d,e){void 0===c&&(c=0);d=l.MulX(d,this.m_p);var f=-(l.Dot(a,d)-c);if(f<-this.m_radius+Number.MIN_VALUE)return 0;if(f>this.m_radius)return e.SetV(d),Math.PI*this.m_radius*this.m_radius;c=this.m_radius*this.m_radius;var g=f*f,f=c*(Math.asin(f/this.m_radius)+Math.PI/2)+f*Math.sqrt(c-g);c=-2/3*Math.pow(c-g,1.5)/f;e.x=d.x+a.x*c;e.y=d.y+a.y*c;return f};c.prototype.GetLocalPosition=function(){return this.m_p};
c.prototype.SetLocalPosition=function(a){this.m_p.SetV(a)};c.prototype.GetRadius=function(){return this.m_radius};c.prototype.SetRadius=function(a){void 0===a&&(a=0);this.m_radius=a};c.prototype.b2CircleShape=function(a){void 0===a&&(a=0);this.__super.b2Shape.call(this);this.m_type=h.e_circleShape;this.m_radius=a};d.b2EdgeChainDef=function(){};d.prototype.b2EdgeChainDef=function(){this.vertexCount=0;this.isALoop=!0;this.vertices=[]};Box2D.inherit(e,Box2D.Collision.Shapes.b2Shape);e.prototype.__super=
Box2D.Collision.Shapes.b2Shape.prototype;e.b2EdgeShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);this.s_supportVec=new v;this.m_v1=new v;this.m_v2=new v;this.m_coreV1=new v;this.m_coreV2=new v;this.m_normal=new v;this.m_direction=new v;this.m_cornerDir1=new v;this.m_cornerDir2=new v};e.prototype.TestPoint=function(a,c){return!1};e.prototype.RayCast=function(a,c,d){var e,f=c.p2.x-c.p1.x,g=c.p2.y-c.p1.y;e=d.R;var k=d.position.x+(e.col1.x*this.m_v1.x+e.col2.x*this.m_v1.y),
h=d.position.y+(e.col1.y*this.m_v1.x+e.col2.y*this.m_v1.y),l=d.position.y+(e.col1.y*this.m_v2.x+e.col2.y*this.m_v2.y)-h;d=-(d.position.x+(e.col1.x*this.m_v2.x+e.col2.x*this.m_v2.y)-k);e=100*Number.MIN_VALUE;var r=-(f*l+g*d);if(r>e){var k=c.p1.x-k,q=c.p1.y-h,h=k*l+q*d;if(0<=h&&h<=c.maxFraction*r&&(c=-f*q+g*k,-e*r<=c&&c<=r*(1+e)))return a.fraction=h/r,c=Math.sqrt(l*l+d*d),a.normal.x=l/c,a.normal.y=d/c,!0}return!1};e.prototype.ComputeAABB=function(a,c){var d=c.R,e=c.position.x+(d.col1.x*this.m_v1.x+
d.col2.x*this.m_v1.y),f=c.position.y+(d.col1.y*this.m_v1.x+d.col2.y*this.m_v1.y),g=c.position.x+(d.col1.x*this.m_v2.x+d.col2.x*this.m_v2.y),d=c.position.y+(d.col1.y*this.m_v2.x+d.col2.y*this.m_v2.y);e<g?(a.lowerBound.x=e,a.upperBound.x=g):(a.lowerBound.x=g,a.upperBound.x=e);f<d?(a.lowerBound.y=f,a.upperBound.y=d):(a.lowerBound.y=d,a.upperBound.y=f)};e.prototype.ComputeMass=function(a,c){a.mass=0;a.center.SetV(this.m_v1);a.I=0};e.prototype.ComputeSubmergedArea=function(a,c,d,e){void 0===c&&(c=0);var f=
new v(a.x*c,a.y*c),g=l.MulX(d,this.m_v1);d=l.MulX(d,this.m_v2);var k=l.Dot(a,g)-c;a=l.Dot(a,d)-c;if(0<k){if(0<a)return 0;g.x=-a/(k-a)*g.x+k/(k-a)*d.x;g.y=-a/(k-a)*g.y+k/(k-a)*d.y}else 0<a&&(d.x=-a/(k-a)*g.x+k/(k-a)*d.x,d.y=-a/(k-a)*g.y+k/(k-a)*d.y);e.x=(f.x+g.x+d.x)/3;e.y=(f.y+g.y+d.y)/3;return.5*((g.x-f.x)*(d.y-f.y)-(g.y-f.y)*(d.x-f.x))};e.prototype.GetLength=function(){return this.m_length};e.prototype.GetVertex1=function(){return this.m_v1};e.prototype.GetVertex2=function(){return this.m_v2};e.prototype.GetCoreVertex1=
function(){return this.m_coreV1};e.prototype.GetCoreVertex2=function(){return this.m_coreV2};e.prototype.GetNormalVector=function(){return this.m_normal};e.prototype.GetDirectionVector=function(){return this.m_direction};e.prototype.GetCorner1Vector=function(){return this.m_cornerDir1};e.prototype.GetCorner2Vector=function(){return this.m_cornerDir2};e.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1};e.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2};e.prototype.GetFirstVertex=
function(a){var c=a.R;return new v(a.position.x+(c.col1.x*this.m_coreV1.x+c.col2.x*this.m_coreV1.y),a.position.y+(c.col1.y*this.m_coreV1.x+c.col2.y*this.m_coreV1.y))};e.prototype.GetNextEdge=function(){return this.m_nextEdge};e.prototype.GetPrevEdge=function(){return this.m_prevEdge};e.prototype.Support=function(a,c,d){void 0===c&&(c=0);void 0===d&&(d=0);var e=a.R,f=a.position.x+(e.col1.x*this.m_coreV1.x+e.col2.x*this.m_coreV1.y),g=a.position.y+(e.col1.y*this.m_coreV1.x+e.col2.y*this.m_coreV1.y),
k=a.position.x+(e.col1.x*this.m_coreV2.x+e.col2.x*this.m_coreV2.y);a=a.position.y+(e.col1.y*this.m_coreV2.x+e.col2.y*this.m_coreV2.y);f*c+g*d>k*c+a*d?(this.s_supportVec.x=f,this.s_supportVec.y=g):(this.s_supportVec.x=k,this.s_supportVec.y=a);return this.s_supportVec};e.prototype.b2EdgeShape=function(c,d){this.__super.b2Shape.call(this);this.m_type=h.e_edgeShape;this.m_nextEdge=this.m_prevEdge=null;this.m_v1=c;this.m_v2=d;this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y);this.m_length=
this.m_direction.Normalize();this.m_normal.Set(this.m_direction.y,-this.m_direction.x);this.m_coreV1.Set(-a.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-a.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+this.m_v1.y);this.m_coreV2.Set(-a.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-a.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y);this.m_cornerDir1=this.m_normal;this.m_cornerDir2.Set(-this.m_normal.x,-this.m_normal.y)};e.prototype.SetPrevEdge=function(a,
c,d,e){this.m_prevEdge=a;this.m_coreV1=c;this.m_cornerDir1=d;this.m_cornerConvex1=e};e.prototype.SetNextEdge=function(a,c,d,e){this.m_nextEdge=a;this.m_coreV2=c;this.m_cornerDir2=d;this.m_cornerConvex2=e};f.b2MassData=function(){this.mass=0;this.center=new v(0,0);this.I=0};Box2D.inherit(g,Box2D.Collision.Shapes.b2Shape);g.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;g.b2PolygonShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)};g.prototype.Copy=function(){var a=
new g;a.Set(this);return a};g.prototype.Set=function(a){this.__super.Set.call(this,a);if(Box2D.is(a,g)){a=a instanceof g?a:null;this.m_centroid.SetV(a.m_centroid);this.m_vertexCount=a.m_vertexCount;this.Reserve(this.m_vertexCount);for(var c=0;c<this.m_vertexCount;c++)this.m_vertices[c].SetV(a.m_vertices[c]),this.m_normals[c].SetV(a.m_normals[c])}};g.prototype.SetAsArray=function(a,c){void 0===c&&(c=0);for(var d=new Vector2,e=0,f,e=0;e<a.length;++e)f=a[e],d.push(f);this.SetAsVector(d,c)};g.AsArray=
function(a,c){void 0===c&&(c=0);var d=new g;d.SetAsArray(a,c);return d};g.prototype.SetAsVector=function(c,d){void 0===d&&(d=0);0==d&&(d=c.length);a.b2Assert(2<=d);this.m_vertexCount=d;this.Reserve(d);for(var e=0,e=0;e<this.m_vertexCount;e++)this.m_vertices[e].SetV(c[e]);for(e=0;e<this.m_vertexCount;++e){var f=parseInt(e),k=parseInt(e+1<this.m_vertexCount?e+1:0),f=l.SubtractVV(this.m_vertices[k],this.m_vertices[f]);a.b2Assert(f.LengthSquared()>Number.MIN_VALUE);this.m_normals[e].SetV(l.CrossVF(f,
1));this.m_normals[e].Normalize()}this.m_centroid=g.ComputeCentroid(this.m_vertices,this.m_vertexCount)};g.AsVector=function(a,c){void 0===c&&(c=0);var d=new g;d.SetAsVector(a,c);return d};g.prototype.SetAsBox=function(a,c){void 0===a&&(a=0);void 0===c&&(c=0);this.m_vertexCount=4;this.Reserve(4);this.m_vertices[0].Set(-a,-c);this.m_vertices[1].Set(a,-c);this.m_vertices[2].Set(a,c);this.m_vertices[3].Set(-a,c);this.m_normals[0].Set(0,-1);this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set(-1,
0);this.m_centroid.SetZero()};g.AsBox=function(a,c){void 0===a&&(a=0);void 0===c&&(c=0);var d=new g;d.SetAsBox(a,c);return d};g.prototype.SetAsOrientedBox=function(a,c,d,e){void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=null);void 0===e&&(e=0);this.m_vertexCount=4;this.Reserve(4);this.m_vertices[0].Set(-a,-c);this.m_vertices[1].Set(a,-c);this.m_vertices[2].Set(a,c);this.m_vertices[3].Set(-a,c);this.m_normals[0].Set(0,-1);this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set(-1,
0);this.m_centroid=d;a=new q;a.position=d;a.R.Set(e);for(d=0;d<this.m_vertexCount;++d)this.m_vertices[d]=l.MulX(a,this.m_vertices[d]),this.m_normals[d]=l.MulMV(a.R,this.m_normals[d])};g.AsOrientedBox=function(a,c,d,e){void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=null);void 0===e&&(e=0);var f=new g;f.SetAsOrientedBox(a,c,d,e);return f};g.prototype.SetAsEdge=function(a,c){this.m_vertexCount=2;this.Reserve(2);this.m_vertices[0].SetV(a);this.m_vertices[1].SetV(c);this.m_centroid.x=.5*(a.x+c.x);
this.m_centroid.y=.5*(a.y+c.y);this.m_normals[0]=l.CrossVF(l.SubtractVV(c,a),1);this.m_normals[0].Normalize();this.m_normals[1].x=-this.m_normals[0].x;this.m_normals[1].y=-this.m_normals[0].y};g.AsEdge=function(a,c){var d=new g;d.SetAsEdge(a,c);return d};g.prototype.TestPoint=function(a,c){var d;d=a.R;for(var e=c.x-a.position.x,f=c.y-a.position.y,g=e*d.col1.x+f*d.col1.y,k=e*d.col2.x+f*d.col2.y,h=0;h<this.m_vertexCount;++h)if(d=this.m_vertices[h],e=g-d.x,f=k-d.y,d=this.m_normals[h],0<d.x*e+d.y*f)return!1;
return!0};g.prototype.RayCast=function(a,c,d){var e=0,f=c.maxFraction,g=0,k=0,h,l,g=c.p1.x-d.position.x,k=c.p1.y-d.position.y;h=d.R;var r=g*h.col1.x+k*h.col1.y,q=g*h.col2.x+k*h.col2.y,g=c.p2.x-d.position.x,k=c.p2.y-d.position.y;h=d.R;c=g*h.col1.x+k*h.col1.y-r;h=g*h.col2.x+k*h.col2.y-q;for(var y=-1,p=0;p<this.m_vertexCount;++p){l=this.m_vertices[p];g=l.x-r;k=l.y-q;l=this.m_normals[p];g=l.x*g+l.y*k;k=l.x*c+l.y*h;if(0==k){if(0>g)return!1}else 0>k&&g<e*k?(e=g/k,y=p):0<k&&g<f*k&&(f=g/k);if(f<e-Number.MIN_VALUE)return!1}return 0<=
y?(a.fraction=e,h=d.R,l=this.m_normals[y],a.normal.x=h.col1.x*l.x+h.col2.x*l.y,a.normal.y=h.col1.y*l.x+h.col2.y*l.y,!0):!1};g.prototype.ComputeAABB=function(a,c){for(var d=c.R,e=this.m_vertices[0],f=c.position.x+(d.col1.x*e.x+d.col2.x*e.y),g=c.position.y+(d.col1.y*e.x+d.col2.y*e.y),k=f,h=g,l=1;l<this.m_vertexCount;++l)var e=this.m_vertices[l],r=c.position.x+(d.col1.x*e.x+d.col2.x*e.y),e=c.position.y+(d.col1.y*e.x+d.col2.y*e.y),f=f<r?f:r,g=g<e?g:e,k=k>r?k:r,h=h>e?h:e;a.lowerBound.x=f-this.m_radius;
a.lowerBound.y=g-this.m_radius;a.upperBound.x=k+this.m_radius;a.upperBound.y=h+this.m_radius};g.prototype.ComputeMass=function(a,c){void 0===c&&(c=0);if(2==this.m_vertexCount)a.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),a.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),a.mass=0,a.I=0;else{for(var d=0,e=0,f=0,g=0,k=1/3,h=0;h<this.m_vertexCount;++h)var l=this.m_vertices[h],r=h+1<this.m_vertexCount?this.m_vertices[parseInt(h+1)]:this.m_vertices[0],q=l.x-0,y=l.y-0,p=r.x-0,t=r.y-0,
B=q*t-y*p,x=.5*B,f=f+x,d=d+x*k*(0+l.x+r.x),e=e+x*k*(0+l.y+r.y),l=q,g=g+B*(k*(.25*(l*l+p*l+p*p)+(0*l+0*p))+0+(k*(.25*(y*y+t*y+t*t)+(0*y+0*t))+0));a.mass=c*f;a.center.Set(1/f*d,1/f*e);a.I=c*g}};g.prototype.ComputeSubmergedArea=function(a,c,d,e){void 0===c&&(c=0);var g=l.MulTMV(d.R,a),k=c-l.Dot(a,d.position),h=new Vector_a2j_Number,r=0,q=-1;c=-1;var y=!1;for(a=a=0;a<this.m_vertexCount;++a){h[a]=l.Dot(g,this.m_vertices[a])-k;var w=h[a]<-Number.MIN_VALUE;0<a&&(w?y||(q=a-1,r++):y&&(c=a-1,r++));y=w}switch(r){case 0:return y?
(a=new f,this.ComputeMass(a,1),e.SetV(l.MulX(d,a.center)),a.mass):0;case 1:-1==q?q=this.m_vertexCount-1:c=this.m_vertexCount-1}a=parseInt((q+1)%this.m_vertexCount);g=parseInt((c+1)%this.m_vertexCount);k=(0-h[q])/(h[a]-h[q]);h=(0-h[c])/(h[g]-h[c]);q=new v(this.m_vertices[q].x*(1-k)+this.m_vertices[a].x*k,this.m_vertices[q].y*(1-k)+this.m_vertices[a].y*k);c=new v(this.m_vertices[c].x*(1-h)+this.m_vertices[g].x*h,this.m_vertices[c].y*(1-h)+this.m_vertices[g].y*h);h=0;k=new v;for(r=this.m_vertices[a];a!=
g;)a=(a+1)%this.m_vertexCount,y=a==g?c:this.m_vertices[a],w=.5*((r.x-q.x)*(y.y-q.y)-(r.y-q.y)*(y.x-q.x)),h+=w,k.x+=w*(q.x+r.x+y.x)/3,k.y+=w*(q.y+r.y+y.y)/3,r=y;k.Multiply(1/h);e.SetV(l.MulX(d,k));return h};g.prototype.GetVertexCount=function(){return this.m_vertexCount};g.prototype.GetVertices=function(){return this.m_vertices};g.prototype.GetNormals=function(){return this.m_normals};g.prototype.GetSupport=function(a){for(var c=0,d=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,e=1;e<this.m_vertexCount;++e){var f=
this.m_vertices[e].x*a.x+this.m_vertices[e].y*a.y;f>d&&(c=e,d=f)}return c};g.prototype.GetSupportVertex=function(a){for(var c=0,d=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,e=1;e<this.m_vertexCount;++e){var f=this.m_vertices[e].x*a.x+this.m_vertices[e].y*a.y;f>d&&(c=e,d=f)}return this.m_vertices[c]};g.prototype.Validate=function(){return!1};g.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this);this.m_type=h.e_polygonShape;this.m_centroid=new v;this.m_vertices=new Vector2;this.m_normals=
new Vector2};g.prototype.Reserve=function(a){void 0===a&&(a=0);for(var c=parseInt(this.m_vertices.length);c<a;c++)this.m_vertices[c]=new v,this.m_normals[c]=new v};g.ComputeCentroid=function(a,c){void 0===c&&(c=0);for(var d=new v,e=0,f=1/3,g=0;g<c;++g){var k=a[g],h=g+1<c?a[parseInt(g+1)]:a[0],l=.5*((k.x-0)*(h.y-0)-(k.y-0)*(h.x-0)),e=e+l;d.x+=l*f*(0+k.x+h.x);d.y+=l*f*(0+k.y+h.y)}d.x*=1/e;d.y*=1/e;return d};g.ComputeOBB=function(a,c,d){void 0===d&&(d=0);for(var e=0,f=new Vector2(d+1),e=0;e<d;++e)f[e]=
c[e];f[d]=f[0];c=Number.MAX_VALUE;for(e=1;e<=d;++e){for(var g=f[parseInt(e-1)],k=f[e].x-g.x,h=f[e].y-g.y,l=Math.sqrt(k*k+h*h),k=k/l,h=h/l,r=-h,q=k,y=l=Number.MAX_VALUE,p=-Number.MAX_VALUE,t=-Number.MAX_VALUE,B=0;B<d;++B){var x=f[B].x-g.x,G=f[B].y-g.y,P=k*x+h*G,x=r*x+q*G;P<l&&(l=P);x<y&&(y=x);P>p&&(p=P);x>t&&(t=x)}B=(p-l)*(t-y);B<.95*c&&(c=B,a.R.col1.x=k,a.R.col1.y=h,a.R.col2.x=r,a.R.col2.y=q,k=.5*(l+p),h=.5*(y+t),r=a.R,a.center.x=g.x+(r.col1.x*k+r.col2.x*h),a.center.y=g.y+(r.col1.y*k+r.col2.y*h),
a.extents.x=.5*(p-l),a.extents.y=.5*(t-y))}};Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2PolygonShape.s_mat=new k});h.b2Shape=function(){};h.prototype.Copy=function(){return null};h.prototype.Set=function(a){this.m_radius=a.m_radius};h.prototype.GetType=function(){return this.m_type};h.prototype.TestPoint=function(a,c){return!1};h.prototype.RayCast=function(a,c,d){return!1};h.prototype.ComputeAABB=function(a,c){};h.prototype.ComputeMass=function(a,c){};h.prototype.ComputeSubmergedArea=
function(a,c,d,e){return 0};h.TestOverlap=function(a,c,d,e){var f=new y;f.proxyA=new z;f.proxyA.Set(a);f.proxyB=new z;f.proxyB.Set(d);f.transformA=c;f.transformB=e;f.useRadii=!0;a=new A;a.count=0;c=new r;w.Distance(c,a,f);return c.distance<10*Number.MIN_VALUE};h.prototype.b2Shape=function(){this.m_type=h.e_unknownShape;this.m_radius=a.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2Shape.e_unknownShape=-1;Box2D.Collision.Shapes.b2Shape.e_circleShape=0;Box2D.Collision.Shapes.b2Shape.e_polygonShape=
1;Box2D.Collision.Shapes.b2Shape.e_edgeShape=2;Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount=3;Box2D.Collision.Shapes.b2Shape.e_hitCollide=1;Box2D.Collision.Shapes.b2Shape.e_missCollide=0;Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide=-1})})();
(function(){var a=Box2D.Common.b2Color,c=Box2D.Common.b2Settings,d=Box2D.Common.Math.b2Math;a.b2Color=function(){this._b=this._g=this._r=0};a.prototype.b2Color=function(a,c,g){void 0===a&&(a=0);void 0===c&&(c=0);void 0===g&&(g=0);this._r=Box2D.parseUInt(255*d.Clamp(a,0,1));this._g=Box2D.parseUInt(255*d.Clamp(c,0,1));this._b=Box2D.parseUInt(255*d.Clamp(g,0,1))};a.prototype.Set=function(a,c,g){void 0===a&&(a=0);void 0===c&&(c=0);void 0===g&&(g=0);this._r=Box2D.parseUInt(255*d.Clamp(a,0,1));this._g=
Box2D.parseUInt(255*d.Clamp(c,0,1));this._b=Box2D.parseUInt(255*d.Clamp(g,0,1))};Object.defineProperty(a.prototype,"r",{enumerable:!1,configurable:!0,set:function(a){void 0===a&&(a=0);this._r=Box2D.parseUInt(255*d.Clamp(a,0,1))}});Object.defineProperty(a.prototype,"g",{enumerable:!1,configurable:!0,set:function(a){void 0===a&&(a=0);this._g=Box2D.parseUInt(255*d.Clamp(a,0,1))}});Object.defineProperty(a.prototype,"b",{enumerable:!1,configurable:!0,set:function(a){void 0===a&&(a=0);this._b=Box2D.parseUInt(255*
d.Clamp(a,0,1))}});Object.defineProperty(a.prototype,"color",{enumerable:!1,configurable:!0,get:function(){return this._r<<16|this._g<<8|this._b}});c.b2Settings=function(){};c.b2MixFriction=function(a,c){void 0===a&&(a=0);void 0===c&&(c=0);return Math.sqrt(a*c)};c.b2MixRestitution=function(a,c){void 0===a&&(a=0);void 0===c&&(c=0);return a>c?a:c};c.b2Assert=function(a){if(!a)throw"Assertion Failed";};Box2D.postDefs.push(function(){Box2D.Common.b2Settings.VERSION="2.1alpha";Box2D.Common.b2Settings.USHRT_MAX=
65535;Box2D.Common.b2Settings.b2_pi=Math.PI;Box2D.Common.b2Settings.b2_maxManifoldPoints=2;Box2D.Common.b2Settings.b2_aabbExtension=.1;Box2D.Common.b2Settings.b2_aabbMultiplier=2;Box2D.Common.b2Settings.b2_polygonRadius=2*c.b2_linearSlop;Box2D.Common.b2Settings.b2_linearSlop=.005;Box2D.Common.b2Settings.b2_angularSlop=2/180*c.b2_pi;Box2D.Common.b2Settings.b2_toiSlop=8*c.b2_linearSlop;Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland=32;Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland=32;Box2D.Common.b2Settings.b2_velocityThreshold=
1;Box2D.Common.b2Settings.b2_maxLinearCorrection=.2;Box2D.Common.b2Settings.b2_maxAngularCorrection=8/180*c.b2_pi;Box2D.Common.b2Settings.b2_maxTranslation=2;Box2D.Common.b2Settings.b2_maxTranslationSquared=c.b2_maxTranslation*c.b2_maxTranslation;Box2D.Common.b2Settings.b2_maxRotation=.5*c.b2_pi;Box2D.Common.b2Settings.b2_maxRotationSquared=c.b2_maxRotation*c.b2_maxRotation;Box2D.Common.b2Settings.b2_contactBaumgarte=.2;Box2D.Common.b2Settings.b2_timeToSleep=.5;Box2D.Common.b2Settings.b2_linearSleepTolerance=
.01;Box2D.Common.b2Settings.b2_angularSleepTolerance=2/180*c.b2_pi})})();
(function(){var a=Box2D.Common.Math.b2Mat22,c=Box2D.Common.Math.b2Mat33,d=Box2D.Common.Math.b2Math,e=Box2D.Common.Math.b2Sweep,f=Box2D.Common.Math.b2Transform,g=Box2D.Common.Math.b2Vec2,h=Box2D.Common.Math.b2Vec3;a.b2Mat22=function(){this.col1=new g;this.col2=new g};a.prototype.b2Mat22=function(){this.SetIdentity()};a.FromAngle=function(c){void 0===c&&(c=0);var d=new a;d.Set(c);return d};a.FromVV=function(c,d){var e=new a;e.SetVV(c,d);return e};a.prototype.Set=function(a){void 0===a&&(a=0);var c=
Math.cos(a);a=Math.sin(a);this.col1.x=c;this.col2.x=-a;this.col1.y=a;this.col2.y=c};a.prototype.SetVV=function(a,c){this.col1.SetV(a);this.col2.SetV(c)};a.prototype.Copy=function(){var c=new a;c.SetM(this);return c};a.prototype.SetM=function(a){this.col1.SetV(a.col1);this.col2.SetV(a.col2)};a.prototype.AddM=function(a){this.col1.x+=a.col1.x;this.col1.y+=a.col1.y;this.col2.x+=a.col2.x;this.col2.y+=a.col2.y};a.prototype.SetIdentity=function(){this.col1.x=1;this.col2.x=0;this.col1.y=0;this.col2.y=1};
a.prototype.SetZero=function(){this.col1.x=0;this.col2.x=0;this.col1.y=0;this.col2.y=0};a.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)};a.prototype.GetInverse=function(a){var c=this.col1.x,d=this.col2.x,e=this.col1.y,f=this.col2.y,g=c*f-d*e;0!=g&&(g=1/g);a.col1.x=g*f;a.col2.x=-g*d;a.col1.y=-g*e;a.col2.y=g*c;return a};a.prototype.Solve=function(a,c,d){void 0===c&&(c=0);void 0===d&&(d=0);var e=this.col1.x,f=this.col2.x,g=this.col1.y,h=this.col2.y,z=e*h-f*g;0!=z&&(z=1/z);
a.x=z*(h*c-f*d);a.y=z*(e*d-g*c);return a};a.prototype.Abs=function(){this.col1.Abs();this.col2.Abs()};c.b2Mat33=function(){this.col1=new h;this.col2=new h;this.col3=new h};c.prototype.b2Mat33=function(a,c,d){void 0===a&&(a=null);void 0===c&&(c=null);void 0===d&&(d=null);a||c||d?(this.col1.SetV(a),this.col2.SetV(c),this.col3.SetV(d)):(this.col1.SetZero(),this.col2.SetZero(),this.col3.SetZero())};c.prototype.SetVVV=function(a,c,d){this.col1.SetV(a);this.col2.SetV(c);this.col3.SetV(d)};c.prototype.Copy=
function(){return new c(this.col1,this.col2,this.col3)};c.prototype.SetM=function(a){this.col1.SetV(a.col1);this.col2.SetV(a.col2);this.col3.SetV(a.col3)};c.prototype.AddM=function(a){this.col1.x+=a.col1.x;this.col1.y+=a.col1.y;this.col1.z+=a.col1.z;this.col2.x+=a.col2.x;this.col2.y+=a.col2.y;this.col2.z+=a.col2.z;this.col3.x+=a.col3.x;this.col3.y+=a.col3.y;this.col3.z+=a.col3.z};c.prototype.SetIdentity=function(){this.col1.x=1;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=1;this.col3.y=0;
this.col1.z=0;this.col2.z=0;this.col3.z=1};c.prototype.SetZero=function(){this.col1.x=0;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=0;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=0};c.prototype.Solve22=function(a,c,d){void 0===c&&(c=0);void 0===d&&(d=0);var e=this.col1.x,f=this.col2.x,g=this.col1.y,h=this.col2.y,z=e*h-f*g;0!=z&&(z=1/z);a.x=z*(h*c-f*d);a.y=z*(e*d-g*c);return a};c.prototype.Solve33=function(a,c,d,e){void 0===c&&(c=0);void 0===d&&(d=0);void 0===e&&(e=0);var f=this.col1.x,
g=this.col1.y,h=this.col1.z,z=this.col2.x,A=this.col2.y,n=this.col2.z,C=this.col3.x,F=this.col3.y,J=this.col3.z,H=f*(A*J-n*F)+g*(n*C-z*J)+h*(z*F-A*C);0!=H&&(H=1/H);a.x=H*(c*(A*J-n*F)+d*(n*C-z*J)+e*(z*F-A*C));a.y=H*(f*(d*J-e*F)+g*(e*C-c*J)+h*(c*F-d*C));a.z=H*(f*(A*e-n*d)+g*(n*c-z*e)+h*(z*d-A*c));return a};d.b2Math=function(){};d.IsValid=function(a){void 0===a&&(a=0);return isFinite(a)};d.Dot=function(a,c){return a.x*c.x+a.y*c.y};d.CrossVV=function(a,c){return a.x*c.y-a.y*c.x};d.CrossVF=function(a,
c){void 0===c&&(c=0);return new g(c*a.y,-c*a.x)};d.CrossFV=function(a,c){void 0===a&&(a=0);return new g(-a*c.y,a*c.x)};d.MulMV=function(a,c){return new g(a.col1.x*c.x+a.col2.x*c.y,a.col1.y*c.x+a.col2.y*c.y)};d.MulTMV=function(a,c){return new g(d.Dot(c,a.col1),d.Dot(c,a.col2))};d.MulX=function(a,c){var e=d.MulMV(a.R,c);e.x+=a.position.x;e.y+=a.position.y;return e};d.MulXT=function(a,c){var e=d.SubtractVV(c,a.position),f=e.x*a.R.col1.x+e.y*a.R.col1.y;e.y=e.x*a.R.col2.x+e.y*a.R.col2.y;e.x=f;return e};
d.AddVV=function(a,c){return new g(a.x+c.x,a.y+c.y)};d.SubtractVV=function(a,c){return new g(a.x-c.x,a.y-c.y)};d.Distance=function(a,c){var d=a.x-c.x,e=a.y-c.y;return Math.sqrt(d*d+e*e)};d.DistanceSquared=function(a,c){var d=a.x-c.x,e=a.y-c.y;return d*d+e*e};d.MulFV=function(a,c){void 0===a&&(a=0);return new g(a*c.x,a*c.y)};d.AddMM=function(c,e){return a.FromVV(d.AddVV(c.col1,e.col1),d.AddVV(c.col2,e.col2))};d.MulMM=function(c,e){return a.FromVV(d.MulMV(c,e.col1),d.MulMV(c,e.col2))};d.MulTMM=function(c,
e){var f=new g(d.Dot(c.col1,e.col1),d.Dot(c.col2,e.col1)),h=new g(d.Dot(c.col1,e.col2),d.Dot(c.col2,e.col2));return a.FromVV(f,h)};d.Abs=function(a){void 0===a&&(a=0);return 0<a?a:-a};d.AbsV=function(a){return new g(d.Abs(a.x),d.Abs(a.y))};d.AbsM=function(c){return a.FromVV(d.AbsV(c.col1),d.AbsV(c.col2))};d.Min=function(a,c){void 0===a&&(a=0);void 0===c&&(c=0);return a<c?a:c};d.MinV=function(a,c){return new g(d.Min(a.x,c.x),d.Min(a.y,c.y))};d.Max=function(a,c){void 0===a&&(a=0);void 0===c&&(c=0);
return a>c?a:c};d.MaxV=function(a,c){return new g(d.Max(a.x,c.x),d.Max(a.y,c.y))};d.Clamp=function(a,c,d){void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=0);return a<c?c:a>d?d:a};d.ClampV=function(a,c,e){return d.MaxV(c,d.MinV(a,e))};d.Swap=function(a,c){var d=a[0];a[0]=c[0];c[0]=d};d.Random=function(){return 2*Math.random()-1};d.RandomRange=function(a,c){void 0===a&&(a=0);void 0===c&&(c=0);var d=Math.random();return(c-a)*d+a};d.NextPowerOfTwo=function(a){void 0===a&&(a=0);a|=a>>1&2147483647;a|=
a>>2&1073741823;a|=a>>4&268435455;a|=a>>8&16777215;return(a|a>>16&65535)+1};d.IsPowerOfTwo=function(a){void 0===a&&(a=0);return 0<a&&0==(a&a-1)};Box2D.postDefs.push(function(){Box2D.Common.Math.b2Math.b2Vec2_zero=new g(0,0);Box2D.Common.Math.b2Math.b2Mat22_identity=a.FromVV(new g(1,0),new g(0,1));Box2D.Common.Math.b2Math.b2Transform_identity=new f(d.b2Vec2_zero,d.b2Mat22_identity)});e.b2Sweep=function(){this.localCenter=new g;this.c0=new g;this.c=new g};e.prototype.Set=function(a){this.localCenter.SetV(a.localCenter);
this.c0.SetV(a.c0);this.c.SetV(a.c);this.a0=a.a0;this.a=a.a;this.t0=a.t0};e.prototype.Copy=function(){var a=new e;a.localCenter.SetV(this.localCenter);a.c0.SetV(this.c0);a.c.SetV(this.c);a.a0=this.a0;a.a=this.a;a.t0=this.t0;return a};e.prototype.GetTransform=function(a,c){void 0===c&&(c=0);a.position.x=(1-c)*this.c0.x+c*this.c.x;a.position.y=(1-c)*this.c0.y+c*this.c.y;a.R.Set((1-c)*this.a0+c*this.a);var d=a.R;a.position.x-=d.col1.x*this.localCenter.x+d.col2.x*this.localCenter.y;a.position.y-=d.col1.y*
this.localCenter.x+d.col2.y*this.localCenter.y};e.prototype.Advance=function(a){void 0===a&&(a=0);if(this.t0<a&&1-this.t0>Number.MIN_VALUE){var c=(a-this.t0)/(1-this.t0);this.c0.x=(1-c)*this.c0.x+c*this.c.x;this.c0.y=(1-c)*this.c0.y+c*this.c.y;this.a0=(1-c)*this.a0+c*this.a;this.t0=a}};f.b2Transform=function(){this.position=new g;this.R=new a};f.prototype.b2Transform=function(a,c){void 0===a&&(a=null);void 0===c&&(c=null);a&&(this.position.SetV(a),this.R.SetM(c))};f.prototype.Initialize=function(a,
c){this.position.SetV(a);this.R.SetM(c)};f.prototype.SetIdentity=function(){this.position.SetZero();this.R.SetIdentity()};f.prototype.Set=function(a){this.position.SetV(a.position);this.R.SetM(a.R)};f.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)};g.b2Vec2=function(){};g.prototype.b2Vec2=function(a,c){void 0===a&&(a=0);void 0===c&&(c=0);this.x=a;this.y=c};g.prototype.SetZero=function(){this.y=this.x=0};g.prototype.Set=function(a,c){void 0===a&&(a=0);void 0===c&&(c=0);
this.x=a;this.y=c};g.prototype.SetV=function(a){this.x=a.x;this.y=a.y};g.prototype.GetNegative=function(){return new g(-this.x,-this.y)};g.prototype.NegativeSelf=function(){this.x=-this.x;this.y=-this.y};g.Make=function(a,c){void 0===a&&(a=0);void 0===c&&(c=0);return new g(a,c)};g.prototype.Copy=function(){return new g(this.x,this.y)};g.prototype.Add=function(a){this.x+=a.x;this.y+=a.y};g.prototype.Subtract=function(a){this.x-=a.x;this.y-=a.y};g.prototype.Multiply=function(a){void 0===a&&(a=0);this.x*=
a;this.y*=a};g.prototype.MulM=function(a){var c=this.x;this.x=a.col1.x*c+a.col2.x*this.y;this.y=a.col1.y*c+a.col2.y*this.y};g.prototype.MulTM=function(a){var c=d.Dot(this,a.col1);this.y=d.Dot(this,a.col2);this.x=c};g.prototype.CrossVF=function(a){void 0===a&&(a=0);var c=this.x;this.x=a*this.y;this.y=-a*c};g.prototype.CrossFV=function(a){void 0===a&&(a=0);var c=this.x;this.x=-a*this.y;this.y=a*c};g.prototype.MinV=function(a){this.x=this.x<a.x?this.x:a.x;this.y=this.y<a.y?this.y:a.y};g.prototype.MaxV=
function(a){this.x=this.x>a.x?this.x:a.x;this.y=this.y>a.y?this.y:a.y};g.prototype.Abs=function(){0>this.x&&(this.x=-this.x);0>this.y&&(this.y=-this.y)};g.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};g.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y};g.prototype.Normalize=function(){var a=Math.sqrt(this.x*this.x+this.y*this.y);if(a<Number.MIN_VALUE)return 0;var c=1/a;this.x*=c;this.y*=c;return a};g.prototype.IsValid=function(){return d.IsValid(this.x)&&
d.IsValid(this.y)};h.b2Vec3=function(){};h.prototype.b2Vec3=function(a,c,d){void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=0);this.x=a;this.y=c;this.z=d};h.prototype.SetZero=function(){this.x=this.y=this.z=0};h.prototype.Set=function(a,c,d){void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=0);this.x=a;this.y=c;this.z=d};h.prototype.SetV=function(a){this.x=a.x;this.y=a.y;this.z=a.z};h.prototype.GetNegative=function(){return new h(-this.x,-this.y,-this.z)};h.prototype.NegativeSelf=function(){this.x=
-this.x;this.y=-this.y;this.z=-this.z};h.prototype.Copy=function(){return new h(this.x,this.y,this.z)};h.prototype.Add=function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z};h.prototype.Subtract=function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z};h.prototype.Multiply=function(a){void 0===a&&(a=0);this.x*=a;this.y*=a;this.z*=a}})();
(function(){var a=Box2D.Common.Math.b2Math,c=Box2D.Common.Math.b2Sweep,d=Box2D.Common.Math.b2Transform,e=Box2D.Common.Math.b2Vec2,f=Box2D.Common.b2Color,g=Box2D.Common.b2Settings,h=Box2D.Collision.b2AABB,k=Box2D.Collision.b2ContactPoint,l=Box2D.Collision.b2DynamicTreeBroadPhase,q=Box2D.Collision.b2RayCastInput,v=Box2D.Collision.b2RayCastOutput,w=Box2D.Collision.Shapes.b2CircleShape,y=Box2D.Collision.Shapes.b2EdgeShape,r=Box2D.Collision.Shapes.b2MassData,z=Box2D.Collision.Shapes.b2PolygonShape,A=Box2D.Collision.Shapes.b2Shape,
n=Box2D.Dynamics.b2Body,C=Box2D.Dynamics.b2BodyDef,F=Box2D.Dynamics.b2ContactFilter,J=Box2D.Dynamics.b2ContactImpulse,H=Box2D.Dynamics.b2ContactListener,L=Box2D.Dynamics.b2ContactManager,D=Box2D.Dynamics.b2DebugDraw,N=Box2D.Dynamics.b2DestructionListener,I=Box2D.Dynamics.b2FilterData,K=Box2D.Dynamics.b2Fixture,O=Box2D.Dynamics.b2FixtureDef,M=Box2D.Dynamics.b2Island,p=Box2D.Dynamics.b2TimeStep,t=Box2D.Dynamics.b2World,B=Box2D.Dynamics.Contacts.b2Contact,x=Box2D.Dynamics.Contacts.b2ContactFactory,G=
Box2D.Dynamics.Contacts.b2ContactSolver,P=Box2D.Dynamics.Joints.b2Joint,Q=Box2D.Dynamics.Joints.b2PulleyJoint;n.b2Body=function(){this.m_xf=new d;this.m_sweep=new c;this.m_linearVelocity=new e;this.m_force=new e};n.prototype.connectEdges=function(c,d,e){void 0===e&&(e=0);var f=Math.atan2(d.GetDirectionVector().y,d.GetDirectionVector().x);e=Math.tan(.5*(f-e));e=a.MulFV(e,d.GetDirectionVector());e=a.SubtractVV(e,d.GetNormalVector());e=a.MulFV(g.b2_toiSlop,e);e=a.AddVV(e,d.GetVertex1());var p=a.AddVV(c.GetDirectionVector(),
d.GetDirectionVector());p.Normalize();var t=0<a.Dot(c.GetDirectionVector(),d.GetNormalVector());c.SetNextEdge(d,e,p,t);d.SetPrevEdge(c,e,p,t);return f};n.prototype.CreateFixture=function(a){if(1==this.m_world.IsLocked())return null;var c=new K;c.Create(this,this.m_xf,a);this.m_flags&n.e_activeFlag&&c.CreateProxy(this.m_world.m_contactManager.m_broadPhase,this.m_xf);c.m_next=this.m_fixtureList;this.m_fixtureList=c;++this.m_fixtureCount;c.m_body=this;0<c.m_density&&this.ResetMassData();this.m_world.m_flags|=
t.e_newFixture;return c};n.prototype.CreateFixture2=function(a,c){void 0===c&&(c=0);var d=new O;d.shape=a;d.density=c;return this.CreateFixture(d)};n.prototype.DestroyFixture=function(a){if(1!=this.m_world.IsLocked()){for(var c=this.m_fixtureList,d=null;null!=c;){if(c==a){d?d.m_next=a.m_next:this.m_fixtureList=a.m_next;break}d=c;c=c.m_next}for(c=this.m_contactList;c;){var d=c.contact,c=c.next,e=d.GetFixtureA(),f=d.GetFixtureB();a!=e&&a!=f||this.m_world.m_contactManager.Destroy(d)}this.m_flags&n.e_activeFlag&&
a.DestroyProxy(this.m_world.m_contactManager.m_broadPhase);a.Destroy();a.m_body=null;a.m_next=null;--this.m_fixtureCount;this.ResetMassData()}};n.prototype.SetPositionAndAngle=function(a,c){void 0===c&&(c=0);var d;if(1!=this.m_world.IsLocked()){this.m_xf.R.Set(c);this.m_xf.position.SetV(a);d=this.m_xf.R;var e=this.m_sweep.localCenter;this.m_sweep.c.x=d.col1.x*e.x+d.col2.x*e.y;this.m_sweep.c.y=d.col1.y*e.x+d.col2.y*e.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.SetV(this.m_sweep.c);
this.m_sweep.a0=this.m_sweep.a=c;e=this.m_world.m_contactManager.m_broadPhase;for(d=this.m_fixtureList;d;d=d.m_next)d.Synchronize(e,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}};n.prototype.SetTransform=function(a){this.SetPositionAndAngle(a.position,a.GetAngle())};n.prototype.GetTransform=function(){return this.m_xf};n.prototype.GetPosition=function(){return this.m_xf.position};n.prototype.SetPosition=function(a){this.SetPositionAndAngle(a,this.GetAngle())};n.prototype.GetAngle=
function(){return this.m_sweep.a};n.prototype.SetAngle=function(a){void 0===a&&(a=0);this.SetPositionAndAngle(this.GetPosition(),a)};n.prototype.GetWorldCenter=function(){return this.m_sweep.c};n.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter};n.prototype.SetLinearVelocity=function(a){this.m_type!=n.b2_staticBody&&this.m_linearVelocity.SetV(a)};n.prototype.GetLinearVelocity=function(){return this.m_linearVelocity};n.prototype.SetAngularVelocity=function(a){void 0===a&&(a=0);this.m_type!=
n.b2_staticBody&&(this.m_angularVelocity=a)};n.prototype.GetAngularVelocity=function(){return this.m_angularVelocity};n.prototype.GetDefinition=function(){var a=new C;a.type=this.GetType();a.allowSleep=(this.m_flags&n.e_allowSleepFlag)==n.e_allowSleepFlag;a.angle=this.GetAngle();a.angularDamping=this.m_angularDamping;a.angularVelocity=this.m_angularVelocity;a.fixedRotation=(this.m_flags&n.e_fixedRotationFlag)==n.e_fixedRotationFlag;a.bullet=(this.m_flags&n.e_bulletFlag)==n.e_bulletFlag;a.awake=(this.m_flags&
n.e_awakeFlag)==n.e_awakeFlag;a.linearDamping=this.m_linearDamping;a.linearVelocity.SetV(this.GetLinearVelocity());a.position=this.GetPosition();a.userData=this.GetUserData();return a};n.prototype.ApplyForce=function(a,c){this.m_type==n.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=a.x,this.m_force.y+=a.y,this.m_torque+=(c.x-this.m_sweep.c.x)*a.y-(c.y-this.m_sweep.c.y)*a.x)};n.prototype.ApplyTorque=function(a){void 0===a&&(a=0);this.m_type==n.b2_dynamicBody&&(0==this.IsAwake()&&
this.SetAwake(!0),this.m_torque+=a)};n.prototype.ApplyImpulse=function(a,c){this.m_type==n.b2_dynamicBody&&(0==this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*a.x,this.m_linearVelocity.y+=this.m_invMass*a.y,this.m_angularVelocity+=this.m_invI*((c.x-this.m_sweep.c.x)*a.y-(c.y-this.m_sweep.c.y)*a.x))};n.prototype.Split=function(c){for(var d=this.GetLinearVelocity().Copy(),e=this.GetAngularVelocity(),f=this.GetWorldCenter(),g=this.m_world.CreateBody(this.GetDefinition()),p,
t=this.m_fixtureList;t;)if(c(t)){var x=t.m_next;p?p.m_next=x:this.m_fixtureList=x;this.m_fixtureCount--;t.m_next=g.m_fixtureList;g.m_fixtureList=t;g.m_fixtureCount++;t.m_body=g;t=x}else p=t,t=t.m_next;this.ResetMassData();g.ResetMassData();p=this.GetWorldCenter();c=g.GetWorldCenter();p=a.AddVV(d,a.CrossFV(e,a.SubtractVV(p,f)));d=a.AddVV(d,a.CrossFV(e,a.SubtractVV(c,f)));this.SetLinearVelocity(p);g.SetLinearVelocity(d);this.SetAngularVelocity(e);g.SetAngularVelocity(e);this.SynchronizeFixtures();g.SynchronizeFixtures();
return g};n.prototype.Merge=function(a){var c;for(c=a.m_fixtureList;c;){var d=c.m_next;a.m_fixtureCount--;c.m_next=this.m_fixtureList;this.m_fixtureList=c;this.m_fixtureCount++;c.m_body=f;c=d}e.m_fixtureCount=0;var e=this,f=a;e.GetWorldCenter();f.GetWorldCenter();e.GetLinearVelocity().Copy();f.GetLinearVelocity().Copy();e.GetAngularVelocity();f.GetAngularVelocity();e.ResetMassData();this.SynchronizeFixtures()};n.prototype.GetMass=function(){return this.m_mass};n.prototype.GetInertia=function(){return this.m_I};
n.prototype.GetMassData=function(a){a.mass=this.m_mass;a.I=this.m_I;a.center.SetV(this.m_sweep.localCenter)};n.prototype.SetMassData=function(c){g.b2Assert(0==this.m_world.IsLocked());if(1!=this.m_world.IsLocked()&&this.m_type==n.b2_dynamicBody){this.m_invI=this.m_I=this.m_invMass=0;this.m_mass=c.mass;0>=this.m_mass&&(this.m_mass=1);this.m_invMass=1/this.m_mass;0<c.I&&0==(this.m_flags&n.e_fixedRotationFlag)&&(this.m_I=c.I-this.m_mass*(c.center.x*c.center.x+c.center.y*c.center.y),this.m_invI=1/this.m_I);
var d=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(c.center);this.m_sweep.c0.SetV(a.MulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-d.y);this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-d.x)}};n.prototype.ResetMassData=function(){this.m_invI=this.m_I=this.m_invMass=this.m_mass=0;this.m_sweep.localCenter.SetZero();if(this.m_type!=n.b2_staticBody&&this.m_type!=n.b2_kinematicBody){for(var c=
e.Make(0,0),d=this.m_fixtureList;d;d=d.m_next)if(0!=d.m_density){var f=d.GetMassData();this.m_mass+=f.mass;c.x+=f.center.x*f.mass;c.y+=f.center.y*f.mass;this.m_I+=f.I}0<this.m_mass?(this.m_invMass=1/this.m_mass,c.x*=this.m_invMass,c.y*=this.m_invMass):this.m_invMass=this.m_mass=1;0<this.m_I&&0==(this.m_flags&n.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(c.x*c.x+c.y*c.y),this.m_I*=this.m_inertiaScale,g.b2Assert(0<this.m_I),this.m_invI=1/this.m_I):this.m_invI=this.m_I=0;d=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(c);
this.m_sweep.c0.SetV(a.MulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-d.y);this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-d.x)}};n.prototype.GetWorldPoint=function(a){var c=this.m_xf.R;a=new e(c.col1.x*a.x+c.col2.x*a.y,c.col1.y*a.x+c.col2.y*a.y);a.x+=this.m_xf.position.x;a.y+=this.m_xf.position.y;return a};n.prototype.GetWorldVector=function(c){return a.MulMV(this.m_xf.R,c)};n.prototype.GetLocalPoint=
function(c){return a.MulXT(this.m_xf,c)};n.prototype.GetLocalVector=function(c){return a.MulTMV(this.m_xf.R,c)};n.prototype.GetLinearVelocityFromWorldPoint=function(a){return new e(this.m_linearVelocity.x-this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))};n.prototype.GetLinearVelocityFromLocalPoint=function(a){var c=this.m_xf.R;a=new e(c.col1.x*a.x+c.col2.x*a.y,c.col1.y*a.x+c.col2.y*a.y);a.x+=this.m_xf.position.x;a.y+=this.m_xf.position.y;
return new e(this.m_linearVelocity.x-this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))};n.prototype.GetLinearDamping=function(){return this.m_linearDamping};n.prototype.SetLinearDamping=function(a){void 0===a&&(a=0);this.m_linearDamping=a};n.prototype.GetAngularDamping=function(){return this.m_angularDamping};n.prototype.SetAngularDamping=function(a){void 0===a&&(a=0);this.m_angularDamping=a};n.prototype.SetType=function(a){void 0===
a&&(a=0);if(this.m_type!=a)for(this.m_type=a,this.ResetMassData(),this.m_type==n.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0,a=this.m_contactList;a;a=a.next)a.contact.FlagForFiltering()};n.prototype.GetType=function(){return this.m_type};n.prototype.SetBullet=function(a){this.m_flags=a?this.m_flags|n.e_bulletFlag:this.m_flags&~n.e_bulletFlag};n.prototype.IsBullet=function(){return(this.m_flags&n.e_bulletFlag)==
n.e_bulletFlag};n.prototype.SetSleepingAllowed=function(a){a?this.m_flags|=n.e_allowSleepFlag:(this.m_flags&=~n.e_allowSleepFlag,this.SetAwake(!0))};n.prototype.SetAwake=function(a){a?(this.m_flags|=n.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~n.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)};n.prototype.IsAwake=function(){return(this.m_flags&n.e_awakeFlag)==n.e_awakeFlag};n.prototype.SetFixedRotation=function(a){this.m_flags=
a?this.m_flags|n.e_fixedRotationFlag:this.m_flags&~n.e_fixedRotationFlag;this.ResetMassData()};n.prototype.IsFixedRotation=function(){return(this.m_flags&n.e_fixedRotationFlag)==n.e_fixedRotationFlag};n.prototype.SetActive=function(a){if(a!=this.IsActive()){var c;if(a)for(this.m_flags|=n.e_activeFlag,a=this.m_world.m_contactManager.m_broadPhase,c=this.m_fixtureList;c;c=c.m_next)c.CreateProxy(a,this.m_xf);else{this.m_flags&=~n.e_activeFlag;a=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;c;c=
c.m_next)c.DestroyProxy(a);for(a=this.m_contactList;a;)c=a,a=a.next,this.m_world.m_contactManager.Destroy(c.contact);this.m_contactList=null}}};n.prototype.IsActive=function(){return(this.m_flags&n.e_activeFlag)==n.e_activeFlag};n.prototype.IsSleepingAllowed=function(){return(this.m_flags&n.e_allowSleepFlag)==n.e_allowSleepFlag};n.prototype.GetFixtureList=function(){return this.m_fixtureList};n.prototype.GetJointList=function(){return this.m_jointList};n.prototype.GetControllerList=function(){return this.m_controllerList};
n.prototype.GetContactList=function(){return this.m_contactList};n.prototype.GetNext=function(){return this.m_next};n.prototype.GetUserData=function(){return this.m_userData};n.prototype.SetUserData=function(a){this.m_userData=a};n.prototype.GetWorld=function(){return this.m_world};n.prototype.b2Body=function(a,c){this.m_flags=0;a.bullet&&(this.m_flags|=n.e_bulletFlag);a.fixedRotation&&(this.m_flags|=n.e_fixedRotationFlag);a.allowSleep&&(this.m_flags|=n.e_allowSleepFlag);a.awake&&(this.m_flags|=n.e_awakeFlag);
a.active&&(this.m_flags|=n.e_activeFlag);this.m_world=c;this.m_xf.position.SetV(a.position);this.m_xf.R.Set(a.angle);this.m_sweep.localCenter.SetZero();this.m_sweep.t0=1;this.m_sweep.a0=this.m_sweep.a=a.angle;var d=this.m_xf.R,e=this.m_sweep.localCenter;this.m_sweep.c.x=d.col1.x*e.x+d.col2.x*e.y;this.m_sweep.c.y=d.col1.y*e.x+d.col2.y*e.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.SetV(this.m_sweep.c);this.m_contactList=this.m_controllerList=this.m_jointList=
null;this.m_controllerCount=0;this.m_next=this.m_prev=null;this.m_linearVelocity.SetV(a.linearVelocity);this.m_angularVelocity=a.angularVelocity;this.m_linearDamping=a.linearDamping;this.m_angularDamping=a.angularDamping;this.m_force.Set(0,0);this.m_sleepTime=this.m_torque=0;this.m_type=a.type;this.m_invMass=this.m_type==n.b2_dynamicBody?this.m_mass=1:this.m_mass=0;this.m_invI=this.m_I=0;this.m_inertiaScale=a.inertiaScale;this.m_userData=a.userData;this.m_fixtureList=null;this.m_fixtureCount=0};n.prototype.SynchronizeFixtures=
function(){var a=n.s_xf1;a.R.Set(this.m_sweep.a0);var c=a.R,d=this.m_sweep.localCenter;a.position.x=this.m_sweep.c0.x-(c.col1.x*d.x+c.col2.x*d.y);a.position.y=this.m_sweep.c0.y-(c.col1.y*d.x+c.col2.y*d.y);d=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;c;c=c.m_next)c.Synchronize(d,a,this.m_xf)};n.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var a=this.m_xf.R,c=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(a.col1.x*c.x+a.col2.x*c.y);
this.m_xf.position.y=this.m_sweep.c.y-(a.col1.y*c.x+a.col2.y*c.y)};n.prototype.ShouldCollide=function(a){if(this.m_type!=n.b2_dynamicBody&&a.m_type!=n.b2_dynamicBody)return!1;for(var c=this.m_jointList;c;c=c.next)if(c.other==a&&0==c.joint.m_collideConnected)return!1;return!0};n.prototype.Advance=function(a){void 0===a&&(a=0);this.m_sweep.Advance(a);this.m_sweep.c.SetV(this.m_sweep.c0);this.m_sweep.a=this.m_sweep.a0;this.SynchronizeTransform()};Box2D.postDefs.push(function(){Box2D.Dynamics.b2Body.s_xf1=
new d;Box2D.Dynamics.b2Body.e_islandFlag=1;Box2D.Dynamics.b2Body.e_awakeFlag=2;Box2D.Dynamics.b2Body.e_allowSleepFlag=4;Box2D.Dynamics.b2Body.e_bulletFlag=8;Box2D.Dynamics.b2Body.e_fixedRotationFlag=16;Box2D.Dynamics.b2Body.e_activeFlag=32;Box2D.Dynamics.b2Body.b2_staticBody=0;Box2D.Dynamics.b2Body.b2_kinematicBody=1;Box2D.Dynamics.b2Body.b2_dynamicBody=2});C.b2BodyDef=function(){this.position=new e;this.linearVelocity=new e};C.prototype.b2BodyDef=function(){this.userData=null;this.position.Set(0,
0);this.angle=0;this.linearVelocity.Set(0,0);this.angularDamping=this.linearDamping=this.angularVelocity=0;this.awake=this.allowSleep=!0;this.bullet=this.fixedRotation=!1;this.type=n.b2_staticBody;this.active=!0;this.inertiaScale=1};F.b2ContactFilter=function(){};F.prototype.ShouldCollide=function(a,c){var d=a.GetFilterData(),e=c.GetFilterData();return d.groupIndex==e.groupIndex&&0!=d.groupIndex?0<d.groupIndex:0!=(d.maskBits&e.categoryBits)&&0!=(d.categoryBits&e.maskBits)};F.prototype.RayCollide=
function(a,c){return a?this.ShouldCollide(a instanceof K?a:null,c):!0};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactFilter.b2_defaultFilter=new F});J.b2ContactImpulse=function(){this.normalImpulses=new Vector_a2j_Number(g.b2_maxManifoldPoints);this.tangentImpulses=new Vector_a2j_Number(g.b2_maxManifoldPoints)};H.b2ContactListener=function(){};H.prototype.BeginContact=function(a){};H.prototype.EndContact=function(a){};H.prototype.PreSolve=function(a,c){};H.prototype.PostSolve=function(a,
c){};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactListener.b2_defaultListener=new H});L.b2ContactManager=function(){};L.prototype.b2ContactManager=function(){this.m_world=null;this.m_contactCount=0;this.m_contactFilter=F.b2_defaultFilter;this.m_contactListener=H.b2_defaultListener;this.m_contactFactory=new x(this.m_allocator);this.m_broadPhase=new l};L.prototype.AddPair=function(a,c){var d=a instanceof K?a:null,e=c instanceof K?c:null,f=d.GetBody(),g=e.GetBody();if(f!=g){for(var p=g.GetContactList();p;){if(p.other==
f){var t=p.contact.GetFixtureA(),x=p.contact.GetFixtureB();if(t==d&&x==e||t==e&&x==d)return}p=p.next}0!=g.ShouldCollide(f)&&0!=this.m_contactFilter.ShouldCollide(d,e)&&(p=this.m_contactFactory.Create(d,e),d=p.GetFixtureA(),e=p.GetFixtureB(),f=d.m_body,g=e.m_body,p.m_prev=null,p.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=p),this.m_world.m_contactList=p,p.m_nodeA.contact=p,p.m_nodeA.other=g,p.m_nodeA.prev=null,p.m_nodeA.next=f.m_contactList,
null!=f.m_contactList&&(f.m_contactList.prev=p.m_nodeA),f.m_contactList=p.m_nodeA,p.m_nodeB.contact=p,p.m_nodeB.other=f,p.m_nodeB.prev=null,p.m_nodeB.next=g.m_contactList,null!=g.m_contactList&&(g.m_contactList.prev=p.m_nodeB),g.m_contactList=p.m_nodeB,++this.m_world.m_contactCount)}};L.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this,this.AddPair))};L.prototype.Destroy=function(a){var c=a.GetFixtureA(),d=a.GetFixtureB(),c=c.GetBody(),d=d.GetBody();a.IsTouching()&&
this.m_contactListener.EndContact(a);a.m_prev&&(a.m_prev.m_next=a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_world.m_contactList&&(this.m_world.m_contactList=a.m_next);a.m_nodeA.prev&&(a.m_nodeA.prev.next=a.m_nodeA.next);a.m_nodeA.next&&(a.m_nodeA.next.prev=a.m_nodeA.prev);a.m_nodeA==c.m_contactList&&(c.m_contactList=a.m_nodeA.next);a.m_nodeB.prev&&(a.m_nodeB.prev.next=a.m_nodeB.next);a.m_nodeB.next&&(a.m_nodeB.next.prev=a.m_nodeB.prev);a.m_nodeB==d.m_contactList&&(d.m_contactList=a.m_nodeB.next);
this.m_contactFactory.Destroy(a);--this.m_contactCount};L.prototype.Collide=function(){for(var a=this.m_world.m_contactList;a;){var c=a.GetFixtureA(),d=a.GetFixtureB(),e=c.GetBody(),f=d.GetBody();if(0==e.IsAwake()&&0==f.IsAwake())a=a.GetNext();else{if(a.m_flags&B.e_filterFlag){if(0==f.ShouldCollide(e)){c=a;a=c.GetNext();this.Destroy(c);continue}if(0==this.m_contactFilter.ShouldCollide(c,d)){c=a;a=c.GetNext();this.Destroy(c);continue}a.m_flags&=~B.e_filterFlag}0==this.m_broadPhase.TestOverlap(c.m_proxy,
d.m_proxy)?(c=a,a=c.GetNext(),this.Destroy(c)):(a.Update(this.m_contactListener),a=a.GetNext())}}};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactManager.s_evalCP=new k});D.b2DebugDraw=function(){};D.prototype.b2DebugDraw=function(){};D.prototype.SetFlags=function(a){};D.prototype.GetFlags=function(){};D.prototype.AppendFlags=function(a){};D.prototype.ClearFlags=function(a){};D.prototype.SetSprite=function(a){};D.prototype.GetSprite=function(){};D.prototype.SetDrawScale=function(a){};D.prototype.GetDrawScale=
function(){};D.prototype.SetLineThickness=function(a){};D.prototype.GetLineThickness=function(){};D.prototype.SetAlpha=function(a){};D.prototype.GetAlpha=function(){};D.prototype.SetFillAlpha=function(a){};D.prototype.GetFillAlpha=function(){};D.prototype.SetXFormScale=function(a){};D.prototype.GetXFormScale=function(){};D.prototype.DrawPolygon=function(a,c,d){};D.prototype.DrawSolidPolygon=function(a,c,d){};D.prototype.DrawCircle=function(a,c,d){};D.prototype.DrawSolidCircle=function(a,c,d,e){};
D.prototype.DrawSegment=function(a,c,d){};D.prototype.DrawTransform=function(a){};Box2D.postDefs.push(function(){Box2D.Dynamics.b2DebugDraw.e_shapeBit=1;Box2D.Dynamics.b2DebugDraw.e_jointBit=2;Box2D.Dynamics.b2DebugDraw.e_aabbBit=4;Box2D.Dynamics.b2DebugDraw.e_pairBit=8;Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit=16;Box2D.Dynamics.b2DebugDraw.e_controllerBit=32});N.b2DestructionListener=function(){};N.prototype.SayGoodbyeJoint=function(a){};N.prototype.SayGoodbyeFixture=function(a){};I.b2FilterData=
function(){this.categoryBits=1;this.maskBits=65535;this.groupIndex=0};I.prototype.Copy=function(){var a=new I;a.categoryBits=this.categoryBits;a.maskBits=this.maskBits;a.groupIndex=this.groupIndex;return a};K.b2Fixture=function(){this.m_filter=new I};K.prototype.GetType=function(){return this.m_shape.GetType()};K.prototype.GetShape=function(){return this.m_shape};K.prototype.SetSensor=function(a){if(this.m_isSensor!=a&&(this.m_isSensor=a,null!=this.m_body))for(a=this.m_body.GetContactList();a;){var c=
a.contact,d=c.GetFixtureA(),e=c.GetFixtureB();d!=this&&e!=this||c.SetSensor(d.IsSensor()||e.IsSensor());a=a.next}};K.prototype.IsSensor=function(){return this.m_isSensor};K.prototype.SetFilterData=function(a){this.m_filter=a.Copy();if(!this.m_body)for(a=this.m_body.GetContactList();a;){var c=a.contact,d=c.GetFixtureA(),e=c.GetFixtureB();d!=this&&e!=this||c.FlagForFiltering();a=a.next}};K.prototype.GetFilterData=function(){return this.m_filter.Copy()};K.prototype.GetBody=function(){return this.m_body};
K.prototype.GetNext=function(){return this.m_next};K.prototype.GetUserData=function(){return this.m_userData};K.prototype.SetUserData=function(a){this.m_userData=a};K.prototype.TestPoint=function(a){return this.m_shape.TestPoint(this.m_body.GetTransform(),a)};K.prototype.RayCast=function(a,c){return this.m_shape.RayCast(a,c,this.m_body.GetTransform())};K.prototype.GetMassData=function(a){void 0===a&&(a=null);null==a&&(a=new r);this.m_shape.ComputeMass(a,this.m_density);return a};K.prototype.SetDensity=
function(a){void 0===a&&(a=0);this.m_density=a};K.prototype.GetDensity=function(){return this.m_density};K.prototype.GetFriction=function(){return this.m_friction};K.prototype.SetFriction=function(a){void 0===a&&(a=0);this.m_friction=a};K.prototype.GetRestitution=function(){return this.m_restitution};K.prototype.SetRestitution=function(a){void 0===a&&(a=0);this.m_restitution=a};K.prototype.GetAABB=function(){return this.m_aabb};K.prototype.b2Fixture=function(){this.m_aabb=new h;this.m_shape=this.m_next=
this.m_body=this.m_userData=null;this.m_restitution=this.m_friction=this.m_density=0};K.prototype.Create=function(a,c,d){this.m_userData=d.userData;this.m_friction=d.friction;this.m_restitution=d.restitution;this.m_body=a;this.m_next=null;this.m_filter=d.filter.Copy();this.m_isSensor=d.isSensor;this.m_shape=d.shape.Copy();this.m_density=d.density};K.prototype.Destroy=function(){this.m_shape=null};K.prototype.CreateProxy=function(a,c){this.m_shape.ComputeAABB(this.m_aabb,c);this.m_proxy=a.CreateProxy(this.m_aabb,
this)};K.prototype.DestroyProxy=function(a){null!=this.m_proxy&&(a.DestroyProxy(this.m_proxy),this.m_proxy=null)};K.prototype.Synchronize=function(c,d,e){if(this.m_proxy){var f=new h,g=new h;this.m_shape.ComputeAABB(f,d);this.m_shape.ComputeAABB(g,e);this.m_aabb.Combine(f,g);d=a.SubtractVV(e.position,d.position);c.MoveProxy(this.m_proxy,this.m_aabb,d)}};O.b2FixtureDef=function(){this.filter=new I};O.prototype.b2FixtureDef=function(){this.userData=this.shape=null;this.friction=.2;this.density=this.restitution=
0;this.filter.categoryBits=1;this.filter.maskBits=65535;this.filter.groupIndex=0;this.isSensor=!1};M.b2Island=function(){};M.prototype.b2Island=function(){this.m_bodies=new Vector2;this.m_contacts=new Vector2;this.m_joints=new Vector2};M.prototype.Initialize=function(a,c,d,e,f,g){void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=0);var p=0;this.m_bodyCapacity=a;this.m_contactCapacity=c;this.m_jointCapacity=d;this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;this.m_allocator=e;this.m_listener=
f;this.m_contactSolver=g;for(p=this.m_bodies.length;p<a;p++)this.m_bodies[p]=null;for(p=this.m_contacts.length;p<c;p++)this.m_contacts[p]=null;for(p=this.m_joints.length;p<d;p++)this.m_joints[p]=null};M.prototype.Clear=function(){this.m_jointCount=this.m_contactCount=this.m_bodyCount=0};M.prototype.Solve=function(c,d,e){for(var f=0,p=0,t,f=0;f<this.m_bodyCount;++f)p=this.m_bodies[f],p.GetType()==n.b2_dynamicBody&&(p.m_linearVelocity.x+=c.dt*(d.x+p.m_invMass*p.m_force.x),p.m_linearVelocity.y+=c.dt*
(d.y+p.m_invMass*p.m_force.y),p.m_angularVelocity+=c.dt*p.m_invI*p.m_torque,p.m_linearVelocity.Multiply(a.Clamp(1-c.dt*p.m_linearDamping,0,1)),p.m_angularVelocity*=a.Clamp(1-c.dt*p.m_angularDamping,0,1));this.m_contactSolver.Initialize(c,this.m_contacts,this.m_contactCount,this.m_allocator);d=this.m_contactSolver;d.InitVelocityConstraints(c);for(f=0;f<this.m_jointCount;++f)t=this.m_joints[f],t.InitVelocityConstraints(c);for(f=0;f<c.velocityIterations;++f){for(p=0;p<this.m_jointCount;++p)t=this.m_joints[p],
t.SolveVelocityConstraints(c);d.SolveVelocityConstraints()}for(f=0;f<this.m_jointCount;++f)t=this.m_joints[f],t.FinalizeVelocityConstraints();d.FinalizeVelocityConstraints();for(f=0;f<this.m_bodyCount;++f)if(p=this.m_bodies[f],p.GetType()!=n.b2_staticBody){var x=c.dt*p.m_linearVelocity.x,h=c.dt*p.m_linearVelocity.y;x*x+h*h>g.b2_maxTranslationSquared&&(p.m_linearVelocity.Normalize(),p.m_linearVelocity.x=p.m_linearVelocity.x*g.b2_maxTranslation*c.inv_dt,p.m_linearVelocity.y=p.m_linearVelocity.y*g.b2_maxTranslation*
c.inv_dt);x=c.dt*p.m_angularVelocity;x*x>g.b2_maxRotationSquared&&(p.m_angularVelocity=0>p.m_angularVelocity?-g.b2_maxRotation*c.inv_dt:g.b2_maxRotation*c.inv_dt);p.m_sweep.c0.SetV(p.m_sweep.c);p.m_sweep.a0=p.m_sweep.a;p.m_sweep.c.x+=c.dt*p.m_linearVelocity.x;p.m_sweep.c.y+=c.dt*p.m_linearVelocity.y;p.m_sweep.a+=c.dt*p.m_angularVelocity;p.SynchronizeTransform()}for(f=0;f<c.positionIterations;++f){x=d.SolvePositionConstraints(g.b2_contactBaumgarte);h=!0;for(p=0;p<this.m_jointCount;++p)t=this.m_joints[p],
t=t.SolvePositionConstraints(g.b2_contactBaumgarte),h=h&&t;if(x&&h)break}this.Report(d.m_constraints);if(e){e=Number.MAX_VALUE;d=g.b2_linearSleepTolerance*g.b2_linearSleepTolerance;x=g.b2_angularSleepTolerance*g.b2_angularSleepTolerance;for(f=0;f<this.m_bodyCount;++f)p=this.m_bodies[f],p.GetType()!=n.b2_staticBody&&(0==(p.m_flags&n.e_allowSleepFlag)&&(e=p.m_sleepTime=0),0==(p.m_flags&n.e_allowSleepFlag)||p.m_angularVelocity*p.m_angularVelocity>x||a.Dot(p.m_linearVelocity,p.m_linearVelocity)>d?e=p.m_sleepTime=
0:(p.m_sleepTime+=c.dt,e=a.Min(e,p.m_sleepTime)));if(e>=g.b2_timeToSleep)for(f=0;f<this.m_bodyCount;++f)p=this.m_bodies[f],p.SetAwake(!1)}};M.prototype.SolveTOI=function(a){var c=0,d=0;this.m_contactSolver.Initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);for(var e=this.m_contactSolver,c=0;c<this.m_jointCount;++c)this.m_joints[c].InitVelocityConstraints(a);for(c=0;c<a.velocityIterations;++c)for(e.SolveVelocityConstraints(),d=0;d<this.m_jointCount;++d)this.m_joints[d].SolveVelocityConstraints(a);
for(c=0;c<this.m_bodyCount;++c)if(d=this.m_bodies[c],d.GetType()!=n.b2_staticBody){var f=a.dt*d.m_linearVelocity.x,p=a.dt*d.m_linearVelocity.y;f*f+p*p>g.b2_maxTranslationSquared&&(d.m_linearVelocity.Normalize(),d.m_linearVelocity.x=d.m_linearVelocity.x*g.b2_maxTranslation*a.inv_dt,d.m_linearVelocity.y=d.m_linearVelocity.y*g.b2_maxTranslation*a.inv_dt);f=a.dt*d.m_angularVelocity;f*f>g.b2_maxRotationSquared&&(d.m_angularVelocity=0>d.m_angularVelocity?-g.b2_maxRotation*a.inv_dt:g.b2_maxRotation*a.inv_dt);
d.m_sweep.c0.SetV(d.m_sweep.c);d.m_sweep.a0=d.m_sweep.a;d.m_sweep.c.x+=a.dt*d.m_linearVelocity.x;d.m_sweep.c.y+=a.dt*d.m_linearVelocity.y;d.m_sweep.a+=a.dt*d.m_angularVelocity;d.SynchronizeTransform()}for(c=0;c<a.positionIterations;++c){f=e.SolvePositionConstraints(.75);p=!0;for(d=0;d<this.m_jointCount;++d)var t=this.m_joints[d].SolvePositionConstraints(g.b2_contactBaumgarte),p=p&&t;if(f&&p)break}this.Report(e.m_constraints)};M.prototype.Report=function(a){if(null!=this.m_listener)for(var c=0;c<this.m_contactCount;++c){for(var d=
this.m_contacts[c],e=a[c],f=0;f<e.pointCount;++f)M.s_impulse.normalImpulses[f]=e.points[f].normalImpulse,M.s_impulse.tangentImpulses[f]=e.points[f].tangentImpulse;this.m_listener.PostSolve(d,M.s_impulse)}};M.prototype.AddBody=function(a){a.m_islandIndex=this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=a};M.prototype.AddContact=function(a){this.m_contacts[this.m_contactCount++]=a};M.prototype.AddJoint=function(a){this.m_joints[this.m_jointCount++]=a};Box2D.postDefs.push(function(){Box2D.Dynamics.b2Island.s_impulse=
new J});p.b2TimeStep=function(){};p.prototype.Set=function(a){this.dt=a.dt;this.inv_dt=a.inv_dt;this.positionIterations=a.positionIterations;this.velocityIterations=a.velocityIterations;this.warmStarting=a.warmStarting};t.b2World=function(){this.s_stack=new Vector2;this.m_contactManager=new L;this.m_contactSolver=new G;this.m_island=new M};t.prototype.b2World=function(a,c){this.m_controllerList=this.m_jointList=this.m_contactList=this.m_bodyList=this.m_debugDraw=this.m_destructionListener=null;this.m_controllerCount=
this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;t.m_warmStarting=!0;t.m_continuousPhysics=!0;this.m_allowSleep=c;this.m_gravity=a;this.m_inv_dt0=0;this.m_contactManager.m_world=this;var d=new C;this.m_groundBody=this.CreateBody(d)};t.prototype.SetDestructionListener=function(a){this.m_destructionListener=a};t.prototype.SetContactFilter=function(a){this.m_contactManager.m_contactFilter=a};t.prototype.SetContactListener=function(a){this.m_contactManager.m_contactListener=a};t.prototype.SetDebugDraw=
function(a){this.m_debugDraw=a};t.prototype.SetBroadPhase=function(a){var c=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=a;for(var d=this.m_bodyList;d;d=d.m_next)for(var e=d.m_fixtureList;e;e=e.m_next)e.m_proxy=a.CreateProxy(c.GetFatAABB(e.m_proxy),e)};t.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()};t.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()};t.prototype.CreateBody=function(a){if(1==this.IsLocked())return null;
a=new n(a,this);a.m_prev=null;if(a.m_next=this.m_bodyList)this.m_bodyList.m_prev=a;this.m_bodyList=a;++this.m_bodyCount;return a};t.prototype.DestroyBody=function(a){if(1!=this.IsLocked()){for(var c=a.m_jointList;c;){var d=c,c=c.next;this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(d.joint);this.DestroyJoint(d.joint)}for(c=a.m_controllerList;c;)d=c,c=c.nextController,d.controller.RemoveBody(a);for(c=a.m_contactList;c;)d=c,c=c.next,this.m_contactManager.Destroy(d.contact);a.m_contactList=
null;for(c=a.m_fixtureList;c;)d=c,c=c.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(d),d.DestroyProxy(this.m_contactManager.m_broadPhase),d.Destroy();a.m_fixtureList=null;a.m_fixtureCount=0;a.m_prev&&(a.m_prev.m_next=a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_bodyList&&(this.m_bodyList=a.m_next);--this.m_bodyCount}};t.prototype.CreateJoint=function(a){var c=P.Create(a,null);c.m_prev=null;if(c.m_next=this.m_jointList)this.m_jointList.m_prev=c;this.m_jointList=
c;++this.m_jointCount;c.m_edgeA.joint=c;c.m_edgeA.other=c.m_bodyB;c.m_edgeA.prev=null;if(c.m_edgeA.next=c.m_bodyA.m_jointList)c.m_bodyA.m_jointList.prev=c.m_edgeA;c.m_bodyA.m_jointList=c.m_edgeA;c.m_edgeB.joint=c;c.m_edgeB.other=c.m_bodyA;c.m_edgeB.prev=null;if(c.m_edgeB.next=c.m_bodyB.m_jointList)c.m_bodyB.m_jointList.prev=c.m_edgeB;c.m_bodyB.m_jointList=c.m_edgeB;var d=a.bodyA,e=a.bodyB;if(0==a.collideConnected)for(a=e.GetContactList();a;)a.other==d&&a.contact.FlagForFiltering(),a=a.next;return c};
t.prototype.DestroyJoint=function(a){var c=a.m_collideConnected;a.m_prev&&(a.m_prev.m_next=a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_jointList&&(this.m_jointList=a.m_next);var d=a.m_bodyA,e=a.m_bodyB;d.SetAwake(!0);e.SetAwake(!0);a.m_edgeA.prev&&(a.m_edgeA.prev.next=a.m_edgeA.next);a.m_edgeA.next&&(a.m_edgeA.next.prev=a.m_edgeA.prev);a.m_edgeA==d.m_jointList&&(d.m_jointList=a.m_edgeA.next);a.m_edgeA.prev=null;a.m_edgeA.next=null;a.m_edgeB.prev&&(a.m_edgeB.prev.next=a.m_edgeB.next);
a.m_edgeB.next&&(a.m_edgeB.next.prev=a.m_edgeB.prev);a.m_edgeB==e.m_jointList&&(e.m_jointList=a.m_edgeB.next);a.m_edgeB.prev=null;a.m_edgeB.next=null;P.Destroy(a,null);--this.m_jointCount;if(0==c)for(a=e.GetContactList();a;)a.other==d&&a.contact.FlagForFiltering(),a=a.next};t.prototype.AddController=function(a){a.m_next=this.m_controllerList;a.m_prev=null;this.m_controllerList=a;a.m_world=this;this.m_controllerCount++;return a};t.prototype.RemoveController=function(a){a.m_prev&&(a.m_prev.m_next=a.m_next);
a.m_next&&(a.m_next.m_prev=a.m_prev);this.m_controllerList==a&&(this.m_controllerList=a.m_next);this.m_controllerCount--};t.prototype.CreateController=function(a){if(a.m_world!=this)throw Error("Controller can only be a member of one world");a.m_next=this.m_controllerList;a.m_prev=null;this.m_controllerList&&(this.m_controllerList.m_prev=a);this.m_controllerList=a;++this.m_controllerCount;a.m_world=this;return a};t.prototype.DestroyController=function(a){a.Clear();a.m_next&&(a.m_next.m_prev=a.m_prev);
a.m_prev&&(a.m_prev.m_next=a.m_next);a==this.m_controllerList&&(this.m_controllerList=a.m_next);--this.m_controllerCount};t.prototype.SetWarmStarting=function(a){t.m_warmStarting=a};t.prototype.SetContinuousPhysics=function(a){t.m_continuousPhysics=a};t.prototype.GetBodyCount=function(){return this.m_bodyCount};t.prototype.GetJointCount=function(){return this.m_jointCount};t.prototype.GetContactCount=function(){return this.m_contactCount};t.prototype.SetGravity=function(a){this.m_gravity=a};t.prototype.GetGravity=
function(){return this.m_gravity};t.prototype.GetGroundBody=function(){return this.m_groundBody};t.prototype.Step=function(a,c,d){void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=0);this.m_flags&t.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~t.e_newFixture);this.m_flags|=t.e_locked;var e=t.s_timestep2;e.dt=a;e.velocityIterations=c;e.positionIterations=d;e.inv_dt=0<a?1/a:0;e.dtRatio=this.m_inv_dt0*a;e.warmStarting=t.m_warmStarting;this.m_contactManager.Collide();0<e.dt&&
this.Solve(e);t.m_continuousPhysics&&0<e.dt&&this.SolveTOI(e);0<e.dt&&(this.m_inv_dt0=e.inv_dt);this.m_flags&=~t.e_locked};t.prototype.ClearForces=function(){for(var a=this.m_bodyList;a;a=a.m_next)a.m_force.SetZero(),a.m_torque=0};t.prototype.DrawDebugData=function(){if(null!=this.m_debugDraw){var a=this.m_debugDraw.GetFlags(),c,d,g;new e;new e;new e;var p;new h;new h;p=[new e,new e,new e,new e];var x=new f(0,0,0);if(a&D.e_shapeBit)for(c=this.m_bodyList;c;c=c.m_next)for(p=c.m_xf,d=c.GetFixtureList();d;d=
d.m_next)g=d.GetShape(),0==c.IsActive()?x.Set(.5,.5,.3):c.GetType()==n.b2_staticBody?x.Set(.5,.9,.5):c.GetType()==n.b2_kinematicBody?x.Set(.5,.5,.9):0==c.IsAwake()?x.Set(.6,.6,.6):x.Set(.9,.7,.7),this.DrawShape(g,p,x);if(a&D.e_jointBit)for(c=this.m_jointList;c;c=c.m_next)this.DrawJoint(c);if(a&D.e_controllerBit)for(c=this.m_controllerList;c;c=c.m_next)c.Draw(this.m_debugDraw);if(a&D.e_pairBit)for(x.Set(.3,.9,.9),c=this.m_contactManager.m_contactList;c;c=c.GetNext())g=c.GetFixtureA(),d=c.GetFixtureB(),
g=g.GetAABB().GetCenter(),d=d.GetAABB().GetCenter(),this.m_debugDraw.DrawSegment(g,d,x);if(a&D.e_aabbBit)for(g=this.m_contactManager.m_broadPhase,p=[new e,new e,new e,new e],c=this.m_bodyList;c;c=c.GetNext())if(0!=c.IsActive())for(d=c.GetFixtureList();d;d=d.GetNext()){var k=g.GetFatAABB(d.m_proxy);p[0].Set(k.lowerBound.x,k.lowerBound.y);p[1].Set(k.upperBound.x,k.lowerBound.y);p[2].Set(k.upperBound.x,k.upperBound.y);p[3].Set(k.lowerBound.x,k.upperBound.y);this.m_debugDraw.DrawPolygon(p,4,x)}if(a&D.e_centerOfMassBit)for(c=
this.m_bodyList;c;c=c.m_next)p=t.s_xf,p.R=c.m_xf.R,p.position=c.GetWorldCenter(),this.m_debugDraw.DrawTransform(p)}};t.prototype.QueryAABB=function(a,c){var d=this.m_contactManager.m_broadPhase;d.Query(function(c){return a(d.GetUserData(c))},c)};t.prototype.QueryShape=function(a,c,e){void 0===e&&(e=null);null==e&&(e=new d,e.SetIdentity());var f=this.m_contactManager.m_broadPhase,g=new h;c.ComputeAABB(g,e);f.Query(function(d){d=f.GetUserData(d)instanceof K?f.GetUserData(d):null;return A.TestOverlap(c,
e,d.GetShape(),d.GetBody().GetTransform())?a(d):!0},g)};t.prototype.QueryPoint=function(a,c){var d=this.m_contactManager.m_broadPhase,e=new h;e.lowerBound.Set(c.x-g.b2_linearSlop,c.y-g.b2_linearSlop);e.upperBound.Set(c.x+g.b2_linearSlop,c.y+g.b2_linearSlop);d.Query(function(e){e=d.GetUserData(e)instanceof K?d.GetUserData(e):null;return e.TestPoint(c)?a(e):!0},e)};t.prototype.RayCast=function(a,c,d){var f=this.m_contactManager.m_broadPhase,g=new v,p=new q(c,d);f.RayCast(function(p,t){var x=f.GetUserData(t),
x=x instanceof K?x:null;if(x.RayCast(g,p)){var h=g.fraction,k=new e((1-h)*c.x+h*d.x,(1-h)*c.y+h*d.y);return a(x,k,g.normal,h)}return p.maxFraction},p)};t.prototype.RayCastOne=function(a,c){var d;this.RayCast(function(a,c,e,f){void 0===f&&(f=0);d=a;return f},a,c);return d};t.prototype.RayCastAll=function(a,c){var d=new Vector2;this.RayCast(function(a,c,e,f){d[d.length]=a;return 1},a,c);return d};t.prototype.GetBodyList=function(){return this.m_bodyList};t.prototype.GetJointList=function(){return this.m_jointList};
t.prototype.GetContactList=function(){return this.m_contactList};t.prototype.IsLocked=function(){return 0<(this.m_flags&t.e_locked)};t.prototype.Solve=function(a){for(var c,d=this.m_controllerList;d;d=d.m_next)d.Step(a);d=this.m_island;d.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver);for(c=this.m_bodyList;c;c=c.m_next)c.m_flags&=~n.e_islandFlag;for(var e=this.m_contactList;e;e=e.m_next)e.m_flags&=~B.e_islandFlag;
for(e=this.m_jointList;e;e=e.m_next)e.m_islandFlag=!1;parseInt(this.m_bodyCount);for(var e=this.s_stack,f=this.m_bodyList;f;f=f.m_next)if(!(f.m_flags&n.e_islandFlag)&&0!=f.IsAwake()&&0!=f.IsActive()&&f.GetType()!=n.b2_staticBody){d.Clear();var g=0;e[g++]=f;for(f.m_flags|=n.e_islandFlag;0<g;)if(c=e[--g],d.AddBody(c),0==c.IsAwake()&&c.SetAwake(!0),c.GetType()!=n.b2_staticBody){for(var p,t=c.m_contactList;t;t=t.next)t.contact.m_flags&B.e_islandFlag||1==t.contact.IsSensor()||0==t.contact.IsEnabled()||
0==t.contact.IsTouching()||(d.AddContact(t.contact),t.contact.m_flags|=B.e_islandFlag,p=t.other,p.m_flags&n.e_islandFlag||(e[g++]=p,p.m_flags|=n.e_islandFlag));for(c=c.m_jointList;c;c=c.next)1!=c.joint.m_islandFlag&&(p=c.other,0!=p.IsActive()&&(d.AddJoint(c.joint),c.joint.m_islandFlag=!0,p.m_flags&n.e_islandFlag||(e[g++]=p,p.m_flags|=n.e_islandFlag)))}d.Solve(a,this.m_gravity,this.m_allowSleep);for(g=0;g<d.m_bodyCount;++g)c=d.m_bodies[g],c.GetType()==n.b2_staticBody&&(c.m_flags&=~n.e_islandFlag)}for(g=
0;g<e.length&&e[g];++g)e[g]=null;for(c=this.m_bodyList;c;c=c.m_next)0!=c.IsAwake()&&0!=c.IsActive()&&c.GetType()!=n.b2_staticBody&&c.SynchronizeFixtures();this.m_contactManager.FindNewContacts()};t.prototype.SolveTOI=function(a){var c,d,e,f=this.m_island;f.Initialize(this.m_bodyCount,g.b2_maxTOIContactsPerIsland,g.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var p=t.s_queue;for(c=this.m_bodyList;c;c=c.m_next)c.m_flags&=~n.e_islandFlag,c.m_sweep.t0=0;
for(e=this.m_contactList;e;e=e.m_next)e.m_flags&=~(B.e_toiFlag|B.e_islandFlag);for(e=this.m_jointList;e;e=e.m_next)e.m_islandFlag=!1;for(;;){var x=null,h=1;for(e=this.m_contactList;e;e=e.m_next)if(1!=e.IsSensor()&&0!=e.IsEnabled()&&0!=e.IsContinuous()){c=1;if(e.m_flags&B.e_toiFlag)c=e.m_toi;else{c=e.m_fixtureA;d=e.m_fixtureB;c=c.m_body;d=d.m_body;if(!(c.GetType()==n.b2_dynamicBody&&0!=c.IsAwake()||d.GetType()==n.b2_dynamicBody&&0!=d.IsAwake()))continue;var k=c.m_sweep.t0;c.m_sweep.t0<d.m_sweep.t0?
(k=d.m_sweep.t0,c.m_sweep.Advance(k)):d.m_sweep.t0<c.m_sweep.t0&&(k=c.m_sweep.t0,d.m_sweep.Advance(k));c=e.ComputeTOI(c.m_sweep,d.m_sweep);g.b2Assert(0<=c&&1>=c);0<c&&1>c&&(c=(1-c)*k+c,1<c&&(c=1));e.m_toi=c;e.m_flags|=B.e_toiFlag}Number.MIN_VALUE<c&&c<h&&(x=e,h=c)}if(null==x||1-100*Number.MIN_VALUE<h)break;c=x.m_fixtureA;d=x.m_fixtureB;c=c.m_body;d=d.m_body;t.s_backupA.Set(c.m_sweep);t.s_backupB.Set(d.m_sweep);c.Advance(h);d.Advance(h);x.Update(this.m_contactManager.m_contactListener);x.m_flags&=
~B.e_toiFlag;if(1==x.IsSensor()||0==x.IsEnabled())c.m_sweep.Set(t.s_backupA),d.m_sweep.Set(t.s_backupB),c.SynchronizeTransform(),d.SynchronizeTransform();else if(0!=x.IsTouching()){c.GetType()!=n.b2_dynamicBody&&(c=d);f.Clear();x=e=0;p[e+x++]=c;for(c.m_flags|=n.e_islandFlag;0<x;)if(c=p[e++],--x,f.AddBody(c),0==c.IsAwake()&&c.SetAwake(!0),c.GetType()==n.b2_dynamicBody){for(d=c.m_contactList;d&&f.m_contactCount!=f.m_contactCapacity;d=d.next)d.contact.m_flags&B.e_islandFlag||1==d.contact.IsSensor()||
0==d.contact.IsEnabled()||0==d.contact.IsTouching()||(f.AddContact(d.contact),d.contact.m_flags|=B.e_islandFlag,k=d.other,k.m_flags&n.e_islandFlag||(k.GetType()!=n.b2_staticBody&&(k.Advance(h),k.SetAwake(!0)),p[e+x]=k,++x,k.m_flags|=n.e_islandFlag));for(c=c.m_jointList;c;c=c.next)f.m_jointCount!=f.m_jointCapacity&&1!=c.joint.m_islandFlag&&(k=c.other,0!=k.IsActive()&&(f.AddJoint(c.joint),c.joint.m_islandFlag=!0,k.m_flags&n.e_islandFlag||(k.GetType()!=n.b2_staticBody&&(k.Advance(h),k.SetAwake(!0)),
p[e+x]=k,++x,k.m_flags|=n.e_islandFlag)))}e=t.s_timestep;e.warmStarting=!1;e.dt=(1-h)*a.dt;e.inv_dt=1/e.dt;e.dtRatio=0;e.velocityIterations=a.velocityIterations;e.positionIterations=a.positionIterations;f.SolveTOI(e);for(h=h=0;h<f.m_bodyCount;++h)if(c=f.m_bodies[h],c.m_flags&=~n.e_islandFlag,0!=c.IsAwake()&&c.GetType()==n.b2_dynamicBody)for(c.SynchronizeFixtures(),d=c.m_contactList;d;d=d.next)d.contact.m_flags&=~B.e_toiFlag;for(h=0;h<f.m_contactCount;++h)e=f.m_contacts[h],e.m_flags&=~(B.e_toiFlag|
B.e_islandFlag);for(h=0;h<f.m_jointCount;++h)e=f.m_joints[h],e.m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}};t.prototype.DrawJoint=function(a){var c=a.GetBodyA(),d=a.GetBodyB(),e=c.m_xf.position,f=d.m_xf.position,g=a.GetAnchorA(),p=a.GetAnchorB(),x=t.s_jointColor;switch(a.m_type){case P.e_distanceJoint:this.m_debugDraw.DrawSegment(g,p,x);break;case P.e_pulleyJoint:c=a instanceof Q?a:null;a=c.GetGroundAnchorA();c=c.GetGroundAnchorB();this.m_debugDraw.DrawSegment(a,g,x);this.m_debugDraw.DrawSegment(c,
p,x);this.m_debugDraw.DrawSegment(a,c,x);break;case P.e_mouseJoint:this.m_debugDraw.DrawSegment(g,p,x);break;default:c!=this.m_groundBody&&this.m_debugDraw.DrawSegment(e,g,x),this.m_debugDraw.DrawSegment(g,p,x),d!=this.m_groundBody&&this.m_debugDraw.DrawSegment(f,p,x)}};t.prototype.DrawShape=function(c,d,e){switch(c.m_type){case A.e_circleShape:var f=c instanceof w?c:null;c=a.MulX(d,f.m_p);this.m_debugDraw.DrawSolidCircle(c,f.m_radius,d.R.col1,e);break;case A.e_polygonShape:f=0;f=c instanceof z?c:
null;c=parseInt(f.GetVertexCount());for(var g=f.GetVertices(),p=new Vector2(c),f=0;f<c;++f)p[f]=a.MulX(d,g[f]);this.m_debugDraw.DrawSolidPolygon(p,c,e);break;case A.e_edgeShape:f=c instanceof y?c:null,this.m_debugDraw.DrawSegment(a.MulX(d,f.GetVertex1()),a.MulX(d,f.GetVertex2()),e)}};Box2D.postDefs.push(function(){Box2D.Dynamics.b2World.s_timestep2=new p;Box2D.Dynamics.b2World.s_xf=new d;Box2D.Dynamics.b2World.s_backupA=new c;Box2D.Dynamics.b2World.s_backupB=new c;Box2D.Dynamics.b2World.s_timestep=
new p;Box2D.Dynamics.b2World.s_queue=new Vector2;Box2D.Dynamics.b2World.s_jointColor=new f(.5,.8,.8);Box2D.Dynamics.b2World.e_newFixture=1;Box2D.Dynamics.b2World.e_locked=2})})();
(function(){var a=Box2D.Collision.Shapes.b2CircleShape,c=Box2D.Collision.Shapes.b2EdgeShape,d=Box2D.Collision.Shapes.b2PolygonShape,e=Box2D.Collision.Shapes.b2Shape,f=Box2D.Dynamics.Contacts.b2CircleContact,g=Box2D.Dynamics.Contacts.b2Contact,h=Box2D.Dynamics.Contacts.b2ContactConstraint,k=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,l=Box2D.Dynamics.Contacts.b2ContactEdge,q=Box2D.Dynamics.Contacts.b2ContactFactory,v=Box2D.Dynamics.Contacts.b2ContactRegister,w=Box2D.Dynamics.Contacts.b2ContactResult,
y=Box2D.Dynamics.Contacts.b2ContactSolver,r=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,z=Box2D.Dynamics.Contacts.b2NullContact,A=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,n=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,C=Box2D.Dynamics.Contacts.b2PolygonContact,F=Box2D.Dynamics.Contacts.b2PositionSolverManifold,J=Box2D.Dynamics.b2Body,H=Box2D.Dynamics.b2TimeStep,L=Box2D.Common.b2Settings,D=Box2D.Common.Math.b2Mat22,N=Box2D.Common.Math.b2Math,I=Box2D.Common.Math.b2Vec2,K=Box2D.Collision.b2Collision,
O=Box2D.Collision.b2ContactID,M=Box2D.Collision.b2Manifold,p=Box2D.Collision.b2TimeOfImpact,t=Box2D.Collision.b2TOIInput,B=Box2D.Collision.b2WorldManifold;Box2D.inherit(f,Box2D.Dynamics.Contacts.b2Contact);f.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;f.b2CircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};f.Create=function(a){return new f};f.Destroy=function(a,c){};f.prototype.Reset=function(a,c){this.__super.Reset.call(this,a,c)};f.prototype.Evaluate=
function(){var c=this.m_fixtureA.GetBody(),d=this.m_fixtureB.GetBody();K.CollideCircles(this.m_manifold,this.m_fixtureA.GetShape()instanceof a?this.m_fixtureA.GetShape():null,c.m_xf,this.m_fixtureB.GetShape()instanceof a?this.m_fixtureB.GetShape():null,d.m_xf)};g.b2Contact=function(){this.m_nodeA=new l;this.m_nodeB=new l;this.m_manifold=new M;this.m_oldManifold=new M};g.prototype.GetManifold=function(){return this.m_manifold};g.prototype.GetWorldManifold=function(a){var c=this.m_fixtureA.GetBody(),
d=this.m_fixtureB.GetBody(),e=this.m_fixtureA.GetShape(),f=this.m_fixtureB.GetShape();a.Initialize(this.m_manifold,c.GetTransform(),e.m_radius,d.GetTransform(),f.m_radius)};g.prototype.IsTouching=function(){return(this.m_flags&g.e_touchingFlag)==g.e_touchingFlag};g.prototype.IsContinuous=function(){return(this.m_flags&g.e_continuousFlag)==g.e_continuousFlag};g.prototype.SetSensor=function(a){this.m_flags=a?this.m_flags|g.e_sensorFlag:this.m_flags&~g.e_sensorFlag};g.prototype.IsSensor=function(){return(this.m_flags&
g.e_sensorFlag)==g.e_sensorFlag};g.prototype.SetEnabled=function(a){this.m_flags=a?this.m_flags|g.e_enabledFlag:this.m_flags&~g.e_enabledFlag};g.prototype.IsEnabled=function(){return(this.m_flags&g.e_enabledFlag)==g.e_enabledFlag};g.prototype.GetNext=function(){return this.m_next};g.prototype.GetFixtureA=function(){return this.m_fixtureA};g.prototype.GetFixtureB=function(){return this.m_fixtureB};g.prototype.FlagForFiltering=function(){this.m_flags|=g.e_filterFlag};g.prototype.b2Contact=function(){};
g.prototype.Reset=function(a,c){void 0===a&&(a=null);void 0===c&&(c=null);this.m_flags=g.e_enabledFlag;if(a&&c){if(a.IsSensor()||c.IsSensor())this.m_flags|=g.e_sensorFlag;var d=a.GetBody(),e=c.GetBody();if(d.GetType()!=J.b2_dynamicBody||d.IsBullet()||e.GetType()!=J.b2_dynamicBody||e.IsBullet())this.m_flags|=g.e_continuousFlag;this.m_fixtureA=a;this.m_fixtureB=c;this.m_manifold.m_pointCount=0;this.m_next=this.m_prev=null;this.m_nodeA.contact=null;this.m_nodeA.prev=null;this.m_nodeA.next=null;this.m_nodeA.other=
null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=null}else this.m_fixtureB=this.m_fixtureA=null};g.prototype.Update=function(a){var c=this.m_oldManifold;this.m_oldManifold=this.m_manifold;this.m_manifold=c;this.m_flags|=g.e_enabledFlag;var d=!1,c=(this.m_flags&g.e_touchingFlag)==g.e_touchingFlag,f=this.m_fixtureA.m_body,p=this.m_fixtureB.m_body,t=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&g.e_sensorFlag)t&&(d=this.m_fixtureA.GetShape(),
t=this.m_fixtureB.GetShape(),f=f.GetTransform(),p=p.GetTransform(),d=e.TestOverlap(d,f,t,p)),this.m_manifold.m_pointCount=0;else{f.GetType()!=J.b2_dynamicBody||f.IsBullet()||p.GetType()!=J.b2_dynamicBody||p.IsBullet()?this.m_flags|=g.e_continuousFlag:this.m_flags&=~g.e_continuousFlag;if(t)for(this.Evaluate(),d=0<this.m_manifold.m_pointCount,t=0;t<this.m_manifold.m_pointCount;++t){var h=this.m_manifold.m_points[t];h.m_normalImpulse=0;h.m_tangentImpulse=0;for(var k=h.m_id,B=0;B<this.m_oldManifold.m_pointCount;++B){var r=
this.m_oldManifold.m_points[B];if(r.m_id.key==k.key){h.m_normalImpulse=r.m_normalImpulse;h.m_tangentImpulse=r.m_tangentImpulse;break}}}else this.m_manifold.m_pointCount=0;d!=c&&(f.SetAwake(!0),p.SetAwake(!0))}this.m_flags=d?this.m_flags|g.e_touchingFlag:this.m_flags&~g.e_touchingFlag;0==c&&1==d&&a.BeginContact(this);1==c&&0==d&&a.EndContact(this);0==(this.m_flags&g.e_sensorFlag)&&a.PreSolve(this,this.m_oldManifold)};g.prototype.Evaluate=function(){};g.prototype.ComputeTOI=function(a,c){g.s_input.proxyA.Set(this.m_fixtureA.GetShape());
g.s_input.proxyB.Set(this.m_fixtureB.GetShape());g.s_input.sweepA=a;g.s_input.sweepB=c;g.s_input.tolerance=L.b2_linearSlop;return p.TimeOfImpact(g.s_input)};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag=1;Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag=2;Box2D.Dynamics.Contacts.b2Contact.e_islandFlag=4;Box2D.Dynamics.Contacts.b2Contact.e_toiFlag=8;Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag=16;Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag=32;Box2D.Dynamics.Contacts.b2Contact.e_filterFlag=
64;Box2D.Dynamics.Contacts.b2Contact.s_input=new t});h.b2ContactConstraint=function(){this.localPlaneNormal=new I;this.localPoint=new I;this.normal=new I;this.normalMass=new D;this.K=new D};h.prototype.b2ContactConstraint=function(){this.points=new Vector2(L.b2_maxManifoldPoints);for(var a=0;a<L.b2_maxManifoldPoints;a++)this.points[a]=new k};k.b2ContactConstraintPoint=function(){this.localPoint=new I;this.rA=new I;this.rB=new I};l.b2ContactEdge=function(){};q.b2ContactFactory=function(){};q.prototype.b2ContactFactory=
function(a){this.m_allocator=a;this.InitializeRegisters()};q.prototype.AddType=function(a,c,d,e){void 0===d&&(d=0);void 0===e&&(e=0);this.m_registers[d][e].createFcn=a;this.m_registers[d][e].destroyFcn=c;this.m_registers[d][e].primary=!0;d!=e&&(this.m_registers[e][d].createFcn=a,this.m_registers[e][d].destroyFcn=c,this.m_registers[e][d].primary=!1)};q.prototype.InitializeRegisters=function(){this.m_registers=new Vector2(e.e_shapeTypeCount);for(var a=0;a<e.e_shapeTypeCount;a++){this.m_registers[a]=
new Vector2(e.e_shapeTypeCount);for(var c=0;c<e.e_shapeTypeCount;c++)this.m_registers[a][c]=new v}this.AddType(f.Create,f.Destroy,e.e_circleShape,e.e_circleShape);this.AddType(A.Create,A.Destroy,e.e_polygonShape,e.e_circleShape);this.AddType(C.Create,C.Destroy,e.e_polygonShape,e.e_polygonShape);this.AddType(r.Create,r.Destroy,e.e_edgeShape,e.e_circleShape);this.AddType(n.Create,n.Destroy,e.e_polygonShape,e.e_edgeShape)};q.prototype.Create=function(a,c){var d=parseInt(a.GetType()),e=parseInt(c.GetType()),
d=this.m_registers[d][e];if(d.pool)return e=d.pool,d.pool=e.m_next,d.poolCount--,e.Reset(a,c),e;e=d.createFcn;return null!=e?(d.primary?(e=e(this.m_allocator),e.Reset(a,c)):(e=e(this.m_allocator),e.Reset(c,a)),e):null};q.prototype.Destroy=function(a){0<a.m_manifold.m_pointCount&&(a.m_fixtureA.m_body.SetAwake(!0),a.m_fixtureB.m_body.SetAwake(!0));var c=parseInt(a.m_fixtureA.GetType()),d=parseInt(a.m_fixtureB.GetType()),c=this.m_registers[c][d];c.poolCount++;a.m_next=c.pool;c.pool=a;c=c.destroyFcn;
c(a,this.m_allocator)};v.b2ContactRegister=function(){};w.b2ContactResult=function(){this.position=new I;this.normal=new I;this.id=new O};y.b2ContactSolver=function(){this.m_step=new H;this.m_constraints=new Vector2};y.prototype.b2ContactSolver=function(){};y.prototype.Initialize=function(a,c,d,e){void 0===d&&(d=0);var f;this.m_step.Set(a);this.m_allocator=e;a=0;for(this.m_constraintCount=d;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new h;for(a=
0;a<d;++a){f=c[a];e=f.m_fixtureA;var g=f.m_fixtureB,p=e.m_shape.m_radius,t=g.m_shape.m_radius,k=e.m_body,B=g.m_body,r=f.GetManifold(),l=L.b2MixFriction(e.GetFriction(),g.GetFriction()),n=L.b2MixRestitution(e.GetRestitution(),g.GetRestitution()),w=k.m_linearVelocity.x,q=k.m_linearVelocity.y,v=B.m_linearVelocity.x,A=B.m_linearVelocity.y,z=k.m_angularVelocity,F=B.m_angularVelocity;L.b2Assert(0<r.m_pointCount);y.s_worldManifold.Initialize(r,k.m_xf,p,B.m_xf,t);g=y.s_worldManifold.m_normal.x;f=y.s_worldManifold.m_normal.y;
e=this.m_constraints[a];e.bodyA=k;e.bodyB=B;e.manifold=r;e.normal.x=g;e.normal.y=f;e.pointCount=r.m_pointCount;e.friction=l;e.restitution=n;e.localPlaneNormal.x=r.m_localPlaneNormal.x;e.localPlaneNormal.y=r.m_localPlaneNormal.y;e.localPoint.x=r.m_localPoint.x;e.localPoint.y=r.m_localPoint.y;e.radius=p+t;e.type=r.m_type;for(p=0;p<e.pointCount;++p){l=r.m_points[p];t=e.points[p];t.normalImpulse=l.m_normalImpulse;t.tangentImpulse=l.m_tangentImpulse;t.localPoint.SetV(l.m_localPoint);var l=t.rA.x=y.s_worldManifold.m_points[p].x-
k.m_sweep.c.x,n=t.rA.y=y.s_worldManifold.m_points[p].y-k.m_sweep.c.y,C=t.rB.x=y.s_worldManifold.m_points[p].x-B.m_sweep.c.x,D=t.rB.y=y.s_worldManifold.m_points[p].y-B.m_sweep.c.y,J=l*f-n*g,H=C*f-D*g,J=J*J,H=H*H;t.normalMass=1/(k.m_invMass+B.m_invMass+k.m_invI*J+B.m_invI*H);var I=k.m_mass*k.m_invMass+B.m_mass*B.m_invMass,I=I+(k.m_mass*k.m_invI*J+B.m_mass*B.m_invI*H);t.equalizedMass=1/I;H=f;I=-g;J=l*I-n*H;H=C*I-D*H;J*=J;H*=H;t.tangentMass=1/(k.m_invMass+B.m_invMass+k.m_invI*J+B.m_invI*H);t.velocityBias=
0;l=e.normal.x*(v+-F*D-w- -z*n)+e.normal.y*(A+F*C-q-z*l);l<-L.b2_velocityThreshold&&(t.velocityBias+=-e.restitution*l)}2==e.pointCount&&(A=e.points[0],v=e.points[1],r=k.m_invMass,k=k.m_invI,w=B.m_invMass,B=B.m_invI,q=A.rA.x*f-A.rA.y*g,A=A.rB.x*f-A.rB.y*g,z=v.rA.x*f-v.rA.y*g,v=v.rB.x*f-v.rB.y*g,g=r+w+k*q*q+B*A*A,f=r+w+k*z*z+B*v*v,B=r+w+k*q*z+B*A*v,g*g<100*(g*f-B*B)?(e.K.col1.Set(g,B),e.K.col2.Set(B,f),e.K.GetInverse(e.normalMass)):e.pointCount=1)}};y.prototype.InitVelocityConstraints=function(a){for(var c=
0;c<this.m_constraintCount;++c){var d=this.m_constraints[c],e=d.bodyA,f=d.bodyB,g=e.m_invMass,p=e.m_invI,t=f.m_invMass,h=f.m_invI,k=d.normal.x,B=d.normal.y,r=B,l=-k,n=0,y=0;if(a.warmStarting)for(y=d.pointCount,n=0;n<y;++n){var w=d.points[n];w.normalImpulse*=a.dtRatio;w.tangentImpulse*=a.dtRatio;var q=w.normalImpulse*k+w.tangentImpulse*r,v=w.normalImpulse*B+w.tangentImpulse*l;e.m_angularVelocity-=p*(w.rA.x*v-w.rA.y*q);e.m_linearVelocity.x-=g*q;e.m_linearVelocity.y-=g*v;f.m_angularVelocity+=h*(w.rB.x*
v-w.rB.y*q);f.m_linearVelocity.x+=t*q;f.m_linearVelocity.y+=t*v}else for(y=d.pointCount,n=0;n<y;++n)e=d.points[n],e.normalImpulse=0,e.tangentImpulse=0}};y.prototype.SolveVelocityConstraints=function(){for(var a=0,c,d=0,e=0,f=0,g=e=e=d=d=0,p=d=d=0,t=d=f=0,h=0,k,B=0;B<this.m_constraintCount;++B){var f=this.m_constraints[B],r=f.bodyA,l=f.bodyB,n=r.m_angularVelocity,y=l.m_angularVelocity,w=r.m_linearVelocity,q=l.m_linearVelocity,v=r.m_invMass,A=r.m_invI,z=l.m_invMass,F=l.m_invI,t=f.normal.x,C=h=f.normal.y;
k=-t;p=f.friction;for(a=0;a<f.pointCount;a++)c=f.points[a],d=q.x-y*c.rB.y-w.x+n*c.rA.y,e=q.y+y*c.rB.x-w.y-n*c.rA.x,d=d*C+e*k,d=c.tangentMass*-d,e=p*c.normalImpulse,e=N.Clamp(c.tangentImpulse+d,-e,e),d=e-c.tangentImpulse,g=d*C,d*=k,w.x-=v*g,w.y-=v*d,n-=A*(c.rA.x*d-c.rA.y*g),q.x+=z*g,q.y+=z*d,y+=F*(c.rB.x*d-c.rB.y*g),c.tangentImpulse=e;parseInt(f.pointCount);if(1==f.pointCount)c=f.points[0],d=q.x+-y*c.rB.y-w.x- -n*c.rA.y,e=q.y+y*c.rB.x-w.y-n*c.rA.x,f=d*t+e*h,d=-c.normalMass*(f-c.velocityBias),e=c.normalImpulse+
d,e=0<e?e:0,d=e-c.normalImpulse,g=d*t,d*=h,w.x-=v*g,w.y-=v*d,n-=A*(c.rA.x*d-c.rA.y*g),q.x+=z*g,q.y+=z*d,y+=F*(c.rB.x*d-c.rB.y*g),c.normalImpulse=e;else{c=f.points[0];var a=f.points[1],d=c.normalImpulse,p=a.normalImpulse,D=(q.x-y*c.rB.y-w.x+n*c.rA.y)*t+(q.y+y*c.rB.x-w.y-n*c.rA.x)*h,H=(q.x-y*a.rB.y-w.x+n*a.rA.y)*t+(q.y+y*a.rB.x-w.y-n*a.rA.x)*h,e=D-c.velocityBias,g=H-a.velocityBias;k=f.K;e-=k.col1.x*d+k.col2.x*p;for(g-=k.col1.y*d+k.col2.y*p;;){k=f.normalMass;C=-(k.col1.x*e+k.col2.x*g);k=-(k.col1.y*e+
k.col2.y*g);if(0<=C&&0<=k){d=C-d;p=k-p;f=d*t;d*=h;t*=p;h*=p;w.x-=v*(f+t);w.y-=v*(d+h);n-=A*(c.rA.x*d-c.rA.y*f+a.rA.x*h-a.rA.y*t);q.x+=z*(f+t);q.y+=z*(d+h);y+=F*(c.rB.x*d-c.rB.y*f+a.rB.x*h-a.rB.y*t);c.normalImpulse=C;a.normalImpulse=k;break}C=-c.normalMass*e;k=0;H=f.K.col1.y*C+g;if(0<=C&&0<=H){d=C-d;p=k-p;f=d*t;d*=h;t*=p;h*=p;w.x-=v*(f+t);w.y-=v*(d+h);n-=A*(c.rA.x*d-c.rA.y*f+a.rA.x*h-a.rA.y*t);q.x+=z*(f+t);q.y+=z*(d+h);y+=F*(c.rB.x*d-c.rB.y*f+a.rB.x*h-a.rB.y*t);c.normalImpulse=C;a.normalImpulse=k;
break}C=0;k=-a.normalMass*g;D=f.K.col2.x*k+e;if(0<=k&&0<=D){d=C-d;p=k-p;f=d*t;d*=h;t*=p;h*=p;w.x-=v*(f+t);w.y-=v*(d+h);n-=A*(c.rA.x*d-c.rA.y*f+a.rA.x*h-a.rA.y*t);q.x+=z*(f+t);q.y+=z*(d+h);y+=F*(c.rB.x*d-c.rB.y*f+a.rB.x*h-a.rB.y*t);c.normalImpulse=C;a.normalImpulse=k;break}k=C=0;D=e;H=g;if(0<=D&&0<=H){d=C-d;p=k-p;f=d*t;d*=h;t*=p;h*=p;w.x-=v*(f+t);w.y-=v*(d+h);n-=A*(c.rA.x*d-c.rA.y*f+a.rA.x*h-a.rA.y*t);q.x+=z*(f+t);q.y+=z*(d+h);y+=F*(c.rB.x*d-c.rB.y*f+a.rB.x*h-a.rB.y*t);c.normalImpulse=C;a.normalImpulse=
k;break}break}}r.m_angularVelocity=n;l.m_angularVelocity=y}};y.prototype.FinalizeVelocityConstraints=function(){for(var a=0;a<this.m_constraintCount;++a)for(var c=this.m_constraints[a],d=c.manifold,e=0;e<c.pointCount;++e){var f=d.m_points[e],g=c.points[e];f.m_normalImpulse=g.normalImpulse;f.m_tangentImpulse=g.tangentImpulse}};y.prototype.SolvePositionConstraints=function(a){void 0===a&&(a=0);for(var c=0,d=0;d<this.m_constraintCount;d++){var e=this.m_constraints[d],f=e.bodyA,g=e.bodyB,p=f.m_mass*f.m_invMass,
t=f.m_mass*f.m_invI,h=g.m_mass*g.m_invMass,k=g.m_mass*g.m_invI;y.s_psm.Initialize(e);for(var B=y.s_psm.m_normal,r=0;r<e.pointCount;r++){var n=e.points[r],l=y.s_psm.m_points[r],w=y.s_psm.m_separations[r],q=l.x-f.m_sweep.c.x,v=l.y-f.m_sweep.c.y,A=l.x-g.m_sweep.c.x,l=l.y-g.m_sweep.c.y,c=c<w?c:w,w=N.Clamp(a*(w+L.b2_linearSlop),-L.b2_maxLinearCorrection,0),w=-n.equalizedMass*w,n=w*B.x,w=w*B.y;f.m_sweep.c.x-=p*n;f.m_sweep.c.y-=p*w;f.m_sweep.a-=t*(q*w-v*n);f.SynchronizeTransform();g.m_sweep.c.x+=h*n;g.m_sweep.c.y+=
h*w;g.m_sweep.a+=k*(A*w-l*n);g.SynchronizeTransform()}}return c>-1.5*L.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new B;Box2D.Dynamics.Contacts.b2ContactSolver.s_psm=new F});Box2D.inherit(r,Box2D.Dynamics.Contacts.b2Contact);r.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;r.b2EdgeAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};r.Create=function(a){return new r};r.Destroy=function(a,
c){};r.prototype.Reset=function(a,c){this.__super.Reset.call(this,a,c)};r.prototype.Evaluate=function(){var d=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof c?this.m_fixtureA.GetShape():null,d.m_xf,this.m_fixtureB.GetShape()instanceof a?this.m_fixtureB.GetShape():null,e.m_xf)};r.prototype.b2CollideEdgeAndCircle=function(a,c,d,e,f){};Box2D.inherit(z,Box2D.Dynamics.Contacts.b2Contact);z.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;
z.b2NullContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};z.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)};z.prototype.Evaluate=function(){};Box2D.inherit(A,Box2D.Dynamics.Contacts.b2Contact);A.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;A.b2PolyAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};A.Create=function(a){return new A};A.Destroy=function(a,c){};A.prototype.Reset=function(a,
c){this.__super.Reset.call(this,a,c);L.b2Assert(a.GetType()==e.e_polygonShape);L.b2Assert(c.GetType()==e.e_circleShape)};A.prototype.Evaluate=function(){var c=this.m_fixtureA.m_body,e=this.m_fixtureB.m_body;K.CollidePolygonAndCircle(this.m_manifold,this.m_fixtureA.GetShape()instanceof d?this.m_fixtureA.GetShape():null,c.m_xf,this.m_fixtureB.GetShape()instanceof a?this.m_fixtureB.GetShape():null,e.m_xf)};Box2D.inherit(n,Box2D.Dynamics.Contacts.b2Contact);n.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;
n.b2PolyAndEdgeContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};n.Create=function(a){return new n};n.Destroy=function(a,c){};n.prototype.Reset=function(a,c){this.__super.Reset.call(this,a,c);L.b2Assert(a.GetType()==e.e_polygonShape);L.b2Assert(c.GetType()==e.e_edgeShape)};n.prototype.Evaluate=function(){var a=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,this.m_fixtureA.GetShape()instanceof d?this.m_fixtureA.GetShape():
null,a.m_xf,this.m_fixtureB.GetShape()instanceof c?this.m_fixtureB.GetShape():null,e.m_xf)};n.prototype.b2CollidePolyAndEdge=function(a,c,d,e,f){};Box2D.inherit(C,Box2D.Dynamics.Contacts.b2Contact);C.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;C.b2PolygonContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};C.Create=function(a){return new C};C.Destroy=function(a,c){};C.prototype.Reset=function(a,c){this.__super.Reset.call(this,a,c)};C.prototype.Evaluate=
function(){var a=this.m_fixtureA.GetBody(),c=this.m_fixtureB.GetBody();K.CollidePolygons(this.m_manifold,this.m_fixtureA.GetShape()instanceof d?this.m_fixtureA.GetShape():null,a.m_xf,this.m_fixtureB.GetShape()instanceof d?this.m_fixtureB.GetShape():null,c.m_xf)};F.b2PositionSolverManifold=function(){};F.prototype.b2PositionSolverManifold=function(){this.m_normal=new I;this.m_separations=new Vector_a2j_Number(L.b2_maxManifoldPoints);this.m_points=new Vector2(L.b2_maxManifoldPoints);for(var a=0;a<L.b2_maxManifoldPoints;a++)this.m_points[a]=
new I};F.prototype.Initialize=function(a){L.b2Assert(0<a.pointCount);var c=0,d=0,e=0,f,g=0,p=0;switch(a.type){case M.e_circles:f=a.bodyA.m_xf.R;e=a.localPoint;c=a.bodyA.m_xf.position.x+(f.col1.x*e.x+f.col2.x*e.y);d=a.bodyA.m_xf.position.y+(f.col1.y*e.x+f.col2.y*e.y);f=a.bodyB.m_xf.R;e=a.points[0].localPoint;g=a.bodyB.m_xf.position.x+(f.col1.x*e.x+f.col2.x*e.y);f=a.bodyB.m_xf.position.y+(f.col1.y*e.x+f.col2.y*e.y);var e=g-c,p=f-d,t=e*e+p*p;t>Number.MIN_VALUE*Number.MIN_VALUE?(t=Math.sqrt(t),this.m_normal.x=
e/t,this.m_normal.y=p/t):(this.m_normal.x=1,this.m_normal.y=0);this.m_points[0].x=.5*(c+g);this.m_points[0].y=.5*(d+f);this.m_separations[0]=e*this.m_normal.x+p*this.m_normal.y-a.radius;break;case M.e_faceA:f=a.bodyA.m_xf.R;e=a.localPlaneNormal;this.m_normal.x=f.col1.x*e.x+f.col2.x*e.y;this.m_normal.y=f.col1.y*e.x+f.col2.y*e.y;f=a.bodyA.m_xf.R;e=a.localPoint;g=a.bodyA.m_xf.position.x+(f.col1.x*e.x+f.col2.x*e.y);p=a.bodyA.m_xf.position.y+(f.col1.y*e.x+f.col2.y*e.y);f=a.bodyB.m_xf.R;for(c=0;c<a.pointCount;++c)e=
a.points[c].localPoint,d=a.bodyB.m_xf.position.x+(f.col1.x*e.x+f.col2.x*e.y),e=a.bodyB.m_xf.position.y+(f.col1.y*e.x+f.col2.y*e.y),this.m_separations[c]=(d-g)*this.m_normal.x+(e-p)*this.m_normal.y-a.radius,this.m_points[c].x=d,this.m_points[c].y=e;break;case M.e_faceB:f=a.bodyB.m_xf.R;e=a.localPlaneNormal;this.m_normal.x=f.col1.x*e.x+f.col2.x*e.y;this.m_normal.y=f.col1.y*e.x+f.col2.y*e.y;f=a.bodyB.m_xf.R;e=a.localPoint;g=a.bodyB.m_xf.position.x+(f.col1.x*e.x+f.col2.x*e.y);p=a.bodyB.m_xf.position.y+
(f.col1.y*e.x+f.col2.y*e.y);f=a.bodyA.m_xf.R;for(c=0;c<a.pointCount;++c)e=a.points[c].localPoint,d=a.bodyA.m_xf.position.x+(f.col1.x*e.x+f.col2.x*e.y),e=a.bodyA.m_xf.position.y+(f.col1.y*e.x+f.col2.y*e.y),this.m_separations[c]=(d-g)*this.m_normal.x+(e-p)*this.m_normal.y-a.radius,this.m_points[c].Set(d,e);this.m_normal.x*=-1;this.m_normal.y*=-1}};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new I;Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=
new I})})();
(function(){var a=Box2D.Common.Math.b2Mat22,c=Box2D.Common.Math.b2Math,d=Box2D.Common.Math.b2Vec2,e=Box2D.Common.b2Color,f=Box2D.Dynamics.Controllers.b2BuoyancyController,g=Box2D.Dynamics.Controllers.b2ConstantAccelController,h=Box2D.Dynamics.Controllers.b2ConstantForceController,k=Box2D.Dynamics.Controllers.b2Controller,l=Box2D.Dynamics.Controllers.b2ControllerEdge,q=Box2D.Dynamics.Controllers.b2GravityController,v=Box2D.Dynamics.Controllers.b2TensorDampingController;Box2D.inherit(f,Box2D.Dynamics.Controllers.b2Controller);
f.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;f.b2BuoyancyController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.normal=new d(0,-1);this.density=this.offset=0;this.velocity=new d(0,0);this.linearDrag=2;this.angularDrag=1;this.useDensity=!1;this.useWorldGravity=!0;this.gravity=null};f.prototype.Step=function(a){if(this.m_bodyList)for(this.useWorldGravity&&(this.gravity=this.GetWorld().GetGravity().Copy()),a=this.m_bodyList;a;a=
a.nextBody){var c=a.body;if(0!=c.IsAwake()){for(var e=new d,f=new d,g=0,h=0,k=c.GetFixtureList();k;k=k.GetNext()){var l=new d,q=k.GetShape().ComputeSubmergedArea(this.normal,this.offset,c.GetTransform(),l),g=g+q;e.x+=q*l.x;e.y+=q*l.y;var v=0,v=1,h=h+q*v;f.x+=q*l.x*v;f.y+=q*l.y*v}e.x/=g;e.y/=g;f.x/=h;f.y/=h;g<Number.MIN_VALUE||(h=this.gravity.GetNegative(),h.Multiply(this.density*g),c.ApplyForce(h,f),f=c.GetLinearVelocityFromWorldPoint(e),f.Subtract(this.velocity),f.Multiply(-this.linearDrag*g),c.ApplyForce(f,
e),c.ApplyTorque(-c.GetInertia()/c.GetMass()*g*c.GetAngularVelocity()*this.angularDrag))}}};f.prototype.Draw=function(a){var c=new d,f=new d;c.x=this.normal.x*this.offset+1E3*this.normal.y;c.y=this.normal.y*this.offset-1E3*this.normal.x;f.x=this.normal.x*this.offset-1E3*this.normal.y;f.y=this.normal.y*this.offset+1E3*this.normal.x;var g=new e(0,0,1);a.DrawSegment(c,f,g)};Box2D.inherit(g,Box2D.Dynamics.Controllers.b2Controller);g.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;
g.b2ConstantAccelController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.A=new d(0,0)};g.prototype.Step=function(a){a=new d(this.A.x*a.dt,this.A.y*a.dt);for(var c=this.m_bodyList;c;c=c.nextBody){var e=c.body;e.IsAwake()&&e.SetLinearVelocity(new d(e.GetLinearVelocity().x+a.x,e.GetLinearVelocity().y+a.y))}};Box2D.inherit(h,Box2D.Dynamics.Controllers.b2Controller);h.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;h.b2ConstantForceController=
function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.F=new d(0,0)};h.prototype.Step=function(a){for(a=this.m_bodyList;a;a=a.nextBody){var c=a.body;c.IsAwake()&&c.ApplyForce(this.F,c.GetWorldCenter())}};k.b2Controller=function(){};k.prototype.Step=function(a){};k.prototype.Draw=function(a){};k.prototype.AddBody=function(a){var c=new l;c.controller=this;c.body=a;c.nextBody=this.m_bodyList;c.prevBody=null;this.m_bodyList=c;c.nextBody&&(c.nextBody.prevBody=c);this.m_bodyCount++;
c.nextController=a.m_controllerList;c.prevController=null;a.m_controllerList=c;c.nextController&&(c.nextController.prevController=c);a.m_controllerCount++};k.prototype.RemoveBody=function(a){for(var c=a.m_controllerList;c&&c.controller!=this;)c=c.nextController;c.prevBody&&(c.prevBody.nextBody=c.nextBody);c.nextBody&&(c.nextBody.prevBody=c.prevBody);c.nextController&&(c.nextController.prevController=c.prevController);c.prevController&&(c.prevController.nextController=c.nextController);this.m_bodyList==
c&&(this.m_bodyList=c.nextBody);a.m_controllerList==c&&(a.m_controllerList=c.nextController);a.m_controllerCount--;this.m_bodyCount--};k.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body)};k.prototype.GetNext=function(){return this.m_next};k.prototype.GetWorld=function(){return this.m_world};k.prototype.GetBodyList=function(){return this.m_bodyList};l.b2ControllerEdge=function(){};Box2D.inherit(q,Box2D.Dynamics.Controllers.b2Controller);q.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;
q.b2GravityController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.G=1;this.invSqr=!0};q.prototype.Step=function(a){var c=a=null,e=null,f=0,g=null,h=null,k=null,l=0,q=0,v=0,l=null;if(this.invSqr)for(a=this.m_bodyList;a;a=a.nextBody)for(c=a.body,e=c.GetWorldCenter(),f=c.GetMass(),g=this.m_bodyList;g!=a;g=g.nextBody)h=g.body,k=h.GetWorldCenter(),l=k.x-e.x,q=k.y-e.y,v=l*l+q*q,v<Number.MIN_VALUE||(l=new d(l,q),l.Multiply(this.G/v/Math.sqrt(v)*f*h.GetMass()),
c.IsAwake()&&c.ApplyForce(l,e),l.Multiply(-1),h.IsAwake()&&h.ApplyForce(l,k));else for(a=this.m_bodyList;a;a=a.nextBody)for(c=a.body,e=c.GetWorldCenter(),f=c.GetMass(),g=this.m_bodyList;g!=a;g=g.nextBody)h=g.body,k=h.GetWorldCenter(),l=k.x-e.x,q=k.y-e.y,v=l*l+q*q,v<Number.MIN_VALUE||(l=new d(l,q),l.Multiply(this.G/v*f*h.GetMass()),c.IsAwake()&&c.ApplyForce(l,e),l.Multiply(-1),h.IsAwake()&&h.ApplyForce(l,k))};Box2D.inherit(v,Box2D.Dynamics.Controllers.b2Controller);v.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;
v.b2TensorDampingController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.T=new a;this.maxTimestep=0};v.prototype.SetAxisAligned=function(a,c){void 0===a&&(a=0);void 0===c&&(c=0);this.T.col1.x=-a;this.T.col1.y=0;this.T.col2.x=0;this.T.col2.y=-c;this.maxTimestep=0<a||0<c?1/Math.max(a,c):0};v.prototype.Step=function(a){a=a.dt;if(!(a<=Number.MIN_VALUE)){a>this.maxTimestep&&0<this.maxTimestep&&(a=this.maxTimestep);for(var e=this.m_bodyList;e;e=e.nextBody){var f=
e.body;if(f.IsAwake()){var g=f.GetWorldVector(c.MulMV(this.T,f.GetLocalVector(f.GetLinearVelocity())));f.SetLinearVelocity(new d(f.GetLinearVelocity().x+g.x*a,f.GetLinearVelocity().y+g.y*a))}}}}})();
(function(){var a=Box2D.Common.b2Settings,c=Box2D.Common.Math.b2Mat22,d=Box2D.Common.Math.b2Mat33,e=Box2D.Common.Math.b2Math,f=Box2D.Common.Math.b2Vec2,g=Box2D.Common.Math.b2Vec3,h=Box2D.Dynamics.Joints.b2DistanceJoint,k=Box2D.Dynamics.Joints.b2DistanceJointDef,l=Box2D.Dynamics.Joints.b2FrictionJoint,q=Box2D.Dynamics.Joints.b2FrictionJointDef,v=Box2D.Dynamics.Joints.b2GearJoint,w=Box2D.Dynamics.Joints.b2GearJointDef,y=Box2D.Dynamics.Joints.b2Jacobian,r=Box2D.Dynamics.Joints.b2Joint,z=Box2D.Dynamics.Joints.b2JointDef,
A=Box2D.Dynamics.Joints.b2JointEdge,n=Box2D.Dynamics.Joints.b2LineJoint,C=Box2D.Dynamics.Joints.b2LineJointDef,F=Box2D.Dynamics.Joints.b2MouseJoint,J=Box2D.Dynamics.Joints.b2MouseJointDef,H=Box2D.Dynamics.Joints.b2PrismaticJoint,L=Box2D.Dynamics.Joints.b2PrismaticJointDef,D=Box2D.Dynamics.Joints.b2PulleyJoint,N=Box2D.Dynamics.Joints.b2PulleyJointDef,I=Box2D.Dynamics.Joints.b2RevoluteJoint,K=Box2D.Dynamics.Joints.b2RevoluteJointDef,O=Box2D.Dynamics.Joints.b2WeldJoint,M=Box2D.Dynamics.Joints.b2WeldJointDef;
Box2D.inherit(h,Box2D.Dynamics.Joints.b2Joint);h.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;h.b2DistanceJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new f;this.m_localAnchor2=new f;this.m_u=new f};h.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};h.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};h.prototype.GetReactionForce=function(a){void 0===a&&(a=0);
return new f(a*this.m_impulse*this.m_u.x,a*this.m_impulse*this.m_u.y)};h.prototype.GetReactionTorque=function(a){return 0};h.prototype.GetLength=function(){return this.m_length};h.prototype.SetLength=function(a){void 0===a&&(a=0);this.m_length=a};h.prototype.GetFrequency=function(){return this.m_frequencyHz};h.prototype.SetFrequency=function(a){void 0===a&&(a=0);this.m_frequencyHz=a};h.prototype.GetDampingRatio=function(){return this.m_dampingRatio};h.prototype.SetDampingRatio=function(a){void 0===
a&&(a=0);this.m_dampingRatio=a};h.prototype.b2DistanceJoint=function(a){this.__super.b2Joint.call(this,a);this.m_localAnchor1.SetV(a.localAnchorA);this.m_localAnchor2.SetV(a.localAnchorB);this.m_length=a.length;this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_bias=this.m_gamma=this.m_impulse=0};h.prototype.InitVelocityConstraints=function(c){var d,e=0,f=this.m_bodyA,g=this.m_bodyB;d=f.m_xf.R;var h=this.m_localAnchor1.x-f.m_sweep.localCenter.x,k=this.m_localAnchor1.y-f.m_sweep.localCenter.y,
e=d.col1.x*h+d.col2.x*k,k=d.col1.y*h+d.col2.y*k,h=e;d=g.m_xf.R;var u=this.m_localAnchor2.x-g.m_sweep.localCenter.x,m=this.m_localAnchor2.y-g.m_sweep.localCenter.y,e=d.col1.x*u+d.col2.x*m,m=d.col1.y*u+d.col2.y*m,u=e;this.m_u.x=g.m_sweep.c.x+u-f.m_sweep.c.x-h;this.m_u.y=g.m_sweep.c.y+m-f.m_sweep.c.y-k;e=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);e>a.b2_linearSlop?this.m_u.Multiply(1/e):this.m_u.SetZero();d=h*this.m_u.y-k*this.m_u.x;var l=u*this.m_u.y-m*this.m_u.x;d=f.m_invMass+f.m_invI*
d*d+g.m_invMass+g.m_invI*l*l;this.m_mass=0!=d?1/d:0;if(0<this.m_frequencyHz){var e=e-this.m_length,l=2*Math.PI*this.m_frequencyHz,n=this.m_mass*l*l;this.m_gamma=c.dt*(2*this.m_mass*this.m_dampingRatio*l+c.dt*n);this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0;this.m_bias=e*c.dt*n*this.m_gamma;this.m_mass=d+this.m_gamma;this.m_mass=0!=this.m_mass?1/this.m_mass:0}c.warmStarting?(this.m_impulse*=c.dtRatio,c=this.m_impulse*this.m_u.x,d=this.m_impulse*this.m_u.y,f.m_linearVelocity.x-=f.m_invMass*c,f.m_linearVelocity.y-=
f.m_invMass*d,f.m_angularVelocity-=f.m_invI*(h*d-k*c),g.m_linearVelocity.x+=g.m_invMass*c,g.m_linearVelocity.y+=g.m_invMass*d,g.m_angularVelocity+=g.m_invI*(u*d-m*c)):this.m_impulse=0};h.prototype.SolveVelocityConstraints=function(a){var c;a=this.m_bodyA;var d=this.m_bodyB;c=a.m_xf.R;var e=this.m_localAnchor1.x-a.m_sweep.localCenter.x,f=this.m_localAnchor1.y-a.m_sweep.localCenter.y,g=c.col1.x*e+c.col2.x*f,f=c.col1.y*e+c.col2.y*f,e=g;c=d.m_xf.R;var h=this.m_localAnchor2.x-d.m_sweep.localCenter.x,k=
this.m_localAnchor2.y-d.m_sweep.localCenter.y,g=c.col1.x*h+c.col2.x*k,k=c.col1.y*h+c.col2.y*k,h=g,g=-this.m_mass*(this.m_u.x*(d.m_linearVelocity.x+-d.m_angularVelocity*k-(a.m_linearVelocity.x+-a.m_angularVelocity*f))+this.m_u.y*(d.m_linearVelocity.y+d.m_angularVelocity*h-(a.m_linearVelocity.y+a.m_angularVelocity*e))+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=g;c=g*this.m_u.x;g*=this.m_u.y;a.m_linearVelocity.x-=a.m_invMass*c;a.m_linearVelocity.y-=a.m_invMass*g;a.m_angularVelocity-=a.m_invI*
(e*g-f*c);d.m_linearVelocity.x+=d.m_invMass*c;d.m_linearVelocity.y+=d.m_invMass*g;d.m_angularVelocity+=d.m_invI*(h*g-k*c)};h.prototype.SolvePositionConstraints=function(c){var d;if(0<this.m_frequencyHz)return!0;c=this.m_bodyA;var f=this.m_bodyB;d=c.m_xf.R;var g=this.m_localAnchor1.x-c.m_sweep.localCenter.x,h=this.m_localAnchor1.y-c.m_sweep.localCenter.y,k=d.col1.x*g+d.col2.x*h,h=d.col1.y*g+d.col2.y*h,g=k;d=f.m_xf.R;var l=this.m_localAnchor2.x-f.m_sweep.localCenter.x,u=this.m_localAnchor2.y-f.m_sweep.localCenter.y,
k=d.col1.x*l+d.col2.x*u,u=d.col1.y*l+d.col2.y*u,l=k,k=f.m_sweep.c.x+l-c.m_sweep.c.x-g,m=f.m_sweep.c.y+u-c.m_sweep.c.y-h;d=Math.sqrt(k*k+m*m);k/=d;m/=d;d-=this.m_length;d=e.Clamp(d,-a.b2_maxLinearCorrection,a.b2_maxLinearCorrection);var n=-this.m_mass*d;this.m_u.Set(k,m);k=n*this.m_u.x;m=n*this.m_u.y;c.m_sweep.c.x-=c.m_invMass*k;c.m_sweep.c.y-=c.m_invMass*m;c.m_sweep.a-=c.m_invI*(g*m-h*k);f.m_sweep.c.x+=f.m_invMass*k;f.m_sweep.c.y+=f.m_invMass*m;f.m_sweep.a+=f.m_invI*(l*m-u*k);c.SynchronizeTransform();
f.SynchronizeTransform();return e.Abs(d)<a.b2_linearSlop};Box2D.inherit(k,Box2D.Dynamics.Joints.b2JointDef);k.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;k.b2DistanceJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new f;this.localAnchorB=new f};k.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this);this.type=r.e_distanceJoint;this.length=1;this.dampingRatio=this.frequencyHz=0};k.prototype.Initialize=function(a,
c,d,e){this.bodyA=a;this.bodyB=c;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(d));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(e));a=e.x-d.x;d=e.y-d.y;this.length=Math.sqrt(a*a+d*d);this.dampingRatio=this.frequencyHz=0};Box2D.inherit(l,Box2D.Dynamics.Joints.b2Joint);l.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;l.b2FrictionJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchorA=new f;this.m_localAnchorB=new f;this.m_linearMass=new c;this.m_linearImpulse=
new f};l.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)};l.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)};l.prototype.GetReactionForce=function(a){void 0===a&&(a=0);return new f(a*this.m_linearImpulse.x,a*this.m_linearImpulse.y)};l.prototype.GetReactionTorque=function(a){void 0===a&&(a=0);return a*this.m_angularImpulse};l.prototype.SetMaxForce=function(a){void 0===a&&(a=0);this.m_maxForce=a};l.prototype.GetMaxForce=function(){return this.m_maxForce};
l.prototype.SetMaxTorque=function(a){void 0===a&&(a=0);this.m_maxTorque=a};l.prototype.GetMaxTorque=function(){return this.m_maxTorque};l.prototype.b2FrictionJoint=function(a){this.__super.b2Joint.call(this,a);this.m_localAnchorA.SetV(a.localAnchorA);this.m_localAnchorB.SetV(a.localAnchorB);this.m_linearMass.SetZero();this.m_angularMass=0;this.m_linearImpulse.SetZero();this.m_angularImpulse=0;this.m_maxForce=a.maxForce;this.m_maxTorque=a.maxTorque};l.prototype.InitVelocityConstraints=function(a){var d,
e=0,f=this.m_bodyA,g=this.m_bodyB;d=f.m_xf.R;var h=this.m_localAnchorA.x-f.m_sweep.localCenter.x,k=this.m_localAnchorA.y-f.m_sweep.localCenter.y,e=d.col1.x*h+d.col2.x*k,k=d.col1.y*h+d.col2.y*k,h=e;d=g.m_xf.R;var u=this.m_localAnchorB.x-g.m_sweep.localCenter.x,m=this.m_localAnchorB.y-g.m_sweep.localCenter.y,e=d.col1.x*u+d.col2.x*m,m=d.col1.y*u+d.col2.y*m,u=e;d=f.m_invMass;var e=g.m_invMass,l=f.m_invI,n=g.m_invI,r=new c;r.col1.x=d+e;r.col2.x=0;r.col1.y=0;r.col2.y=d+e;r.col1.x+=l*k*k;r.col2.x+=-l*h*
k;r.col1.y+=-l*h*k;r.col2.y+=l*h*h;r.col1.x+=n*m*m;r.col2.x+=-n*u*m;r.col1.y+=-n*u*m;r.col2.y+=n*u*u;r.GetInverse(this.m_linearMass);this.m_angularMass=l+n;0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass);a.warmStarting?(this.m_linearImpulse.x*=a.dtRatio,this.m_linearImpulse.y*=a.dtRatio,this.m_angularImpulse*=a.dtRatio,a=this.m_linearImpulse,f.m_linearVelocity.x-=d*a.x,f.m_linearVelocity.y-=d*a.y,f.m_angularVelocity-=l*(h*a.y-k*a.x+this.m_angularImpulse),g.m_linearVelocity.x+=e*a.x,
g.m_linearVelocity.y+=e*a.y,g.m_angularVelocity+=n*(u*a.y-m*a.x+this.m_angularImpulse)):(this.m_linearImpulse.SetZero(),this.m_angularImpulse=0)};l.prototype.SolveVelocityConstraints=function(a){var c,d=0,g=this.m_bodyA,h=this.m_bodyB,k=g.m_linearVelocity,l=g.m_angularVelocity,u=h.m_linearVelocity,m=h.m_angularVelocity,r=g.m_invMass,n=h.m_invMass,q=g.m_invI,v=h.m_invI;c=g.m_xf.R;var w=this.m_localAnchorA.x-g.m_sweep.localCenter.x,y=this.m_localAnchorA.y-g.m_sweep.localCenter.y,d=c.col1.x*w+c.col2.x*
y,y=c.col1.y*w+c.col2.y*y,w=d;c=h.m_xf.R;var A=this.m_localAnchorB.x-h.m_sweep.localCenter.x,z=this.m_localAnchorB.y-h.m_sweep.localCenter.y,d=c.col1.x*A+c.col2.x*z,z=c.col1.y*A+c.col2.y*z,A=d;c=0;var d=-this.m_angularMass*(m-l),C=this.m_angularImpulse;c=a.dt*this.m_maxTorque;this.m_angularImpulse=e.Clamp(this.m_angularImpulse+d,-c,c);d=this.m_angularImpulse-C;l-=q*d;m+=v*d;c=e.MulMV(this.m_linearMass,new f(-(u.x-m*z-k.x+l*y),-(u.y+m*A-k.y-l*w)));d=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(c);
c=a.dt*this.m_maxForce;this.m_linearImpulse.LengthSquared()>c*c&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Multiply(c));c=e.SubtractVV(this.m_linearImpulse,d);k.x-=r*c.x;k.y-=r*c.y;l-=q*(w*c.y-y*c.x);u.x+=n*c.x;u.y+=n*c.y;m+=v*(A*c.y-z*c.x);g.m_angularVelocity=l;h.m_angularVelocity=m};l.prototype.SolvePositionConstraints=function(a){return!0};Box2D.inherit(q,Box2D.Dynamics.Joints.b2JointDef);q.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;q.b2FrictionJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,
arguments);this.localAnchorA=new f;this.localAnchorB=new f};q.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this);this.type=r.e_frictionJoint;this.maxTorque=this.maxForce=0};q.prototype.Initialize=function(a,c,d){this.bodyA=a;this.bodyB=c;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(d));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(d))};Box2D.inherit(v,Box2D.Dynamics.Joints.b2Joint);v.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;v.b2GearJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,
arguments);this.m_groundAnchor1=new f;this.m_groundAnchor2=new f;this.m_localAnchor1=new f;this.m_localAnchor2=new f;this.m_J=new y};v.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};v.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};v.prototype.GetReactionForce=function(a){void 0===a&&(a=0);return new f(a*this.m_impulse*this.m_J.linearB.x,a*this.m_impulse*this.m_J.linearB.y)};v.prototype.GetReactionTorque=function(a){void 0===
a&&(a=0);var c=this.m_bodyB.m_xf.R,d=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,e=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*e;return a*(this.m_impulse*this.m_J.angularB-f*this.m_impulse*this.m_J.linearB.y+e*this.m_impulse*this.m_J.linearB.x)};v.prototype.GetRatio=function(){return this.m_ratio};v.prototype.SetRatio=function(a){void 0===a&&(a=0);this.m_ratio=a};v.prototype.b2GearJoint=function(a){this.__super.b2Joint.call(this,
a);var c=parseInt(a.joint1.m_type),d=parseInt(a.joint2.m_type);this.m_prismatic2=this.m_revolute2=this.m_prismatic1=this.m_revolute1=null;var e=0,f=0;this.m_ground1=a.joint1.GetBodyA();this.m_bodyA=a.joint1.GetBodyB();c==r.e_revoluteJoint?(this.m_revolute1=a.joint1 instanceof I?a.joint1:null,this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2),e=this.m_revolute1.GetJointAngle()):(this.m_prismatic1=a.joint1 instanceof H?a.joint1:null,
this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2),e=this.m_prismatic1.GetJointTranslation());this.m_ground2=a.joint2.GetBodyA();this.m_bodyB=a.joint2.GetBodyB();d==r.e_revoluteJoint?(this.m_revolute2=a.joint2 instanceof I?a.joint2:null,this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2),f=this.m_revolute2.GetJointAngle()):(this.m_prismatic2=a.joint2 instanceof H?a.joint2:
null,this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2),f=this.m_prismatic2.GetJointTranslation());this.m_ratio=a.ratio;this.m_constant=e+this.m_ratio*f;this.m_impulse=0};v.prototype.InitVelocityConstraints=function(a){var c=this.m_ground1,d=this.m_ground2,e=this.m_bodyA,f=this.m_bodyB,g=0,h=0,k=0,m=0,l=k=0,r=0;this.m_J.SetZero();this.m_revolute1?(this.m_J.angularA=-1,r+=e.m_invI):(c=c.m_xf.R,h=this.m_prismatic1.m_localXAxis1,g=c.col1.x*
h.x+c.col2.x*h.y,h=c.col1.y*h.x+c.col2.y*h.y,c=e.m_xf.R,k=this.m_localAnchor1.x-e.m_sweep.localCenter.x,m=this.m_localAnchor1.y-e.m_sweep.localCenter.y,l=c.col1.x*k+c.col2.x*m,m=c.col1.y*k+c.col2.y*m,k=l*h-m*g,this.m_J.linearA.Set(-g,-h),this.m_J.angularA=-k,r+=e.m_invMass+e.m_invI*k*k);this.m_revolute2?(this.m_J.angularB=-this.m_ratio,r+=this.m_ratio*this.m_ratio*f.m_invI):(c=d.m_xf.R,h=this.m_prismatic2.m_localXAxis1,g=c.col1.x*h.x+c.col2.x*h.y,h=c.col1.y*h.x+c.col2.y*h.y,c=f.m_xf.R,k=this.m_localAnchor2.x-
f.m_sweep.localCenter.x,m=this.m_localAnchor2.y-f.m_sweep.localCenter.y,l=c.col1.x*k+c.col2.x*m,m=c.col1.y*k+c.col2.y*m,k=l*h-m*g,this.m_J.linearB.Set(-this.m_ratio*g,-this.m_ratio*h),this.m_J.angularB=-this.m_ratio*k,r+=this.m_ratio*this.m_ratio*(f.m_invMass+f.m_invI*k*k));this.m_mass=0<r?1/r:0;a.warmStarting?(e.m_linearVelocity.x+=e.m_invMass*this.m_impulse*this.m_J.linearA.x,e.m_linearVelocity.y+=e.m_invMass*this.m_impulse*this.m_J.linearA.y,e.m_angularVelocity+=e.m_invI*this.m_impulse*this.m_J.angularA,
f.m_linearVelocity.x+=f.m_invMass*this.m_impulse*this.m_J.linearB.x,f.m_linearVelocity.y+=f.m_invMass*this.m_impulse*this.m_J.linearB.y,f.m_angularVelocity+=f.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0};v.prototype.SolveVelocityConstraints=function(a){a=this.m_bodyA;var c=this.m_bodyB,d=this.m_J.Compute(a.m_linearVelocity,a.m_angularVelocity,c.m_linearVelocity,c.m_angularVelocity),d=-this.m_mass*d;this.m_impulse+=d;a.m_linearVelocity.x+=a.m_invMass*d*this.m_J.linearA.x;a.m_linearVelocity.y+=
a.m_invMass*d*this.m_J.linearA.y;a.m_angularVelocity+=a.m_invI*d*this.m_J.angularA;c.m_linearVelocity.x+=c.m_invMass*d*this.m_J.linearB.x;c.m_linearVelocity.y+=c.m_invMass*d*this.m_J.linearB.y;c.m_angularVelocity+=c.m_invI*d*this.m_J.angularB};v.prototype.SolvePositionConstraints=function(c){c=this.m_bodyA;var d=this.m_bodyB,e=0,f=0,e=this.m_revolute1?this.m_revolute1.GetJointAngle():this.m_prismatic1.GetJointTranslation(),f=this.m_revolute2?this.m_revolute2.GetJointAngle():this.m_prismatic2.GetJointTranslation(),
e=-this.m_mass*(this.m_constant-(e+this.m_ratio*f));c.m_sweep.c.x+=c.m_invMass*e*this.m_J.linearA.x;c.m_sweep.c.y+=c.m_invMass*e*this.m_J.linearA.y;c.m_sweep.a+=c.m_invI*e*this.m_J.angularA;d.m_sweep.c.x+=d.m_invMass*e*this.m_J.linearB.x;d.m_sweep.c.y+=d.m_invMass*e*this.m_J.linearB.y;d.m_sweep.a+=d.m_invI*e*this.m_J.angularB;c.SynchronizeTransform();d.SynchronizeTransform();return 0<a.b2_linearSlop};Box2D.inherit(w,Box2D.Dynamics.Joints.b2JointDef);w.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;
w.b2GearJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)};w.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this);this.type=r.e_gearJoint;this.joint2=this.joint1=null;this.ratio=1};y.b2Jacobian=function(){this.linearA=new f;this.linearB=new f};y.prototype.SetZero=function(){this.linearA.SetZero();this.angularA=0;this.linearB.SetZero();this.angularB=0};y.prototype.Set=function(a,c,d,e){void 0===c&&(c=0);void 0===e&&(e=0);this.linearA.SetV(a);this.angularA=
c;this.linearB.SetV(d);this.angularB=e};y.prototype.Compute=function(a,c,d,e){void 0===c&&(c=0);void 0===e&&(e=0);return this.linearA.x*a.x+this.linearA.y*a.y+this.angularA*c+(this.linearB.x*d.x+this.linearB.y*d.y)+this.angularB*e};r.b2Joint=function(){this.m_edgeA=new A;this.m_edgeB=new A;this.m_localCenterA=new f;this.m_localCenterB=new f};r.prototype.GetType=function(){return this.m_type};r.prototype.GetAnchorA=function(){return null};r.prototype.GetAnchorB=function(){return null};r.prototype.GetReactionForce=
function(a){return null};r.prototype.GetReactionTorque=function(a){return 0};r.prototype.GetBodyA=function(){return this.m_bodyA};r.prototype.GetBodyB=function(){return this.m_bodyB};r.prototype.GetNext=function(){return this.m_next};r.prototype.GetUserData=function(){return this.m_userData};r.prototype.SetUserData=function(a){this.m_userData=a};r.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()};r.Create=function(a,c){var d=null;switch(a.type){case r.e_distanceJoint:d=
new h(a instanceof k?a:null);break;case r.e_mouseJoint:d=new F(a instanceof J?a:null);break;case r.e_prismaticJoint:d=new H(a instanceof L?a:null);break;case r.e_revoluteJoint:d=new I(a instanceof K?a:null);break;case r.e_pulleyJoint:d=new D(a instanceof N?a:null);break;case r.e_gearJoint:d=new v(a instanceof w?a:null);break;case r.e_lineJoint:d=new n(a instanceof C?a:null);break;case r.e_weldJoint:d=new O(a instanceof M?a:null);break;case r.e_frictionJoint:d=new l(a instanceof q?a:null)}return d};
r.Destroy=function(a,c){};r.prototype.b2Joint=function(c){a.b2Assert(c.bodyA!=c.bodyB);this.m_type=c.type;this.m_next=this.m_prev=null;this.m_bodyA=c.bodyA;this.m_bodyB=c.bodyB;this.m_collideConnected=c.collideConnected;this.m_islandFlag=!1;this.m_userData=c.userData};r.prototype.InitVelocityConstraints=function(a){};r.prototype.SolveVelocityConstraints=function(a){};r.prototype.FinalizeVelocityConstraints=function(){};r.prototype.SolvePositionConstraints=function(a){return!1};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2Joint.e_unknownJoint=
0;Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint=1;Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint=2;Box2D.Dynamics.Joints.b2Joint.e_distanceJoint=3;Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint=4;Box2D.Dynamics.Joints.b2Joint.e_mouseJoint=5;Box2D.Dynamics.Joints.b2Joint.e_gearJoint=6;Box2D.Dynamics.Joints.b2Joint.e_lineJoint=7;Box2D.Dynamics.Joints.b2Joint.e_weldJoint=8;Box2D.Dynamics.Joints.b2Joint.e_frictionJoint=9;Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit=0;Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit=
1;Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit=2;Box2D.Dynamics.Joints.b2Joint.e_equalLimits=3});z.b2JointDef=function(){};z.prototype.b2JointDef=function(){this.type=r.e_unknownJoint;this.bodyB=this.bodyA=this.userData=null;this.collideConnected=!1};A.b2JointEdge=function(){};Box2D.inherit(n,Box2D.Dynamics.Joints.b2Joint);n.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;n.b2LineJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new f;this.m_localAnchor2=
new f;this.m_localXAxis1=new f;this.m_localYAxis1=new f;this.m_axis=new f;this.m_perp=new f;this.m_K=new c;this.m_impulse=new f};n.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};n.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};n.prototype.GetReactionForce=function(a){void 0===a&&(a=0);return new f(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+
(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))};n.prototype.GetReactionTorque=function(a){void 0===a&&(a=0);return a*this.m_impulse.y};n.prototype.GetJointTranslation=function(){var a=this.m_bodyA,c=this.m_bodyB,d=a.GetWorldPoint(this.m_localAnchor1),e=c.GetWorldPoint(this.m_localAnchor2),c=e.x-d.x,d=e.y-d.y,a=a.GetWorldVector(this.m_localXAxis1);return a.x*c+a.y*d};n.prototype.GetJointSpeed=function(){var a=this.m_bodyA,c=this.m_bodyB,d;d=a.m_xf.R;var e=this.m_localAnchor1.x-a.m_sweep.localCenter.x,
f=this.m_localAnchor1.y-a.m_sweep.localCenter.y,g=d.col1.x*e+d.col2.x*f,f=d.col1.y*e+d.col2.y*f,e=g;d=c.m_xf.R;var h=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,g=d.col1.x*h+d.col2.x*k,k=d.col1.y*h+d.col2.y*k,h=g;d=c.m_sweep.c.x+h-(a.m_sweep.c.x+e);var g=c.m_sweep.c.y+k-(a.m_sweep.c.y+f),m=a.GetWorldVector(this.m_localXAxis1),l=a.m_linearVelocity,r=c.m_linearVelocity,a=a.m_angularVelocity,c=c.m_angularVelocity;return d*-a*m.y+g*a*m.x+(m.x*(r.x+-c*
k-l.x- -a*f)+m.y*(r.y+c*h-l.y-a*e))};n.prototype.IsLimitEnabled=function(){return this.m_enableLimit};n.prototype.EnableLimit=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableLimit=a};n.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};n.prototype.GetUpperLimit=function(){return this.m_upperTranslation};n.prototype.SetLimits=function(a,c){void 0===a&&(a=0);void 0===c&&(c=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_lowerTranslation=a;this.m_upperTranslation=
c};n.prototype.IsMotorEnabled=function(){return this.m_enableMotor};n.prototype.EnableMotor=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=a};n.prototype.SetMotorSpeed=function(a){void 0===a&&(a=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=a};n.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};n.prototype.SetMaxMotorForce=function(a){void 0===a&&(a=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorForce=
a};n.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce};n.prototype.GetMotorForce=function(){return this.m_motorImpulse};n.prototype.b2LineJoint=function(a){this.__super.b2Joint.call(this,a);this.m_localAnchor1.SetV(a.localAnchorA);this.m_localAnchor2.SetV(a.localAnchorB);this.m_localXAxis1.SetV(a.localAxisA);this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_impulse.SetZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=a.lowerTranslation;
this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=r.e_inactiveLimit;this.m_axis.SetZero();this.m_perp.SetZero()};n.prototype.InitVelocityConstraints=function(c){var d=this.m_bodyA,f=this.m_bodyB,g,h=0;this.m_localCenterA.SetV(d.GetLocalCenter());this.m_localCenterB.SetV(f.GetLocalCenter());var k=d.GetTransform();f.GetTransform();g=d.m_xf.R;var l=this.m_localAnchor1.x-
this.m_localCenterA.x,u=this.m_localAnchor1.y-this.m_localCenterA.y,h=g.col1.x*l+g.col2.x*u,u=g.col1.y*l+g.col2.y*u,l=h;g=f.m_xf.R;var m=this.m_localAnchor2.x-this.m_localCenterB.x,n=this.m_localAnchor2.y-this.m_localCenterB.y,h=g.col1.x*m+g.col2.x*n,n=g.col1.y*m+g.col2.y*n,m=h;g=f.m_sweep.c.x+m-d.m_sweep.c.x-l;h=f.m_sweep.c.y+n-d.m_sweep.c.y-u;this.m_invMassA=d.m_invMass;this.m_invMassB=f.m_invMass;this.m_invIA=d.m_invI;this.m_invIB=f.m_invI;this.m_axis.SetV(e.MulMV(k.R,this.m_localXAxis1));this.m_a1=
(g+l)*this.m_axis.y-(h+u)*this.m_axis.x;this.m_a2=m*this.m_axis.y-n*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0;this.m_perp.SetV(e.MulMV(k.R,this.m_localYAxis1));this.m_s1=(g+l)*this.m_perp.y-(h+u)*this.m_perp.x;this.m_s2=m*this.m_perp.y-n*this.m_perp.x;k=this.m_invMassA;l=this.m_invMassB;u=this.m_invIA;m=this.m_invIB;this.m_K.col1.x=k+l+u*this.m_s1*
this.m_s1+m*this.m_s2*this.m_s2;this.m_K.col1.y=u*this.m_s1*this.m_a1+m*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=k+l+u*this.m_a1*this.m_a1+m*this.m_a2*this.m_a2;this.m_enableLimit?(g=this.m_axis.x*g+this.m_axis.y*h,e.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*a.b2_linearSlop?this.m_limitState=r.e_equalLimits:g<=this.m_lowerTranslation?this.m_limitState!=r.e_atLowerLimit&&(this.m_limitState=r.e_atLowerLimit,this.m_impulse.y=0):g>=this.m_upperTranslation?this.m_limitState!=
r.e_atUpperLimit&&(this.m_limitState=r.e_atUpperLimit,this.m_impulse.y=0):(this.m_limitState=r.e_inactiveLimit,this.m_impulse.y=0)):this.m_limitState=r.e_inactiveLimit;0==this.m_enableMotor&&(this.m_motorImpulse=0);c.warmStarting?(this.m_impulse.x*=c.dtRatio,this.m_impulse.y*=c.dtRatio,this.m_motorImpulse*=c.dtRatio,c=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,g=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,h=this.m_impulse.x*
this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,k=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2,d.m_linearVelocity.x-=this.m_invMassA*c,d.m_linearVelocity.y-=this.m_invMassA*g,d.m_angularVelocity-=this.m_invIA*h,f.m_linearVelocity.x+=this.m_invMassB*c,f.m_linearVelocity.y+=this.m_invMassB*g,f.m_angularVelocity+=this.m_invIB*k):(this.m_impulse.SetZero(),this.m_motorImpulse=0)};n.prototype.SolveVelocityConstraints=function(a){var c=this.m_bodyA,d=this.m_bodyB,
g=c.m_linearVelocity,h=c.m_angularVelocity,k=d.m_linearVelocity,l=d.m_angularVelocity,u=0,m=0,n=0,q=0;this.m_enableMotor&&this.m_limitState!=r.e_equalLimits&&(q=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(k.x-g.x)+this.m_axis.y*(k.y-g.y)+this.m_a2*l-this.m_a1*h)),u=this.m_motorImpulse,m=a.dt*this.m_maxMotorForce,this.m_motorImpulse=e.Clamp(this.m_motorImpulse+q,-m,m),q=this.m_motorImpulse-u,u=q*this.m_axis.x,m=q*this.m_axis.y,n=q*this.m_a1,q*=this.m_a2,g.x-=this.m_invMassA*u,g.y-=this.m_invMassA*
m,h-=this.m_invIA*n,k.x+=this.m_invMassB*u,k.y+=this.m_invMassB*m,l+=this.m_invIB*q);m=this.m_perp.x*(k.x-g.x)+this.m_perp.y*(k.y-g.y)+this.m_s2*l-this.m_s1*h;this.m_enableLimit&&this.m_limitState!=r.e_inactiveLimit?(n=this.m_axis.x*(k.x-g.x)+this.m_axis.y*(k.y-g.y)+this.m_a2*l-this.m_a1*h,u=this.m_impulse.Copy(),a=this.m_K.Solve(new f,-m,-n),this.m_impulse.Add(a),this.m_limitState==r.e_atLowerLimit?this.m_impulse.y=e.Max(this.m_impulse.y,0):this.m_limitState==r.e_atUpperLimit&&(this.m_impulse.y=
e.Min(this.m_impulse.y,0)),m=-m-(this.m_impulse.y-u.y)*this.m_K.col2.x,n=0,n=0!=this.m_K.col1.x?m/this.m_K.col1.x+u.x:u.x,this.m_impulse.x=n,a.x=this.m_impulse.x-u.x,a.y=this.m_impulse.y-u.y,u=a.x*this.m_perp.x+a.y*this.m_axis.x,m=a.x*this.m_perp.y+a.y*this.m_axis.y,n=a.x*this.m_s1+a.y*this.m_a1,q=a.x*this.m_s2+a.y*this.m_a2):(a=0,a=0!=this.m_K.col1.x?-m/this.m_K.col1.x:0,this.m_impulse.x+=a,u=a*this.m_perp.x,m=a*this.m_perp.y,n=a*this.m_s1,q=a*this.m_s2);g.x-=this.m_invMassA*u;g.y-=this.m_invMassA*
m;h-=this.m_invIA*n;k.x+=this.m_invMassB*u;k.y+=this.m_invMassB*m;l+=this.m_invIB*q;c.m_linearVelocity.SetV(g);c.m_angularVelocity=h;d.m_linearVelocity.SetV(k);d.m_angularVelocity=l};n.prototype.SolvePositionConstraints=function(d){d=this.m_bodyA;var g=this.m_bodyB,h=d.m_sweep.c,k=d.m_sweep.a,l=g.m_sweep.c,n=g.m_sweep.a,r,u=0,m=0,q=0,v=0,w=r=0,y=0,m=!1,A=0,z=c.FromAngle(k),q=c.FromAngle(n);r=z;var y=this.m_localAnchor1.x-this.m_localCenterA.x,C=this.m_localAnchor1.y-this.m_localCenterA.y,u=r.col1.x*
y+r.col2.x*C,C=r.col1.y*y+r.col2.y*C,y=u;r=q;q=this.m_localAnchor2.x-this.m_localCenterB.x;v=this.m_localAnchor2.y-this.m_localCenterB.y;u=r.col1.x*q+r.col2.x*v;v=r.col1.y*q+r.col2.y*v;q=u;r=l.x+q-h.x-y;u=l.y+v-h.y-C;if(this.m_enableLimit){this.m_axis=e.MulMV(z,this.m_localXAxis1);this.m_a1=(r+y)*this.m_axis.y-(u+C)*this.m_axis.x;this.m_a2=q*this.m_axis.y-v*this.m_axis.x;var D=this.m_axis.x*r+this.m_axis.y*u;e.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*a.b2_linearSlop?(A=e.Clamp(D,-a.b2_maxLinearCorrection,
a.b2_maxLinearCorrection),w=e.Abs(D),m=!0):D<=this.m_lowerTranslation?(A=e.Clamp(D-this.m_lowerTranslation+a.b2_linearSlop,-a.b2_maxLinearCorrection,0),w=this.m_lowerTranslation-D,m=!0):D>=this.m_upperTranslation&&(A=e.Clamp(D-this.m_upperTranslation+a.b2_linearSlop,0,a.b2_maxLinearCorrection),w=D-this.m_upperTranslation,m=!0)}this.m_perp=e.MulMV(z,this.m_localYAxis1);this.m_s1=(r+y)*this.m_perp.y-(u+C)*this.m_perp.x;this.m_s2=q*this.m_perp.y-v*this.m_perp.x;z=new f;C=this.m_perp.x*r+this.m_perp.y*
u;w=e.Max(w,e.Abs(C));y=0;m?(m=this.m_invMassA,q=this.m_invMassB,v=this.m_invIA,r=this.m_invIB,this.m_K.col1.x=m+q+v*this.m_s1*this.m_s1+r*this.m_s2*this.m_s2,this.m_K.col1.y=v*this.m_s1*this.m_a1+r*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=m+q+v*this.m_a1*this.m_a1+r*this.m_a2*this.m_a2,this.m_K.Solve(z,-C,-A)):(m=this.m_invMassA,q=this.m_invMassB,v=this.m_invIA,r=this.m_invIB,A=m+q+v*this.m_s1*this.m_s1+r*this.m_s2*this.m_s2,z.x=0!=A?-C/A:0,z.y=0);A=z.x*this.m_perp.x+z.y*
this.m_axis.x;m=z.x*this.m_perp.y+z.y*this.m_axis.y;C=z.x*this.m_s1+z.y*this.m_a1;z=z.x*this.m_s2+z.y*this.m_a2;h.x-=this.m_invMassA*A;h.y-=this.m_invMassA*m;k-=this.m_invIA*C;l.x+=this.m_invMassB*A;l.y+=this.m_invMassB*m;n+=this.m_invIB*z;d.m_sweep.a=k;g.m_sweep.a=n;d.SynchronizeTransform();g.SynchronizeTransform();return w<=a.b2_linearSlop&&y<=a.b2_angularSlop};Box2D.inherit(C,Box2D.Dynamics.Joints.b2JointDef);C.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;C.b2LineJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,
arguments);this.localAnchorA=new f;this.localAnchorB=new f;this.localAxisA=new f};C.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this);this.type=r.e_lineJoint;this.localAxisA.Set(1,0);this.enableLimit=!1;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=!1;this.motorSpeed=this.maxMotorForce=0};C.prototype.Initialize=function(a,c,d,e){this.bodyA=a;this.bodyB=c;this.localAnchorA=this.bodyA.GetLocalPoint(d);this.localAnchorB=this.bodyB.GetLocalPoint(d);this.localAxisA=
this.bodyA.GetLocalVector(e)};Box2D.inherit(F,Box2D.Dynamics.Joints.b2Joint);F.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;F.b2MouseJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.K=new c;this.K1=new c;this.K2=new c;this.m_localAnchor=new f;this.m_target=new f;this.m_impulse=new f;this.m_mass=new c;this.m_C=new f};F.prototype.GetAnchorA=function(){return this.m_target};F.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)};
F.prototype.GetReactionForce=function(a){void 0===a&&(a=0);return new f(a*this.m_impulse.x,a*this.m_impulse.y)};F.prototype.GetReactionTorque=function(a){return 0};F.prototype.GetTarget=function(){return this.m_target};F.prototype.SetTarget=function(a){0==this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0);this.m_target=a};F.prototype.GetMaxForce=function(){return this.m_maxForce};F.prototype.SetMaxForce=function(a){void 0===a&&(a=0);this.m_maxForce=a};F.prototype.GetFrequency=function(){return this.m_frequencyHz};
F.prototype.SetFrequency=function(a){void 0===a&&(a=0);this.m_frequencyHz=a};F.prototype.GetDampingRatio=function(){return this.m_dampingRatio};F.prototype.SetDampingRatio=function(a){void 0===a&&(a=0);this.m_dampingRatio=a};F.prototype.b2MouseJoint=function(a){this.__super.b2Joint.call(this,a);this.m_target.SetV(a.target);var c=this.m_target.x-this.m_bodyB.m_xf.position.x,d=this.m_target.y-this.m_bodyB.m_xf.position.y,e=this.m_bodyB.m_xf.R;this.m_localAnchor.x=c*e.col1.x+d*e.col1.y;this.m_localAnchor.y=
c*e.col2.x+d*e.col2.y;this.m_maxForce=a.maxForce;this.m_impulse.SetZero();this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_gamma=this.m_beta=0};F.prototype.InitVelocityConstraints=function(a){var c=this.m_bodyB,d=c.GetMass(),e=2*Math.PI*this.m_frequencyHz,f=d*e*e;this.m_gamma=a.dt*(2*d*this.m_dampingRatio*e+a.dt*f);this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0;this.m_beta=a.dt*f*this.m_gamma;var f=c.m_xf.R,d=this.m_localAnchor.x-c.m_sweep.localCenter.x,e=this.m_localAnchor.y-
c.m_sweep.localCenter.y,g=f.col1.x*d+f.col2.x*e,e=f.col1.y*d+f.col2.y*e,d=g,f=c.m_invMass,g=c.m_invI;this.K1.col1.x=f;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=f;this.K2.col1.x=g*e*e;this.K2.col2.x=-g*d*e;this.K2.col1.y=-g*d*e;this.K2.col2.y=g*d*d;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.col1.x+=this.m_gamma;this.K.col2.y+=this.m_gamma;this.K.GetInverse(this.m_mass);this.m_C.x=c.m_sweep.c.x+d-this.m_target.x;this.m_C.y=c.m_sweep.c.y+e-this.m_target.y;c.m_angularVelocity*=.98;this.m_impulse.x*=
a.dtRatio;this.m_impulse.y*=a.dtRatio;c.m_linearVelocity.x+=f*this.m_impulse.x;c.m_linearVelocity.y+=f*this.m_impulse.y;c.m_angularVelocity+=g*(d*this.m_impulse.y-e*this.m_impulse.x)};F.prototype.SolveVelocityConstraints=function(a){var c=this.m_bodyB,d,e=0,f=0;d=c.m_xf.R;var g=this.m_localAnchor.x-c.m_sweep.localCenter.x,h=this.m_localAnchor.y-c.m_sweep.localCenter.y,e=d.col1.x*g+d.col2.x*h,h=d.col1.y*g+d.col2.y*h,g=e,e=c.m_linearVelocity.x+-c.m_angularVelocity*h,k=c.m_linearVelocity.y+c.m_angularVelocity*
g;d=this.m_mass;e=e+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x;f=k+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;k=-(d.col1.x*e+d.col2.x*f);f=-(d.col1.y*e+d.col2.y*f);d=this.m_impulse.x;e=this.m_impulse.y;this.m_impulse.x+=k;this.m_impulse.y+=f;a=a.dt*this.m_maxForce;this.m_impulse.LengthSquared()>a*a&&this.m_impulse.Multiply(a/this.m_impulse.Length());k=this.m_impulse.x-d;f=this.m_impulse.y-e;c.m_linearVelocity.x+=c.m_invMass*k;c.m_linearVelocity.y+=c.m_invMass*f;c.m_angularVelocity+=
c.m_invI*(g*f-h*k)};F.prototype.SolvePositionConstraints=function(a){return!0};Box2D.inherit(J,Box2D.Dynamics.Joints.b2JointDef);J.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;J.b2MouseJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.target=new f};J.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this);this.type=r.e_mouseJoint;this.maxForce=0;this.frequencyHz=5;this.dampingRatio=.7};Box2D.inherit(H,Box2D.Dynamics.Joints.b2Joint);
H.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;H.b2PrismaticJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new f;this.m_localAnchor2=new f;this.m_localXAxis1=new f;this.m_localYAxis1=new f;this.m_axis=new f;this.m_perp=new f;this.m_K=new d;this.m_impulse=new g};H.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};H.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};
H.prototype.GetReactionForce=function(a){void 0===a&&(a=0);return new f(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))};H.prototype.GetReactionTorque=function(a){void 0===a&&(a=0);return a*this.m_impulse.y};H.prototype.GetJointTranslation=function(){var a=this.m_bodyA,c=this.m_bodyB,d=a.GetWorldPoint(this.m_localAnchor1),e=c.GetWorldPoint(this.m_localAnchor2),c=e.x-d.x,
d=e.y-d.y,a=a.GetWorldVector(this.m_localXAxis1);return a.x*c+a.y*d};H.prototype.GetJointSpeed=function(){var a=this.m_bodyA,c=this.m_bodyB,d;d=a.m_xf.R;var e=this.m_localAnchor1.x-a.m_sweep.localCenter.x,f=this.m_localAnchor1.y-a.m_sweep.localCenter.y,g=d.col1.x*e+d.col2.x*f,f=d.col1.y*e+d.col2.y*f,e=g;d=c.m_xf.R;var h=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,g=d.col1.x*h+d.col2.x*k,k=d.col1.y*h+d.col2.y*k,h=g;d=c.m_sweep.c.x+h-(a.m_sweep.c.x+
e);var g=c.m_sweep.c.y+k-(a.m_sweep.c.y+f),m=a.GetWorldVector(this.m_localXAxis1),l=a.m_linearVelocity,r=c.m_linearVelocity,a=a.m_angularVelocity,c=c.m_angularVelocity;return d*-a*m.y+g*a*m.x+(m.x*(r.x+-c*k-l.x- -a*f)+m.y*(r.y+c*h-l.y-a*e))};H.prototype.IsLimitEnabled=function(){return this.m_enableLimit};H.prototype.EnableLimit=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableLimit=a};H.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};H.prototype.GetUpperLimit=
function(){return this.m_upperTranslation};H.prototype.SetLimits=function(a,c){void 0===a&&(a=0);void 0===c&&(c=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_lowerTranslation=a;this.m_upperTranslation=c};H.prototype.IsMotorEnabled=function(){return this.m_enableMotor};H.prototype.EnableMotor=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=a};H.prototype.SetMotorSpeed=function(a){void 0===a&&(a=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);
this.m_motorSpeed=a};H.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};H.prototype.SetMaxMotorForce=function(a){void 0===a&&(a=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorForce=a};H.prototype.GetMotorForce=function(){return this.m_motorImpulse};H.prototype.b2PrismaticJoint=function(a){this.__super.b2Joint.call(this,a);this.m_localAnchor1.SetV(a.localAnchorA);this.m_localAnchor2.SetV(a.localAnchorB);this.m_localXAxis1.SetV(a.localAxisA);this.m_localYAxis1.x=-this.m_localXAxis1.y;
this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_refAngle=a.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=a.lowerTranslation;this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=r.e_inactiveLimit;this.m_axis.SetZero();this.m_perp.SetZero()};H.prototype.InitVelocityConstraints=function(c){var d=this.m_bodyA,
f=this.m_bodyB,g,h=0;this.m_localCenterA.SetV(d.GetLocalCenter());this.m_localCenterB.SetV(f.GetLocalCenter());var k=d.GetTransform();f.GetTransform();g=d.m_xf.R;var l=this.m_localAnchor1.x-this.m_localCenterA.x,u=this.m_localAnchor1.y-this.m_localCenterA.y,h=g.col1.x*l+g.col2.x*u,u=g.col1.y*l+g.col2.y*u,l=h;g=f.m_xf.R;var m=this.m_localAnchor2.x-this.m_localCenterB.x,n=this.m_localAnchor2.y-this.m_localCenterB.y,h=g.col1.x*m+g.col2.x*n,n=g.col1.y*m+g.col2.y*n,m=h;g=f.m_sweep.c.x+m-d.m_sweep.c.x-
l;h=f.m_sweep.c.y+n-d.m_sweep.c.y-u;this.m_invMassA=d.m_invMass;this.m_invMassB=f.m_invMass;this.m_invIA=d.m_invI;this.m_invIB=f.m_invI;this.m_axis.SetV(e.MulMV(k.R,this.m_localXAxis1));this.m_a1=(g+l)*this.m_axis.y-(h+u)*this.m_axis.x;this.m_a2=m*this.m_axis.y-n*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass);this.m_perp.SetV(e.MulMV(k.R,this.m_localYAxis1));
this.m_s1=(g+l)*this.m_perp.y-(h+u)*this.m_perp.x;this.m_s2=m*this.m_perp.y-n*this.m_perp.x;k=this.m_invMassA;l=this.m_invMassB;u=this.m_invIA;m=this.m_invIB;this.m_K.col1.x=k+l+u*this.m_s1*this.m_s1+m*this.m_s2*this.m_s2;this.m_K.col1.y=u*this.m_s1+m*this.m_s2;this.m_K.col1.z=u*this.m_s1*this.m_a1+m*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=u+m;this.m_K.col2.z=u*this.m_a1+m*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=k+l+u*this.m_a1*
this.m_a1+m*this.m_a2*this.m_a2;this.m_enableLimit?(g=this.m_axis.x*g+this.m_axis.y*h,e.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*a.b2_linearSlop?this.m_limitState=r.e_equalLimits:g<=this.m_lowerTranslation?this.m_limitState!=r.e_atLowerLimit&&(this.m_limitState=r.e_atLowerLimit,this.m_impulse.z=0):g>=this.m_upperTranslation?this.m_limitState!=r.e_atUpperLimit&&(this.m_limitState=r.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=r.e_inactiveLimit,this.m_impulse.z=0)):this.m_limitState=
r.e_inactiveLimit;0==this.m_enableMotor&&(this.m_motorImpulse=0);c.warmStarting?(this.m_impulse.x*=c.dtRatio,this.m_impulse.y*=c.dtRatio,this.m_motorImpulse*=c.dtRatio,c=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x,g=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,h=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,k=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+
this.m_impulse.z)*this.m_a2,d.m_linearVelocity.x-=this.m_invMassA*c,d.m_linearVelocity.y-=this.m_invMassA*g,d.m_angularVelocity-=this.m_invIA*h,f.m_linearVelocity.x+=this.m_invMassB*c,f.m_linearVelocity.y+=this.m_invMassB*g,f.m_angularVelocity+=this.m_invIB*k):(this.m_impulse.SetZero(),this.m_motorImpulse=0)};H.prototype.SolveVelocityConstraints=function(a){var c=this.m_bodyA,d=this.m_bodyB,h=c.m_linearVelocity,k=c.m_angularVelocity,l=d.m_linearVelocity,n=d.m_angularVelocity,u=0,m=0,q=0,v=0;this.m_enableMotor&&
this.m_limitState!=r.e_equalLimits&&(v=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(l.x-h.x)+this.m_axis.y*(l.y-h.y)+this.m_a2*n-this.m_a1*k)),u=this.m_motorImpulse,a=a.dt*this.m_maxMotorForce,this.m_motorImpulse=e.Clamp(this.m_motorImpulse+v,-a,a),v=this.m_motorImpulse-u,u=v*this.m_axis.x,m=v*this.m_axis.y,q=v*this.m_a1,v*=this.m_a2,h.x-=this.m_invMassA*u,h.y-=this.m_invMassA*m,k-=this.m_invIA*q,l.x+=this.m_invMassB*u,l.y+=this.m_invMassB*m,n+=this.m_invIB*v);q=this.m_perp.x*(l.x-h.x)+this.m_perp.y*
(l.y-h.y)+this.m_s2*n-this.m_s1*k;m=n-k;this.m_enableLimit&&this.m_limitState!=r.e_inactiveLimit?(a=this.m_axis.x*(l.x-h.x)+this.m_axis.y*(l.y-h.y)+this.m_a2*n-this.m_a1*k,u=this.m_impulse.Copy(),a=this.m_K.Solve33(new g,-q,-m,-a),this.m_impulse.Add(a),this.m_limitState==r.e_atLowerLimit?this.m_impulse.z=e.Max(this.m_impulse.z,0):this.m_limitState==r.e_atUpperLimit&&(this.m_impulse.z=e.Min(this.m_impulse.z,0)),q=-q-(this.m_impulse.z-u.z)*this.m_K.col3.x,m=-m-(this.m_impulse.z-u.z)*this.m_K.col3.y,
m=this.m_K.Solve22(new f,q,m),m.x+=u.x,m.y+=u.y,this.m_impulse.x=m.x,this.m_impulse.y=m.y,a.x=this.m_impulse.x-u.x,a.y=this.m_impulse.y-u.y,a.z=this.m_impulse.z-u.z,u=a.x*this.m_perp.x+a.z*this.m_axis.x,m=a.x*this.m_perp.y+a.z*this.m_axis.y,q=a.x*this.m_s1+a.y+a.z*this.m_a1,v=a.x*this.m_s2+a.y+a.z*this.m_a2):(a=this.m_K.Solve22(new f,-q,-m),this.m_impulse.x+=a.x,this.m_impulse.y+=a.y,u=a.x*this.m_perp.x,m=a.x*this.m_perp.y,q=a.x*this.m_s1+a.y,v=a.x*this.m_s2+a.y);h.x-=this.m_invMassA*u;h.y-=this.m_invMassA*
m;k-=this.m_invIA*q;l.x+=this.m_invMassB*u;l.y+=this.m_invMassB*m;n+=this.m_invIB*v;c.m_linearVelocity.SetV(h);c.m_angularVelocity=k;d.m_linearVelocity.SetV(l);d.m_angularVelocity=n};H.prototype.SolvePositionConstraints=function(d){d=this.m_bodyA;var h=this.m_bodyB,k=d.m_sweep.c,l=d.m_sweep.a,r=h.m_sweep.c,n=h.m_sweep.a,q,u=0,m=0,v=0,w=u=q=0,y=0,m=!1,A=0,z=c.FromAngle(l),C=c.FromAngle(n);q=z;var y=this.m_localAnchor1.x-this.m_localCenterA.x,D=this.m_localAnchor1.y-this.m_localCenterA.y,u=q.col1.x*
y+q.col2.x*D,D=q.col1.y*y+q.col2.y*D,y=u;q=C;C=this.m_localAnchor2.x-this.m_localCenterB.x;v=this.m_localAnchor2.y-this.m_localCenterB.y;u=q.col1.x*C+q.col2.x*v;v=q.col1.y*C+q.col2.y*v;C=u;q=r.x+C-k.x-y;u=r.y+v-k.y-D;if(this.m_enableLimit){this.m_axis=e.MulMV(z,this.m_localXAxis1);this.m_a1=(q+y)*this.m_axis.y-(u+D)*this.m_axis.x;this.m_a2=C*this.m_axis.y-v*this.m_axis.x;var F=this.m_axis.x*q+this.m_axis.y*u;e.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*a.b2_linearSlop?(A=e.Clamp(F,-a.b2_maxLinearCorrection,
a.b2_maxLinearCorrection),w=e.Abs(F),m=!0):F<=this.m_lowerTranslation?(A=e.Clamp(F-this.m_lowerTranslation+a.b2_linearSlop,-a.b2_maxLinearCorrection,0),w=this.m_lowerTranslation-F,m=!0):F>=this.m_upperTranslation&&(A=e.Clamp(F-this.m_upperTranslation+a.b2_linearSlop,0,a.b2_maxLinearCorrection),w=F-this.m_upperTranslation,m=!0)}this.m_perp=e.MulMV(z,this.m_localYAxis1);this.m_s1=(q+y)*this.m_perp.y-(u+D)*this.m_perp.x;this.m_s2=C*this.m_perp.y-v*this.m_perp.x;z=new g;D=this.m_perp.x*q+this.m_perp.y*
u;C=n-l-this.m_refAngle;w=e.Max(w,e.Abs(D));y=e.Abs(C);m?(m=this.m_invMassA,v=this.m_invMassB,q=this.m_invIA,u=this.m_invIB,this.m_K.col1.x=m+v+q*this.m_s1*this.m_s1+u*this.m_s2*this.m_s2,this.m_K.col1.y=q*this.m_s1+u*this.m_s2,this.m_K.col1.z=q*this.m_s1*this.m_a1+u*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=q+u,this.m_K.col2.z=q*this.m_a1+u*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=m+v+q*this.m_a1*this.m_a1+u*this.m_a2*this.m_a2,
this.m_K.Solve33(z,-D,-C,-A)):(m=this.m_invMassA,v=this.m_invMassB,q=this.m_invIA,u=this.m_invIB,A=q*this.m_s1+u*this.m_s2,F=q+u,this.m_K.col1.Set(m+v+q*this.m_s1*this.m_s1+u*this.m_s2*this.m_s2,A,0),this.m_K.col2.Set(A,F,0),A=this.m_K.Solve22(new f,-D,-C),z.x=A.x,z.y=A.y,z.z=0);A=z.x*this.m_perp.x+z.z*this.m_axis.x;m=z.x*this.m_perp.y+z.z*this.m_axis.y;D=z.x*this.m_s1+z.y+z.z*this.m_a1;z=z.x*this.m_s2+z.y+z.z*this.m_a2;k.x-=this.m_invMassA*A;k.y-=this.m_invMassA*m;l-=this.m_invIA*D;r.x+=this.m_invMassB*
A;r.y+=this.m_invMassB*m;n+=this.m_invIB*z;d.m_sweep.a=l;h.m_sweep.a=n;d.SynchronizeTransform();h.SynchronizeTransform();return w<=a.b2_linearSlop&&y<=a.b2_angularSlop};Box2D.inherit(L,Box2D.Dynamics.Joints.b2JointDef);L.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;L.b2PrismaticJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new f;this.localAnchorB=new f;this.localAxisA=new f};L.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this);
this.type=r.e_prismaticJoint;this.localAxisA.Set(1,0);this.referenceAngle=0;this.enableLimit=!1;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=!1;this.motorSpeed=this.maxMotorForce=0};L.prototype.Initialize=function(a,c,d,e){this.bodyA=a;this.bodyB=c;this.localAnchorA=this.bodyA.GetLocalPoint(d);this.localAnchorB=this.bodyB.GetLocalPoint(d);this.localAxisA=this.bodyA.GetLocalVector(e);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};Box2D.inherit(D,Box2D.Dynamics.Joints.b2Joint);
D.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;D.b2PulleyJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_groundAnchor1=new f;this.m_groundAnchor2=new f;this.m_localAnchor1=new f;this.m_localAnchor2=new f;this.m_u1=new f;this.m_u2=new f};D.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};D.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};D.prototype.GetReactionForce=function(a){void 0===
a&&(a=0);return new f(a*this.m_impulse*this.m_u2.x,a*this.m_impulse*this.m_u2.y)};D.prototype.GetReactionTorque=function(a){return 0};D.prototype.GetGroundAnchorA=function(){var a=this.m_ground.m_xf.position.Copy();a.Add(this.m_groundAnchor1);return a};D.prototype.GetGroundAnchorB=function(){var a=this.m_ground.m_xf.position.Copy();a.Add(this.m_groundAnchor2);return a};D.prototype.GetLength1=function(){var a=this.m_bodyA.GetWorldPoint(this.m_localAnchor1),c=a.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),
a=a.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y);return Math.sqrt(c*c+a*a)};D.prototype.GetLength2=function(){var a=this.m_bodyB.GetWorldPoint(this.m_localAnchor2),c=a.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor2.x),a=a.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor2.y);return Math.sqrt(c*c+a*a)};D.prototype.GetRatio=function(){return this.m_ratio};D.prototype.b2PulleyJoint=function(a){this.__super.b2Joint.call(this,a);this.m_ground=this.m_bodyA.m_world.m_groundBody;this.m_groundAnchor1.x=
a.groundAnchorA.x-this.m_ground.m_xf.position.x;this.m_groundAnchor1.y=a.groundAnchorA.y-this.m_ground.m_xf.position.y;this.m_groundAnchor2.x=a.groundAnchorB.x-this.m_ground.m_xf.position.x;this.m_groundAnchor2.y=a.groundAnchorB.y-this.m_ground.m_xf.position.y;this.m_localAnchor1.SetV(a.localAnchorA);this.m_localAnchor2.SetV(a.localAnchorB);this.m_ratio=a.ratio;this.m_constant=a.lengthA+this.m_ratio*a.lengthB;this.m_maxLength1=e.Min(a.maxLengthA,this.m_constant-this.m_ratio*D.b2_minPulleyLength);
this.m_maxLength2=e.Min(a.maxLengthB,(this.m_constant-D.b2_minPulleyLength)/this.m_ratio);this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0};D.prototype.InitVelocityConstraints=function(c){var d=this.m_bodyA,e=this.m_bodyB,f;f=d.m_xf.R;var g=this.m_localAnchor1.x-d.m_sweep.localCenter.x,h=this.m_localAnchor1.y-d.m_sweep.localCenter.y,k=f.col1.x*g+f.col2.x*h,h=f.col1.y*g+f.col2.y*h,g=k;f=e.m_xf.R;var l=this.m_localAnchor2.x-e.m_sweep.localCenter.x,m=this.m_localAnchor2.y-e.m_sweep.localCenter.y,
k=f.col1.x*l+f.col2.x*m,m=f.col1.y*l+f.col2.y*m,l=k;f=e.m_sweep.c.x+l;var k=e.m_sweep.c.y+m,n=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,q=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(d.m_sweep.c.x+g-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),d.m_sweep.c.y+h-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y));this.m_u2.Set(f-n,k-q);f=this.m_u1.Length();k=this.m_u2.Length();f>a.b2_linearSlop?this.m_u1.Multiply(1/f):this.m_u1.SetZero();k>a.b2_linearSlop?
this.m_u2.Multiply(1/k):this.m_u2.SetZero();0<this.m_constant-f-this.m_ratio*k?(this.m_state=r.e_inactiveLimit,this.m_impulse=0):this.m_state=r.e_atUpperLimit;f<this.m_maxLength1?(this.m_limitState1=r.e_inactiveLimit,this.m_limitImpulse1=0):this.m_limitState1=r.e_atUpperLimit;k<this.m_maxLength2?(this.m_limitState2=r.e_inactiveLimit,this.m_limitImpulse2=0):this.m_limitState2=r.e_atUpperLimit;f=g*this.m_u1.y-h*this.m_u1.x;k=l*this.m_u2.y-m*this.m_u2.x;this.m_limitMass1=d.m_invMass+d.m_invI*f*f;this.m_limitMass2=
e.m_invMass+e.m_invI*k*k;this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2;this.m_limitMass1=1/this.m_limitMass1;this.m_limitMass2=1/this.m_limitMass2;this.m_pulleyMass=1/this.m_pulleyMass;c.warmStarting?(this.m_impulse*=c.dtRatio,this.m_limitImpulse1*=c.dtRatio,this.m_limitImpulse2*=c.dtRatio,c=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,f=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,k=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,n=(-this.m_ratio*
this.m_impulse-this.m_limitImpulse2)*this.m_u2.y,d.m_linearVelocity.x+=d.m_invMass*c,d.m_linearVelocity.y+=d.m_invMass*f,d.m_angularVelocity+=d.m_invI*(g*f-h*c),e.m_linearVelocity.x+=e.m_invMass*k,e.m_linearVelocity.y+=e.m_invMass*n,e.m_angularVelocity+=e.m_invI*(l*n-m*k)):this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0};D.prototype.SolveVelocityConstraints=function(a){a=this.m_bodyA;var c=this.m_bodyB,d;d=a.m_xf.R;var f=this.m_localAnchor1.x-a.m_sweep.localCenter.x,g=this.m_localAnchor1.y-
a.m_sweep.localCenter.y,h=d.col1.x*f+d.col2.x*g,g=d.col1.y*f+d.col2.y*g,f=h;d=c.m_xf.R;var k=this.m_localAnchor2.x-c.m_sweep.localCenter.x,l=this.m_localAnchor2.y-c.m_sweep.localCenter.y,h=d.col1.x*k+d.col2.x*l,l=d.col1.y*k+d.col2.y*l,k=h,m=h=d=0,n=0;d=n=d=n=m=h=d=0;this.m_state==r.e_atUpperLimit&&(d=a.m_linearVelocity.x+-a.m_angularVelocity*g,h=a.m_linearVelocity.y+a.m_angularVelocity*f,m=c.m_linearVelocity.x+-c.m_angularVelocity*l,n=c.m_linearVelocity.y+c.m_angularVelocity*k,d=-(this.m_u1.x*d+this.m_u1.y*
h)-this.m_ratio*(this.m_u2.x*m+this.m_u2.y*n),n=this.m_pulleyMass*-d,d=this.m_impulse,this.m_impulse=e.Max(0,this.m_impulse+n),n=this.m_impulse-d,d=-n*this.m_u1.x,h=-n*this.m_u1.y,m=-this.m_ratio*n*this.m_u2.x,n=-this.m_ratio*n*this.m_u2.y,a.m_linearVelocity.x+=a.m_invMass*d,a.m_linearVelocity.y+=a.m_invMass*h,a.m_angularVelocity+=a.m_invI*(f*h-g*d),c.m_linearVelocity.x+=c.m_invMass*m,c.m_linearVelocity.y+=c.m_invMass*n,c.m_angularVelocity+=c.m_invI*(k*n-l*m));this.m_limitState1==r.e_atUpperLimit&&
(d=a.m_linearVelocity.x+-a.m_angularVelocity*g,h=a.m_linearVelocity.y+a.m_angularVelocity*f,d=-(this.m_u1.x*d+this.m_u1.y*h),n=-this.m_limitMass1*d,d=this.m_limitImpulse1,this.m_limitImpulse1=e.Max(0,this.m_limitImpulse1+n),n=this.m_limitImpulse1-d,d=-n*this.m_u1.x,h=-n*this.m_u1.y,a.m_linearVelocity.x+=a.m_invMass*d,a.m_linearVelocity.y+=a.m_invMass*h,a.m_angularVelocity+=a.m_invI*(f*h-g*d));this.m_limitState2==r.e_atUpperLimit&&(m=c.m_linearVelocity.x+-c.m_angularVelocity*l,n=c.m_linearVelocity.y+
c.m_angularVelocity*k,d=-(this.m_u2.x*m+this.m_u2.y*n),n=-this.m_limitMass2*d,d=this.m_limitImpulse2,this.m_limitImpulse2=e.Max(0,this.m_limitImpulse2+n),n=this.m_limitImpulse2-d,m=-n*this.m_u2.x,n=-n*this.m_u2.y,c.m_linearVelocity.x+=c.m_invMass*m,c.m_linearVelocity.y+=c.m_invMass*n,c.m_angularVelocity+=c.m_invI*(k*n-l*m))};D.prototype.SolvePositionConstraints=function(c){c=this.m_bodyA;var d=this.m_bodyB,f,g=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,h=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,
k=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,l=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,n=0,m=0,q=0,v=0,w=f=0,y=0,A=0,z=w=A=f=w=f=0;this.m_state==r.e_atUpperLimit&&(f=c.m_xf.R,n=this.m_localAnchor1.x-c.m_sweep.localCenter.x,m=this.m_localAnchor1.y-c.m_sweep.localCenter.y,w=f.col1.x*n+f.col2.x*m,m=f.col1.y*n+f.col2.y*m,n=w,f=d.m_xf.R,q=this.m_localAnchor2.x-d.m_sweep.localCenter.x,v=this.m_localAnchor2.y-d.m_sweep.localCenter.y,w=f.col1.x*q+f.col2.x*v,v=f.col1.y*q+f.col2.y*v,
q=w,f=c.m_sweep.c.x+n,w=c.m_sweep.c.y+m,y=d.m_sweep.c.x+q,A=d.m_sweep.c.y+v,this.m_u1.Set(f-g,w-h),this.m_u2.Set(y-k,A-l),f=this.m_u1.Length(),w=this.m_u2.Length(),f>a.b2_linearSlop?this.m_u1.Multiply(1/f):this.m_u1.SetZero(),w>a.b2_linearSlop?this.m_u2.Multiply(1/w):this.m_u2.SetZero(),f=this.m_constant-f-this.m_ratio*w,z=e.Max(z,-f),f=e.Clamp(f+a.b2_linearSlop,-a.b2_maxLinearCorrection,0),A=-this.m_pulleyMass*f,f=-A*this.m_u1.x,w=-A*this.m_u1.y,y=-this.m_ratio*A*this.m_u2.x,A=-this.m_ratio*A*this.m_u2.y,
c.m_sweep.c.x+=c.m_invMass*f,c.m_sweep.c.y+=c.m_invMass*w,c.m_sweep.a+=c.m_invI*(n*w-m*f),d.m_sweep.c.x+=d.m_invMass*y,d.m_sweep.c.y+=d.m_invMass*A,d.m_sweep.a+=d.m_invI*(q*A-v*y),c.SynchronizeTransform(),d.SynchronizeTransform());this.m_limitState1==r.e_atUpperLimit&&(f=c.m_xf.R,n=this.m_localAnchor1.x-c.m_sweep.localCenter.x,m=this.m_localAnchor1.y-c.m_sweep.localCenter.y,w=f.col1.x*n+f.col2.x*m,m=f.col1.y*n+f.col2.y*m,n=w,f=c.m_sweep.c.x+n,w=c.m_sweep.c.y+m,this.m_u1.Set(f-g,w-h),f=this.m_u1.Length(),
f>a.b2_linearSlop?(this.m_u1.x*=1/f,this.m_u1.y*=1/f):this.m_u1.SetZero(),f=this.m_maxLength1-f,z=e.Max(z,-f),f=e.Clamp(f+a.b2_linearSlop,-a.b2_maxLinearCorrection,0),A=-this.m_limitMass1*f,f=-A*this.m_u1.x,w=-A*this.m_u1.y,c.m_sweep.c.x+=c.m_invMass*f,c.m_sweep.c.y+=c.m_invMass*w,c.m_sweep.a+=c.m_invI*(n*w-m*f),c.SynchronizeTransform());this.m_limitState2==r.e_atUpperLimit&&(f=d.m_xf.R,q=this.m_localAnchor2.x-d.m_sweep.localCenter.x,v=this.m_localAnchor2.y-d.m_sweep.localCenter.y,w=f.col1.x*q+f.col2.x*
v,v=f.col1.y*q+f.col2.y*v,q=w,y=d.m_sweep.c.x+q,A=d.m_sweep.c.y+v,this.m_u2.Set(y-k,A-l),w=this.m_u2.Length(),w>a.b2_linearSlop?(this.m_u2.x*=1/w,this.m_u2.y*=1/w):this.m_u2.SetZero(),f=this.m_maxLength2-w,z=e.Max(z,-f),f=e.Clamp(f+a.b2_linearSlop,-a.b2_maxLinearCorrection,0),A=-this.m_limitMass2*f,y=-A*this.m_u2.x,A=-A*this.m_u2.y,d.m_sweep.c.x+=d.m_invMass*y,d.m_sweep.c.y+=d.m_invMass*A,d.m_sweep.a+=d.m_invI*(q*A-v*y),d.SynchronizeTransform());return z<a.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=
2});Box2D.inherit(N,Box2D.Dynamics.Joints.b2JointDef);N.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;N.b2PulleyJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.groundAnchorA=new f;this.groundAnchorB=new f;this.localAnchorA=new f;this.localAnchorB=new f};N.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this);this.type=r.e_pulleyJoint;this.groundAnchorA.Set(-1,1);this.groundAnchorB.Set(1,1);this.localAnchorA.Set(-1,0);this.localAnchorB.Set(1,
0);this.maxLengthB=this.lengthB=this.maxLengthA=this.lengthA=0;this.ratio=1;this.collideConnected=!0};N.prototype.Initialize=function(a,c,d,e,f,g,h){void 0===h&&(h=0);this.bodyA=a;this.bodyB=c;this.groundAnchorA.SetV(d);this.groundAnchorB.SetV(e);this.localAnchorA=this.bodyA.GetLocalPoint(f);this.localAnchorB=this.bodyB.GetLocalPoint(g);a=f.x-d.x;d=f.y-d.y;this.lengthA=Math.sqrt(a*a+d*d);d=g.x-e.x;e=g.y-e.y;this.lengthB=Math.sqrt(d*d+e*e);this.ratio=h;h=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=
h-this.ratio*D.b2_minPulleyLength;this.maxLengthB=(h-D.b2_minPulleyLength)/this.ratio};Box2D.inherit(I,Box2D.Dynamics.Joints.b2Joint);I.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;I.b2RevoluteJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.K=new c;this.K1=new c;this.K2=new c;this.K3=new c;this.impulse3=new g;this.impulse2=new f;this.reduced=new f;this.m_localAnchor1=new f;this.m_localAnchor2=new f;this.m_impulse=new g;this.m_mass=new d};I.prototype.GetAnchorA=
function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};I.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};I.prototype.GetReactionForce=function(a){void 0===a&&(a=0);return new f(a*this.m_impulse.x,a*this.m_impulse.y)};I.prototype.GetReactionTorque=function(a){void 0===a&&(a=0);return a*this.m_impulse.z};I.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle};I.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-
this.m_bodyA.m_angularVelocity};I.prototype.IsLimitEnabled=function(){return this.m_enableLimit};I.prototype.EnableLimit=function(a){this.m_enableLimit=a};I.prototype.GetLowerLimit=function(){return this.m_lowerAngle};I.prototype.GetUpperLimit=function(){return this.m_upperAngle};I.prototype.SetLimits=function(a,c){void 0===a&&(a=0);void 0===c&&(c=0);this.m_lowerAngle=a;this.m_upperAngle=c};I.prototype.IsMotorEnabled=function(){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);return this.m_enableMotor};
I.prototype.EnableMotor=function(a){this.m_enableMotor=a};I.prototype.SetMotorSpeed=function(a){void 0===a&&(a=0);this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=a};I.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};I.prototype.SetMaxMotorTorque=function(a){void 0===a&&(a=0);this.m_maxMotorTorque=a};I.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque};I.prototype.b2RevoluteJoint=function(a){this.__super.b2Joint.call(this,a);this.m_localAnchor1.SetV(a.localAnchorA);
this.m_localAnchor2.SetV(a.localAnchorB);this.m_referenceAngle=a.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=0;this.m_lowerAngle=a.lowerAngle;this.m_upperAngle=a.upperAngle;this.m_maxMotorTorque=a.maxMotorTorque;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=r.e_inactiveLimit};I.prototype.InitVelocityConstraints=function(c){var d=this.m_bodyA,f=this.m_bodyB,g,h=0;g=d.m_xf.R;var k=this.m_localAnchor1.x-d.m_sweep.localCenter.x,
l=this.m_localAnchor1.y-d.m_sweep.localCenter.y,h=g.col1.x*k+g.col2.x*l,l=g.col1.y*k+g.col2.y*l,k=h;g=f.m_xf.R;var n=this.m_localAnchor2.x-f.m_sweep.localCenter.x,m=this.m_localAnchor2.y-f.m_sweep.localCenter.y,h=g.col1.x*n+g.col2.x*m,m=g.col1.y*n+g.col2.y*m,n=h;g=d.m_invMass;var h=f.m_invMass,q=d.m_invI,v=f.m_invI;this.m_mass.col1.x=g+h+l*l*q+m*m*v;this.m_mass.col2.x=-l*k*q-m*n*v;this.m_mass.col3.x=-l*q-m*v;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=g+h+k*k*q+n*n*v;this.m_mass.col3.y=
k*q+n*v;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=q+v;this.m_motorMass=1/(q+v);0==this.m_enableMotor&&(this.m_motorImpulse=0);if(this.m_enableLimit){var w=f.m_sweep.a-d.m_sweep.a-this.m_referenceAngle;e.Abs(this.m_upperAngle-this.m_lowerAngle)<2*a.b2_angularSlop?this.m_limitState=r.e_equalLimits:w<=this.m_lowerAngle?(this.m_limitState!=r.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=r.e_atLowerLimit):w>=this.m_upperAngle?(this.m_limitState!=
r.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=r.e_atUpperLimit):(this.m_limitState=r.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=r.e_inactiveLimit;c.warmStarting?(this.m_impulse.x*=c.dtRatio,this.m_impulse.y*=c.dtRatio,this.m_motorImpulse*=c.dtRatio,c=this.m_impulse.x,w=this.m_impulse.y,d.m_linearVelocity.x-=g*c,d.m_linearVelocity.y-=g*w,d.m_angularVelocity-=q*(k*w-l*c+this.m_motorImpulse+this.m_impulse.z),f.m_linearVelocity.x+=h*c,f.m_linearVelocity.y+=h*w,f.m_angularVelocity+=
v*(n*w-m*c+this.m_motorImpulse+this.m_impulse.z)):(this.m_impulse.SetZero(),this.m_motorImpulse=0)};I.prototype.SolveVelocityConstraints=function(a){var c=this.m_bodyA,d=this.m_bodyB,f=0,g=f=0,h=0,k=0,l=0,m=c.m_linearVelocity,n=c.m_angularVelocity,q=d.m_linearVelocity,v=d.m_angularVelocity,w=c.m_invMass,y=d.m_invMass,A=c.m_invI,z=d.m_invI;this.m_enableMotor&&this.m_limitState!=r.e_equalLimits&&(g=this.m_motorMass*-(v-n-this.m_motorSpeed),h=this.m_motorImpulse,k=a.dt*this.m_maxMotorTorque,this.m_motorImpulse=
e.Clamp(this.m_motorImpulse+g,-k,k),g=this.m_motorImpulse-h,n-=A*g,v+=z*g);if(this.m_enableLimit&&this.m_limitState!=r.e_inactiveLimit){a=c.m_xf.R;g=this.m_localAnchor1.x-c.m_sweep.localCenter.x;h=this.m_localAnchor1.y-c.m_sweep.localCenter.y;f=a.col1.x*g+a.col2.x*h;h=a.col1.y*g+a.col2.y*h;g=f;a=d.m_xf.R;k=this.m_localAnchor2.x-d.m_sweep.localCenter.x;l=this.m_localAnchor2.y-d.m_sweep.localCenter.y;f=a.col1.x*k+a.col2.x*l;l=a.col1.y*k+a.col2.y*l;k=f;a=q.x+-v*l-m.x- -n*h;var C=q.y+v*k-m.y-n*g;this.m_mass.Solve33(this.impulse3,
-a,-C,-(v-n));this.m_limitState==r.e_equalLimits?this.m_impulse.Add(this.impulse3):this.m_limitState==r.e_atLowerLimit?(f=this.m_impulse.z+this.impulse3.z,0>f&&(this.m_mass.Solve22(this.reduced,-a,-C),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)):this.m_limitState==r.e_atUpperLimit&&(f=this.m_impulse.z+this.impulse3.z,0<f&&(this.m_mass.Solve22(this.reduced,-a,-C),
this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0));m.x-=w*this.impulse3.x;m.y-=w*this.impulse3.y;n-=A*(g*this.impulse3.y-h*this.impulse3.x+this.impulse3.z);q.x+=y*this.impulse3.x;q.y+=y*this.impulse3.y;v+=z*(k*this.impulse3.y-l*this.impulse3.x+this.impulse3.z)}else a=c.m_xf.R,g=this.m_localAnchor1.x-c.m_sweep.localCenter.x,h=this.m_localAnchor1.y-c.m_sweep.localCenter.y,
f=a.col1.x*g+a.col2.x*h,h=a.col1.y*g+a.col2.y*h,g=f,a=d.m_xf.R,k=this.m_localAnchor2.x-d.m_sweep.localCenter.x,l=this.m_localAnchor2.y-d.m_sweep.localCenter.y,f=a.col1.x*k+a.col2.x*l,l=a.col1.y*k+a.col2.y*l,k=f,this.m_mass.Solve22(this.impulse2,-(q.x+-v*l-m.x- -n*h),-(q.y+v*k-m.y-n*g)),this.m_impulse.x+=this.impulse2.x,this.m_impulse.y+=this.impulse2.y,m.x-=w*this.impulse2.x,m.y-=w*this.impulse2.y,n-=A*(g*this.impulse2.y-h*this.impulse2.x),q.x+=y*this.impulse2.x,q.y+=y*this.impulse2.y,v+=z*(k*this.impulse2.y-
l*this.impulse2.x);c.m_linearVelocity.SetV(m);c.m_angularVelocity=n;d.m_linearVelocity.SetV(q);d.m_angularVelocity=v};I.prototype.SolvePositionConstraints=function(c){var d=0,f;c=this.m_bodyA;var g=this.m_bodyB,h=0,k=f=0,l=0,n=0;if(this.m_enableLimit&&this.m_limitState!=r.e_inactiveLimit){var d=g.m_sweep.a-c.m_sweep.a-this.m_referenceAngle,m=0;this.m_limitState==r.e_equalLimits?(d=e.Clamp(d-this.m_lowerAngle,-a.b2_maxAngularCorrection,a.b2_maxAngularCorrection),m=-this.m_motorMass*d,h=e.Abs(d)):this.m_limitState==
r.e_atLowerLimit?(d-=this.m_lowerAngle,h=-d,d=e.Clamp(d+a.b2_angularSlop,-a.b2_maxAngularCorrection,0),m=-this.m_motorMass*d):this.m_limitState==r.e_atUpperLimit&&(h=d-=this.m_upperAngle,d=e.Clamp(d-a.b2_angularSlop,0,a.b2_maxAngularCorrection),m=-this.m_motorMass*d);c.m_sweep.a-=c.m_invI*m;g.m_sweep.a+=g.m_invI*m;c.SynchronizeTransform();g.SynchronizeTransform()}f=c.m_xf.R;m=this.m_localAnchor1.x-c.m_sweep.localCenter.x;d=this.m_localAnchor1.y-c.m_sweep.localCenter.y;k=f.col1.x*m+f.col2.x*d;d=f.col1.y*
m+f.col2.y*d;m=k;f=g.m_xf.R;var q=this.m_localAnchor2.x-g.m_sweep.localCenter.x,v=this.m_localAnchor2.y-g.m_sweep.localCenter.y,k=f.col1.x*q+f.col2.x*v,v=f.col1.y*q+f.col2.y*v,q=k,l=g.m_sweep.c.x+q-c.m_sweep.c.x-m,n=g.m_sweep.c.y+v-c.m_sweep.c.y-d,w=l*l+n*n;f=Math.sqrt(w);var k=c.m_invMass,y=g.m_invMass,A=c.m_invI,z=g.m_invI,C=10*a.b2_linearSlop;w>C*C&&(w=1/(k+y),l=w*-l,n=w*-n,c.m_sweep.c.x-=.5*k*l,c.m_sweep.c.y-=.5*k*n,g.m_sweep.c.x+=.5*y*l,g.m_sweep.c.y+=.5*y*n,l=g.m_sweep.c.x+q-c.m_sweep.c.x-m,
n=g.m_sweep.c.y+v-c.m_sweep.c.y-d);this.K1.col1.x=k+y;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=k+y;this.K2.col1.x=A*d*d;this.K2.col2.x=-A*m*d;this.K2.col1.y=-A*m*d;this.K2.col2.y=A*m*m;this.K3.col1.x=z*v*v;this.K3.col2.x=-z*q*v;this.K3.col1.y=-z*q*v;this.K3.col2.y=z*q*q;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.AddM(this.K3);this.K.Solve(I.tImpulse,-l,-n);l=I.tImpulse.x;n=I.tImpulse.y;c.m_sweep.c.x-=c.m_invMass*l;c.m_sweep.c.y-=c.m_invMass*n;c.m_sweep.a-=c.m_invI*(m*n-d*l);g.m_sweep.c.x+=
g.m_invMass*l;g.m_sweep.c.y+=g.m_invMass*n;g.m_sweep.a+=g.m_invI*(q*n-v*l);c.SynchronizeTransform();g.SynchronizeTransform();return f<=a.b2_linearSlop&&h<=a.b2_angularSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse=new f});Box2D.inherit(K,Box2D.Dynamics.Joints.b2JointDef);K.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;K.b2RevoluteJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new f;this.localAnchorB=
new f};K.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this);this.type=r.e_revoluteJoint;this.localAnchorA.Set(0,0);this.localAnchorB.Set(0,0);this.motorSpeed=this.maxMotorTorque=this.upperAngle=this.lowerAngle=this.referenceAngle=0;this.enableMotor=this.enableLimit=!1};K.prototype.Initialize=function(a,c,d){this.bodyA=a;this.bodyB=c;this.localAnchorA=this.bodyA.GetLocalPoint(d);this.localAnchorB=this.bodyB.GetLocalPoint(d);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};
Box2D.inherit(O,Box2D.Dynamics.Joints.b2Joint);O.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;O.b2WeldJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchorA=new f;this.m_localAnchorB=new f;this.m_impulse=new g;this.m_mass=new d};O.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)};O.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)};O.prototype.GetReactionForce=function(a){void 0===
a&&(a=0);return new f(a*this.m_impulse.x,a*this.m_impulse.y)};O.prototype.GetReactionTorque=function(a){void 0===a&&(a=0);return a*this.m_impulse.z};O.prototype.b2WeldJoint=function(a){this.__super.b2Joint.call(this,a);this.m_localAnchorA.SetV(a.localAnchorA);this.m_localAnchorB.SetV(a.localAnchorB);this.m_referenceAngle=a.referenceAngle;this.m_impulse.SetZero();this.m_mass=new d};O.prototype.InitVelocityConstraints=function(a){var c,d=0,e=this.m_bodyA,f=this.m_bodyB;c=e.m_xf.R;var g=this.m_localAnchorA.x-
e.m_sweep.localCenter.x,h=this.m_localAnchorA.y-e.m_sweep.localCenter.y,d=c.col1.x*g+c.col2.x*h,h=c.col1.y*g+c.col2.y*h,g=d;c=f.m_xf.R;var k=this.m_localAnchorB.x-f.m_sweep.localCenter.x,l=this.m_localAnchorB.y-f.m_sweep.localCenter.y,d=c.col1.x*k+c.col2.x*l,l=c.col1.y*k+c.col2.y*l,k=d;c=e.m_invMass;var d=f.m_invMass,n=e.m_invI,r=f.m_invI;this.m_mass.col1.x=c+d+h*h*n+l*l*r;this.m_mass.col2.x=-h*g*n-l*k*r;this.m_mass.col3.x=-h*n-l*r;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=c+d+g*g*
n+k*k*r;this.m_mass.col3.y=g*n+k*r;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=n+r;a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_impulse.z*=a.dtRatio,e.m_linearVelocity.x-=c*this.m_impulse.x,e.m_linearVelocity.y-=c*this.m_impulse.y,e.m_angularVelocity-=n*(g*this.m_impulse.y-h*this.m_impulse.x+this.m_impulse.z),f.m_linearVelocity.x+=d*this.m_impulse.x,f.m_linearVelocity.y+=d*this.m_impulse.y,f.m_angularVelocity+=r*
(k*this.m_impulse.y-l*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.SetZero()};O.prototype.SolveVelocityConstraints=function(a){var c,d=0;a=this.m_bodyA;var e=this.m_bodyB,f=a.m_linearVelocity,h=a.m_angularVelocity,k=e.m_linearVelocity,l=e.m_angularVelocity,m=a.m_invMass,n=e.m_invMass,r=a.m_invI,q=e.m_invI;c=a.m_xf.R;var v=this.m_localAnchorA.x-a.m_sweep.localCenter.x,w=this.m_localAnchorA.y-a.m_sweep.localCenter.y,d=c.col1.x*v+c.col2.x*w,w=c.col1.y*v+c.col2.y*w,v=d;c=e.m_xf.R;var y=this.m_localAnchorB.x-
e.m_sweep.localCenter.x,A=this.m_localAnchorB.y-e.m_sweep.localCenter.y,d=c.col1.x*y+c.col2.x*A,A=c.col1.y*y+c.col2.y*A,y=d;c=k.x-l*A-f.x+h*w;var d=k.y+l*y-f.y-h*v,z=l-h,C=new g;this.m_mass.Solve33(C,-c,-d,-z);this.m_impulse.Add(C);f.x-=m*C.x;f.y-=m*C.y;h-=r*(v*C.y-w*C.x+C.z);k.x+=n*C.x;k.y+=n*C.y;l+=q*(y*C.y-A*C.x+C.z);a.m_angularVelocity=h;e.m_angularVelocity=l};O.prototype.SolvePositionConstraints=function(c){var d,f=0;c=this.m_bodyA;var h=this.m_bodyB;d=c.m_xf.R;var k=this.m_localAnchorA.x-c.m_sweep.localCenter.x,
l=this.m_localAnchorA.y-c.m_sweep.localCenter.y,f=d.col1.x*k+d.col2.x*l,l=d.col1.y*k+d.col2.y*l,k=f;d=h.m_xf.R;var n=this.m_localAnchorB.x-h.m_sweep.localCenter.x,r=this.m_localAnchorB.y-h.m_sweep.localCenter.y,f=d.col1.x*n+d.col2.x*r,r=d.col1.y*n+d.col2.y*r,n=f;d=c.m_invMass;var f=h.m_invMass,m=c.m_invI,q=h.m_invI,v=h.m_sweep.c.x+n-c.m_sweep.c.x-k,w=h.m_sweep.c.y+r-c.m_sweep.c.y-l,y=h.m_sweep.a-c.m_sweep.a-this.m_referenceAngle,A=10*a.b2_linearSlop,z=Math.sqrt(v*v+w*w),C=e.Abs(y);z>A&&(m*=1,q*=1);
this.m_mass.col1.x=d+f+l*l*m+r*r*q;this.m_mass.col2.x=-l*k*m-r*n*q;this.m_mass.col3.x=-l*m-r*q;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=d+f+k*k*m+n*n*q;this.m_mass.col3.y=k*m+n*q;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=m+q;A=new g;this.m_mass.Solve33(A,-v,-w,-y);c.m_sweep.c.x-=d*A.x;c.m_sweep.c.y-=d*A.y;c.m_sweep.a-=m*(k*A.y-l*A.x+A.z);h.m_sweep.c.x+=f*A.x;h.m_sweep.c.y+=f*A.y;h.m_sweep.a+=q*(n*A.y-r*A.x+A.z);c.SynchronizeTransform();
h.SynchronizeTransform();return z<=a.b2_linearSlop&&C<=a.b2_angularSlop};Box2D.inherit(M,Box2D.Dynamics.Joints.b2JointDef);M.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;M.b2WeldJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new f;this.localAnchorB=new f};M.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this);this.type=r.e_weldJoint;this.referenceAngle=0};M.prototype.Initialize=function(a,c,d){this.bodyA=a;
this.bodyB=c;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(d));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(d));this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}})();
(function(){var a=Box2D.Dynamics.b2DebugDraw;a.b2DebugDraw=function(){this.m_xformScale=this.m_fillAlpha=this.m_alpha=this.m_lineThickness=this.m_drawScale=1;var a=this;this.m_sprite={graphics:{clear:function(){a.m_ctx.clearRect(0,0,a.m_ctx.canvas.width,a.m_ctx.canvas.height)}}}};a.prototype._color=function(a,d){return"rgba("+((a&16711680)>>16)+","+((a&65280)>>8)+","+(a&255)+","+d+")"};a.prototype.b2DebugDraw=function(){this.m_drawFlags=0};a.prototype.SetFlags=function(a){void 0===a&&(a=0);this.m_drawFlags=
a};a.prototype.GetFlags=function(){return this.m_drawFlags};a.prototype.AppendFlags=function(a){void 0===a&&(a=0);this.m_drawFlags|=a};a.prototype.ClearFlags=function(a){void 0===a&&(a=0);this.m_drawFlags&=~a};a.prototype.SetSprite=function(a){this.m_ctx=a};a.prototype.GetSprite=function(){return this.m_ctx};a.prototype.SetDrawScale=function(a){void 0===a&&(a=0);this.m_drawScale=a};a.prototype.GetDrawScale=function(){return this.m_drawScale};a.prototype.SetLineThickness=function(a){void 0===a&&(a=
0);this.m_lineThickness=a;this.m_ctx.strokeWidth=a};a.prototype.GetLineThickness=function(){return this.m_lineThickness};a.prototype.SetAlpha=function(a){void 0===a&&(a=0);this.m_alpha=a};a.prototype.GetAlpha=function(){return this.m_alpha};a.prototype.SetFillAlpha=function(a){void 0===a&&(a=0);this.m_fillAlpha=a};a.prototype.GetFillAlpha=function(){return this.m_fillAlpha};a.prototype.SetXFormScale=function(a){void 0===a&&(a=0);this.m_xformScale=a};a.prototype.GetXFormScale=function(){return this.m_xformScale};
a.prototype.DrawPolygon=function(a,d,e){if(d){var f=this.m_ctx,g=this.m_drawScale;f.beginPath();f.strokeStyle=this._color(e.color,this.m_alpha);f.moveTo(a[0].x*g,a[0].y*g);for(e=1;e<d;e++)f.lineTo(a[e].x*g,a[e].y*g);f.lineTo(a[0].x*g,a[0].y*g);f.closePath();f.stroke()}};a.prototype.DrawSolidPolygon=function(a,d,e){if(d){var f=this.m_ctx,g=this.m_drawScale;f.beginPath();f.strokeStyle=this._color(e.color,this.m_alpha);f.fillStyle=this._color(e.color,this.m_fillAlpha);f.moveTo(a[0].x*g,a[0].y*g);for(e=
1;e<d;e++)f.lineTo(a[e].x*g,a[e].y*g);f.lineTo(a[0].x*g,a[0].y*g);f.closePath();f.fill();f.stroke()}};a.prototype.DrawCircle=function(a,d,e){if(d){var f=this.m_ctx,g=this.m_drawScale;f.beginPath();f.strokeStyle=this._color(e.color,this.m_alpha);f.arc(a.x*g,a.y*g,d*g,0,2*Math.PI,!0);f.closePath();f.stroke()}};a.prototype.DrawSolidCircle=function(a,d,e,f){if(d){var g=this.m_ctx,h=this.m_drawScale,k=a.x*h,l=a.y*h;g.moveTo(0,0);g.beginPath();g.strokeStyle=this._color(f.color,this.m_alpha);g.fillStyle=
this._color(f.color,this.m_fillAlpha);g.arc(k,l,d*h,0,2*Math.PI,!0);g.moveTo(k,l);g.lineTo((a.x+e.x*d)*h,(a.y+e.y*d)*h);g.closePath();g.fill();g.stroke()}};a.prototype.DrawSegment=function(a,d,e){var f=this.m_ctx,g=this.m_drawScale;f.strokeStyle=this._color(e.color,this.m_alpha);f.beginPath();f.moveTo(a.x*g,a.y*g);f.lineTo(d.x*g,d.y*g);f.closePath();f.stroke()};a.prototype.DrawTransform=function(a){var d=this.m_ctx,e=this.m_drawScale;d.beginPath();d.strokeStyle=this._color(16711680,this.m_alpha);
d.moveTo(a.position.x*e,a.position.y*e);d.lineTo((a.position.x+this.m_xformScale*a.R.col1.x)*e,(a.position.y+this.m_xformScale*a.R.col1.y)*e);d.strokeStyle=this._color(65280,this.m_alpha);d.moveTo(a.position.x*e,a.position.y*e);d.lineTo((a.position.x+this.m_xformScale*a.R.col2.x)*e,(a.position.y+this.m_xformScale*a.R.col2.y)*e);d.closePath();d.stroke()}})();var i;for(i=0;i<Box2D.postDefs.length;++i)Box2D.postDefs[i]();delete Box2D.postDefs;var mathSin=Math.sin;
Math.sin=function(a){return 0===a?0:mathSin(a)};var mathCos=Math.cos;Math.cos=function(a){return 0===a?1:mathCos(a)};
var b2Vec2=Box2D.Common.Math.b2Vec2,b2AABB=Box2D.Collision.b2AABB,b2BodyDef=Box2D.Dynamics.b2BodyDef,b2Body=Box2D.Dynamics.b2Body,b2FixtureDef=Box2D.Dynamics.b2FixtureDef,b2Fixture=Box2D.Dynamics.b2Fixture,b2World=Box2D.Dynamics.b2World,b2MassData=Box2D.Collision.Shapes.b2MassData,b2PolygonShape=Box2D.Collision.Shapes.b2PolygonShape,b2CircleShape=Box2D.Collision.Shapes.b2CircleShape,b2DebugDraw=Box2D.Dynamics.b2DebugDraw,b2MouseJointDef=Box2D.Dynamics.Joints.b2MouseJointDef,b2DistanceJointDef=Box2D.Dynamics.Joints.b2DistanceJointDef,
b2RevoluteJointDef=Box2D.Dynamics.Joints.b2RevoluteJointDef,b2PrismaticJointDef=Box2D.Dynamics.Joints.b2PrismaticJointDef,b2PulleyJointDef=Box2D.Dynamics.Joints.b2PulleyJointDef,b2GearJointDef=Box2D.Dynamics.Joints.b2GearJointDef,b2ContactListener=Box2D.Dynamics.b2ContactListener,b2ContactFilter=Box2D.Dynamics.b2ContactFilter,b2DestructionListener=Box2D.Dynamics.b2DestructionListener,box2d={SCALE:30,DEFAULT_DENSITY:1,DEFAULT_RESTITUTION:.2,DEFAULT_FRICTION:.5,bodyType:{dynamic:b2Body.b2_dynamicBody,
static:b2Body.b2_staticBody,kinematic:b2Body.b2_kinematicBody},createWorld:function(a,c){"undefined"==typeof a&&(a=new b2Vec2(0,10));"undefined"==typeof c&&(c=!0);return new b2World(a,c)},setDebugDraw:function(a,c){var d=new b2DebugDraw;d.SetSprite(c.getContext("2d"));d.SetFillAlpha(.5);d.SetLineThickness(1);d.SetFlags(b2DebugDraw.e_shapeBit|b2DebugDraw.e_jointBit);a.SetDebugDraw(d);box2d.setDebugDrawScale(a)},setDebugDrawScale:function(a){a&&a.m_debugDraw&&a.m_debugDraw.SetDrawScale(Utils.globalScale*
box2d.SCALE)},prepareBodyOptions:function(a){"object"!=typeof a&&(a={});a.x="undefined"!=typeof a.x?a.x:0;a.y="undefined"!=typeof a.y?a.y:0;a.rotation="undefined"!=typeof a.rotation?a.rotation:0;a.bodyType="undefined"!=typeof a.bodyType?a.bodyType:box2d.bodyType.dynamic;a.density="undefined"!=typeof a.density?a.density:box2d.DEFAULT_DENSITY;a.restitution="undefined"!=typeof a.restitution?a.restitution:box2d.DEFAULT_RESTITUTION;a.friction="undefined"!=typeof a.friction?a.friction:box2d.DEFAULT_FRICTION;
a.linearDamping="undefined"!=typeof a.linearDamping?a.linearDamping:0;a.angularDamping="undefined"!=typeof a.angularDamping?a.angularDamping:0;a.allowSleep="undefined"!=typeof a.allowSleep?a.allowSleep:!0;a.isSleeping="undefined"!=typeof a.isSleeping?a.isSleeping:!1;a.isBullet="undefined"!=typeof a.isBullet?a.isBullet:!1;a.fixedRotation="undefined"!=typeof a.fixedRotation?a.fixedRotation:!1;"undefined"==typeof a.filter&&(a.filter={});a.filter.categoryBits="undefined"!=typeof a.filter.categoryBits?
a.filter.categoryBits:1;a.filter.groupIndex="undefined"!=typeof a.filter.groupIndex?a.filter.groupIndex:0;a.filter.maskBits="undefined"!=typeof a.filter.maskBits?a.filter.maskBits:65535;a.isSensor="undefined"!=typeof a.isSensor?a.isSensor:!1;return a},fillFixtureDef:function(a,c){a.density=c.density;a.restitution=c.restitution;a.friction=c.friction;a.filter.categoryBits=c.filter.categoryBits;a.filter.groupIndex=c.filter.groupIndex;a.filter.maskBits=c.filter.maskBits;a.isSensor=c.isSensor;return a},
fillBodyDef:function(a,c){a.type=c.bodyType;a.angle=c.rotation;a.position.Set(c.x/box2d.SCALE,c.y/box2d.SCALE);a.linearDamping=c.linearDamping;a.angularDamping=c.angularDamping;a.allowSleep=c.allowSleep;a.isSleeping=c.isSleeping;a.isBullet=c.isBullet;a.fixedRotation=c.fixedRotation;return a},createCircle:function(a,c){c=box2d.prepareBodyOptions(c);c.radius="undefined"!=typeof c.radius?c.radius:10;var d=box2d.fillFixtureDef(new b2FixtureDef,c),e=box2d.fillBodyDef(new b2BodyDef,c);d.shape=new b2CircleShape(c.radius/
box2d.SCALE);e=a.CreateBody(e);e.CreateFixture(d);e.SetBullet(c.isBullet);return e},createBox:function(a,c){c=box2d.prepareBodyOptions(c);c.width="undefined"!=typeof c.width?c.width:20;c.height="undefined"!=typeof c.height?c.height:20;var d=box2d.fillFixtureDef(new b2FixtureDef,c),e=box2d.fillBodyDef(new b2BodyDef,c);d.shape=new b2PolygonShape;d.shape.SetAsBox(c.width/box2d.SCALE/2,c.height/box2d.SCALE/2);e=a.CreateBody(e);e.CreateFixture(d);e.SetBullet(c.isBullet);return e},createPoly:function(a,
c){c=box2d.prepareBodyOptions(c);c.points="undefined"!=typeof c.points?c.points:[];for(var d=box2d.fillBodyDef(new b2BodyDef,c),d=a.CreateBody(d),e,f=0;f<c.points.length;f++){var g=c.points[f];e=box2d.fillFixtureDef(new b2FixtureDef,c);e.shape=new b2PolygonShape;for(var h=[],k=0;k<g.length;k++)h.push(new b2Vec2(g[k][0]/box2d.SCALE,g[k][1]/box2d.SCALE));e.shape.SetAsVector(h,h.length);d.CreateFixture(e)}d.SetBullet(c.isBullet);return d},setBodyPosition:function(a,c,d){var e=a.GetPosition();"undefined"==
typeof c&&(c=e.x*box2d.SCALE);"undefined"==typeof d&&(d=e.y*box2d.SCALE);a.SetPosition(new b2Vec2(c/box2d.SCALE,d/box2d.SCALE))},setBodyPositionAndRotation:function(a,c,d,e){var f=a.GetPosition();"undefined"==typeof c&&(c=f.x*box2d.SCALE);"undefined"==typeof d&&(d=f.y*box2d.SCALE);"undefined"==typeof e&&(e=a.GetAngle());a.SetPositionAndAngle(new b2Vec2(c/box2d.SCALE,d/box2d.SCALE),e)},createDistanceJoint:function(a,c){"object"!=typeof c&&(c={});if(c.body1&&c.body2&&c.point1&&c.point2){c.collideConnected=
"undefined"!=typeof c.collideConnected?c.collideConnected:!1;var d=new b2DistanceJointDef;d.Initialize(c.body1,c.body2,new b2Vec2(c.point1.x/box2d.SCALE,c.point1.y/box2d.SCALE),new b2Vec2(c.point2.x/box2d.SCALE,c.point2.y/box2d.SCALE));d.collideConnected=c.collideConnected;return a.CreateJoint(d)}},createRevoluteJoint:function(a,c){"object"!=typeof c&&(c={});if(c.body1&&c.body2&&c.point){c.collideConnected="undefined"!=typeof c.collideConnected?c.collideConnected:!1;c.enableMotor="undefined"!=typeof c.enableMotor?
c.enableMotor:!1;c.motorSpeed="undefined"!=typeof c.motorSpeed?c.motorSpeed:0;c.maxMotorTorque="undefined"!=typeof c.maxMotorTorque?c.maxMotorTorque:NaN;c.enableLimit="undefined"!=typeof c.enableLimit?c.enableLimit:!1;c.lowerAngle="undefined"!=typeof c.lowerAngle?c.lowerAngle:0;c.upperAngle="undefined"!=typeof c.upperAngle?c.upperAngle:0;var d=new b2RevoluteJointDef;d.Initialize(c.body1,c.body2,new b2Vec2(c.point.x/box2d.SCALE,c.point.y/box2d.SCALE));d.collideConnected=c.collideConnected;d.enableMotor=
c.enableMotor;d.motorSpeed=c.motorSpeed;d.maxMotorTorque=c.maxMotorTorque;d.enableLimit=c.enableLimit;d.lowerAngle=c.lowerAngle;d.upperAngle=c.upperAngle;return a.CreateJoint(d)}},createPrismaticJoint:function(a,c){"object"!=typeof c&&(c={});if(c.body1&&c.body2&&c.point&&c.axis){c.collideConnected="undefined"!=typeof c.collideConnected?c.collideConnected:!1;c.lowerTranslation="undefined"!=typeof c.lowerTranslation?c.lowerTranslation:0;c.upperTranslation="undefined"!=typeof c.upperTranslation?c.upperTranslation:
0;c.enableLimit="undefined"!=typeof c.enableLimit?c.enableLimit:!1;c.motorForce="undefined"!=typeof c.motorForce?c.motorForce:0;c.motorSpeed="undefined"!=typeof c.motorSpeed?c.motorSpeed:0;c.enableMotor="undefined"!=typeof c.enableMotor?c.enableMotor:!1;var d=new b2PrismaticJointDef;d.Initialize(c.body1,c.body2,new b2Vec2(c.point.x/box2d.SCALE,c.point.y/box2d.SCALE),new b2Vec2(c.axis.x/box2d.SCALE,c.axis.y/box2d.SCALE));d.collideConnected=c.collideConnected;d.lowerTranslation=c.lowerTranslation/box2d.SCALE;
d.upperTranslation=c.upperTranslation/box2d.SCALE;d.enableLimit=c.enableLimit;d.motorForce=c.motorForce;d.motorSpeed=c.motorSpeed;d.enableMotor=c.enableMotor;return a.CreateJoint(d)}},createPulleyJoint:function(a,c){"object"!=typeof c&&(c={});if(c.body1&&c.body2&&c.groundAnchor1&&c.groundAnchor2&&c.anchor1&&c.anchor2){c.collideConnected="undefined"!=typeof c.collideConnected?c.collideConnected:!1;c.ratio="undefined"!=typeof c.ratio?c.ratio:1;c.maxLength1="undefined"!=typeof c.maxLength1?c.maxLength1:
1;c.maxLength2="undefined"!=typeof c.maxLength2?c.maxLength2:1;var d=new b2PulleyJointDef;d.Initialize(c.body1,c.body2,new b2Vec2(c.groundAnchor1.x/box2d.SCALE,c.groundAnchor1.y/box2d.SCALE),new b2Vec2(c.groundAnchor2.x/box2d.SCALE,c.groundAnchor2.y/box2d.SCALE),new b2Vec2(c.anchor1.x/box2d.SCALE,c.anchor1.y/box2d.SCALE),new b2Vec2(c.anchor2.x/box2d.SCALE,c.anchor2.y/box2d.SCALE),c.ratio);d.collideConnected=c.collideConnected;d.maxLength1=c.maxLength1/box2d.SCALE;d.maxLength2=c.maxLength2/box2d.SCALE;
return a.CreateJoint(d)}},createGearJoint:function(a,c){"object"!=typeof c&&(c={});if(c.body1&&c.body2&&c.joint1&&c.joint2){c.ratio="undefined"!=typeof c.ratio?c.ratio:1;c.collideConnected="undefined"!=typeof c.collideConnected?c.collideConnected:!1;var d=new b2GearJointDef;d.bodyA=c.body1;d.bodyB=c.body2;d.joint1=c.joint1;d.joint2=c.joint2;d.ratio=c.ratio;d.collideConnected=c.collideConnected;return a.CreateJoint(d)}},setContactsListener:function(a,c){c||(c={});var d=new b2ContactListener;c.beginContact&&
(d.BeginContact=c.beginContact);c.endContact&&(d.EndContact=c.endContact);c.preSolve&&(d.PreSolve=c.preSolve);c.postSolve&&(d.PostSolve=c.postSolve);a.SetContactListener(d)},setContactFilter:function(a,c){c||(c={});var d=new b2ContactFilter;c.shouldCollide&&(d.ShouldCollide=c.shouldCollide);a.SetContactFilter(d)},setDestructionListener:function(a,c){c||(c={});var d=new b2DestructionListener;c.sayGoodbyeFixture&&(d.SayGoodbyeFixture=c.sayGoodbyeFixture);c.sayGoodbyeJoint&&(d.SayGoodbyeJoint=c.sayGoodbyeJoint);
a.SetDestructionListener(d)},rayCast:function(a,c,d,e){a.RayCast(c,new b2Vec2(d.x/box2d.SCALE,d.y/box2d.SCALE),new b2Vec2(e.x/box2d.SCALE,e.y/box2d.SCALE))},syncStage:function(a){a=a.GetBodyList();for(var c,d;a;){if(c=a.GetUserData()||a.sprite)d=a.GetPosition(),c.x=d.x*box2d.SCALE,c.y=d.y*box2d.SCALE,c.rotation=a.GetAngle(),c.dispatchEvent("box2dsync",{target:c});a=a.GetNext()}},hitTest:function(a,c){if(!a||!c)return!1;for(var d=a.GetContactList();d;){if(d.contact.IsTouching()&&d.other==c)return!0;
d=d.next}return!1}};
handlers={buttonPress:function(a,c,d){this.animDelay=4;d=d||28;this.onchangeframe=function(a){a=a.target;a.currentFrame===a.totalFrames-1&&(a.stop(),a.setStatic(!0),a.onchangeframe=null)};this.onprerender=function(){switch(c){case "allBobs":for(var a=0;a<field.bobs.length;a++)this.checkHit(field.bobs[a]);break;case "bobAndBall":this.checkHit(bob);this.checkHit(levelsScripts[GET.debug?editorLevel:currentLevel].ball);break;default:this.checkHit(c||bob)}};this.checkHit=function(c){c&&Math.abs(c.x-this.x)<
d&&stage.hitTest(c,this)&&(this.setStatic(!1),this.onprerender=null,this.play(),a&&a(this))}},addHintArrow:function(a,c,d,e,f){var g,h,k;f?(f="arrow_yellow",g=20,h=27):(f="arrow_white",g=15,h=23);k=e?addToContainer(e,f,g,h,a,c):addSprite(f,g,h,a,c);k.rotation=d;var l=[{tweens:[{prop:"x",to:a+10*Math.sin(d)},{prop:"y",to:c-10*Math.cos(d)}],duration:750},{tweens:[{prop:"x",to:a},{prop:"y",to:c}],duration:750,onfinish:function(){Animation.play(k,l)}}];Animation.play(k,l);k.opacity=0;k.fadeTo(1,1E3);
return k},addTap:function(a,c,d){a=d?addToContainer(d,"tap",40,60,a,c):addSprite("tap",40,60,a,c);a.opacity=0;a.fadeTo(1,1E3);return a},destroyByOpacity:function(a){a.setStatic(!1);a.fadeTo(0,1E3,!1,function(a){a.target.obj.destroy=!0})},moveBridge:function(a,c,d,e,f,g,h){var k=a.box2dBody,l=box2d.getBodyPosition(k);a.setStatic(!1);if(f)if(Utils.isArray(f))for(var q=0;q<f.length;q++)f[q].setStatic(!1);else f.setStatic(!1);a.removeTweens();a.posx=l.x;a.posy=l.y;Animation.play(a,[{tweens:[{prop:"pos"+
c,to:d,onchange:function(e){box2d.setBodyPosition(k,a.posx,a.posy);if("y"===c&&"lift"===a.info&&a.y<d&&bob.x>a.x-a.width/2&&bob.x<a.x+a.width/2&&bob.y<a.y&&stage.hitTest(bob,a)){e=a.box2dBody.m_fixtureList.m_aabb.lowerBound.y;var f=bob.box2dBody.GetPosition();f.y=e-.582;bob.box2dBody.SetPosition(f)}}}],duration:e,ease:g,onfinish:function(){a.setStatic(!0);if(f)if(Utils.isArray(f))for(var c=0;c<f.length;c++)f[c].setStatic(!0);else f.setStatic(!0);h&&h()}}])},getStar:function(){function a(a,c,f){var g=
randInt(10,-10);randY=randInt(10,-10);var h=addSprite("star_trail",13,12,a+g,c+randY);h.setZIndex(f);h.scaleTo(0,300,!1,function(){h.destroy=!0})}var c=this;c.setStatic(!0);c.addEventListener("click",function(d){var e=181+24*field.starsCount;1===field.starsCount&&(e+=.8);e=[{tweens:[{prop:"y",to:c.y-15},{prop:"rotation",to:0}],duration:300},{tweens:[{prop:"y",to:305.5},{prop:"x",to:e,onchange:function(c){c=c.target.obj;var d=c.getAbsolutePosition();a(d.x,d.y,c.zIndex-1)}},{prop:"rotation",to:4*Math.PI}],
duration:500},{tweens:[{prop:"scaleX",to:.8},{prop:"scaleY",to:.8},{prop:"rotation",to:6*Math.PI}],duration:500,onfinish:function(){c.bitmap=bitmaps.star_finish;c.height++;c.y++;c.totalFrames=10;c.animDelay=3;c.play();c.onchangeframe=function(a){9===a.target.currentFrame&&a.target.gotoAndStop(0)}}}];d=d.target;d.collected||(playSound("star"+(field.starsCount+1)+"(SnailBob3)"),gameScore+=1E3,d.collected=!0,d.bitmap=bitmaps.star1,d.width=28,d.height=27,d.gotoAndStop(0),d.setZIndex(stage.findMaxZIndex().zIndex+
1),d.setStatic(!1),Animation.play(d,e),field.starsCount++,e=new TilesSprite(bitmaps.star_anim,78,78,18,9,2),e.x=d.x,e.y=d.y,e.animDelay=4,e.setZIndex(d.zIndex-1),e.onchangeframe=function(a){16===a.target.currentFrameX&&(a.target.destroy=!0)},stage.addChild(e))})},ifBobFall:function(a){var c;if(bob&&"fall"!==bob.state){switch(typeof a){case "number":bob.y>a&&(c=!0);break;case "function":c=a();break;case "object":c=!0;a.minY&&bob.y<a.minY&&(c=!1);a.minX&&bob.x<a.minX&&(c=!1);break;default:console.log("default condition")}c&&
bob.changeState("fall")}},setBaraban:function(a,c){c.onclick=function(c){a.animated||(a.animDirection="right"==bob.direction?1:-1,a.play(),playSound("TurnAround"),stage.hitTest(bob,a)&&33>Math.abs(box2d.getBodyPosition(bob.box2dBody).x-a.x)&&bob.turn())};a.animDelay=2;a.onchangeframe=function(a){a=a.target;a.animated&&0===a.currentFrame&&a.stop()}},setLaser:function(a,c,d,e){playSound("L8_S1_laser_out(SnailBob3)");a.lasers||(a.lasers=[]);var f,g;e?(f=("x"===d?stage.screenWidth:stage.screenHeight)-
c[d],g=c[d]+f/2):(f=c[d],g=f/2);var h=new Sprite(null,f,4);h.y=c.y;h.x=c.x;h[d]=g;h.rotation="x"===d?0:Math.PI/2;var k=[];for(g=0;g<stage.objects.length;g++)stage.objects[g].stopLaser&&k.push(stage.objects[g]);var l=[];for(g=0;g<k.length;g++)stage.hitTest(k[g],h)&&10<getDistance(k[g],c)&&l.push(k[g]);var q;for(g=0;g<l.length;g++)k=Math.abs(l[g][d]-c[d]),k<f&&(f=k,q=l[g]);g=0;var v;if(q)for(l=q.pixelCheck=!0;l;)v={x:c.x,y:c.y},e?g--:g++,v[d]=q[d]+g,stage.hitTestPointObject(q,v.x,v.y)||(l=!1);f-=Math.abs(g);
g=addSprite("laser",f+4,8,c.x,c.y);g[d]=c[d]+(e?f/2:-f/2);g.setZIndex(16);g.rotation=h.rotation;a.lasers.push(g);if(q&&.1<Math.abs(q.rotation/(Math.PI/2)%1)){c=!1;if(0<q.rotation&&e||0>q.rotation&&!e)c=!0;handlers.setLaser(a,{x:v.x,y:v.y},"x"===d?"y":"x",c)}},destroyLaser:function(a){if(a.lasers){for(var c=0;c<a.lasers.length;c++)a.lasers[c].destroy=!0;a.lasers=[]}},setResurretion:function(){function a(){c.blockBtn=!1;createObject({type:"Bob",x:c.x,y:c.y},findObject("Bob"));bob.init();field.bobs=
[bob];for(var a=0;a<field.freezeBobs.length;a++)field.bobs.push(field.freezeBobs[a]);a=new TilesSprite(bitmaps.resurrection_breath,66,68,26,13,2);a.x=c.x;a.y=c.y+30;a.animDelay=3;a.setZIndex(16);stage.addChild(a);a.onchangeframe=function(a){24===a.target.currentFrameX&&(a.target.destroy=!0)}}var c=this;c.setZIndex(17);addToContainer(c,"resurrection_mouth",42,12,1,30,!0);var d=new TilesSprite(bitmaps.resurrection_eyes,50,30,39,13,3);d.x=.8;d.y=15;d.onchangeframe=function(c){37===c.target.currentFrameX&&
(c.target.gotoAndStop(38),a())};c.addChild(d);d.gotoAndStop(38);var e=addToContainer(c,"resurrection_btn",26,26,-20,-13,!1,3),f=addToContainer(c,"resurrection_btn",26,26,19,-13,!1,3);e.onmousedown=f.onmousedown=function(a){a=a.target;if(!c.blockBtn){c.blockBtn=!0;a.gotoAndStop(2);a.onmousedown=returnFalse;a.onmouseover=a.onmouseout=null;bob.blockClick=!0;bob.fadeTo(0,1E3,!1,function(){bob.destroy=!0});world.DestroyBody(bob.box2dBody);var e=createObject({type:"freezeBob",x:bob.x,y:bob.y},findObject("freezeBob"));
e.opacity=0;e.fadeTo(1,1E3,!1,function(){e.box2dBody.SetAwake(!0);d.play()});e.box2dBody.SetFixedRotation(!0);e.box2dBody.SetAwake(!1);field.freezeBobs.push(e);playSound("Ch3_L5_GenieHides(SnailBob3)")}};e.onmouseover=f.onmouseover=function(a){a.target.gotoAndStop(1)};e.onmouseout=f.onmouseout=function(a){a.target.gotoAndStop(0)};c.leftBtn=e;c.rightBtn=f;field.freezeBobs=[];field.bobs=[bob]},setFan:function(a,c,d,e){function f(c){if(c.hitTestPoint(a.checkPoint.x,a.checkPoint.y)){var d=c.box2dBody;
if(c===bob){c.cancelSpeed=!0;var f=1===a.scaleX?.4:1;stage.clearInterval(bob.returnSpeedInt);bob.returnSpeedInt=stage.setInterval(function(){var a=d.GetLinearVelocity();a.x+=0>a.x?.02:-.02;d.SetLinearVelocity(a);Math.abs(d.GetLinearVelocity().x)<f&&(c.cancelSpeed=!1,stage.clearInterval(bob.returnSpeedInt))},1)}d.SetLinearVelocity(new b2Vec2(0,0));d.ApplyImpulse(e,d.GetPosition())}}c.onclick=function(){-.2>a.rotation||(a.removeTweens(),Animation.play(a,[{tweens:[{prop:"rotation",to:-Math.PI/2*a.scaleX}],
duration:500,ease:Easing.exponential.easeOut},{tweens:[{prop:"rotation",to:0}],duration:500,ease:Easing.exponential.easeOut}]),playSound("L1_S3_Turn_Head(SnailBob3)"),stage.setTimeout(function(){switch(d){case "allBobs":for(var a=0;a<field.bobs.length;a++)f(field.bobs[a]);break;case "ball":f(levelsScripts[GET.debug?editorLevel:currentLevel].ball);break;default:f(d)}},50))};d=d||bob;a.anchor={x:-15,y:-16};a.checkPoint={x:a.x+5*a.scaleX,y:a.y-16};e=e||new b2Vec2(-5*a.scaleX,-2)},moveFrogPlatform:function(a,
c,d){var e;c=c||500;this.onclick=function(){e="button_left"===this.custom?a.state-1:a.state+1;0>e||e>a.coords.length-1||(playSound("L4_S2_Frog_scroll_2(SnailBob3)"),a.state=e,a.removeTweens(),stage.createTween(a,"x",a.x,a.coords[e],c,d).play())}},movePlatform:function(a,c,d){function e(){a.removeTweens()}d=d||10;var f=a.box2dBody;this.addEventListener("mousedown",function(e){e=-1!==e.target.custom.indexOf("button_left")?!1:!0;e&&a.x>=c||!e&&a.x<=c||(a.posX=a.x,e=Math.abs(a.x-c)*d,e=stage.createTween(a,
"posX",a.x,c,e),e.onchange=function(c){var d=f.GetPosition(),e=a.posX/box2d.SCALE;c=e-d.x;d.x=e;f.SetPosition(d);"hide"===bob.state&&bob.y<a.y&&stage.hitTest(bob,a)&&bob.x>a.x-a.width/2&&bob.x<a.x+a.width/2&&(d=bob.box2dBody.GetPosition(),d.x+=c,bob.box2dBody.SetPosition(d))},e.play())});this.addEventListener("mouseup",e);this.addEventListener("mouseout",e)}};var NONE=0,BOX=1,CIRCLE=2,POLY=3;
function spritesSync(a,c,d){c=new Vector(-a.target.syncX,-a.target.syncY);c.rotate(-a.target.rotation);a.target.x+=c.x;a.target.y+=c.y}
var platform_density=0,platform_restitution=.01,platform_friction=.5,objects=[{name:"Bob",image:"Bob/Bob.png",width:48,height:39,bodyWidth:35,bodyHeight:39,frames:1,bodyType:CIRCLE,bodyPosCorrect:{x:0,y:0},fixed:!1,info:"bob",density:1,restitution:.2,friction:1},{name:"freezeBob",image:"Bob/freezeBob.png",width:48,height:39,bodyWidth:39,bodyType:CIRCLE,bodyPosCorrect:{x:0,y:-1},fixed:!1,info:"freezeBob",density:1,restitution:.2,friction:.1},{name:"tube1",image:"tube1.png",width:79,height:57,bodyType:NONE,
info:"tube"},{name:"tube2",image:"tube2.png",width:79,height:57,bodyType:NONE,info:"tube"},{name:"tube3",image:"tube3.png",width:56,height:56,bodyType:NONE,info:"tube"},{name:"tube4",image:"tube4.png",width:38,height:42,bodyType:NONE,info:"tube"},{name:"tube5",image:"tube5.png",width:62,height:54,bodyType:NONE,info:"tube"},{name:"invisible_wall_very_small",image:"invisible_wall_very_small.png",width:26,height:4,bodyType:BOX,info:"invisible",density:platform_density,restitution:platform_restitution,
friction:platform_friction},{name:"invisible_wall_small",image:"invisible_wall_small.png",width:50,height:5,bodyType:BOX,info:"invisible",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"invisible_wall_big",image:"invisible_wall_big.png",width:150,height:5,bodyType:BOX,info:"invisible",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"stopLaser",image:"stopLaser.png",width:26,height:4,bodyType:NONE,info:"stopLaser_invisible"},
{name:"fan",image:"fan.png",width:34,height:36,bodyType:NONE,info:"fan"},{name:"resurrection",image:"resurrection/resurrection_face.png",width:92,height:62,bodyType:NONE,info:"resurrection"},{name:"fire",image:"fire_on.png",width:36,height:99,bodyType:NONE,frames:22,rows:2,columns:11,info:"fire"},{name:"lever",image:"lever.png",width:44,height:56,frames:9,rows:3,columns:3,bodyType:NONE,info:"lever"},{name:"lever2",image:"lever2.png",width:56,height:38,frames:7,bodyType:NONE,info:"lever2"},{name:"baraban",
image:"Baraban.png",type:BOX,width:58,height:26,bodyWidth:58,bodyHeight:21,frames:15,bodyType:BOX,info:"baraban",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"btn2",image:"btn2.png",width:28,height:12,bodyHeight:5,frames:5,bodyType:BOX,bodyPosCorrect:{x:0,y:3},density:platform_density,restitution:.2,friction:.01,info:"btn2"},{name:"button_red",image:"button_red.png",width:30,height:30,frames:3,bodyType:NONE,info:"button"},{name:"button_green",image:"button_green.png",
width:24,height:24,frames:2,bodyType:NONE,info:"button"},{name:"lamp_check",image:"lamp_check.png",width:30,height:32,frames:2,bodyType:NONE,info:"lamp"},{name:"lamp_green",image:"lamp_green.png",width:36,height:36,frames:2,bodyType:NONE,info:"lamp"},{name:"lamp_blue",image:"lamp_blue.png",width:36,height:36,frames:2,bodyType:NONE,info:"lamp"},{name:"lamp_blue2",image:"lamp_blue2.png",width:28,height:28,frames:2,bodyType:NONE,info:"lamp"},{name:"lamp_green2",image:"lamp_green2.png",width:28,height:28,
frames:2,bodyType:NONE,info:"lamp"},{name:"lamp_red2",image:"lamp_red2.png",width:28,height:28,frames:2,bodyType:NONE,info:"lamp"},{name:"cover_baraban",image:"cover_baraban.png",width:40,height:60,bodyType:NONE,info:"cover_baraban"},{name:"mirrow",image:"mirrow.png",width:48,height:44,frames:2,bodyType:NONE,info:"mirrow"},{name:"frog",image:"frog.png",width:62,height:50,frames:15,rows:5,columns:3,bodyType:NONE,info:"frog"},{name:"frog_tongue",image:"frog_tongue.png",width:8,height:60,frames:6,rows:1,
columns:6,bodyType:NONE,info:"frog_tongue"},{name:"star1",image:"stars/star1.png",width:28,height:27,bodyType:NONE,info:"star"},{name:"star2",image:"stars/star2.png",width:28,height:27,bodyType:NONE,info:"star"},{name:"star3",image:"stars/star3.png",width:28,height:27,bodyType:NONE,info:"star"},{name:"star4",image:"stars/star4.png",width:28,height:27,bodyType:NONE,info:"star"},{name:"star5",image:"stars/star5.png",width:28,height:27,bodyType:NONE,info:"star"},{name:"star6",image:"stars/star6.png",
width:28,height:27,bodyType:NONE,info:"star"},{name:"star7",image:"stars/star7.png",width:28,height:27,bodyType:NONE,info:"star"},{name:"star8",image:"stars/star8.png",width:28,height:27,bodyType:NONE,info:"star"},{name:"star9",image:"stars/star9.png",width:28,height:27,bodyType:NONE,info:"star"},{name:"star10",image:"stars/star10.png",width:28,height:27,bodyType:NONE,info:"star"},{name:"star11",image:"stars/star11.png",width:28,height:27,bodyType:NONE,info:"star"},{name:"portal_lvl1",image:"levels/01/portal_lvl1.png",
width:118,height:68,frames:59,rows:14,columns:5,bodyType:NONE,info:"portal_lvl1"},{name:"billboard",image:"levels/01/billboard.png",width:92,height:44,frames:40,rows:20,columns:2,bodyType:NONE,info:"billboard"},{name:"lift_part1_lvl1",image:"levels/01/lift_part1_lvl1.png",width:29,height:51,bodyType:BOX,info:"lift_part1",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"lift_part2_lvl1",image:"levels/01/lift_part2_lvl1.png",width:29,height:55,bodyType:NONE,
info:"lift_part2"},{name:"bridge_lvl1",image:"levels/01/bridge_lvl1.png",width:14,height:48,bodyType:BOX,info:"bridge",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"earth1_lvl1",image:"levels/01/earth1_lvl1.jpg",width:16,height:52,bodyType:NONE,info:"cover"},{name:"earth2_lvl1",image:"levels/01/earth2_lvl1.jpg",width:16,height:52,bodyType:NONE,info:"cover"},{name:"earth_lift",image:"levels/01/earth_lift.jpg",width:26,height:50,bodyType:NONE,info:"cover"},
{name:"earth_portal",image:"levels/01/earth_portal.png",width:24,height:6,bodyType:NONE,info:"cover_portal"},{name:"palm",image:"levels/01/palm.png",width:28,height:18,bodyType:NONE,info:"cover"},{name:"bridge1_lvl2",image:"levels/02/bridge1_lvl2.png",width:149,height:16,bodyHeight:14,bodyType:BOX,info:"bridge1",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"bridge2_lvl2",image:"levels/02/bridge2_lvl2.png",width:14,height:52,bodyType:BOX,info:"bridge2",
density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"cover1_lvl2",image:"levels/02/cover1_lvl2.png",width:150,height:18,bodyType:NONE,info:"cover"},{name:"cover2_lvl2",image:"levels/02/cover2_lvl2.png",width:150,height:18,bodyType:NONE,info:"cover"},{name:"cover3_lvl2",image:"levels/02/cover3_lvl2.jpg",width:14,height:52,bodyType:NONE,info:"cover"},{name:"cover4_lvl2",image:"levels/02/cover4_lvl2.png",width:28,height:28,bodyType:NONE,info:"cover"},{name:"cover5_lvl2",
image:"levels/02/cover5_lvl2.png",width:28,height:14,bodyType:NONE,info:"cover"},{name:"cover6_lvl2",image:"levels/02/cover6_lvl2.png",width:16,height:26,bodyType:NONE,info:"cover"},{name:"spring_lvl3",image:"levels/03/spring_lvl3.png",width:66,height:46,frames:12,bodyType:NONE,info:"spring_lvl3"},{name:"bridge_lvl3",image:"levels/03/bridge_lvl3.png",width:16,height:94,bodyType:BOX,info:"bridge",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"star_lvl3",
image:"stars/star1.png",width:28,height:27,bodyType:CIRCLE,info:"star",density:2,restitution:.2,friction:.5},{name:"flap",image:"levels/03/flap.png",width:32,height:30,bodyType:NONE,info:"flap"},{name:"bob_eyes",image:"levels/03/bob_eyes.png",width:22,height:28,frames:10,bodyType:NONE,info:"bob_eyes"},{name:"cover1_lvl3",image:"levels/03/cover1_lvl3.png",width:26,height:26,bodyType:NONE,info:"cover"},{name:"earth1_lvl3",image:"levels/03/earth1_lvl3.png",width:52,height:24,bodyType:NONE,info:"cover"},
{name:"earth2_lvl3",image:"levels/03/earth2_lvl3.png",width:20,height:26,bodyType:NONE,info:"cover"},{name:"frog_laser",image:"levels/04/frog_laser.png",width:34,height:50,bodyType:NONE,info:"frog_laser"},{name:"bridge1_lvl4",image:"levels/04/bridge1_lvl4.png",width:70,height:20,bodyHeight:16,bodyType:BOX,info:"bridge_stopLaser",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"bridge2_lvl4",image:"levels/04/bridge2_lvl4.png",width:16,height:52,bodyType:BOX,
info:"bridge_stopLaser",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"wheel",image:"levels/04/wheel.png",width:16,height:16,bodyType:CIRCLE,info:"wheel",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"push_wall",image:"levels/04/push_wall.png",width:26,height:44,bodyWidth:16,bodyPosCorrect:{x:2,y:0},bodyType:BOX,info:"stopLaser_pushWall",density:platform_density,restitution:platform_restitution,friction:platform_friction},
{name:"cover1_lvl4",image:"levels/04/cover1_lvl4.png",width:72,height:20,bodyType:NONE,info:"cover"},{name:"cover2_lvl4",image:"levels/04/cover2_lvl4.png",width:22,height:60,bodyType:NONE,info:"cover"},{name:"cover3_lvl4",image:"levels/04/cover3_lvl4.png",width:42,height:50,bodyType:NONE,info:"cover"},{name:"earth1_lvl4",image:"levels/04/earth1_lvl4.png",width:18,height:20,bodyType:NONE,info:"earth1_lvl4"},{name:"earth2_lvl4",image:"levels/04/earth2_lvl4.png",width:18,height:28,bodyType:NONE,info:"earth2_lvl4"},
{name:"earth3_lvl4",image:"levels/04/earth3_lvl4.png",width:14,height:18,bodyType:NONE,info:"earth3_lvl4"},{name:"cover_star_lvl4",image:"levels/04/cover_star_lvl4.png",width:32,height:32,bodyType:NONE,info:"cover"},{name:"cover_conveyor",image:"levels/04/cover_conveyor.png",width:200,height:20,bodyType:NONE,info:"cover_conveyor"},{name:"star_doors",image:"levels/04/star_doors.png",width:34,height:32,frames:9,rows:3,columns:3,bodyType:NONE,info:"star_doors"},{name:"bridge1_lvl5",image:"levels/05/bridge1_lvl5.png",
width:48,height:18,bodyHeight:15,bodyType:BOX,info:"bridge",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"bridge2_lvl5",image:"levels/05/bridge2_lvl5.png",width:66,height:16,bodyHeight:13,bodyType:BOX,info:"bridge",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"cover1_lvl5",image:"levels/05/cover1_lvl5.png",width:70,height:28,bodyType:NONE,info:"cover"},{name:"cover2_lvl5",image:"levels/05/cover2_lvl5.png",
width:70,height:20,bodyType:NONE,info:"cover"},{name:"cover3_lvl5",image:"levels/05/cover3_lvl5.png",width:60,height:26,bodyType:NONE,info:"cover3_lvl5"},{name:"cover4_lvl5",image:"levels/05/cover4_lvl5.png",width:70,height:50,bodyType:NONE,info:"cover"},{name:"cover5_lvl5",image:"levels/05/cover5_lvl5.png",width:38,height:38,bodyType:NONE,info:"cover5_lvl5"},{name:"cover6_lvl5",image:"levels/05/cover6_lvl5.png",width:34,height:34,bodyType:NONE,info:"cover"},{name:"hedge_lvl5",image:"levels/05/hedge_lvl5.png",
width:22,height:28,bodyType:POLY,points:[[[-11,-14],[0,-14],[11,10],[-11,14]]],info:"hedge_lvl5",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"ball_lvl5",image:"levels/05/ball_lvl5.png",width:70,height:70,bodyWidth:23,bodyPosCorrect:{x:2,y:.5},bodyType:CIRCLE,frames:12,rows:4,columns:3,info:"ball_lvl5",density:1,restitution:.2,friction:.5},{name:"frog_platform",image:"levels/05/frog_platform.png",width:60,height:20,bodyType:NONE,info:"frog_platform"},
{name:"spring_lvl5",image:"levels/05/spring_lvl5.png",width:60,height:40,bodyWidth:55,bodyHeight:14,bodyPosCorrect:{x:0,y:13},bodyType:BOX,frames:12,rows:4,columns:3,info:"spring_lvl5",density:1,restitution:.01,friction:.2},{name:"spring2_lvl5",image:"levels/05/spring2_lvl5.png",width:62,height:48,bodyWidth:30,bodyHeight:38,bodyPosCorrect:{x:-8,y:0},bodyType:BOX,frames:12,rows:4,columns:3,info:"spring2_lvl5",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"wheel_carriage",
image:"levels/05/wheel_carriage.png",width:18,height:18,bodyType:CIRCLE,info:"wheel_carriage",density:1,restitution:.1,friction:.5},{name:"carriage",image:"levels/05/carriage.png",width:58,height:16,bodyWidth:54,bodyHeight:15,bodyPosCorrect:{x:0,y:2},bodyType:BOX,info:"carriage",density:1,restitution:.1,friction:.5},{name:"pillar_lvl5",image:"levels/05/pillar_lvl5.png",width:58,height:10,bodyHeight:6,bodyType:BOX,info:"bridge",density:platform_density,restitution:platform_restitution,friction:platform_friction},
{name:"button_lvl5",image:"levels/05/button_lvl5.png",width:24,height:20,bodyType:NONE,info:"cover"},{name:"triangle",image:"levels/05/triangle.png",width:18,height:10,bodyType:NONE,info:"triangle"},{name:"cover1_lvl6",image:"levels/06/cover1_lvl6.png",width:62,height:22,bodyType:NONE,info:"cover"},{name:"cover2_lvl6",image:"levels/06/cover2_lvl6.png",width:22,height:20,bodyType:NONE,info:"cover"},{name:"cover3_lvl6",image:"levels/06/cover3_lvl6.png",width:34,height:34,bodyType:NONE,info:"cover"},
{name:"cover4_lvl6",image:"levels/06/cover4_lvl6.png",width:42,height:58,bodyType:NONE,info:"cover4_lvl6"},{name:"cover5_lvl6",image:"levels/06/cover5_lvl6.png",width:42,height:58,bodyType:NONE,info:"cover5_lvl6"},{name:"frog_fire",image:"levels/06/frog_fire.png",width:34,height:20,bodyType:NONE,info:"frog_fire"},{name:"cover1_lvl7",image:"levels/07/cover1_lvl7.png",width:80,height:42,bodyType:NONE,info:"cover1_lvl7"},{name:"cover2_lvl7",image:"levels/07/cover2_lvl7.png",width:106,height:100,bodyType:NONE,
info:"cover2_lvl7"},{name:"cover3_lvl7",image:"levels/07/cover3_lvl7.png",width:18,height:22,bodyType:NONE,info:"cover3_lvl7"},{name:"cover4_lvl7",image:"levels/07/cover4_lvl7.png",width:104,height:32,bodyType:NONE,info:"cover"},{name:"cover5_lvl7",image:"levels/07/cover5_lvl7.png",width:56,height:22,bodyType:NONE,info:"cover"},{name:"ad_lvl7",image:"levels/07/ad_lvl7.png",width:108,height:54,frames:40,rows:10,columns:4,bodyType:NONE,info:"ad_lvl7"},{name:"bridge1_lvl7",image:"levels/07/bridge1_lvl7.png",
width:68,height:16,bodyHeight:14,bodyType:BOX,info:"bridge",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"bridge2_lvl7",image:"levels/07/bridge2_lvl7.png",width:18,height:64,bodyHeight:58,bodyType:BOX,info:"bridge",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"bridge3_lvl7",image:"levels/07/bridge3_lvl7.png",width:52,height:16,bodyWidth:46,bodyHeight:14,bodyType:BOX,info:"bridge",density:platform_density,
restitution:platform_restitution,friction:platform_friction},{name:"bridgeLever_lvl7",image:"levels/07/bridgeLever_lvl7.png",width:64,height:14,bodyHeight:12,bodyType:BOX,info:"rotateByLever",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"face_rotate",image:"levels/07/face_rotate.png",width:26,height:26,bodyType:NONE,info:"face_rotate"},{name:"ball_lvl7",image:"levels/07/ball_lvl7.png",width:30,height:30,bodyWidth:29,bodyType:CIRCLE,info:"ball_lvl7",density:1.1,
restitution:.2,friction:.5},{name:"cover_baraban_lvl8",image:"levels/08/cover_baraban.png",width:70,height:72,bodyType:NONE,info:"cover_baraban"},{name:"cover_lava",image:"levels/08/cover_lava.png",width:136,height:48,bodyType:NONE,info:"cover_lava"},{name:"cover_paper",image:"levels/08/cover_paper.png",width:50,height:42,bodyType:NONE,info:"cover"},{name:"cover_roll",image:"levels/08/cover_roll.png",width:40,height:40,bodyType:NONE,info:"cover"},{name:"cover_stat",image:"levels/08/cover_stat.png",
width:36,height:32,bodyType:NONE,info:"cover"},{name:"eyes_lvl8",image:"levels/08/eyes_lvl8.png",width:20,height:28,bodyType:NONE,info:"cover"},{name:"lava",image:"levels/08/lava.png",width:94,height:24,frames:9,rows:3,columns:3,bodyType:NONE,info:"lava"},{name:"platform_lvl8",image:"levels/08/platform_lvl8.png",width:50,height:50,bodyHeight:12,bodyPosCorrect:{x:0,y:-18},bodyType:BOX,info:"bridge",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"roll1",
image:"levels/08/roll1.png",width:22,height:48,bodyType:NONE,info:"cover"},{name:"roll2",image:"levels/08/roll2.png",width:40,height:36,bodyType:NONE,info:"cover"},{name:"roll3",image:"levels/08/roll3.png",width:12,height:54,bodyType:NONE,info:"cover"},{name:"bridge1_lvl9",image:"levels/09/bridge1_lvl9.png",width:62,height:18,bodyType:BOX,info:"bridge",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"bridge2_lvl9",image:"levels/09/bridge2_lvl9.png",width:18,
height:92,bodyType:BOX,info:"bridge",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"coverBridge1_lvl9",image:"levels/09/coverBridge1_lvl9.png",width:70,height:24,bodyType:NONE,info:"cover"},{name:"coverBridge2_lvl9",image:"levels/09/coverBridge2_lvl9.png",width:18,height:26,bodyType:NONE,info:"cover"},{name:"coverWall_lvl9",image:"levels/09/coverWall_lvl9.png",width:32,height:38,bodyType:NONE,info:"cover"},{name:"coverFan1_lvl9",image:"levels/09/coverFan1_lvl9.png",
width:46,height:42,bodyType:NONE,info:"coverFan1_lvl9"},{name:"coverFan2_lvl9",image:"levels/09/coverFan2_lvl9.png",width:42,height:42,bodyType:NONE,info:"coverFan2_lvl9"},{name:"lamp_lvl9",image:"levels/09/lamp_lvl9.png",width:48,height:32,frames:14,rows:7,columns:2,bodyType:NONE,info:"lamp_lvl9"},{name:"cover1_lvl10",image:"levels/10/cover1_lvl10.png",width:36,height:66,bodyType:NONE,info:"cover"},{name:"cover2_lvl10",image:"levels/10/cover2_lvl10.png",width:58,height:14,bodyType:NONE,info:"cover"},
{name:"cover3_lvl10",image:"levels/10/cover3_lvl10.png",width:36,height:36,bodyType:NONE,info:"cover"},{name:"frog_magnet",image:"levels/10/frog_magnet.png",width:46,height:50,bodyType:NONE,info:"frog_magnet"},{name:"circle_lvl10",image:"levels/10/circle_lvl10.png",width:12,height:12,bodyType:NONE,info:"circle_lvl10"},{name:"stick_lvl10",image:"levels/10/stick_lvl10.png",width:134,height:10,bodyHeight:4,bodyWidth:130,bodyPosCorrect:{x:0,y:-.5},bodyType:BOX,info:"stick_lvl10",density:2,restitution:.01,
friction:1},{name:"box_lvl10",image:"levels/10/box_lvl10.png",width:44,height:44,bodyWidth:42,bodyHeight:42,bodyType:BOX,info:"box_lvl10",density:10,restitution:.01,friction:50},{name:"bird_sit",image:"levels/10/bird_sit.png",width:32,height:34,frames:18,rows:3,columns:6,bodyType:NONE,info:"bird"},{name:"magnet_start",image:"levels/10/magnet_start.png",width:38,height:48,frames:10,rows:5,columns:2,bodyType:NONE,info:"magnet"},{name:"cover_bridge_lvl11",image:"levels/11/cover_bridge_lvl11.png",width:76,
height:22,bodyType:NONE,info:"cover"},{name:"cover_lava1_lvl11",image:"levels/11/cover_lava1_lvl11.png",width:16,height:62,bodyType:NONE,info:"cover_lava1_lvl11"},{name:"cover_lava2_lvl11",image:"levels/11/cover_lava2_lvl11.png",width:22,height:68,bodyType:NONE,info:"cover_lava2_lvl11"},{name:"cover_lava_lvl11",image:"levels/11/cover_lava_lvl11.png",width:86,height:26,bodyType:NONE,info:"cover_lava_lvl11"},{name:"cover_lift_lvl11",image:"levels/11/cover_lift_lvl11.png",width:60,height:76,bodyType:NONE,
info:"cover"},{name:"cover_piramid_lvl11",image:"levels/11/cover_piramid_lvl11.png",width:50,height:22,bodyType:NONE,info:"cover"},{name:"cover_star_lvl11",image:"levels/11/cover_star_lvl11.png",width:32,height:32,bodyType:NONE,info:"cover"},{name:"bridge_lvl11",image:"levels/11/bridge_lvl11.png",width:68,height:16,bodyHeight:14,bodyType:BOX,info:"bridge",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"lift_lvl11",image:"levels/11/lift_lvl11.png",width:50,
height:188,bodyWidth:46,bodyHeight:184,bodyType:BOX,info:"lift",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"mirrow_lvl11",image:"levels/11/mirrow_lvl11.png",width:44,height:40,frames:2,bodyType:NONE,info:"mirrow_lvl11"},{name:"lava_lvl11",image:"levels/11/lava_lvl11.png",width:88,height:58,frames:14,rows:7,columns:2,bodyType:NONE,info:"lava"},{name:"star_lvl11",image:"levels/11/star_lvl11.png",width:34,height:34,frames:10,rows:5,columns:2,bodyType:NONE,
info:"star"},{name:"arrow_lvl12",image:"levels/12/arrow_lvl12.png",width:24,height:24,bodyType:NONE,info:"arrow_lvl12"},{name:"boxing_glove",image:"levels/12/boxing_glove.png",width:96,height:64,frames:12,rows:6,columns:2,bodyType:NONE,info:"boxing_glove"},{name:"bridge_lvl12",image:"levels/12/bridge_lvl12.png",width:82,height:16,bodyHeight:14,bodyType:BOX,info:"bridge",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"coverBridge_lvl12",image:"levels/12/coverBridge_lvl12.png",
width:90,height:24,bodyType:NONE,info:"cover"},{name:"coverSpider_lvl12",image:"levels/12/coverSpider_lvl12.png",width:96,height:60,bodyType:NONE,info:"cover"},{name:"coverStar1_lvl12",image:"levels/12/coverStar1_lvl12.png",width:72,height:14,bodyType:NONE,info:"cover"},{name:"coverStar2_lvl12",image:"levels/12/coverStar2_lvl12.png",width:36,height:28,bodyType:NONE,info:"cover"},{name:"coverStar3_lvl12",image:"levels/12/coverStar3_lvl12.png",width:36,height:26,bodyType:NONE,info:"cover"},{name:"face_lvl12",
image:"levels/12/face_lvl12.png",width:18,height:26,frames:5,bodyType:NONE,info:"face_lvl12"},{name:"paw1",image:"levels/12/paw1.png",width:78,height:18,bodyType:NONE,info:"paw1"},{name:"paw2",image:"levels/12/paw2.png",width:78,height:18,bodyType:NONE,info:"paw2"},{name:"btn_stop",image:"levels/13/btn_stop.png",width:26,height:26,frames:2,bodyType:NONE,info:"button"},{name:"cover_lvl13_1",image:"levels/13/cover_lvl13_1.png",width:252,height:20,frames:1,bodyType:NONE,info:"cover_lvl13_1"},{name:"cover_lvl13_2",
image:"levels/13/cover_lvl13_2.png",width:48,height:88,frames:1,bodyType:NONE,info:"cover_lvl13_2"},{name:"cover_lvl13_3",image:"levels/13/cover_lvl13_3.png",width:72,height:22,frames:1,bodyType:NONE,info:"cover_lvl13_3"},{name:"cover_lvl13_4",image:"levels/13/cover_lvl13_4.png",width:56,height:78,frames:1,bodyType:NONE,info:"cover_lvl13_4"},{name:"cover_lvl13_5",image:"levels/13/cover_lvl13_5.png",width:62,height:76,frames:1,bodyType:NONE,info:"cover_lvl13_5"},{name:"cover_lvl13_6",image:"levels/13/cover_lvl13_6.png",
width:94,height:58,frames:1,bodyType:NONE,info:"cover_lvl13_6"},{name:"cover_lvl13_7",image:"levels/13/cover_lvl13_7.png",width:90,height:58,frames:1,bodyType:NONE,info:"cover_lvl13_7"},{name:"electro_platform",image:"levels/13/electro_platform.png",width:50,height:92,frames:10,bodyWidth:28,bodyHeight:74,bodyType:BOX,bodyPosCorrect:{x:-3,y:0},fixed:!0,density:3,restitution:.2,friction:2,info:"electro_platform"},{name:"lava_corner",image:"levels/13/lava_corner.png",width:16,height:20,frames:1,bodyType:NONE,
info:"lava_corner"},{name:"lava_horizontal",image:"levels/13/lava_horizontal.png",width:172,height:24,frames:33,bodyType:NONE,info:"lava_horizontal"},{name:"lava_vertical",image:"levels/13/lava_vertical.png",width:16,height:138,frames:32,rows:5,columns:7,bodyType:NONE,info:"lava_vertical"},{name:"platform_lvl13",image:"levels/13/platform_lvl13.png",width:62,height:20,frames:1,bodyWidth:62,bodyHeight:20,bodyType:POLY,points:[[[-29,-28],[-25,-28],[-25,5],[-29,5]],[[22,-28],[29,-28],[29,5],[22,5]],[[-29,
5],[-29,-3],[29,-3],[29,5]]],bodyPosCorrect:{x:0,y:0},fixed:!0,density:3,restitution:.2,friction:2,info:"platform_lvl13"},{name:"star_lvl13_1",image:"levels/13/star_lvl13_1.png",width:26,height:26,frames:1,bodyType:NONE,info:"star_1"},{name:"star_lvl13_2",image:"levels/13/star_lvl13_2.png",width:26,height:26,frames:1,bodyType:NONE,info:"star_2"},{name:"star_lvl13_3",image:"levels/13/star_lvl13_3.png",width:26,height:26,frames:1,bodyType:NONE,info:"star_3"},{name:"star_lvl13_4",image:"levels/13/star_lvl13_4.png",
width:26,height:26,frames:1,bodyType:NONE,info:"star_4"},{name:"tooth_d",image:"levels/13/tooth_d.png",width:16,height:28,frames:1,bodyType:NONE,info:"tooth_d"},{name:"tooth_u",image:"levels/13/tooth_u.png",width:16,height:28,frames:1,bodyType:NONE,info:"tooth_u"},{name:"destination_tube_lvl13",image:"levels/13/destination_tube_lvl13.png",width:122,height:60,frames:1,bodyType:NONE,info:"destination_tube_lvl13"},{name:"bridge_lvl14",image:"levels/14/bridge_lvl14.png",width:58,height:18,bodyHeight:16,
bodyType:BOX,info:"bridge",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"coverBridge_lvl14",image:"levels/14/coverBridge_lvl14.png",width:74,height:24,bodyType:NONE,info:"cover"},{name:"coverBut_lvl14",image:"levels/14/coverBut_lvl14.png",width:32,height:32,bodyType:NONE,info:"cover"},{name:"coverLift_lvl14",image:"levels/14/coverLift_lvl14.png",width:56,height:108,bodyType:NONE,info:"cover"},{name:"coverStar1_lvl14",image:"levels/14/coverStar1_lvl14.png",
width:30,height:20,bodyType:NONE,info:"cover"},{name:"coverStar3_lvl14",image:"levels/14/coverStar3_lvl14.png",width:40,height:40,bodyType:NONE,info:"cover"},{name:"lift_lvl14",image:"levels/14/lift_lvl14.png",width:48,height:180,bodyHeight:177,bodyWidth:46,bodyType:BOX,info:"lift",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"platform_lvl14",image:"levels/14/platform_lvl14.png",width:62,height:24,bodyWidth:56,bodyHeight:20,bodyType:BOX,info:"platform",
density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"conv_circle1_lvl15",image:"levels/15/conv_circle1_lvl15.png",width:16,height:16,frames:1,bodyWidth:14,bodyHeight:16,bodyType:CIRCLE,bodyPosCorrect:{x:0,y:0},fixed:!0,density:3,restitution:.2,friction:2,info:"wheel"},{name:"conv_circle2_lvl15",image:"levels/15/conv_circle2_lvl15.png",width:16,height:16,frames:1,bodyWidth:14,bodyHeight:16,bodyType:CIRCLE,bodyPosCorrect:{x:0,y:0},fixed:!0,density:3,restitution:.2,
friction:2,info:"wheel"},{name:"conveyor_lvl15",image:"levels/15/conveyor_lvl15.png",width:254,height:18,frames:1,bodyType:NONE,info:"conveyor"},{name:"cover1_lvl15",image:"levels/15/cover1_lvl15.png",width:34,height:22,frames:1,bodyType:NONE,info:"cover1"},{name:"cover2_lvl15",image:"levels/15/cover2_lvl15.png",width:24,height:34,frames:1,bodyType:NONE,info:"cover2"},{name:"down_lighting",image:"levels/15/down_lighting.png",width:18,height:12,frames:1,bodyType:NONE,info:"down_lightning"},{name:"down_wall_lvl15",
image:"levels/15/down_wall_lvl15.png",width:32,height:60,frames:1,bodyType:NONE,info:"down_wall_lvl15"},{name:"green_fish_lvl15",image:"levels/15/green_fish_lvl15.png",width:50,height:72,frames:1,bodyType:NONE,info:"green_fish_lvl15"},{name:"lamp_green_lvl15",image:"levels/15/lamp_green_lvl15.png",width:36,height:36,frames:2,bodyType:NONE,info:"lamp_green_lvl15"},{name:"platform_lvl15",image:"levels/15/platform_lvl15.png",width:62,height:24,frames:1,bodyWidth:62,bodyHeight:20,bodyType:BOX,bodyPosCorrect:{x:0,
y:0},fixed:!0,density:3,restitution:.2,friction:2,info:"platform_lvl15"},{name:"red_fish_lvl15",image:"levels/15/red_fish_lvl15.png",width:46,height:72,frames:1,bodyType:NONE,info:"red_fish_lvl15"},{name:"small_wall_lvl15",image:"levels/15/small_wall_lvl15.png",width:16,height:32,frames:1,bodyWidth:14,bodyHeight:30,bodyType:BOX,bodyPosCorrect:{x:0,y:0},fixed:!0,density:3,restitution:.2,friction:2,info:"small_wall"},{name:"square_green_lvl15",image:"levels/15/square_green_lvl15.png",width:28,height:28,
frames:2,bodyType:NONE,info:"square_green"},{name:"square_red_lvl15",image:"levels/15/square_red_lvl15.png",width:28,height:28,frames:2,bodyType:NONE,info:"square_red"},{name:"star_doors_lvl15",image:"levels/15/star_doors_lvl15.png",width:34,height:32,rows:3,columns:3,frames:9,bodyType:NONE,info:"star_doors"},{name:"star_rock_lvl15",image:"levels/15/star_rock_lvl15.png",width:24,height:24,frames:2,bodyType:NONE,info:"star_rock"},{name:"tube_on_blue_lvl15",image:"levels/15/tube_on_blue_lvl15.png",
width:62,height:55,frames:1,bodyType:NONE,info:"pipe"},{name:"tube_on_green_lvl15",image:"levels/15/tube_on_green_lvl15.png",width:62,height:55,frames:1,bodyType:NONE,info:"pipe"},{name:"tube_on_red_lvl15",image:"levels/15/tube_on_red_lvl15.png",width:62,height:55,frames:1,bodyType:NONE,info:"pipe"},{name:"wall_big_lvl15",image:"levels/15/wall_big_lvl15.png",width:18,height:58,frames:1,bodyWidth:16,bodyHeight:56,bodyType:BOX,bodyPosCorrect:{x:0,y:0},fixed:!0,density:3,restitution:.2,friction:2,info:"wall_big"},
{name:"ad_lvl16",image:"levels/16/ad_lvl16.png",width:102,height:48,frames:122,rows:14,columns:9,bodyType:NONE,info:"ad_lvl16"},{name:"blind_lvl16",image:"levels/16/blind_lvl16.png",width:126,height:66,bodyType:NONE,info:"cover"},{name:"coverBridge2_lvl16",image:"levels/16/coverBridge2_lvl16.png",width:66,height:22,bodyType:NONE,info:"cover"},{name:"coverStar_lvl16",image:"levels/16/coverStar_lvl16.png",width:30,height:32,bodyType:NONE,info:"cover"},{name:"coverStar2_lvl16",image:"levels/16/coverStar2_lvl16.png",
width:60,height:60,bodyType:NONE,info:"cover"},{name:"coverStar3_lvl16",image:"levels/16/coverStar3_lvl16.png",width:40,height:40,bodyType:NONE,info:"cover"},{name:"coverWall_lvl16",image:"levels/16/coverWall_lvl16.png",width:26,height:72,bodyType:NONE,info:"cover"},{name:"platform_lvl16",image:"levels/16/platform_lvl16.png",width:62,height:24,bodyWidth:56,bodyHeight:22,bodyType:BOX,info:"platform",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"bridge2_lvl16",
image:"levels/16/bridge2_lvl16.png",width:62,height:18,bodyHeight:15,bodyType:BOX,info:"bridge",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"wall_lvl16",image:"levels/16/wall_lvl16.png",width:20,height:62,bodyHeight:60,bodyType:BOX,info:"bridge",density:platform_density,restitution:platform_restitution,friction:platform_friction},{name:"light_lvl16",image:"final/portalLight_final.png",width:26,height:70,frames:20,rows:2,columns:10,bodyType:NONE,info:"light_lvl16"},
{name:"bridge_green_lvl17_1",image:"levels/17/bridge_green_lvl17_1.png",width:52,height:16,bodyWidth:52,bodyHeight:12,bodyType:BOX,bodyPosCorrect:{x:0,y:-1},fixed:!0,density:3,restitution:.2,friction:2,info:"bridge_green_lvl17_1"},{name:"bridge_green_lvl17_2",image:"levels/17/bridge_green_lvl17_2.png",width:56,height:16,bodyWidth:56,bodyHeight:16,bodyType:BOX,bodyPosCorrect:{x:0,y:0},fixed:!0,density:3,restitution:.2,friction:2,info:"bridge_green_lvl17_2"},{name:"bridge_lvl17",image:"levels/17/bridge_lvl17.png",
width:50,height:152,frames:1,bodyWidth:50,bodyHeight:152,bodyType:BOX,bodyPosCorrect:{x:0,y:0},fixed:!0,density:3,restitution:.2,friction:2,info:"bridge_lvl17"},{name:"cover_lvl17_1",image:"levels/17/cover_lvl17_1.png",width:58,height:22,bodyType:NONE,info:"cover_lvl17_1",fixed:!0},{name:"cover_lvl17_2",image:"levels/17/cover_lvl17_2.png",width:66,height:22,bodyType:NONE,info:"cover_lvl17_2",fixed:!0},{name:"cover_lvl17_3",image:"levels/17/cover_lvl17_3.png",width:54,height:64,bodyType:NONE,info:"cover_lvl17_3",
fixed:!0},{name:"doors_lvl17",image:"levels/17/doors_lvl17.png",width:34,height:84,frames:9,rows:1,columns:9,bodyType:NONE,info:"doors_lvl17"},{name:"eye_triangle_lvl17",image:"levels/17/eye_triangle_lvl17.png",width:50,height:46,frames:6,rows:3,columns:2,bodyType:NONE,info:"eye_triangle_lvl17"},{name:"head_lvl17",image:"levels/17/head_lvl17.png",width:26,height:28,bodyType:NONE,info:"head_lvl17"},{name:"lamp_green_lvl17",image:"levels/17/lamp_green_lvl17.png",width:36,height:36,frames:2,bodyType:NONE,
info:"lamp_green_lvl17"},{name:"red_button_lvl_17",image:"levels/17/red_button_lvl_17.png",width:26,height:26,frames:3,bodyType:NONE,info:"red_button_lvl_17"},{name:"star_lvl17",image:"levels/17/star_lvl17.png",width:27,height:26,bodyType:NONE,info:"star_lvl17"},{name:"bridge_lvl18",image:"levels/18/bridge_lvl18.png",width:68,height:16,frames:1,bodyWidth:64,bodyHeight:14,bodyType:BOX,bodyPosCorrect:{x:0,y:0},fixed:!0,density:3,restitution:.2,friction:2,info:"bridge"},{name:"ball_lvl18",image:"levels/18/ball_lvl18.png",
width:28,height:30,frames:1,bodyWidth:26,bodyHeight:30,bodyType:CIRCLE,bodyPosCorrect:{x:0,y:-1},fixed:!1,density:120,restitution:0,friction:.5,info:"ball_lvl18"},{name:"ant_lvl18",image:"levels/18/ant_worker.png",width:30,height:24,frames:12,rows:4,columns:3,bodyWidth:16,bodyHeight:16,bodyType:CIRCLE,bodyPosCorrect:{x:0,y:2},fixed:!1,density:14,restitution:0,friction:.1,info:"ant_lvl18"},{name:"ant_beach",image:"levels/18/ant_beach.png",width:22,height:28,frames:12,rows:3,columns:4,bodyWidth:18,
bodyHeight:18,bodyType:CIRCLE,bodyPosCorrect:{x:0,y:3},fixed:!1,density:14,restitution:0,friction:.1,info:"ant_beach"},{name:"hoover_end",image:"levels/18/hoover_end.png",width:60,height:46,frames:12,rows:4,columns:3,bodyType:NONE,info:"hoover_end"},{name:"umbrella_lvl18",image:"levels/18/umbrella_lvl18.png",width:50,height:36,frames:5,bodyType:NONE,info:"umbrella"},{name:"cover1_lvl18",image:"levels/18/cover1_lvl18.png",width:73,height:20,frames:1,bodyType:NONE,info:"cover1"},{name:"cover2_lvl18",
image:"levels/18/cover2_lvl18.png",width:84,height:42,frames:1,bodyType:NONE,info:"cover2"},{name:"cover3_lvl18",image:"levels/18/cover3_lvl18.png",width:50,height:52,frames:1,bodyType:NONE,info:"cover3"},{name:"cover4_lvl18",image:"levels/18/cover4_lvl18.png",width:76,height:92,frames:1,bodyType:NONE,info:"cover4"},{name:"hoover_lvl18",image:"levels/18/hoover_lvl18.png",width:140,height:128,frames:1,bodyType:NONE,info:"hoover"},{name:"press_lvl18",image:"levels/18/press_lvl18.png",width:68,height:110,
frames:1,bodyWidth:68,bodyHeight:55,bodyType:BOX,bodyPosCorrect:{x:0,y:27.5},fixed:!0,density:3,restitution:.2,friction:2,info:"press_lvl18"},{name:"cover_lvl19_1",image:"levels/19/cover1.png",width:62,height:18,frames:1,bodyType:NONE,info:"cover_lvl19_1"},{name:"cover_lvl19_2",image:"levels/19/cover2.png",width:64,height:22,frames:1,bodyType:NONE,info:"cover_lvl19_2"},{name:"cover_lvl19_3",image:"levels/19/cover3.png",width:96,height:76,frames:1,bodyType:NONE,info:"cover_lvl19_3"},{name:"cover_lvl19_4",
image:"levels/19/cover4.png",width:122,height:84,frames:1,bodyType:NONE,info:"cover_lvl19_4"},{name:"cover_lvl19_5",image:"levels/19/cover5.png",width:12,height:36,frames:1,bodyType:NONE,info:"cover_lvl19_5"},{name:"cover_lvl19_6",image:"levels/19/cover6.png",width:28,height:14,frames:1,bodyType:NONE,info:"cover_lvl19_6"},{name:"cover_lvl19_7",image:"levels/19/cover7.png",width:54,height:98,frames:1,bodyType:NONE,info:"cover_lvl19_7"},{name:"cover_lvl19_8",image:"levels/19/cover8.png",width:18,height:34,
frames:1,bodyType:NONE,info:"cover_lvl19_7"},{name:"green_light_lvl19",image:"levels/19/green_light_lvl19.png",width:28,height:28,frames:2,bodyType:NONE,info:"green_light_lvl19"},{name:"red_light_lvl19",image:"levels/19/red_light_lvl19.png",width:10,height:10,frames:2,bodyType:NONE,info:"red_light_lvl19"},{name:"electro_ball_off",image:"levels/19/electro_ball_off.png",width:32,height:32,frames:1,rows:1,columns:1,bodyType:NONE,info:"shocker"},{name:"boss_lvl20",image:"levels/20/boss_state_stay.png",
width:102,height:60,frames:24,rows:6,columns:4,bodyWidth:35,bodyHeight:360,bodyType:CIRCLE,bodyPosCorrect:{x:15,y:4},fixed:!1,density:3,restitution:.2,friction:2,info:"boss_lvl20"},{name:"bridge_lvl20",image:"levels/20/bridge_lvl20.png",width:60,height:18,frames:1,bodyWidth:58,bodyHeight:16,bodyType:BOX,fixed:!0,density:3,restitution:.2,friction:2,info:"bridge_lvl20"},{name:"cover_lvl20_1",image:"levels/20/cover_lvl20_1.png",width:156,height:10,bodyType:NONE,info:"cover_lvl20_1"},{name:"cover_lvl20_2",
image:"levels/20/cover_lvl20_2.png",width:42,height:42,bodyType:NONE,info:"cover_lvl20_2"},{name:"cover_lvl20_3",image:"levels/20/cover_lvl20_3.png",width:66,height:20,bodyType:NONE,info:"cover_lvl20_3"},{name:"cover_lvl20_4",image:"levels/20/cover_lvl20_4.png",width:22,height:98,bodyType:NONE,info:"cover_lvl20_4"},{name:"cover_lvl20_5",image:"levels/20/cover_lvl20_5.png",width:31,height:78,bodyType:NONE,info:"cover_lvl20_5"},{name:"cover_lvl20_6",image:"levels/20/cover_lvl20_6.png",width:64,height:20,
bodyType:NONE,info:"cover_lvl20_6"},{name:"cover_lvl20_7",image:"levels/20/cover_lvl20_7.png",width:72,height:46,bodyType:NONE,info:"cover_lvl20_7"},{name:"cover_lvl20_8",image:"levels/20/cover_lvl20_8.png",width:24,height:46,bodyType:NONE,info:"cover_lvl20_8"},{name:"star_cover_lvl20",image:"levels/20/star_cover_lvl20.png",width:22,height:40,bodyType:NONE,info:"star_cover_lvl20"},{name:"star_lvl20",image:"levels/20/star_lvl20.png",width:28,height:26,bodyType:NONE,info:"star_lvl20"},{name:"lift_lvl_20",
image:"levels/20/lift_lvl_20.png",width:50,height:188,frames:1,bodyWidth:46,bodyHeight:184,bodyType:BOX,bodyPosCorrect:{x:0,y:0},fixed:!0,density:3,restitution:.2,friction:2,info:"lift"},{name:"lift_star_lvl20",image:"levels/20/lift_star_lvl20.png",width:28,height:26,bodyType:NONE,info:"lift_star_lvl20"},{name:"mirror_wall_lvl20",image:"levels/20/mirror_wall_lvl20.png",width:18,height:60,frames:10,rows:1,columns:10,bodyWidth:15,bodyHeight:56,bodyType:BOX,bodyPosCorrect:{x:0,y:0},fixed:!0,density:3,
restitution:.2,friction:2,info:"mirror_wall_lvl20"},{name:"portal_lvl20",image:"levels/20/portal_lvl20.png",width:56,height:64,frames:12,rows:6,columns:2,bodyType:NONE,info:"portal_lvl20"},{name:"obstacle_lvl20",image:"levels/20/obstacle_lvl20.png",width:17,height:60,frames:1,bodyWidth:15,bodyHeight:58,bodyType:BOX,bodyPosCorrect:{x:0,y:0},fixed:!0,density:3,restitution:.2,friction:2,info:"obstacle_lvl20"}],levelsScripts=[{init:function(){var a=this,c=getObjectByInfo("portal_lvl1");c.setStatic(!1);
c.play();c.animDelay=5;c.onchangeframe=function(c){50===c.target.currentFrameX&&a.bobAppears();57===c.target.currentFrameX&&(c.target.gotoAndStop(58),c.target.setStatic(!0),stage.setTimeout(function(){getObjectByInfo("cover_portal").setStatic(!0)},1))};playSound("bob_portal");c=getObjectByInfo("billboard");c.animDelay=3;c.onchangeframe=this.billboardAnim;c.play();c=getObjectByInfo("button");c.onclick=this.btnAction;this.btn=c;c=getObjectByInfo("btn2");this.lift=getObjectByInfo("lift_part1");handlers.buttonPress.call(c,
a.moveLift,bob,30);this.liftPart2=getObjectByInfo("lift_part2");this.liftPart2.setZIndex(8);this.earthLift=getObjectByCustomInfo("earth_lift");c=getObjectByCustomInfo("star1");c.onclick=this.starAction;c.hitArea={x:0,y:0,width:0,height:0};this.star1=c},starAction:function(a){if(!a.target.done){var c=levelsScripts[0];a.target.done=!0;playSound("DoorOpening3");c.liftPart2.setStatic(!1);stage.createTween(c.liftPart2,"y",c.liftPart2.y,106,1E4).play();handlers.moveBridge(c.lift,"y",154,1E4,c.earthLift,
!1,function(){c.liftPart2.setStatic(!0)});c.arrowStar1&&c.arrowStar1.destroyByOpacity();c.addStarsHints();field.destination.setStatic(!1)}},addStarsHints:function(){for(var a=getObjectByInfo("star"),c=0;c<a.length;c++){var d=a[c];d.bitmap!==bitmaps.star1&&d.bitmap!==bitmaps.star_finish&&(d.arrow=handlers.addHintArrow(d.x+40,d.y,-Math.PI/2),d.tap=handlers.addTap(d.x+75,d.y+10),d.onclick=function(a){a.target.arrow.destroyByOpacity();a.target.tap.destroyByOpacity()})}},btnAction:function(a){a=a.target;
var c=getObjectByCustomInfo("bridge1"),d=getObjectByCustomInfo("bridge2"),e=getObjectByCustomInfo("earth_bridge1"),f=getObjectByCustomInfo("earth_bridge2");handlers.moveBridge(a.state?d:c,"y",159,1E3,a.state?f:e,Easing.quartic.easeOut);handlers.moveBridge(a.state?c:d,"y",207,1E3,a.state?e:f,Easing.quartic.easeOut);a.state=!a.state;a.state?playSound("DoorLeft"):playSound("DoorRight")},moveLift:function(){var a=levelsScripts[0],c=Easing.quartic.easeOut;a.star1.setStatic(!1);a.liftPart2.setStatic(!1);
stage.createTween(a.liftPart2,"y",a.liftPart2.y,155,1E3,c).play();handlers.moveBridge(a.lift,"y",205,1E3,a.earthLift,c,function(){a.liftPart2.setStatic(!0)});playSound("DoorLeft");stage.setTimeout(function(){a.star1.hitArea=null;a.arrowStar1=handlers.addHintArrow(325,150,2.1);addSprite("hint2_lvl1",79,24,285,130,!0);handlers.addTap(300,172)},500)},billboardAnim:function(a){var c=a.target;!c.animated||20!==c.currentFrameX&&0!==c.currentFrameX||(c.stop(),stage.setTimeout(function(){c.gotoAndPlay(c.currentFrameX+
1)},3E3))},bobAppears:function(){createObject({type:"Bob",x:165,y:58,rotation:0},findObject("Bob"));bob.init();var a=bob.box2dBody;a.ApplyImpulse(new b2Vec2(-6,-1),a.GetPosition());stage.setTimeout(this.addHint1,800);playSound("bob_portalwall")},addHint1:function(){var a=levelsScripts[0];a.btn.addHint();a.arrowBtn=handlers.addHintArrow(214,134,-2.1);addSprite("hint1_lvl1",140,38,140,60,!0)},ifRemoveHint1:function(){bob&&200<bob.x&&!this.btn.hintRemoved&&(this.btn.hintRemoved=!0,this.btn.removeHint(),
this.arrowBtn.destroyByOpacity())},pretick:function(){levelsScripts[0].ifRemoveHint1()}},{init:function(){var a=getObjectByCustomInfo("btn_bridge");a.onclick=this.btnAction;a.addHint();a=getObjectByInfo("btn2");handlers.buttonPress.call(a,this.moveBridges);var c=getObjectByInfo("baraban"),d=getObjectByCustomInfo("btnBaraban");d.addHint();handlers.setBaraban(c,d);this.hint1=addSprite("hint1_lvl2",130,48,a.x,a.y-100,!0);handlers.addHintArrow(0,40,Math.PI,this.hint1);this.hint4=null},btnAction:function(a){a=
a.target;var c=getObjectByInfo("bridge2");handlers.moveBridge(c,"y",a.state?192:242,700,getObjectByCustomInfo("cover_bridge"),Easing.quartic.easeOut);a.state=!a.state;a.state?playSound("DoorLeft"):playSound("DoorRight")},changeHints:function(){var a=levelsScripts[1];a.hint1.setStatic(!1);var c=stage.createTween(a.hint1,"y",a.hint1.y,-70,800,Easing.quartic.easeOut);c.play();c.onfinish=function(){a.hint1.destroy=!0;"hide"===bob.state&&(a.hint3=addSprite("hint3_lvl2",175,44,a.hint1.x,a.hint1.y),handlers.addHintArrow(0,
40,Math.PI,a.hint3,!0),stage.createTween(a.hint3,"y",a.hint3.y,30,800,Easing.quartic.easeOut).play(),a.hint3.onchangeframe=function(a){"hide"!==bob.state&&1===a.target.opacity&&a.target.destroyByOpacity()})};getObjectByCustomInfo("start_tube").setStatic(!0)},moveBridges:function(){var a=levelsScripts[1],c=getObjectByCustomInfo("bridge1"),d=getObjectByCustomInfo("bridge2");playSound("DoorOpening3");handlers.moveBridge(c,"x",247,5E3,getObjectByCustomInfo("cover_bridge1"),!1,a.changeHints);stage.setTimeout(function(){handlers.moveBridge(d,
"x",247,5E3,getObjectByCustomInfo("cover_bridge2"))},1300);a.hint3=addSprite("hint2_lvl2",77,16,bob.x+105,bob.y);a.hint3.onprerender=function(a){a.target.x=bob.x+105;1===a.target.opacity&&("hide"===bob.state||180<bob.x)&&a.target.destroyByOpacity()};handlers.addHintArrow(-55,0,-Math.PI/2,a.hint3,!0);handlers.addTap(-27,37,a.hint3)},ifAddStarsHints:function(){function a(a,d,e,f){a.bitmap!==bitmaps.star1&&a.bitmap!==bitmaps.star_finish&&(a.arrow=handlers.addHintArrow(a.x+d,a.y+e,f),a.tap=handlers.addTap(a.x+
d+(0<d?35:-35),a.y+e+10),a.tap.setZIndex(14),a.onclick=function(a){a=a.target;a.arrow.destroyByOpacity();a.tap.destroyByOpacity()})}-1===bob.scaleX&&185>bob.x&&field.destination.static&&(field.destination.setStatic(!1),a(getObjectByCustomInfo("star_left"),40,5,-Math.PI/2),a(getObjectByCustomInfo("star_middle"),40,0,-Math.PI/2),a(getObjectByCustomInfo("star_palm"),-40,5,Math.PI/2),levelsScripts[1].hint4.destroyByOpacity())},ifAddHint4:function(){var a=levelsScripts[1];335>bob.x&&-1===bob.scaleX&&!a.hint4&&
(a.hint4=addSprite("hint4_lvl2",163,51,180,50,!0),handlers.addHintArrow(-95,-15,-1.2,a.hint4))},pretick:function(){var a=levelsScripts[1];handlers.ifBobFall(230);a.ifAddStarsHints();a.ifAddHint4()}},{init:function(){var a=levelsScripts[2],c=getObjectByCustomInfo("spring_left");c.scaleX=-1;c.distance=30;c.force=new b2Vec2(7.8,-7.5);this.springLeft=c;c=getObjectByCustomInfo("spring_right");c.distance=33;c.force=new b2Vec2(-7.5,-4.5);this.springRight=c;this.springs=getObjectByInfo("spring_lvl3");for(c=
0;c<this.springs.length;c++)this.springs[c].animDelay=2,this.springs[c].onchangeframe=function(a){11===a.target.currentFrame&&a.target.gotoAndStop(0)};handlers.setBaraban(getObjectByInfo("baraban"),getObjectByCustomInfo("btnBaraban"));this.earthArr=[getObjectByCustomInfo("earth1"),getObjectByCustomInfo("earth2")];getObjectByCustomInfo("btn_bridge").onclick=this.btnAction;this.bridge=getObjectByInfo("bridge");c=getObjectByCustomInfo("starFlap");c.setPropScale(.9);c.onclick=function(a){a.target.scaleTo(1,
300);a.target.onclick=null};var d=getObjectByCustomInfo("bottomFlap"),e=getObjectByCustomInfo("upFlap");d.addEventListener("click",function(){a.moveFlap.call(d)});d.addEventListener("click",function(){return!1});e.addEventListener("click",function(){e.block||stage.setTimeout(function(){f.play(e.state?0:6)},e.state?100:200)});e.addEventListener("click",function(){a.moveFlap.call(e)});var f=getObjectByInfo("bob_eyes");f.onchangeframe=function(a){a=a.target;9===a.currentFrame&&a.gotoAndStop(0);e.state||
5!==a.currentFrame||a.gotoAndStop(6)};f.gotoAndStop(6);stage.setInterval(function(){e.state&&!e.block&&f.gotoAndPlay(0)},2E3);this.startTube=getObjectByCustomInfo("start_tube");field.speedPanel.setZIndex(this.startTube.zIndex+1);field.speedPanel.setStatic(!1);this.star=null},moveFlap:function(){var a=this;if(!a.block){var c=stage.createTween(a,"x",a.x,a.state?374:405,400);c.play();c.onfinish=function(){a.block=!1};a.block=!0;a.state=!a.state;playSound("Dveri_open_3(SnailBob3)")}},addStar:function(){!this.star&&
350<bob.x&&(this.startTube.setStatic(!0),field.speedPanel.setStatic(!0),field.destination.setStatic(!1),this.star=createObject({type:"star_lvl3",x:124,y:-50,rotation:0},findObject("star_lvl3")),this.star.setStatic(!1),this.star.hitArea={x:0,y:0,width:50,height:50},this.star.onclick=function(a){a=a.target;for(world.DestroyBody(a.box2dBody);a.rotation>Math.PI;)a.rotation-=Math.PI/2;a.onclick=a.onchangeframe=null},this.star.onchangeframe=function(a){240<a.target.y&&field.bottomUIBack.setStatic(!1)})},
btnAction:function(a){a=a.target;handlers.moveBridge(levelsScripts[2].bridge,"y",a.state?104:201,500,levelsScripts[2].earthArr,Easing.quartic.easeOut);a.state=!a.state;a.state?playSound("DoorLeft"):playSound("DoorRight")},spingsAction:function(){function a(a,c){c&&!a.animated&&getDistance(c,a)<a.distance&&(function(a){stage.setTimeout(function(){var d=c.box2dBody;d.SetLinearVelocity(new b2Vec2(0,0));d.SetAngularVelocity(c===bob?0:4);d.ApplyImpulse(a.force,d.GetPosition())},3*a.changeFrameTime);playSound("Spring")}(a),
a.play())}for(var c=0;c<this.springs.length;c++){var d=this.springs[c];a(d,bob);a(d,this.star)}},ifCancelSpeed:function(){var a=bob.box2dBody,c=levelsScripts[2].bridge;60>getDistance(bob,c)&&box2d.hitTest(c.box2dBody,a)&&(a.m_linearVelocity.x=0)},pretick:function(){var a=levelsScripts[2];a.spingsAction();a.addStar();a.ifCancelSpeed();handlers.ifBobFall(245)}},{init:function(){var a=levelsScripts[3];this.frog=getObjectByInfo("frog_laser");this.pushWall=getObjectByInfo("stopLaser_pushWall");this.pushWall.setStatic(!0);
this.pushWall.wheel=addToContainer(this.pushWall,"wheel",16,16,4,13,!0);this.star1=getObjectByCustomInfo("star1");this.star2=getObjectByCustomInfo("star2");this.star1.onclick=this.star2.onclick=function(){return!1};var c=getObjectByCustomInfo("btn_up"),d=getObjectByCustomInfo("btn_down");c.onclick=d.onclick=this.moveFrog;c=getObjectByInfo("btn2");handlers.buttonPress.call(c,a.moveBridges);var e=getObjectByInfo("mirrow");this.changeMirrowState.call(e[1]);for(c=0;c<e.length;c++)(function(c){e[c].onclick=
function(d){a.changeMirrowState.call(e[c])}})(c);d=getObjectByInfo("wheel");for(c=0;c<d.length;c++)d[c].onprerender=function(a){a.target.box2dBody.SetAngle(a.target.box2dBody.GetAngle()-.3)};this.earth1=getObjectByInfo("earth1_lvl4");this.earth2=getObjectByInfo("earth2_lvl4");this.earth3=getObjectByInfo("earth3_lvl4");this.earth1.setStatic(!0);this.earth2.setStatic(!0);this.earth3.setStatic(!0);this.bridge2=getObjectByCustomInfo("bridge2")},reCalcLaser:function(){if(gameState===STATE_GAME){var a=
levelsScripts[3].frog;handlers.destroyLaser(a);handlers.setLaser(a,{x:a.x+17,y:a.y-1.5},"x",!0)}},changeMirrowState:function(){var a=levelsScripts[3],c=a.frog,d;0===this.currentFrame?(this.gotoAndStop(1),d=!1):(this.gotoAndStop(0),d=!0);for(var e=0;e<this.lasers.length;e++)this.lasers[e].stopLaser=d;258===c.y&&a.reCalcLaser();stage.refreshBackground();playSound("StonePlatformsStarMoving(SnailBob3)")},moveBridges:function(){var a=getObjectByCustomInfo("bridge1"),c=getObjectByCustomInfo("bridge2"),
d=getObjectByCustomInfo("lamp1"),e=getObjectByCustomInfo("lamp2"),f=getObjectByCustomInfo("cover1"),g=getObjectByCustomInfo("cover2"),f=[d,f],g=[e,g],h=levelsScripts[3],k=h.frog;d.gotoAndStop(1);e.gotoAndStop(1);handlers.moveBridge(a,"x",393,500,f,!1,function(){193===k.y&&h.reCalcLaser();a.box2dBody.SetPosition(new b2Vec2(393/box2d.SCALE,97.8/box2d.SCALE))});handlers.moveBridge(c,"y",228,500,g);field.destination.setStatic(!1);h.pushWall.setStatic(!1)},moveFrog:function(){var a=levelsScripts[3],c=
a.frog,d;d="btn_down"===this.custom?258:193;if(c.y!==d){playSound("L4_S2_Frog_scroll_2(SnailBob3)");handlers.destroyLaser(c);var e=5*Math.abs(c.y-d);c.removeTweens();c=stage.createTween(c,"y",c.y,d,e);c.play();c.onfinish=a.reCalcLaser}},ifBobOnConveyor:function(){var a=!1;if(!(410<bob.x)){var c=bob.box2dBody.GetContactList();for(c;c;c=c.next)"wheel"===c.other.sprite.info&&(a=!0);a&&(bob.box2dBody.m_linearVelocity.x=-2)}},ifPushWall:function(){var a=levelsScripts[3],c=a.frog.lasers[0],d=a.pushWall,
e=d.box2dBody,f=d.wheel,a=a.bridge2;c&&191.5===c.y&&220<a.y&&390>d.x&&(d=e.GetPosition(),d.x+=.02,e.SetPosition(d),c.width+=.02*box2d.SCALE,c.x+=.02*box2d.SCALE/2,f.rotation+=.4)},ifBobOnLaser:function(){var a=levelsScripts[3].frog;if("onLaser"!==bob.state)for(var c=0;c<a.lasers.length;c++){var d=a.lasers[c];stage.hitTest(d,bob)&&20>Math.min(Math.abs(bob.x-d.x),Math.abs(bob.y-d.y))&&bob.changeState("onLaser")}},showStar1:function(){var a=levelsScripts[3],c=a.frog.lasers[1],d=getObjectByCustomInfo("laser_star1"),
e=getObjectByCustomInfo("lampCheck");0===e.currentFrame&&c&&stage.hitTest(c,d)&&(getObjectByInfo("star_doors").play(),e.gotoAndStop(1),stage.refreshBackground(),a.star1.onclick=null,playSound("Battery"))},showStar2:function(){var a=levelsScripts[3],c=a.frog.lasers[0],d=getObjectByCustomInfo("laser_star2"),e=a.earth1,f=a.earth2,g=a.earth3;c&&a.star2.onclick&&stage.hitTest(c,d)&&(a.star2.onclick=null,field.bottomUIBack.setStatic(!1),e.setStatic(!1),f.setStatic(!1),g.setStatic(!1),playSound("L3_S3_Laser_rock(SnailBob3)"),
a=[{tweens:[{prop:"x",to:f.x-30,ease:Easing.quadratic.easeOut},{prop:"y",to:f.y+100,ease:Easing.quadratic.easeIn}],duration:1E3}],c=[{tweens:[{prop:"x",to:g.x-15,ease:Easing.quadratic.easeOut},{prop:"y",to:g.y+100,ease:Easing.quadratic.easeIn}],duration:1E3,onfinish:function(){e.destroy=f.destroy=g.destroy=!0;field.bottomUIBack.setStatic(!0)}}],Animation.play(e,[{tweens:[{prop:"x",to:e.x-55,ease:Easing.quadratic.easeOut},{prop:"y",to:e.y+100,ease:Easing.quadratic.easeIn}],duration:1E3}]),Animation.play(f,
a),Animation.play(g,c))},pretick:function(){var a=levelsScripts[3];a.ifBobOnConveyor();a.ifPushWall();a.ifBobOnLaser();a.showStar1();a.showStar2()}},{init:function(){var a=levelsScripts[4];getObjectByCustomInfo("button_hedge").onclick=this.rotateHedge;this.hedge=getObjectByInfo("hedge_lvl5");getObjectByCustomInfo("cover_hedge").onclick=returnFalse;var c=getObjectByInfo("frog_platform");c.state=1;c.coords=[93,147,215.5];this.platform=c;c.frog.tongue.addEventListener("prerender",this.getSpring);c.frog.tongue.addEventListener("changeframe",
this.checkSpringTongueContact);handlers.moveFrogPlatform.call(getObjectByCustomInfo("button_left"),c);handlers.moveFrogPlatform.call(getObjectByCustomInfo("button_right"),c);c=getObjectByInfo("spring_lvl5");c.onclick=getObjectByCustomInfo("cover2").onclick=returnFalse;c.box2dBody.SetFixedRotation(!0);c.onprerender=this.fixSpring;c.triangle=createObject({type:"triangle",x:0,y:9.8,rotation:Math.PI},findObject("triangle"),c);c.animDelay=2;c.onchangeframe=function(a){11===a.target.currentFrameX&&a.target.gotoAndStop(0)};
this.spring=c;this.star3=getObjectByCustomInfo("star3");this.star3.onclick=returnFalse;getObjectByCustomInfo("star2").setZIndex(1);var d=getObjectByCustomInfo("btn_star");handlers.buttonPress.call(d,this.showStar,c,45);d.animDelay=2;c=getObjectByInfo("spring2_lvl5");for(d=0;d<c.length;d++){var e=c[d];e.onchangeframe=function(a){11===a.target.currentFrameX&&a.target.gotoAndStop(0)};e.rect=new Rectangle(e.x,e.y,65,50,0)}this.springs2=c;getObjectByCustomInfo("button_spring1").onclick=getObjectByCustomInfo("button_spring2").onclick=
this.spring2Action;this.carriage=getObjectByInfo("carriage");this.carriage.onprerender=function(c){152>c.target.x&&a.stopCarriage()};this.carriage.box2dBody.SetFixedRotation(!0);this.carriage.triangle=createObject({type:"triangle",x:0,y:2},findObject("triangle"),this.carriage);this.lampBlueUp=getObjectByCustomInfo("lampBlueUp");this.lampBlueDown=getObjectByCustomInfo("lampBlueDown");this.pillar=getObjectByCustomInfo("pillar");this.bridge1=getObjectByCustomInfo("bridge1");this.wheel=getObjectByCustomInfo("wheel");
this.buttonPillar=getObjectByCustomInfo("buttonPillar");this.addBall();c=getObjectByCustomInfo("btn_carriage");handlers.buttonPress.call(c,this.moveBridge2,this.carriage,40);field.levelTitle.setStatic(!1)},fixSpring:function(a){var c=a.target;a=levelsScripts[4];if(stage.hitTest(c,a.carriage)&&4>Math.abs(c.x-a.carriage.x)){if(!c.fixed){c.fixed=!0;var d=stage.createTween(c.triangle,"y",c.triangle.y,c.triangle.y+4.5,500),e=stage.createTween(a.carriage.triangle,"y",a.carriage.triangle.y,a.carriage.triangle.y-
5,500);d.play();e.play();playSound("L1_S3_Turn_Head(SnailBob3)")}c=c.box2dBody;a=a.carriage.box2dBody.GetPosition();a=new b2Vec2(a.x+.2/box2d.SCALE,a.y-14.5/box2d.SCALE);c.SetPosition(a)}},stopCarriage:function(){this.carriage.onprerender=null;for(var a=getObjectByInfo("wheel_carriage"),c=0;c<a.length;c++)a[c].box2dBody.SetAwake(!1);this.carriage.box2dBody.SetAwake(!1)},moveBridge2:function(){var a=getObjectByCustomInfo("bridge2"),c=getObjectByCustomInfo("lamp1"),d=getObjectByCustomInfo("lamp2"),
e=getObjectByCustomInfo("cover2"),e=[c,e];c.gotoAndStop(1);d.gotoAndStop(1);handlers.moveBridge(a,"x",220,1E3,e)},spring2Action:function(a){var c=levelsScripts[4],d=a.target.custom.replace(/[^\d]/gi,"")-1;a=c.springs2[d];var e;a.play();playSound("Spring");0===d?(d=c.ball?[c.ball]:[],c=new b2Vec2(-6,-4)):(d=[c.carriage,c.spring],c=new b2Vec2(5,0));for(var f=0;f<d.length;f++)if(e=d[f],e.rect=e.getHitAreaRectangle(),e.rect.hitTestRectangle(a.rect)){a=e.box2dBody;a.IsAwake()||a.SetAwake(!0);a.ApplyImpulse(c,
a.GetPosition());break}},addBall:function(){var a=this,c=createObject({type:"ball_lvl5",x:440,y:20},findObject("ball_lvl5"));c.stop();c.animDelay=2;c.hitArea={x:0,y:0,width:25,height:25};c.onchangeframe=function(c){10===c.target.currentFrameX&&(c.target.destroy=!0,stage.setTimeout(function(){a.ball=null;getObjectByCustomInfo("tube4").setStatic(!0)},1))};c.onprerender=function(c){var e=c.target;if(!e.willDestroy){if(box2d.hitTest(e.box2dBody,a.carriage.box2dBody)||box2d.hitTest(e.box2dBody,a.wheel.box2dBody))e.willDestroy=
!0,e.play(),playSound("L11_S8_break(SnailBob3)"),world.DestroyBody(e.box2dBody);280<e.y&&(e.willDestroy=!0,field.bottomUIBack.setStatic(!1),stage.setTimeout(function(){field.bottomUIBack.setStatic(!0);e.destroy=!0;a.addBall()},1E3))}};this.ball=c},showStar:function(){getObjectByInfo("star_doors").play();levelsScripts[4].star3.onclick=null;playSound("Battery")},getSpring:function(a){a=a.target;var c=levelsScripts[4].spring,d=c.box2dBody;5===a.currentFrameX&&stage.hitTest(a,c)?(d.IsAwake()&&d.SetAwake(!1),
d.SetPositionAndAngle({x:(a.x+5)/box2d.SCALE,y:(a.y+40)/box2d.SCALE},0)):d.IsAwake()||d.SetAwake(!0)},checkSpringTongueContact:function(a){var c=a.target;a=levelsScripts[4].spring;5==c.currentFrameX&&(c=stage.hitTest(c,a),a.isSticked!=c&&(a.isSticked=c,a.isSticked&&playSound("GoodPop(SnailBob3)")))},rotateHedge:function(a){function c(a){var c=new Vector(6/box2d.SCALE,10/box2d.SCALE);c.rotate(-f.rotation);var d=f.box2dBody.GetPosition(),l=d.x+c.x,q=d.y+c.y,c=stage.createTween(f,"rotation",f.rotation,
a,500);c.onchange=function(){var a=new Vector(-6/box2d.SCALE,-10/box2d.SCALE);a.rotate(-f.rotation);f.box2dBody.SetPositionAndAngle({x:l+a.x,y:q+a.y},f.rotation)};c.play();0===a&&(c.onfinish=function(){e.block=!1})}var d=levelsScripts[4],e=a.target,f=d.hedge;e.block||(playSound("DoorLeft"),e.block=!0,c(-1.4),stage.setTimeout(function(){d.ball?(c(0),playSound("DoorRight")):(f.setStatic(!0),getObjectByCustomInfo("cover_hedge").setStatic(!0))},2500))},ifCarriageOnPillar:function(){var a=levelsScripts[4],
c=a.wheel,d=a.pillar,e=a.spring,f=a.buttonPillar,g=a.bridge1,h,k;272<d.y||!box2d.hitTest(d.box2dBody,c.box2dBody)||(c=!1,e.fixed?2!==d.state&&(d.state?stage.createTween(f,"y",f.y,272,500).play():stage.setTimeout(function(){stage.createTween(f,"y",f.y,272,300).play()},200),d.state=2,playSound("LiftUp"),c=!0,h=273,k=340,stage.setTimeout(function(){bob.speed=0},450)):1!==d.state&&(stage.setTimeout(function(){stage.createTween(f,"y",f.y,266,250).play()},250),d.state=1,c=!0,h=267,k=310),c&&(a.lampBlueUp.gotoAndStop(1),
a.lampBlueDown.gotoAndStop(1),e=[getObjectByCustomInfo("cover4"),a.lampBlueDown,f],a=[getObjectByCustomInfo("cover1"),a.lampBlueUp],handlers.moveBridge(d,"y",h,500,e),handlers.moveBridge(g,"x",k,500,a),playSound("DoorLeft")))},springAction:function(){var a=levelsScripts[4].spring;bob&&!a.animated&&30>getDistance(bob,a)&&(stage.setTimeout(function(){var a=bob.box2dBody;a.SetLinearVelocity(new b2Vec2(0,0));a.SetAngularVelocity(0);a.ApplyImpulse(new b2Vec2(5,-9),a.GetPosition());field.destination.setStatic(!1);
playSound("Spring")},3*a.changeFrameTime),a.play())},pretick:function(){var a=levelsScripts[4];a.ifCarriageOnPillar();a.springAction();handlers.ifBobFall(235)}},{init:function(){var a=getObjectByCustomInfo("btnBridge");handlers.buttonPress.call(a,this.moveBridge,"allBobs");a=getObjectByCustomInfo("btnFire");handlers.buttonPress.call(a,this.switchOffFire,"allBobs");this.fire=getObjectByInfo("fire");this.fire.switchOn();handlers.setFan(getObjectByCustomInfo("fan1"),getObjectByCustomInfo("button1"),
"allBobs");handlers.setFan(getObjectByCustomInfo("fan2"),getObjectByCustomInfo("button2"),"allBobs");this.resurrection=getObjectByInfo("resurrection")},switchOffFire:function(){var a=levelsScripts[5],c=a.fire,d=getObjectByCustomInfo("lamp1"),e=getObjectByCustomInfo("lamp2");d.gotoAndStop(1);e.gotoAndStop(1);stage.refreshBackground();c.switchOff();c.onchangeframe=function(a){var c=a.target;18===c.currentFrameX&&(c.gotoAndStop(19),stage.setTimeout(function(){c.setStatic(!0);getObjectByInfo("frog_fire").setStatic(!0);
field.destination.setStatic(!1)},1))};a.addHint2()},moveBridge:function(){var a=levelsScripts[5],c=getObjectByCustomInfo("lampBridge"),d=getObjectByInfo("bridge"),e=getObjectByCustomInfo("coverBridge");handlers.moveBridge(d,"x",289,500,[c,e]);c.gotoAndStop(1);a.addHint1();playSound("DoorLeft")},addHint1:function(){var a=levelsScripts[5];a.arrow1=handlers.addHintArrow(215,20,-Math.PI/2);a.tap1=handlers.addTap(a.arrow1.x+35,a.arrow1.y+10);a.resurrection.rightBtn.addEventListener("mousedown",function(){a.arrow1.destroyByOpacity();
a.tap1.destroyByOpacity()})},addHint2:function(){var a=levelsScripts[5];a.arrow2=handlers.addHintArrow(105,45,Math.PI/4);a.tap2=handlers.addTap(a.arrow2.x-30,a.arrow2.y+10);a.resurrection.leftBtn.addEventListener("mousedown",function(){a.arrow2.destroyByOpacity();a.tap2.destroyByOpacity()})},ifBobOnFire:function(){var a=levelsScripts[5].fire;"burn"!==bob.state&&bob.x+20>a.x&&a.bitmap===bitmaps.fire_normal&&bob.changeState("burn")},pretick:function(){levelsScripts[5].ifBobOnFire()}},{init:function(){getObjectByCustomInfo("lampBridge1").setStatic(!1);
getObjectByCustomInfo("lampBridge2").setStatic(!1);handlers.buttonPress.call(getObjectByCustomInfo("btn1"),this.moveBridge1);this.ball=getObjectByInfo("ball_lvl7");var a=getObjectByCustomInfo("fan1"),c=getObjectByCustomInfo("fan2"),d=getObjectByCustomInfo("fan3"),e=getObjectByCustomInfo("buttonFan1"),f=getObjectByCustomInfo("buttonFan2"),g=getObjectByCustomInfo("buttonFan3");handlers.setFan(a,e);handlers.setFan(c,f,"ball");handlers.setFan(d,g,"ball");handlers.buttonPress.call(getObjectByCustomInfo("btn2"),
this.moveBridge2,"bobAndBall");getObjectByCustomInfo("star").onclick=returnFalse;a=getObjectByInfo("face_rotate");for(c=0;c<a.length;c++)a[c].onclick=this.rotateFace;this.faces=a;getObjectByInfo("lever").onclick=this.leverAction;this.bridgeLever=getObjectByInfo("rotateByLever");a=getObjectByInfo("ad_lvl7");a.animDelay=7;a.onclick=showFirstBob;a.play()},leverAction:function(a){function c(a){box2d.hitTest(f,a.box2dBody)&&a.y<e.y&&(a.box2dBody.ApplyImpulse(new b2Vec2(5,-5),a.box2dBody.GetPosition()),
a===bob&&(bob.cancelSpeed=!0,stage.setTimeout(function(){bob.cancelSpeed=!1},100)))}var d=levelsScripts[6],e=d.bridgeLever,f=e.box2dBody;a=-1===a.target.animDirection?Math.PI/2:.01;var g=new Vector(29/box2d.SCALE,-1/box2d.SCALE);g.rotate(-f.GetAngle());var h=f.GetPosition(),k=h.x+g.x,l=h.y+g.y,q={rotation:f.GetAngle()};a=stage.createTween(q,"rotation",q.rotation,a,500);a.onchange=function(){var a=new Vector(-29/box2d.SCALE,1/box2d.SCALE);a.rotate(-q.rotation);f.SetPositionAndAngle({x:k+a.x,y:l+a.y},
q.rotation)};a.play();stage.setTimeout(function(){c(bob);c(d.ball)},250)},rotateFace:function(a){function c(){if("face1"===e.custom&&e.rotation>Math.PI||"face2"===e.custom&&0<e.rotation){e.onclick=null;e.setStatic(!0);for(var a=!0,c=0;c<f.length;c++)f[c].onclick&&(a=!1);a&&(a=new TilesSprite(bitmaps.eyes_lvl7,34,20,18,6,3),a.x=250.8,a.y=127.8,a.rotation=-Math.PI/4,a.animDelay=4,stage.addChild(a),a.onchangeframe=function(a){17===a.target.currentFrameX&&(a.target.destroy=!0,getObjectByCustomInfo("star").onclick=
null,getObjectByInfo("star_doors").play())},d(323.8,188),d(314,194),playSound("CorrectButton"))}else e.blocked=!1}function d(a,c){var d=new TilesSprite(bitmaps.light_lvl7,16,200,18,1,18);d.x=a;d.y=c;d.rotation=-.81;d.animDelay=4;stage.addChild(d);d.onchangeframe=function(a){17===a.target.currentFrameX&&(a.target.destroy=!0)};playSound("L1_S4_Eyes1(SnailBob3)")}var e=a.target,f=levelsScripts[6].faces;e.blocked||(e.blocked=!0,playSound("StoneHeadRotating(SnailBob3)"),e.rotateBy(Math.PI/2,500,Easing.linear.easeIn,
c))},moveBridge2:function(){var a=getObjectByCustomInfo("lampBtn2"),c=getObjectByCustomInfo("lampBridge2"),d=getObjectByCustomInfo("lampBridge3"),e=getObjectByCustomInfo("bridge2"),f=getObjectByCustomInfo("bridge3"),g=getObjectByCustomInfo("cover5"),g=[d,g];a.gotoAndStop(1);c.gotoAndStop(1);d.gotoAndStop(1);handlers.moveBridge(e,"y",120,500);handlers.moveBridge(f,"x",340,500,g);field.destination.setStatic(!1);playSound("L1_S3_Turn_Head(SnailBob3)")},moveBridge1:function(){var a=getObjectByCustomInfo("bridge1"),
c=getObjectByCustomInfo("lampBridge1"),d=getObjectByCustomInfo("lampBtn1");handlers.moveBridge(a,"x",180,500);c.gotoAndStop(1);d.gotoAndStop(1);getObjectByCustomInfo("startTube").setStatic(!0);playSound("DoorLeft")},ifBallFall:function(){var a=levelsScripts[6],c=a.ball;280<c.y&&!c.willDestroy&&(c.willDestroy=!0,field.bottomUIBack.setStatic(!1),stage.setTimeout(function(){field.bottomUIBack.setStatic(!0);c.destroy=!0;a.ball=createObject({type:"ball_lvl7",x:427,y:-20},findObject("ball_lvl7"))},1E3))},
pretick:function(){levelsScripts[6].ifBallFall();handlers.ifBobFall({minX:290,minY:220})}},{init:function(){var a=getObjectByInfo("lava");a.setZIndex(16);a.animDelay=7;a.play();this.lava=a;getObjectByInfo("cover_lava").setZIndex(17);this.fireSettings();a=getObjectByInfo("frog_platform");a.state=0;a.coords=[187,340];this.platform=a;a.setZIndex(17);a.frog.tongue.setZIndex(16);var c=getObjectByCustomInfo("button_left"),d=getObjectByCustomInfo("button_right");handlers.moveFrogPlatform.call(c,a,700);handlers.moveFrogPlatform.call(d,
a,700);this.frog1=c=getObjectByCustomInfo("frog1");c.tongue.x-=12;d=getObjectByCustomInfo("frog2");d.tongue.y-=17;this.tongues=[a.frog.tongue,c.tongue,d.tongue];handlers.buttonPress.call(getObjectByInfo("btn2"),this.movePlatforms);handlers.setBaraban(getObjectByInfo("baraban"),getObjectByCustomInfo("buttonBaraban"));a=getObjectByInfo("bridge");a[0].onclick=a[1].onclick=returnFalse;this.platforms=a;this.starEyes=getObjectByCustomInfo("starEyes");this.starEyes.onclick=returnFalse;getObjectByCustomInfo("eyes").onclick=
this.hideEyes;getObjectByCustomInfo("frogPaper").onclick=this.frogPaperAction;getObjectByCustomInfo("starRoll").onclick=returnFalse},frogPaperAction:function(a){var c=a.target,d=getObjectByCustomInfo("roll1");a=getObjectByCustomInfo("coverRoll");c.block||(c.tongue.x+=5,c.block=!0,c.play(),c.tongue.visible=!0,c.tongue.play(),c.animDelay=3,c.tongue.onchangeframe=function(a){a=a.target;5===a.currentFrameX&&(a.animDirection=-1);0===a.currentFrameX&&-1===a.animDirection&&(a.stop(),a.animDirection=1,a.visible=
!1)},c.onchangeframe=function(a){14===a.target.currentFrameX&&a.target.gotoAndStop(0)},d.setStatic(!1),a.setStatic(!1),stage.setTimeout(function(){var a=stage.createTween(d,"y",d.y,d.y-40,400);a.play();a.onfinish=function(){c.onclick=levelsScripts[7].frogPaperAction2};playSound("L4_S2_Frog_scroll_2(SnailBob3)")},200))},frogPaperAction2:function(a){var c=a.target,d=getObjectByCustomInfo("roll2"),e=getObjectByCustomInfo("roll3"),f=getObjectByCustomInfo("starRoll"),g=getObjectByCustomInfo("coverPaper");
c.onclick=null;c.play();c.tongue.visible=!0;c.tongue.play();playSound("L4_S3_kolba_papyrus_2(SnailBob3)");f.onclick=null;c.tongue.onchangeframe=function(a){var k=a.target;5===k.currentFrameX&&(k.onchangeframe=null,f.setStatic(!1),e.setStatic(!1),d.setStatic(!1),g.setStatic(!1),Animation.play(d,[{tweens:[{prop:"x",to:368}],duration:500}]),Animation.play(f,[{tweens:[{prop:"x",to:365}],duration:500}]),k.stop(),a=stage.createTween(k,"x",k.x,k.x+35,500),a.play(),a.onfinish=function(){f.setStatic(!0);e.setStatic(!0);
d.setStatic(!0);g.setStatic(!0);k.setStatic(!0);c.setStatic(!0);getObjectByCustomInfo("roll1").setStatic(!0);getObjectByCustomInfo("coverRoll").setStatic(!0)})};c.onchangeframe=function(a){7===a.target.currentFrameX&&a.target.gotoAndStop(8)}},hideEyes:function(a){var c=a.target,d=getObjectByCustomInfo("coverStat");c.setStatic(!1);d.setStatic(!1);stage.setTimeout(function(){levelsScripts[7].starEyes.onclick=null},1);a=stage.createTween(c,"y",c.y,c.y+20,500,Easing.quadratic.easeOut);a.play();a.onfinish=
function(){c.destroy=!0;d.setStatic(!0)}},movePlatforms:function(){function a(){var a=c[0].state;c[0].state=!a;for(var e,f,g=0;g<c.length;g++){var h=c[g];e=a?h.x+90:h.x-90;handlers.moveBridge(h,"x",e,1E3);stage.hitTest(bob,h)&&240>bob.y&&50>getDistance(bob,h)&&(f=h)}for(g=0;g<stage.tweens.length;g++)if(stage.tweens[g].obj===f){a=f.box2dBody.GetPosition();e=bob.box2dBody.GetPosition();var k=a.x-e.x;stage.tweens[g].addEventListener("change",function(){var a=k;if(!bob.catchUp){var c=f.box2dBody.GetPosition(),
d=bob.box2dBody.GetPosition();d.x=c.x-a;bob.box2dBody.SetPosition(d)}})}}var c=levelsScripts[7].platforms;getObjectByInfo("lamp").gotoAndStop(1);field.bottomUIBack.setStatic(!1);field.destination.setStatic(!1);stage.setTimeout(function(){getObjectByCustomInfo("startTube").setStatic(!0)},1);a();stage.setInterval(a,5E3)},fireSettings:function(){var a=getObjectByCustomInfo("fire1"),c=getObjectByCustomInfo("fire2"),d=getObjectByInfo("fire");this.fire=d;c.visible=!1;a.switchOn();stage.setTimeout(function(){c.switchOn();
c.visible=!0;a.switchOff();stage.setInterval(function(){for(var a=0;a<d.length;a++)d[a].bitmap!==bitmaps.fire_off?d[a].switchOff():d[a].appear()},4E3)},4E3)},ifBobBurn:function(){var a=levelsScripts[7],c=a.lava,a=a.fire;if("burn"!==bob.state){var d=!1;30>getDistance(bob,c)&&(d=!0);for(c=0;c<a.length;c++){var e=a[c];e.bitmap!==bitmaps.fire_off&&30>getDistance(e,bob)&&(d=!0)}d&&bob.changeState("burn")}},ifBobOnTongue:function(){var a=levelsScripts[7],c=a.tongues;bob.catchUp=!1;for(var d=0;d<c.length;d++){var e=
c[d];if(5===e.currentFrameX&&40>getDistance(e,bob)){1!==d||e.catched||a.catchByFrog1();bob.catchUp=!0;var f=new Vector(0,30);f.rotate(-e.rotation);bob.box2dBody.IsAwake()&&bob.box2dBody.SetAwake(!1);bob.box2dBody.SetPosition(new b2Vec2((e.x+f.x)/box2d.SCALE,(e.y+f.y)/box2d.SCALE))}}bob.catchUp&&!bob.box2dBody.IsAwake()&&bob.box2dBody.SetAwake(!0)},catchByFrog1:function(a){function c(){"burn"===bob.state&&d.removeTweens();var a=new Vector(-.5,36);a.rotate(-d.rotation);e.x=d.x+a.x;e.y=d.y+a.y;e.rotation=
d.rotation}a=levelsScripts[7];var d=a.frog1,e=d.tongue;a=a.platform.frog;e.catched=!0;5===a.tongue.currentFrameX&&(a.play(),a.tongue.play());Animation.play(d,[{tweens:[{prop:"rotation",to:.7,onchange:c}],duration:1E3,ease:Easing.sine.easeIn},{tweens:[{prop:"rotation",to:0,onchange:c}],duration:500}]);playSound("DoorRight")},pretick:function(){var a=levelsScripts[7];a.ifBobBurn();a.ifBobOnTongue();handlers.ifBobFall(240)}},{init:function(){var a=getObjectByCustomInfo("fan1"),c=getObjectByCustomInfo("fan2"),
d=getObjectByCustomInfo("buttonFan1"),e=getObjectByCustomInfo("buttonFan2");a.scaleX=c.scaleX=-1;handlers.setFan(a,d,"allBobs",new b2Vec2(7,-5));handlers.setFan(c,e,"allBobs",new b2Vec2(7,-3));handlers.buttonPress.call(getObjectByCustomInfo("btn1"),this.moveBridge1,"allBobs");handlers.buttonPress.call(getObjectByCustomInfo("btn2"),this.moveBridge2,"allBobs");field.bottomUIBack.setStatic(!1);getObjectByCustomInfo("starMouth").setZIndex(20);this.lampSettings()},lampSettings:function(){var a=getObjectByInfo("lamp_lvl9");
this.lamp=a;a.animDelay=3;a.onclick=this.lampAction;a.onchangeframe=function(a){13===a.target.currentFrameX&&a.target.gotoAndStop(0)};a.jumping=stage.setInterval(function(){a.bitmap=a.bitmap===bitmaps.lamp_lvl9?bitmaps.lamp2_lvl9:bitmaps.lamp_lvl9;a.play()},5E3)},lampAction:function(a){var c=a.target;c.onclick=null;Animation.play(c,[{tweens:[{prop:"y",to:75}],duration:300,ease:Easing.quadratic.easeOut},{tweens:[{prop:"y",to:94}],duration:300,ease:Easing.quadratic.easeIn,onfinish:function(){c.onclick=
levelsScripts[8].lampAction2}}]);playSound("Spring")},lampAction2:function(a){var c=a.target;c.onclick=null;c.bitmap=bitmaps.lamp3_lvl9;c.framesCount=36;c.totalLayers=6;c.totalFrames=6;c.width=62;c.height=60;c.x+=9;c.y-=14.8;c.gotoAndPlay(0);c.onchangeframe=function(a){a=a.target;35===a.currentFrameX&&a.gotoAndPlay(8)};stage.clearInterval(c.jumping);stage.setTimeout(function(){var a=createObject({type:"star10",x:c.x+12,y:c.y-12},findObject("star10"));a.setStatic(!1);a.opacity=0;a.fadeTo(1,1E3)},300);
playSound("Ch3_L5_Wish(SnailBob3)")},moveBridge1:function(){var a=getObjectByCustomInfo("bridge1"),c=getObjectByCustomInfo("cover1"),d=getObjectByCustomInfo("cover0"),e=getObjectByCustomInfo("lamp1"),f=getObjectByCustomInfo("lampBtn1"),c=[c,d,e];e.gotoAndStop(1);f.gotoAndStop(1);handlers.moveBridge(a,"x",161,500,c,Easing.exponential.easeOut);playSound("DoorLeft")},moveBridge2:function(){var a=getObjectByCustomInfo("bridge2"),c=getObjectByCustomInfo("cover2"),d=getObjectByCustomInfo("lamp2"),e=getObjectByCustomInfo("lampBtn2"),
c=[c,d];d.gotoAndStop(1);e.gotoAndStop(1);handlers.moveBridge(a,"y",-10,500,c);field.destination.setStatic(!1);playSound("DoorLeft")},pretick:function(){handlers.ifBobFall(220)}},{init:function(){var a=levelsScripts[9],c=getObjectByInfo("frog_magnet");c.onclick=returnFalse;c.state=0;c.coords=[150,237,302];this.frog=c;var d=createObject({type:"lever2",x:0,y:-40},findObject("lever2"),c);d.addEventListener("click",returnFalse);d.onclick=this.leverAction;var e=createObject({type:"magnet_start",x:1,y:40},
findObject("magnet_start"),c);e.stop();e.animDelay=2;this.magnet=e;var f=createObject({type:"lamp_green",x:1,y:-14},findObject("lamp_green"),c);f.setStatic(!1);f.stop();this.lampFrog=f;this.box=getObjectByInfo("box_lvl10");this.box.onprerender=function(c){c=c.target;if(c.fixed){var d=new b2Vec2((e.localToGlobal().x-2)/box2d.SCALE,(e.localToGlobal().y+22)/box2d.SCALE);c.box2dBody.SetPosition(d)}1!==f.currentFrame||c.pulled||a.pullBox()};var d=getObjectByCustomInfo("button_left"),g=getObjectByCustomInfo("button_right");
handlers.moveFrogPlatform.call(d,c,500,Easing.sine.easeIn);handlers.moveFrogPlatform.call(g,c,500,Easing.sine.easeIn);c=getObjectByInfo("btn2");handlers.buttonPress.call(c,this.moveBridge,this.box);c.animDelay=2;this.birdsSettings()},birdsSettings:function(){for(var a=getObjectByInfo("bird"),c=levelsScripts[9],d=0;d<a.length;d++){var e=a[d];e.animDelay=4;e.onchangeframe=function(a){17===a.target.currentFrameX&&a.target.gotoAndStop(0)};e.onclick=c.birdAction;(function(a,c){stage.setTimeout(function(){a.playAnim=
stage.setInterval(function(){a.play()},2500);a.play()},1250*c)})(e,d)}},birdAction:function(a){a=a.target;a.onclick=null;a.bitmap=bitmaps.bird_fly;a.framesCount=25;a.totalLayers=5;a.totalFrames=5;a.animDelay=2;a.onchangeframe=function(a){a=a.target;24===a.currentFrameX&&(a.onchangeframe=function(a){17===a.target.currentFrameX&&a.target.gotoAndStop(0)},a.bitmap=bitmaps.bird_sit,a.framesCount=18,a.totalLayers=6,a.totalFrames=3,a.animDelay=4)};a.gotoAndPlay(0);(new PathTween(a,[{x:a.x,y:a.y},{x:a.x+
("left"===a.custom?-10:10),y:a.y-15},{x:a.x+("left"===a.custom?-20:20),y:a.y}],!0)).start(800,Easing.sine.easeIn);"left"==a.custom?playSound("BirdTweet(SnailBob3)"):playSound("BirdTweet2(SnailBob3)");return!1},moveBridge:function(){var a=getObjectByInfo("bridge"),c=getObjectByCustomInfo("lamp1"),d=getObjectByCustomInfo("cover1"),d=[c,d],e=levelsScripts[9].box.box2dBody;c.gotoAndStop(1);handlers.moveBridge(a,"y",257,1E3,d);field.destination.setStatic(!1);e.m_fixtureList.m_density=.95;e.ResetMassData();
playSound("DoorLeft")},leverAction:function(a){a=levelsScripts[9];0===a.lampFrog.currentFrame?a.switchOnMagnet():a.switchOffMagnet()},switchOnMagnet:function(){var a=levelsScripts[9],c=a.magnet;a.lampFrog.gotoAndStop(1);c.gotoAndPlay(0);c.bitmap=bitmaps.magnet_start;c.animDirection=1;c.framesCount=10;c.totalLayers=2;c.onchangeframe=function(a){a=a.target;9===a.currentFrameX&&(a.onchangeframe=null,a.bitmap=bitmaps.magnet_normal,a.framesCount=20,a.totalLayers=4,a.gotoAndPlay(0))};a.pullBox()},pullBox:function(){var a=
levelsScripts[9],c=a.magnet,d=a.box,e=d.box2dBody;if(!d.pulled&&70>Math.abs(c.localToGlobal().x-d.x)){d.pulled=!0;var f=e.GetAngle(),g=f%(Math.PI/2),a=f-g,g=f-g+(0<f?Math.PI/2:-Math.PI/2),h;h=Math.abs(Math.abs(a)-Math.abs(f))<Math.abs(Math.abs(g)-Math.abs(f))?a:g;var k=h-f,a=e.GetPosition(),l=a.x,q=a.y;d.pos=0;a=stage.createTween(d,"pos",0,1,500);a.play();a.onchange=function(){var a=new b2Vec2((c.localToGlobal().x-2)/box2d.SCALE,(c.localToGlobal().y+22)/box2d.SCALE),g=a.x-l,a=a.y-q,h=e.GetPosition();
h.x=l+g*d.pos;h.y=q+a*d.pos;e.SetPositionAndAngle(h,f+k*d.pos)};a.onfinish=function(){e.SetAwake(!1);var a=new b2Vec2((c.localToGlobal().x-2)/box2d.SCALE,(c.localToGlobal().y+22)/box2d.SCALE);e.SetPositionAndAngle(a,h);d.fixed=!0}}},switchOffMagnet:function(){var a=levelsScripts[9],c=a.magnet;a.lampFrog.gotoAndStop(0);a.box.box2dBody.SetAwake(!0);c.bitmap=bitmaps.magnet_start;c.animDirection=-1;c.framesCount=10;c.totalLayers=2;c.onchangeframe=function(a){a=a.target;0===a.currentFrameX&&(a.onchangeframe=
null,a.animDirection=1,a.stop())};c.gotoAndPlay(9);a.box.removeTweens();a.box.fixed=!1;a.box.pulled=!1},pretick:function(){}},{init:function(){field.bottomUIBack.setStatic(!1);field.destination.setStatic(!1);getObjectByCustomInfo("lampBridge").setStatic(!1);var a=getObjectByInfo("lava");a.animDelay=6;a.play();this.mirrowsSettings();a=addSprite(null,1,1,-1,40,!0);handlers.setLaser(a,{x:a.x,y:a.y},"x",!0);this.laserParent=a;a=getObjectByCustomInfo("star");a.onclick=returnFalse;a.onchangeframe=function(a){a=
a.target;8===a.currentFrameX&&1===a.animDirection&&(a.gotoAndStop(9),a.animDirection=-1,a.onclick=null);1===a.currentFrameX&&-1===a.animDirection&&(a.gotoAndStop(0),a.animDirection=1)};a.setStatic(!1);this.star=a;getObjectByInfo("cover_lava_lvl11").setZIndex(16);getObjectByInfo("cover_lava1_lvl11").setZIndex(16);getObjectByInfo("cover_lava2_lvl11").setZIndex(16);getObjectByCustomInfo("lampBridge").setZIndex(16)},mirrowsSettings:function(){for(var a=getObjectByInfo("mirrow_lvl11"),c=0;c<a.length;c++){var d=
a[c];d.setZIndex(17);d.setStatic(!1)}this.mirrows=a;var a=getObjectByCustomInfo("mirrow1"),c=getObjectByCustomInfo("mirrow2"),d=getObjectByCustomInfo("mirrow3"),e=getObjectByCustomInfo("mirrow4");a.st=getObjectByCustomInfo("stopLaser5");c.st=getObjectByCustomInfo("stopLaser6");d.st=getObjectByCustomInfo("stopLaser7");e.st=getObjectByCustomInfo("stopLaser8");a.anchor.y=4.5;a.gotoAndStop(1);c.st.stopLaser=!1;d.st.stopLaser=!1;e.st.stopLaser=!1;a.onclick=this.rotateMirrow;c.onclick=d.onclick=e.onclick=
this.moveMirrow},moveMirrow:function(a){var c=a.target,d=levelsScripts[10],e,f;if(!c.block)return c.block=!0,playSound("Dveri_open_3(SnailBob3)"),"mirrow4"===c.custom?(a="y",e=176,f=225):(a="x",e=358,f=414),c.state=!c.state,c.state||(c.st.stopLaser=!1,d.reCalcLaser()),Animation.play(c,[{tweens:[{prop:a,to:c.state?e:f}],duration:200,onfinish:function(){c.block=!1;c.state&&(c.st.stopLaser=!0,d.reCalcLaser())}}]),!1},rotateMirrow:function(a){var c=a.target,d=levelsScripts[10];c.block||(c.block=!0,stage.setTimeout(function(){c.st.rotation*=
-1;d.reCalcLaser()},100),Animation.play(c,[{tweens:[{prop:"rotation",to:c.state?Math.PI:0}],duration:200,onfinish:function(){c.block=!1}}]),c.state=!c.state)},reCalcLaser:function(){if(gameState===STATE_GAME){var a=levelsScripts[10],c=a.laserParent;handlers.destroyLaser(c);handlers.setLaser(c,{x:c.x,y:c.y},"x",!0);a.changeStateOfMirrows();a.moveBridge();a.moveLift();a.showStar();stage.refreshBackground()}},changeStateOfMirrows:function(){for(var a=levelsScripts[10],c=a.laserParent,d=1;d<a.mirrows.length;d++)for(var e=
a.mirrows[d],f=0;f<c.lasers.length;f++){var g=c.lasers[f];if(e.state&&stage.hitTest(e,g)){e.gotoAndStop(1);break}else e.gotoAndStop(0)}},moveBridge:function(){var a=levelsScripts[10].laserParent.lasers,c=getObjectByCustomInfo("lampLaser1"),d=getObjectByCustomInfo("stopLaser1"),e=getObjectByInfo("bridge"),f=getObjectByCustomInfo("lampBridge"),g=getObjectByCustomInfo("coverBridge");a[2]&&stage.hitTest(a[2],d)?0===c.currentFrame&&(a=5*(e.x-295),handlers.moveBridge(e,"x",295,a,g),c.gotoAndStop(1),f.gotoAndStop(1)):
1===c.currentFrame&&(a=5*(364-e.x),handlers.moveBridge(e,"x",364,a,g),c.gotoAndStop(0),f.gotoAndStop(0))},moveLift:function(){var a=levelsScripts[10].laserParent.lasers,c=getObjectByCustomInfo("lampLaser3"),d=getObjectByCustomInfo("stopLaser2"),e=getObjectByInfo("lift"),f=getObjectByCustomInfo("coverLift"),g=getObjectByCustomInfo("lampLift"),f=[f,g];a[3]&&stage.hitTest(a[3],d)?0===c.currentFrame&&(a=40*(e.y-235),handlers.moveBridge(e,"y",235,a,f),c.gotoAndStop(1),g.gotoAndStop(1)):1===c.currentFrame&&
(a=40*(338-e.y),handlers.moveBridge(e,"y",338,a,f),c.gotoAndStop(0),g.gotoAndStop(0));playSound("GroundUp")},showStar:function(){var a=levelsScripts[10],c=a.laserParent.lasers,d=getObjectByCustomInfo("lampLaser2"),e=getObjectByCustomInfo("stopLaser3"),a=a.star;c[1]&&stage.hitTest(c[1],e)?0===d.currentFrame&&(d.gotoAndStop(1),a.collected||a.play()):1===d.currentFrame&&(d.gotoAndStop(0),a.collected||(a.play(),a.onclick=returnFalse))},ifBobOnLaser:function(){var a=levelsScripts[10].laserParent.lasers;
if("onLaser"!==bob.state)for(var c=0;c<a.length;c++){var d=a[c];if(stage.hitTest(d,bob)){var e=0===d.rotation?"y":"x";18>Math.abs(bob[e]-d[e])&&bob.changeState("onLaser")}}},ifBobOnLava:function(){bob.inLava||(235<bob.y&&(bob.cancelSpeed=!0),250<bob.y&&(bob.inLava=!0,bob.box2dBody.SetLinearDamping(12),stage.setTimeout(showGameOverScreen,2E3),playSound("BobTonetSands(SnailBob3)")))},pretick:function(){var a=levelsScripts[10];a.ifBobOnLaser();a.ifBobOnLava()}},{init:function(){var a=levelsScripts[11],
c=getObjectByCustomInfo("tubeDown");c.setStatic(!0);c.setZIndex(15);c.backTube.setZIndex(1);this.tubeDown=c;var d=getObjectByCustomInfo("tubeUp");d.state=2;d.coords=[167,260,350];d.onclick=returnFalse;d.backTube.setStatic(!1);d.backTube.setZIndex(14);d.backTube.onprerender=function(a){a.target.x=d.x+1};this.tubeUp=d;var c=getObjectByCustomInfo("button_left"),e=getObjectByCustomInfo("button_right");e.setZIndex(18);handlers.moveFrogPlatform.call(c,d,700);handlers.moveFrogPlatform.call(e,d,700);var f=
getObjectByInfo("face_lvl12");f.play();f.onchangeframe=function(a){4===a.target.currentFrame&&a.target.gotoAndStop(0)};f.animDelay=2;this.face=f;stage.setInterval(function(){f.play()},3E3);c=getObjectByCustomInfo("btn1");c.animDelay=4;c.onchangeframe=function(a){a=a.target;if(4===a.currentFrame&&1===a.animDirection||0===a.currentFrame&&-1===a.animDirection)a.stop(),a.animDirection*=-1};this.btn1=c;bob.box2dBody.SetLinearDamping(.4);this.boxingGloge=getObjectByInfo("boxing_glove");this.boxingGloge.anchor=
{x:-43,y:3};this.boxingGloge.onchangeframe=function(a){a=a.target;11===a.currentFrameX&&a.gotoAndStop(0)};this.arrow=getObjectByInfo("arrow_lvl12");getObjectByCustomInfo("buttonGlove").onclick=this.gloveAction;handlers.buttonPress.call(getObjectByCustomInfo("btn2"),a.moveBridge,bob,25);field.levelTitle.setStatic(!1);this.startTube=getObjectByCustomInfo("startTube");this.paw1=getObjectByInfo("paw1");this.paw2=getObjectByInfo("paw2");this.paw2.setZIndex(16)},spiderAction:function(){var a;if(!bob.died&&
340<bob.x&&65<bob.y&&80>bob.y){bob.died=!0;playSound("Whoosh3(SnailBob3)");bob.posX=bob.x;bob.posY=bob.y;var c=bob.box2dBody;bob.blockClick=!0;a=[{tweens:[{prop:"x",to:478}],duration:400}];var d=[{tweens:[{prop:"posX",to:bob.posX+100,onchange:function(){c.SetPosition(new b2Vec2(bob.posX/box2d.SCALE,bob.posY/box2d.SCALE))}}],duration:400,onfinish:function(){bob.changeState("hide");playSound("L14_S3_1_chewing(SnailBob3)");bob.gotoAndStop(10);bob.blockClick=!0;stage.setTimeout(function(){c.ApplyImpulse(new b2Vec2(-3,
-3.5),c.GetPosition());stage.setTimeout(showGameOverScreen,3E3)},1E3)}}];Animation.play(this.paw1,a);Animation.play(this.paw2,a);Animation.play(bob,d);Animation.play(this.face,[{tweens:[{prop:"x",to:497}],duration:400}]);a=getObjectByCustomInfo("coverSpider");a.setStatic(!1);a.setZIndex(17)}},moveBridge:function(){var a=getObjectByInfo("bridge"),c=getObjectByCustomInfo("lampBtn"),d=getObjectByCustomInfo("lampBridge"),e=[getObjectByCustomInfo("coverBridge"),d];handlers.moveBridge(a,"x",345,1E3,e);
c.gotoAndStop(1);d.gotoAndStop(1);field.destination.setStatic(!1);field.destination.backTube.setStatic(!1);field.destination.backTube.setZIndex(14);playSound("DoorLeft")},ifBobFallInTube:function(){var a=levelsScripts[11];!bob.inTube&&238<bob.x&&285>bob.x&&245<bob.y&&(bob.inTube=!0,bob.cancelSpeed=!0,a.startTube.setStatic(!0),a.tubeDown.setStatic(!1),a.tubeDown.backTube.setStatic(!1),field.bottomUIBack.setStatic(!1),stage.setTimeout(function(){bob.appearInt=stage.setInterval(function(){for(var c=
0;c<stage.tweens.length;c++)if(stage.tweens[c].obj===a.tubeUp)return;stage.clearInterval(bob.appearInt);bob.inTube=!1;bob.cancelSpeed=!1;a.tubeDown.setStatic(!0);a.tubeDown.backTube.setStatic(!0);field.bottomUIBack.setStatic(!0);c=bob.box2dBody;c.SetPosition(new b2Vec2(a.tubeUp.x/box2d.SCALE,0));c.SetLinearVelocity(new b2Vec2(0,0))},1)},2E3))},gloveAction:function(){var a=levelsScripts[11].boxingGloge,c;a.play();playSound("Spring");c=a.up?new b2Vec2(9,-4):new b2Vec2(6,2);stage.setTimeout(function(){if(stage.hitTest(bob,
a)){var d=bob.box2dBody;d.SetLinearVelocity(new b2Vec2(0,0));d.ApplyImpulse(c,d.GetPosition())}},5*a.changeFrameTime)},ifBobPressBtn:function(){var a=this.btn1;a.animated||(28>Math.abs(bob.x-a.x)&&stage.hitTest(bob,a)?0===a.currentFrame&&(a.play(),a=this.boxingGloge.up?.25:-.25,this.boxingGloge.up=!this.boxingGloge.up,a=[{tweens:[{prop:"rotation",to:a}],duration:500}],Animation.play(this.boxingGloge,a),Animation.play(this.arrow,a),playSound("Button")):4===a.currentFrame&&a.play())},pretick:function(){var a=
levelsScripts[11];a.ifBobFallInTube();a.ifBobPressBtn();handlers.ifBobFall({minX:300,minY:250});a.spiderAction()}},{init:function(){var a=levelsScripts[12];field.bottomUIBack.setStatic(!1);a.prepareLava();a.prepareSpiders();a.prepareElectroBarrier();a.prepareStarPuzzle();a.prepareBobPlatform();a.turnFireOn();a.addBtnMouthHandler();a.addDropInterval();a=getObjectByCustomInfo("destination");a.setStatic(!1);a.setZIndex(bob.zIndex+1);field.checkIfWin=function(){bob&&15>getDistance(bob,field.destination)&&
victory()}},addDropInterval:function(){getObjectByCustomInfo("lava_vert");stage.setInterval(function(){if(gameState==STATE_GAME){var a=new Sprite(null,2,6);a.fillColor="#f43200";stage.addChild(a);a.setRelativePosition(42,28);a.moveTo(a.x,a.y+100,400,null,function(){a.destroy=!0})}},2E3)},addBtnMouthHandler:function(){function a(){c.turnFireOff();e.removeTweens();f.removeTweens();e.moveTo(e.x,h[0],200,null,function(){e.moveTo(e.x,g[0],3E3)});f.moveTo(f.x,h[1],200,null,function(){f.moveTo(f.x,g[1],
3E3)});stage.setTimeout(function(){c.turnFireOn();d.locked=!1},3E3)}var c=levelsScripts[12],d=getObjectByCustomInfo("btn_mouth"),e=getObjectByInfo("tooth_u"),f=getObjectByInfo("tooth_d"),g=[e.y,f.y],h=[e.y+10,f.y-10];d.hitArea={x:0,y:0,width:40,height:40};d.onclick=function(c){c=c.target;c.locked||(c.locked=!0,a())}},turnFireOn:function(){var a=levelsScripts[12],c=getObjectByCustomInfo("cover1");playSound("FlameStarts(SnailBob3)");var d=new TilesSprite(bitmaps.fire,36,99,22,2,11);d.animDelay=2;d.rotation=
Math.PI/2;d.setPosition(c.x+30,c.y+1);d.setZIndex(c.zIndex-1);stage.addChild(d);d.onchangeframe=function(d){d=d.target;d.currentFrameX==d.framesCount-1&&(d.destroy=!0,d=new TilesSprite(bitmaps.fire_normal,22,96,30,2,15),d.animDelay=2,d.rotation=Math.PI/2,d.setPosition(c.x+30,c.y+1),d.setZIndex(c.zIndex-1),stage.addChild(d),a.fire=d)};a.fire=d},turnFireOff:function(){var a=levelsScripts[12],c=getObjectByCustomInfo("cover1");playSound("FlameStop(SnailBob3)");a.fire.destroy=!0;a.fire=null;a=new TilesSprite(bitmaps.fire_off,
36,96,20,2,10);a.animDelay=3;a.rotation=Math.PI/2;a.setPosition(c.x+30,c.y+1);a.setZIndex(c.zIndex-1);stage.addChild(a);a.onchangeframe=function(a){a=a.target;a.currentFrameX==a.framesCount-2&&(a.destroy=!0)}},prepareBobPlatform:function(){function a(){bob.isDead?f.pause():(box2d.setBodyPosition(d.box2dBody,d.x,d.y),box2d.setBodyPosition(bob.box2dBody,e.x,e.y),e=d.getAbsolutePosition(),e.y-=6)}var c=getObjectByCustomInfo("btn_platform"),d=getObjectByInfo("platform_lvl13"),e=d.getAbsolutePosition(),
f=Animation.play(d,[{tweens:[{prop:"y",to:145,onchange:a}],duration:765},{tweens:[{prop:"x",to:335,onchange:a}],duration:3315},{tweens:[{prop:"y",to:40,onchange:a}],duration:1785},{tweens:[{prop:"x",to:197,onchange:a}],duration:2346},{tweens:[{prop:"y",to:243,onchange:a}],duration:3451},{tweens:[{prop:"x",to:360,onchange:a}],duration:2771}],function(){world.DestroyBody(d.box2dBody);playSound("GroundUp");d.scaleTo(.8,800);d.fadeTo(0,800,null,function(){d.destroy=!0})});f.pause();c.hitArea={x:0,y:0,
width:40,height:40};c.onmousedown=function(a){d.posX=d.x;d.posY=d.y;f.resume();playSound("Button");a.target.gotoAndStop(1)};c.onmouseup=function(a){f.pause();a.target.gotoAndStop(0)};c.onmouseout=function(a){f.pause();a.target.gotoAndStop(0)}},stopLava:function(){var a=levelsScripts[12];playSound("L14_S6_lava_stop(SnailBob3)");getObjectByCustomInfo("lava_hor").stop();var c=getObjectByCustomInfo("lava_vert");c.removeTweens();c=stage.createTween(c,"scaleX",c.scaleX,0,300);c.onfinish=function(){a.isLavaOn=
!1};c.play()},startLava:function(){var a=levelsScripts[12];getObjectByCustomInfo("lava_hor").play();a.isLavaOn=!0;a=getObjectByCustomInfo("lava_vert");a.removeTweens();stage.createTween(a,"scaleX",a.scaleX,1,300).play()},prepareElectroBarrier:function(){var a=levelsScripts[12],c=getObjectByInfo("electro_platform"),d=getObjectByCustomInfo("btn_up"),e=getObjectByCustomInfo("btn_down"),f=[30,95,140],g=!1;c.index=1;c.animDelay=3;c.play();d.onclick=function(d){g||0==c.index||(g=!0,playSound("Pump"),c.index==
f.length-1&&a.startLava(),c.index--,handlers.moveBridge(c,"y",f[c.index],500,null,null,function(){g=!1;c.setStatic(!1)}))};e.onclick=function(d){g||c.index==f.length-1||(g=!0,c.index++,playSound("Pump"),handlers.moveBridge(c,"y",f[c.index],500,null,null,function(){g=!1;c.setStatic(!1);c.index==f.length-1&&a.stopLava()}))}},prepareStarPuzzle:function(){function a(){[d,e,f,g].every(function(a){return 1==Math.cos(a.rotation)})&&([d,e,f,g].forEach(function(a){a.onclick=null;a.setStatic(!0)}),playSound("get_all_stars(SnailBob3)"),
c())}function c(){var a=createObject({type:"star1",x:d.x+13,y:d.y+13,rotation:0},findObject("star1"));a.onclick=null;stage.setTimeout(function(){animateStarReceive(a)},800)}var d=getObjectByInfo("star_1"),e=getObjectByInfo("star_2"),f=getObjectByInfo("star_3"),g=getObjectByInfo("star_4"),h=Math.PI/2;d.rotation=1*h;e.rotation=2*h;f.rotation=1*h;g.rotation=2*h;[d,e,f,g].forEach(function(c){c.onclick=function(c){var d=c.target;d.locked||(d.locked=!0,d.rotateBy(h,200,null,function(){d.locked=!1;a()}),
playSound("SomethinMoving1(SnailBob3)"))}})},spiderEatsBob:function(a){if(!bob.isDead){bob.isDead=!0;playSound("Whoosh3(SnailBob3)");var c=bob.box2dBody;bob.posX=bob.x;bob.posY=bob.y;bob.blockClick=!0;bob.setZIndex(a.arm2.zIndex-1);var d=[{tweens:[{prop:"x",to:a.arm1.x+80*a.arm1.scaleX}],duration:400}],e=[{tweens:[{prop:"posX",to:bob.posX+100*a.face.scaleX,onchange:function(){c.SetPosition(new b2Vec2(bob.posX/box2d.SCALE,bob.posY/box2d.SCALE))}}],duration:400,onfinish:function(){bob.changeState("hide");
playSound("L14_S3_1_chewing(SnailBob3)");bob.gotoAndStop(10);bob.blockClick=!0;c.SetActive(!1);stage.setTimeout(function(){playSound("ThrowSomething(SnailBob3)");c.SetActive(!0);c.ApplyImpulse(new b2Vec2(-6*a.face.scaleX,-1.5),c.GetPosition());stage.setTimeout(showGameOverScreen,3E3)},1E3)}}],f=[{tweens:[{prop:"x",to:a.face.x+80*a.face.scaleX}],duration:400}];Animation.play(a.arm1,d);Animation.play(a.arm2,d);Animation.play(bob,e);Animation.play(a.face,f)}},setSpiderListeners:function(a){function c(){var c=
a.arm1,e=a.arm2;bob.isDead||(c.moveTo(c.x-35*c.scaleX,c.y,350),e.moveTo(e.x-35*e.scaleX,e.y,350,null,function(){stage.addEventListener("pretick",d);stage.setTimeout(function(){stage.removeEventListener("pretick",d);bob.isDead||(c.moveTo(c.x+35*c.scaleX,c.y,2500),e.moveTo(e.x+35*e.scaleX,e.y,2500))},2500)}))}function d(){if(45>getDistance(bob,a.arm2)){stage.clearInterval(f);e.spiderEatsBob(a);var c=getObjectByInfo("platform_lvl13");world.DestroyBody(c.box2dBody);c.setStatic(!0)}}var e=levelsScripts[12];
a.face.animDelay=3;a.face.onchangeframe=function(a){a=a.target;a.currentFrame==a.totalFrames-1&&a.stop()};stage.setInterval(function(a){a.gotoAndPlay(0)}.bind(null,a.face),4E3);c();var f=stage.setInterval(c,7E3)},prepareSpiders:function(){var a=levelsScripts[12],c=getObjectByCustomInfo("face1");c.scaleX=-1;var d=getObjectByCustomInfo("arm1");d.scaleX=-1;d.setZIndex(bob.zIndex-1);var e=getObjectByCustomInfo("arm2");e.scaleX=-1;e.setZIndex(bob.zIndex+1);var c={face:c,arm1:d,arm2:e},d=getObjectByCustomInfo("face2"),
f=getObjectByCustomInfo("arm3"),g=getObjectByCustomInfo("arm4"),d={face:d,arm1:f,arm2:g};a.setSpiderListeners(c);a.setSpiderListeners(d);getObjectByCustomInfo("cover2").setZIndex(e.zIndex+1);getObjectByCustomInfo("cover3").setZIndex(e.zIndex+1)},prepareLava:function(){var a=levelsScripts[12],c=getObjectByCustomInfo("lava_hor");c.animDelay=4;c.play();a.lavaHorizontal=c;c=getObjectByCustomInfo("lava_vert");c.animDelay=4;c.play();a.lavaVertical=c;a.isLavaOn=!0},checkBobHitElectroWall:function(){var a=
getObjectByInfo("electro_platform");!bob.isDead&&box2d.hitTest(bob.box2dBody,a.box2dBody)&&(bob.isDead=!0,bob.changeState("magicHit"))},checkBobOnFire:function(){var a=levelsScripts[12];a.fire&&!bob.isDead&&30>getDistance(bob,a.fire)&&(bob.isDead=!0,getObjectByInfo("platform_lvl13").setStatic(!0),bob.changeState("burn"))},checkBobInLava:function(){if(levelsScripts[12].isLavaOn&&!bob.isDead){var a=getObjectByCustomInfo("lava_vert");30>getDistance(bob,a)&&(bob.isDead=!0,bob.changeState("burn"))}},pretick:function(){var a=
levelsScripts[12];a.checkBobHitElectroWall();a.checkBobOnFire();a.checkBobInLava()}},{init:function(){field.bottomUIBack.setStatic(!1);getObjectByCustomInfo("buttonLift").onclick=this.moveLift;this.lift=getObjectByInfo("lift");this.coverLift=getObjectByCustomInfo("coverLift");var a=getObjectByCustomInfo("button_left"),c=getObjectByCustomInfo("button_right"),d=getObjectByInfo("platform");handlers.movePlatform.call(a,d,286);handlers.movePlatform.call(c,d,395);handlers.buttonPress.call(getObjectByInfo("btn2"),
this.moveBridge,"allBobs");bob.box2dBody.SetLinearDamping(.2)},moveBridge:function(){var a=getObjectByInfo("bridge"),c=getObjectByCustomInfo("coverBridge"),d=getObjectByCustomInfo("lampBtn"),e=getObjectByCustomInfo("lampBridge");handlers.moveBridge(a,"x",285,500,[c,e],Easing.quadratic.easeOut);d.gotoAndStop(1);e.gotoAndStop(1);field.destination.setStatic(!1);getObjectByCustomInfo("startTube").setStatic(!0);playSound("DoorLeft")},moveLift:function(a){a=a.target;var c=levelsScripts[13],d=a.state?276:
176,e=20*Math.abs(c.lift.y-d);"walk"===bob.state&&!a.state&&185<bob.x&&200>bob.x&&(bob.cancelSpeed=!0,bob.box2dBody.ApplyImpulse(new b2Vec2(-1.5,-.5),bob.box2dBody.GetPosition()),stage.setTimeout(function(){bob.cancelSpeed=!1},200));handlers.moveBridge(c.lift,"y",d,e,c.coverLift);a.state=!a.state;playSound("GroundUp")},pretick:function(){handlers.ifBobFall(245)}},{init:function(){var a=levelsScripts[14];field.bottomUIBack.setStatic(!1);a.setLightningInterval();a.turnConveyorOn();a.addPipesCovers();
a.addWheelStar();a.addEyeCovers();a.addConveyorBtnHandler();a.addBobBtnPressListener();a.addStarStonesHandlers();a.addPipesListeners();a.addBridgeButtonHandlers();getObjectByCustomInfo("destination").setStatic(!1);getObjectByCustomInfo("square_red").gotoAndStop(1);getObjectByCustomInfo("square_green").gotoAndStop(1);getObjectByCustomInfo("star_door").onclick=returnFalse;getObjectByCustomInfo("g1").static=!1},addEyeCovers:function(){var a=getObjectByCustomInfo("fish_red"),c=getObjectByCustomInfo("fish_green");
a.setZIndex(bob.zIndex+1);c.setZIndex(bob.zIndex+1);var d=new TilesSprite(bitmaps.eye_blink_lvl15,24,10,6,3,2);d.animDelay=4;d.onchangeframe=function(a){a=a.target;a.currentFrameX==a.framesCount-1&&(a.stop(),a.destroy=!0)};d.stop();d.open=function(){this.play();this.parent.eye=null};c.eye=d;c.addChild(d);d.setPosition(-2,-12);c=d.clone();c.scaleX=-1;a.eye=c;a.addChild(c);c.setPosition(1,-12)},addPipesListeners:function(){var a=levelsScripts[14],c=[getObjectByCustomInfo("pipe_blue1"),getObjectByCustomInfo("pipe_red"),
getObjectByCustomInfo("pipe_green"),getObjectByCustomInfo("pipe_blue2")];stage.addEventListener("pretick",function(){for(var d=0;d<c.length;d++)if(25>getDistance(c[d],bob)&&0<bob.box2dBody.GetLinearVelocity().y){a.processEnterTube(c[d]);break}})},processEnterTube:function(a){var c=levelsScripts[14];switch(a.custom){case "pipe_blue1":c.enterBlueTube1();break;case "pipe_red":c.enterRedTube();break;case "pipe_green":c.enterGreenTube();break;case "pipe_blue2":c.enterBlueTube2()}playSound("Teleporting1(SnailBob3)")},
enterBlueTube1:function(){var a=levelsScripts[14],c=getObjectByCustomInfo("pipe_blue2");box2d.setBodyPosition(bob.box2dBody,c.x,c.y);a.shootBobOut()},enterRedTube:function(){var a=getObjectByCustomInfo("fish_red");box2d.setBodyPosition(bob.box2dBody,a.x,a.y-5);var c=bob.box2dBody;c.SetAngularVelocity(0);c.SetLinearVelocity(new b2Vec2(0,0));c.ApplyImpulse(new b2Vec2(5,0),c.GetPosition());if(!a.isOpened){var d=getObjectByCustomInfo("small_wall_red"),e=getObjectByCustomInfo("cover3"),f=getObjectByCustomInfo("square_red");
a.isOpened=!0;getObjectByCustomInfo("fish_green").isOpened&&world.DestroyBody(getObjectByCustomInfo("win_wall").box2dBody);f.gotoAndStop(0);a.eye.open();playSound("CorrectButton");playSound("DoorLeft");handlers.moveBridge(d,"y",d.y+25,250,e,!1,function(){world.DestroyBody(d.box2dBody);d.setStatic(!0);e.setStatic(!0);f.setStatic(!0)})}},enterGreenTube:function(){var a=getObjectByCustomInfo("fish_green");box2d.setBodyPosition(bob.box2dBody,a.x,a.y-5);var c=bob.box2dBody;c.SetAngularVelocity(0);c.SetLinearVelocity(new b2Vec2(0,
0));c.ApplyImpulse(new b2Vec2(-5,0),c.GetPosition());if(!a.isOpened){var d=getObjectByCustomInfo("small_wall_green"),e=getObjectByCustomInfo("cover2"),f=getObjectByCustomInfo("square_green");a.isOpened=!0;getObjectByCustomInfo("fish_green").isOpened&&world.DestroyBody(getObjectByCustomInfo("win_wall").box2dBody);f.gotoAndStop(0);a.eye.open();playSound("CorrectButton");playSound("DoorLeft");handlers.moveBridge(d,"y",d.y-25,250,e,!1,function(){d.setStatic(!0);e.setStatic(!0);f.setStatic(!0)})}},enterBlueTube2:function(){var a=
levelsScripts[14],c=getObjectByCustomInfo("pipe_blue1");box2d.setBodyPosition(bob.box2dBody,c.x,c.y);a.shootBobOut()},shootBobOut:function(){var a=bob.box2dBody;a.SetAngularVelocity(0);a.SetLinearVelocity(new b2Vec2(0,0));a.ApplyImpulse(new b2Vec2(0,-12),a.GetPosition())},addStarStonesHandlers:function(){function a(){c.forEach(function(a){a.finished=!0;a.onclick=null});playSound("WoodDrag(SnailBob3)");d.onclick=null;d.onchangeframe=function(a){a=a.target;a.animated&&a.currentFrameX==a.framesCount-
1&&a.stop()};d.play()}var c=[getObjectByCustomInfo("sb1"),getObjectByCustomInfo("sb2"),getObjectByCustomInfo("sb3")],d=getObjectByCustomInfo("star_door");c.forEach(function(d){d.onclick=function(f){f=f.target;f.gotoAndStop(1);f.checked=!0;playSound("ButtonInterface1(SnailBob3)");c.every(function(a){return a.checked})?a():stage.setTimeout(function(){d.finished||(d.checked=!1,d.gotoAndStop(0))},500)}})},addBobBtnPressListener:function(){function a(){25<getDistance(bob,c)||(stage.removeEventListener("pretick",
a),c.setStatic(!1),c.play(),playSound("Button"))}var c=getObjectByCustomInfo("press_btn");c.onchangeframe=function(a){a=a.target;if(a.currentFrame==a.totalFrames-1){a.stop();a.setStatic(!0);a=getObjectByCustomInfo("g2");a.currentFrame=1;a.setStatic(!0);var c=getObjectByCustomInfo("g1");c.currentFrame=1;var f=getObjectByCustomInfo("obstacle1"),g=getObjectByInfo("cover1");handlers.moveBridge(f,"y",f.y-40,250,g,!1,function(){f.setStatic(!0);g.setStatic(!0);c.setStatic(!0)});playSound("DoorLeft")}};c.animDelay=
3;stage.addEventListener("pretick",a)},addConveyorBtnHandler:function(){var a=levelsScripts[14];getObjectByCustomInfo("btn_conveyor").onclick=function(){a.isConveyorOn?a.turnConveyorOff():a.turnConveyorOn()}},setLightningInterval:function(){function a(){gameState==STATE_GAME&&(playSound("Battery"),e=new TilesSprite(bitmaps.shock_lvl20,26,70,20,2,10),stage.addChild(e),e.setRelativePosition(104,-110),stage.setTimeout(function(){e.destroy=!0;e=null;stage.removeEventListener("pretick",c);stage.setTimeout(a,
5E3)},5E3),stage.addEventListener("pretick",c))}function c(){25>getDistance(e,bob)&&d.shockBob()}var d=levelsScripts[14],e;a()},shockBob:function(){bob.isShocked||(bob.isShocked=!0,bob.changeState("shocked"))},addBridgeButtonHandlers:function(){var a=getObjectByCustomInfo("button_left"),c=getObjectByCustomInfo("button_right"),d=new Sprite(bitmaps.btn_move_platform_lvl15,32,32);d.setZIndex(1);var e=d.clone();stage.addChild(d);stage.addChild(e);d.setPosition(a.x,a.y);e.setPosition(c.x,c.y);d=getObjectByCustomInfo("bridge");
handlers.movePlatform.call(a,d,158);handlers.movePlatform.call(c,d,345)},addPipesCovers:function(){["pipe_blue1","pipe_green","pipe_red","pipe_blue2"].forEach(function(a){a=getObjectByCustomInfo(a);a.setZIndex(bob.zIndex+1);var c=new Sprite(bitmaps.tube_under,62,8);c.setPosition(a.x,a.y-28);c.setZIndex(bob.zIndex-1);stage.addChild(c)})},addWheelStar:function(){var a=getObjectByCustomInfo("star_wheel"),c=new Sprite(bitmaps.star_lvl15,18,18);c.setPropScale(1.2);c.onclick=function(a){a=a.target;changeParent(a,
stage,!0);animateStarReceive(a);return!1};a.addChild(c)},turnConveyorOn:function(){levelsScripts[14].isConveyorOn=!0;getObjectByInfo("wheel").forEach(function(a){a.onprerender=function(a){a=a.target.box2dBody;a.SetAngle(a.GetAngle()-.3)}})},turnConveyorOff:function(){levelsScripts[14].isConveyorOn=!1;getObjectByInfo("wheel").forEach(function(a){a.onprerender=null})},isBobOnConveyor:function(){if(levelsScripts[14].isConveyorOn&&!(150<bob.y)){var a=bob.box2dBody.GetContactList();for(a;a;a=a.next)if("wheel"==
a.other.sprite.info){bob.box2dBody.m_linearVelocity.x=-2;break}}},isBobInFishMouth:function(){var a=getObjectByCustomInfo("fish_green");20>getDistance(a,bob)&&0<bob.box2dBody.GetLinearVelocity().x&&(box2d.setBodyPosition(bob.box2dBody,a.x,a.y-5),a=bob.box2dBody,a.SetAngularVelocity(0),a.SetLinearVelocity(new b2Vec2(0,0)),a.ApplyImpulse(new b2Vec2(-5,0),a.GetPosition()))},pretick:function(){var a=levelsScripts[14];a.isBobOnConveyor();a.isBobInFishMouth()}},{init:function(){var a=getObjectByCustomInfo("button_left1"),
c=getObjectByCustomInfo("button_right1"),d=getObjectByCustomInfo("platform1");handlers.movePlatform.call(a,d,134);handlers.movePlatform.call(c,d,368);var c=getObjectByCustomInfo("button_left2"),e=getObjectByCustomInfo("button_right2"),a=getObjectByCustomInfo("platform2");handlers.movePlatform.call(c,a,135);handlers.movePlatform.call(e,a,317);d.lamp=createObject({type:"lamp_red2",x:.8,y:1},findObject("lamp_red2"),d);a.lamp=createObject({type:"lamp_blue2",x:.8,y:1},findObject("lamp_blue2"),a);d.lamp.stop();
a.lamp.stop();d.lamp.setStatic(!1);a.lamp.setStatic(!1);d.btn=createObject({type:"btn2",x:d.x+.8,y:d.y-12},findObject("btn2"));a.btn=createObject({type:"btn2",x:a.x+.8,y:a.y-12},findObject("btn2"));d.onprerender=a.onprerender=function(a){a.target.btn.x=a.target.x+.8};d.btn.stop();a.btn.stop();c=getObjectByInfo("ad_lvl16");c.setStatic(!0);c.animDelay=3;this.ad=c;getObjectByCustomInfo("buttonAd").onclick=this.showAd;getObjectByCustomInfo("coverAd").onclick=returnFalse;this.bridge=getObjectByCustomInfo("bridge");
getObjectByCustomInfo("buttonBridge").onclick=this.moveBridge;this.light=getObjectByInfo("light_lvl16");this.light.animDelay=2;this.light.play();c=getObjectByCustomInfo("btn");c.lamp1=getObjectByCustomInfo("lamp_btn");c.lamp2=getObjectByCustomInfo("lampGreen");handlers.buttonPress.call(c,this.buttonPressed);d.btn.lamp1=d.lamp;d.btn.lamp2=getObjectByCustomInfo("lampRed");handlers.buttonPress.call(d.btn,this.buttonPressed);a.btn.lamp1=a.lamp;a.btn.lamp2=getObjectByCustomInfo("lampBlue");handlers.buttonPress.call(a.btn,
this.buttonPressed);this.checkLamps=[c.lamp2,d.btn.lamp2,a.btn.lamp2]},buttonPressed:function(a){var c=levelsScripts[15];playSound("CorrectButton5(SnailBob3)");a.lamp1.gotoAndStop(1);a.lamp2.gotoAndStop(1);"btn"!==a.custom&&(a.onchangeframe=function(a){a=a.target;a.currentFrame===a.totalFrames-1&&(a.stop(),a.onchangeframe=null)});stage.refreshBackground();a=c.checkLamps;for(var d=!0,e=0;e<a.length;e++)0===a[e].currentFrame&&(d=!1);d&&c.moveWall();getObjectByCustomInfo("startTube").setStatic(!0)},
moveWall:function(){var a=levelsScripts[15],c=getObjectByCustomInfo("wall"),d=getObjectByCustomInfo("coverWall"),e=a.checkLamps;e.push(d);e.push(getObjectByCustomInfo("coverBut"));handlers.moveBridge(c,"y",150,1E3,e,Easing.quartic.easeOut);a.light.destroy=!0;field.destination.setStatic(!1);playSound("get_all_stars(SnailBob3)")},moveBridge:function(){var a=levelsScripts[15].bridge,c=getObjectByCustomInfo("coverBridge");handlers.moveBridge(a,"x",a.state?163:223,500,c,Easing.quartic.easeOut);a.state?
playSound("DoorLeft"):playSound("DoorRight");a.state=!a.state},showAd:function(a){a=a.target;var c=levelsScripts[15];a.destroy=!0;addSprite("button_temp_cover",26,26,a.x,a.y,!0);var d=getObjectByCustomInfo("coverAd");d.setStatic(!1);d.moveTo(d.x,d.y-70,500,!1,function(){d.destroy=!0});c.ad.setStatic(!1);c.ad.play();c.ad.onclick=showSecondBob;playSound("Bridge")},ifBobShocked:function(){var a=levelsScripts[15].light;!a.destroy&&30>getDistance(bob,a)&&220<bob.y&&-1===bob.state.indexOf("shocked")&&bob.changeState("shocked")},
pretick:function(){var a=levelsScripts[15];handlers.ifBobFall(260);a.ifBobShocked()}},{init:function(){var a=getObjectByInfo("star");a.setStatic(!0);a.onclick=this.starAction;this.star1=a;a=getObjectByInfo("star_lvl17");a.setStatic(!0);handlers.getStar.call(a);this.star2=a;var c=getObjectByInfo("doors_lvl17");c.stop();c.animDelay=3;c.setStatic(!0);c.onchangeframe=function(a){a=a.target;a.currentFrameX==a.framesCount-1&&(a.stop(),c.setStatic(!0),c.onclick=null)};c.onclick=returnFalse;getObjectByCustomInfo("cover1").setStatic(!0);
getObjectByCustomInfo("cover2").setStatic(!0);getObjectByCustomInfo("cover3").setStatic(!0);getObjectByCustomInfo("destination").setStatic(!1);getObjectByCustomInfo("g1").currentFrame=1;getObjectByCustomInfo("g2").currentFrame=1;getObjectByCustomInfo("bridge_btn").onclick=this.moveBridges;getObjectByCustomInfo("lift_btn").onclick=this.moveLift;getObjectByCustomInfo("head_1").onclick=this.rotateHead;getObjectByCustomInfo("head_2").onclick=this.rotateHead;bob.blockClick=!0;stage.setTimeout(function(){bob.changeState("hide")},
1800);this.addTriangularsHandlers();this.setStar3Interval()},addTriangularsHandlers:function(){function a(a){k.setStatic(!1);k.animDirection=1;k.onchangeframe=function(a){a=a.target;a.currentFrameX==a.framesCount-1&&(a.stop(),a.animDirection=1,a.setStatic(!0))};k.play();k=a;k.setStatic(!1);k.animDirection=-1;k.onchangeframe=function(a){a=a.target;0==a.currentFrameX&&(a.stop(),a.setStatic(!0),c())};k.play()}function c(){var a=levelsScripts[16];a.lasers&&a.lasers.forEach(destroyMe);a.lasers=[];l.forEach(function(c,
d){if(c!==k){switch(d+1){case 1:var e=new Sprite(bitmaps.laser_lvl17_horizontal,138,8);e.setPosition(e.width/2-1,3);break;case 2:e=new Sprite(bitmaps.laser_lvl17_long,7,206);e.setPosition(1,e.height/2+2);break;case 3:e=new Sprite(bitmaps.laser_lvl17_short,8,70);e.setPosition(1,e.height/2+2);break;case 4:e=new Sprite(bitmaps.laser_lvl17_long,7,206);e.setPosition(1,e.height/2+2);break;case 5:e=new Sprite(bitmaps.laser_lvl17_horizontal,128,8),e.setPosition(-e.width/2,3)}e.x+=c.x;e.y+=c.y;e.index=d+1;
stage.addChild(e);e.setStatic(!0);a.lasers.push(e)}})}var d=getObjectByCustomInfo("t1"),e=getObjectByCustomInfo("t2"),f=getObjectByCustomInfo("t3"),g=getObjectByCustomInfo("t4"),h=getObjectByCustomInfo("t5"),k=d,l=[d,e,f,g,h];l.forEach(function(c,d){c.gotoAndStop(5);c.animDelay=3;c.index=d+1;c.setStatic(!0);c.onclick=function(c){c=c.target;if(c!==k)return a(c),playSound("L8_S1_laser_out(SnailBob3)"),!1}});d.gotoAndStop(0);c()},setStar3Interval:function(){var a=levelsScripts[16],c=stage.setInterval(function(){for(var d=
a.lasers,e,f=0;f<d.length;f++)2==d[f].index&&(e=d[f]);if(e){var g=new Sprite(bitmaps.star_lvl17_laser,30,28);e.addChild(g);g.setPosition(0,-e.height/2+30);g.addEventListener("click",function(){if(!g.received)return g.received=!0,stage.clearInterval(c),g.removeTweens(),changeParent(g,stage,!0),animateStarReceive(g),!1});g.moveTo(0,e.height/2-30,2E3,null,function(){g.destroy=!0});g.rotateTo(2*Math.PI,2E3);g.setPropScale(0);g.scaleTo(1.5,1E3,null,function(){g.scaleTo(0,1E3)})}},5E3)},rotateHead:function(a){var c=
a.target;if(!c.busy){c.busy=!0;var d=levelsScripts[16].checkHeadRotation;c.rotateTo(c.rotation+Math.PI/2,500,null,function(){d(c)||(c.busy=!1)});playSound("StoneHeadRotating(SnailBob3)")}},checkHeadRotation:function(a){var c=levelsScripts[16],d=getObjectByCustomInfo("head_1"),e=getObjectByCustomInfo("head_2");if(0==d.rotation&&e.rotation==Math.PI)return c.addEyes(),!0;if(a===d&&0==d.rotation||a===e&&e.rotation==Math.PI)return!0},addEyes:function(){var a=this,c=getObjectByCustomInfo("head_1"),d=getObjectByCustomInfo("head_2"),
e=new TilesSprite(bitmaps.eyes_light_lvl17,34,20,18,6,3);e.animDelay=3;e.onchangeframe=function(a){a=a.target;a.currentFrameX==a.framesCount-1&&a.gotoAndStop(0)};e.setPosition(2,8);c.addChild(e);c=e.clone();d.addChild(c);c.addEventListener("changeframe",function(c){c=c.target;c.currentFrameX==c.framesCount-1&&a.openBox()});playSound("L1_S4_Eyes1(SnailBob3)")},openBox:function(){var a=getObjectByInfo("doors_lvl17");a.play();a.setStatic(!1);playSound("Battery")},moveBridges:function(a){var c=getObjectByCustomInfo("bridge1"),
d=getObjectByCustomInfo("bridge2"),e=getObjectByCustomInfo("cover1"),f=getObjectByCustomInfo("cover2");a=a.target;var g=a.state?304:304+d.width;handlers.moveBridge(c,"x",a.state?302:302-c.width,200,e,!1);handlers.moveBridge(d,"x",g,200,f,!1);a.state=!a.state;a.state?playSound("DoorLeft"):playSound("DoorRight");c=getObjectByCustomInfo("g1");d=getObjectByCustomInfo("g2");c.currentFrame=d.currentFrame=!c.currentFrame},moveLift:function(a){var c=getObjectByCustomInfo("lift"),d=getObjectByCustomInfo("cover3");
a=a.target;var e=a.state?320:182,f=5E3*Math.abs(e-c.y)/Math.abs(-138);field.bottomUIBack.setStatic(!1);handlers.moveBridge(c,"y",e,f,d,!1,function(){field.bottomUIBack.setStatic(!0)});playSound("GroundUp");a.state=!a.state},checkLaserHit:function(){if("onLaser"!=bob.state)for(var a=this.lasers,c=0;c<a.length;c++){var d=a[c];if(stage.hitTest(d,bob)){var e=-1!==d.bitmap.src.indexOf("horizontal")?"y":"x";12>Math.abs(bob[e]-d[e])&&bob.changeState("onLaser")}}},pretick:function(){levelsScripts[16].checkLaserHit();
handlers.ifBobFall(260)}},{init:function(){var a=levelsScripts[17];a.setAntsInterval();a.setStoneOnBtnListener();a.setAntOnBtnListener();a.setBeachAntOnBtnListener();a.initBobPosition();a.setLevelHandler();a.turnHooverOn();a.addBeeInterval();a.setUmbrellaHandler();getObjectByCustomInfo("destination").static=!1;getObjectByCustomInfo("g3").static=!1;"cover1 g1 g2 star_umb umb_cover umbrella".split(" ").forEach(function(a){(getObjectByCustomInfo(a)||getObjectByInfo(a)).setStatic(!0)})},turnHooverOn:function(){levelsScripts[17].isHooverOn=
!0;var a=getObjectByCustomInfo("hoover_in"),c=getObjectByCustomInfo("hoover_out");a.play();c.play();playSound("AntiantTurnsOn")},turnHooverOff:function(){levelsScripts[17].isHooverOn=!1;var a=getObjectByCustomInfo("hoover_in"),c=getObjectByCustomInfo("hoover_out");a.gotoAndStop(0);c.gotoAndStop(0);playSound("AntiantTurnsOff")},setUmbrellaHandler:function(){getObjectByCustomInfo("star_umb").setPropScale(.8);var a=getObjectByInfo("umbrella");a.animDelay=3;a.onchangeframe=function(a){a=a.target;a.animated&&
a.currentFrame==a.totalFrames-1&&(a.stop(),a.setStatic(!0))};a.onclick=function(a){a=a.target;a.onclick=null;a.setStatic(!1);a.play();playSound("UmbrellaClose(SnailBob3)");return!1}},activatePress:function(){function a(){bob.isSmashed||!box2d.hitTest(bob.box2dBody,e.box2dBody)||50<Math.abs(bob.x-e.x)||(bob.isSmashed=!0,bob.changeState("smashed"))}var c=levelsScripts[17],d=getObjectByCustomInfo("g3"),e=getObjectByCustomInfo("press");e.activated||(e.activated=!0,d.gotoAndStop(1),stage.addEventListener("posttick",
a),c.movePress(e,60,function(){stage.removeEventListener("posttick",a);d.gotoAndStop(0)},function(){e.activated=!1}))},movePress:function(a,c,d,e){function f(){var c=box2d.getBodyPosition(a.box2dBody),c=stage.createTween(0,0,c.y,g.y,300,null);c.onchange=function(c){box2d.setBodyPosition(a.box2dBody,a.x,c.value)};c.onfinish=function(c){box2d.setBodyPosition(a.box2dBody,a.x,c.value);e&&e()};c.play()}var g=box2d.getBodyPosition(a.box2dBody);c=stage.createTween(0,0,g.y,g.y+c,500,Easing.exponential.easeOut);
c.onchange=function(c){box2d.setBodyPosition(a.box2dBody,a.x,c.value)};c.onfinish=function(c){box2d.setBodyPosition(a.box2dBody,a.x,c.value);d&&d();f()};c.play();playSound("BoxDropped")},addBeeInterval:function(){function a(){var a=new Sprite(bitmaps.star1,28,27);a.onclick=function(a){a=a.target;changeParent(a,stage,!0);stage.clearInterval(c);animateStarReceive(a);a.onclick=null;return!1};a.setPosition(0,15);return a}var c=stage.setInterval(function(){if(gameState==STATE_GAME){playSound("Bumblebee(SnailBob3)");
var c=[-30,510],e=c.splice(Math.round(Math.random()),1)[0],c=c[0],f=new Sprite(bitmaps.bee_lvl18,40,40,3);-30!=e&&(f.scaleX=-1);f.animDelay=3;f.setPosition(e,160);f.addChild(a());stage.addChild(f);e=stage.createTween(f,"x",e,c,3E3);e.onfinish=function(){f.destroy=!0};e.play();(function(){var a=arguments.callee,c=stage.createTween(f,"y",f.y,160==f.y?170:160,500);c.onfinish=function(){a()};c.play()})()}},8E3)},setLevelHandler:function(){var a=levelsScripts[17],c=getObjectByInfo("lever2");c.scaleX=-1;
c.onclick=function(){a.isHooverOn?a.turnHooverOff():a.turnHooverOn()}},setAntOnBtnListener:function(){function a(){gameState==STATE_GAME&&(playSound("Battery"),f=new TilesSprite(bitmaps.shock_lvl20,26,70,20,2,10),f.setPropScale(1.2),stage.addChild(f),f.setRelativePosition(6,52),stage.setTimeout(function(){f.destroy=!0;f=null;e.animDirection=-1;e.play();stage.removeEventListener("pretick",c)},500),stage.addEventListener("pretick",c))}function c(){20>Math.abs(f.x-bob.x)&&d.shockBob()}var d=levelsScripts[17],
e=getObjectByCustomInfo("press_btn2");e.static=!1;e.onchangeframe=function(c){c=c.target;c.animated&&(0==c.currentFrame&&(c.stop(),c.active=!1),c.currentFrame==c.totalFrames-1&&(c.stop(),a()))};e.animDelay=1;stage.addEventListener("pretick",function(){if(!e.active)for(var a=d.getAnts(),c=0,f=a.length;c<f;c++)if(15>getDistance(a[c],e)){e.active=!0;e.play();playSound("Button");break}});var f},setBeachAntOnBtnListener:function(){function a(){gameState==STATE_GAME&&(d.active=!0,d.play(),playSound("Button"),
stage.setTimeout(function(){d.animDirection=-1;d.play()},500))}var c=levelsScripts[17],d=getObjectByCustomInfo("press_btn3");d.setStatic(!1);d.onchangeframe=function(a){a=a.target;a.animated&&(0==a.currentFrame&&(a.stop(),a.active=!1),a.currentFrame==a.totalFrames-1&&(a.stop(),c.activatePress()))};d.animDelay=1;stage.addEventListener("pretick",function(){if(!d.active)for(var e=c.getAnts(!0),f=0,g=e.length;f<g;f++)if(15>getDistance(e[f],d)){a();break}})},shockBob:function(){bob.isShocked||(bob.isShocked=
!0,bob.changeState("shocked"))},getAnts:function(a){for(var c=[],d=stage.objects,e=0,f=d.length;e<f;e++){var g=d[e];a&&g.beachAnt?c.push(g):g.isAnt&&!a&&c.push(g)}return c},setStoneOnBtnListener:function(){function a(){25<getDistance(c,d)||(stage.removeEventListener("pretick",a),d.setStatic(!1),d.play(),playSound("Button"))}var c=getObjectByInfo("ball_lvl18"),d=getObjectByCustomInfo("press_btn1");d.onchangeframe=function(a){var c=a.target;if(c.currentFrame==c.totalFrames-1){c.stop();c.setStatic(!0);
var d=getObjectByCustomInfo("g1");d.currentFrame=1;d.setStatic(!1);getObjectByCustomInfo("g2").currentFrame=1;var h=getObjectByCustomInfo("bridge"),k=getObjectByInfo("cover1");handlers.moveBridge(h,"x",h.x+59,250,k,!1,function(){c.locked=!1;h.setStatic(!0);d.setStatic(!0);k.setStatic(!0)});playSound("DoorLeft")}};d.animDelay=3;stage.addEventListener("pretick",a)},initBobPosition:function(){bob.changeState("hide");bob.box2dBody.SetFixedRotation(!0);bob.box2dBody.ApplyImpulse(new b2Vec2(7,-1),bob.box2dBody.GetPosition())},
setAntsInterval:function(){getObjectByInfo("cover2").setZIndex(12);stage.setInterval(function(){var a=createObject({type:"ant_lvl18",x:0,y:115,rotation:0},findObject("ant_lvl18"));a.isAnt=!0;a.mySpeed=2;a.box2dBody.m_linearVelocity.x=a.mySpeed;a.box2dBody.SetFixedRotation(!0);a.setZIndex(11)},1500)},keepAntsSpeed:function(){var a=levelsScripts[17],c=a.getAnts(),c=c.concat(a.getAnts(!0));c.forEach(function(a){a.box2dBody.m_linearVelocity.x=a.mySpeed})},checkAntsOut:function(){var a=levelsScripts[17],
c=a.getAnts(),a=a.getAnts(!0);c.forEach(function(a){350<a.x&&deleteObject(a)});a.forEach(function(a){490<a.x&&deleteObject(a)})},suckAntIntoHoover:function(a){var c=getObjectByCustomInfo("hoover"),d=getObjectByCustomInfo("hoover_in"),e=getObjectByCustomInfo("hoover_out");e.setZIndex(12);a.isAnt=!1;world.DestroyBody(a.box2dBody);a.setZIndex(d.zIndex-1);a.moveTo(d.x,d.y-15,200,null,function(){a.destroy=!0;var d=new Sprite(bitmaps.ant_received_anim,24,24);d.setZIndex(c.zIndex-1);d.setPosition(c.x-62,
c.y+55);stage.addChild(d);(function(){(new PathTween(d,[{x:c.x-62,y:c.y+55},{x:c.x-68,y:c.y-15},{x:c.x-55,y:c.y-12},{x:c.x+23,y:c.y-15},{x:c.x+40,y:c.y-10},{x:c.x+42,y:c.y+25},{x:c.x+60,y:c.y+32}],!0)).start(700,null,function(){d.destroy=!0;var a=createObject({type:"ant_beach",x:e.x,y:e.y,rotation:0},findObject("ant_beach"));a.setZIndex(e.zIndex-1);a.beachAnt=!0;a.mySpeed=2;a.box2dBody.m_linearVelocity.x=a.mySpeed;a.box2dBody.SetFixedRotation(!0)})})()})},checkAntHooverIn:function(){var a=levelsScripts[17];
if(a.isHooverOn)for(var c=a.getAnts(),d=getObjectByCustomInfo("hoover_in"),e=0,f=c.length;e<f;e++){var g=c[e];8>Math.abs(g.x-d.x)&&a.suckAntIntoHoover(g)}},pretick:function(){var a=levelsScripts[17];a.checkAntHooverIn();a.keepAntsSpeed();a.checkAntsOut();handlers.ifBobFall(250)}},{init:function(){var a=levelsScripts[18];bob.changeState("hide");var c=getObjectByCustomInfo("star1");c.onclick=animateStarReceive.bind(null,c);var c=getObjectByInfo("baraban"),d=getObjectByCustomInfo("btn_1");handlers.setBaraban(c,
d);getObjectByCustomInfo("head_in").zIndex=20;getObjectByCustomInfo("head_out").zIndex=20;getObjectByCustomInfo("destination").zIndex=20;getObjectByCustomInfo("destination").static=!1;a.setShockers();a.setBtn2Handler();a.addElectroHandler();a.setIsBobInHeadListener();field.levelTitle.setStatic(!1)},setShockers:function(){function a(a,d){var g=e[d][1],h=Math.abs(g-a.x);a.moveTo(g,a.y,h*f[d],null,c.bind(null,a,d))}function c(c,d){var g=e[d][0],h=Math.abs(g-c.x);c.moveTo(g,c.y,h*f[d],null,a.bind(null,
c,d))}for(var d=[getObjectByCustomInfo("s1"),getObjectByCustomInfo("s2"),getObjectByCustomInfo("s3")],e=[[110,337],[248,355],[237,374]],f=[14,20,18],g=0;g<d.length;g++){var h=d[g],k=e[g][0],l=Math.abs(k-h.x);h.moveTo(k,h.y,l*f[g],null,a.bind(null,h,g))}},addElectroHandler:function(){function a(){l.forEach(function(a){var c=new Sprite(bitmaps.laser_lvl19,8,52);c.rotation=Math.PI/2;c.rotation+=a.rotation;0==a.rotation?c.setPosition(a.x+c.height/2+8,a.y):c.setPosition(a.x,a.y+ +c.height/2+8);c.setZIndex(a.zIndex-
1);stage.addChild(c);c.setStatic(!0);a.myLaser=c});playSound("L8_S1_laser_out(SnailBob3)")}function c(){l.forEach(function(a){a.myLaser.destroy=!0;a.myLaser=null});stage.refreshBackground();playSound("L8_S2_laser_in(SnailBob3)")}function d(){v.forEach(function(a){a.bitmap=bitmaps.electro_ball_on;a.width=46;a.height=52;a.totalFrames=5;a.framesCount=10;a.totalLayers=2;a.animDelay=3;a.play()});stage.addEventListener("pretick",f);playSound("L18_S1_light_off(SnailBob3)")}function e(){v.forEach(function(a){a.bitmap=
bitmaps.electro_ball_off;a.width=32;a.height=32;a.frames=1;a.gotoAndStop(0)});stage.removeEventListener("pretick",f);playSound("L18_S2_Light_on(SnailBob3)")}function f(){for(var a=0,c=v.length;a<c;a++)20>getDistance(bob,v[a])&&(bob.changeState("shocked"),stage.removeEventListener("pretick",f))}for(var g=getObjectByCustomInfo("handler"),h=getObjectByCustomInfo("g1"),k=getObjectByCustomInfo("g2"),l=[],q=1;4>=q;q++)l.push(getObjectByCustomInfo("l"+q));var v=[getObjectByCustomInfo("s1"),getObjectByCustomInfo("s2"),
getObjectByCustomInfo("s3")];h.gotoAndStop(1);a();var w=!1;g.onclick=function(f){(w=!w)?(h.gotoAndStop(0),k.gotoAndStop(1),c(),d()):(h.gotoAndStop(1),k.gotoAndStop(0),a(),e())};stage.addEventListener("pretick",function(){if(l[0].myLaser&&!bob.isBurned)for(var a=0;4>a;a++)15>getDistance(bob,l[a].myLaser)&&(bob.isBurned=!0,bob.changeState("onLaser"))})},setBtn2Handler:function(){function a(){var a=l?55:-55;(l=!l)?(g.gotoAndStop(0),h.gotoAndStop(0),playSound("DoorRight")):(g.gotoAndStop(1),h.gotoAndStop(1),
playSound("DoorLeft"));handlers.moveBridge(c,"x",c.x+a,300,e,!1,function(){c.setStatic(!0);d.setStatic(!0);e.setStatic(!0);f.setStatic(!0);k.busy=!1});handlers.moveBridge(d,"x",d.x+a,300,f,!1)}var c=getObjectByCustomInfo("bridge1"),d=getObjectByCustomInfo("bridge2"),e=getObjectByCustomInfo("cover1"),f=getObjectByCustomInfo("cover2"),g=getObjectByCustomInfo("g3"),h=getObjectByCustomInfo("g4"),k=getObjectByCustomInfo("btn_2");g.gotoAndStop(1);h.gotoAndStop(1);k.onclick=function(c){c=c.target;c.busy||
(c.busy=!0,a())};var l=!1},teleportBob:function(){var a=getObjectByCustomInfo("head_out");box2d.setBodyPosition(bob.box2dBody,a.x+15,a.y);bob.changeState("turn")},setIsBobInHeadListener:function(){function a(){25>getDistance(bob,d)&&(stage.removeEventListener("pretick",a),stage.setTimeout(function(){c.teleportBob()},1E3))}var c=levelsScripts[18],d=getObjectByCustomInfo("head_in");stage.addEventListener("pretick",a)},pretick:function(){handlers.ifBobFall(260)}},{init:function(){var a=levelsScripts[19],
c=getObjectByInfo("boss_lvl20");c.animDelay=3;c.play();c.level=1;c.state="stay";c.box2dBody.SetFixedRotation(!0);a.boss=c;getObjectByCustomInfo("lift").level=1;getObjectByCustomInfo("red_btn2").onclick=function(c){a.moveUpperObstacles(c);return!1};a.setBtn3Handler();a.setBtn4Handler();a.setBtn5Handler();field.bottomUIBack.setStatic(!1);a.setMirrorAnim();handlers.setFan(getObjectByCustomInfo("mech"),getObjectByCustomInfo("red_btn1"),null,new b2Vec2(-10,-2));a.setBobOnBtnListener();a.setBossShootListener();
["star1","star_lvl20","lift_star"].forEach(function(a){getObjectByCustomInfo(a).onclick=function(a){a=a.target;a.received=!0;animateStarReceive(a);return!1}});c=getObjectByInfo("portal_lvl20");c.play();var d=new Sprite(bitmaps.portal_cover_lvl20,26,64);d.setPosition(c.x+15,c.y);stage.addChild(d);["cover1","star_cover","star_lvl20"].forEach(function(a){getObjectByCustomInfo(a).setStatic(!0)});getObjectByCustomInfo("lift").setStatic(!1)},setMirrorAnim:function(){var a=getObjectByCustomInfo("mirror");
a.animDelay=5;a.onchangeframe=function(a){var d=a.target;d.animated&&d.currentFrameX==d.framesCount-1&&(console.log("alarm"),d.stop(),stage.setTimeout(function(){d.gotoAndPlay(0)},3E3))}},setBossShootListener:function(){var a=levelsScripts[19],c=a.boss;stage.addEventListener("pretick",function(){if(!a.lightBulb&&"stay"==c.state){var d=getTwoPointsObstacles(c,{x:c.x-400,y:c.y}),e=d.every(function(a){return!a.custom||-1==a.custom.indexOf("obstacle")}),d=d.some(function(a){return a===bob});e&&d&&a.processShoot()}})},
processShoot:function(){function a(){playSound("Ch3_L20_MagicBallThrowing(SnailBob3)");var a=new TilesSprite(bitmaps.light_bulb,24,22,20,4,5);a.setPosition(d.x-25,d.y+5);stage.addChild(a);a.moveTo(d.x-400,d.y,5E3,null,function(){a.destroy=!0;c.lightBulb=null});c.lightBulb=a}var c=levelsScripts[19],d=c.boss;playSound("Mummy_cast(SnailBob3)");playSound("Ch3_L20_MagicBallCreating2(SnailBob3)");c.changeBossState("shoot");d.onchangeframe=function(d){d=d.target;20==d.currentFrameX&&a();d.currentFrameX==
d.framesCount-1&&c.changeBossState("stay")}},changeBossState:function(a){var c=levelsScripts[19],d=c.boss,c=c.getStateProps(a);d.bitmap=c.bitmap;d.width=c.w;d.height=c.h;d.totalFrames=c.r;d.totalLayers=c.c;d.framesCount=c.r*c.c;d.state=a;d.currentFrame=0;d.currentFrameX=0;d.onenterframe=null;d.onchangeframe=null},setBtn3Handler:function(){getObjectByCustomInfo("red_btn3").onclick=function(a){var c=a.target;if(!c.busy){c.busy=!0;var d=getObjectByCustomInfo("obstacle4");handlers.moveBridge(d,"y",d.moved?
133:170,300,getObjectByCustomInfo("cover4"),!1,function(){d.moved=!d.moved;d.setStatic(!0);c.busy=!1});return!1}}},setBtn4Handler:function(){function a(){playSound("CorrectButton");var a=getObjectByCustomInfo("push_btn2");a.animDelay=3;a.setStatic(!1);a.onchangeframe=function(a){a=a.target;if(a.currentFrame==a.totalFrames-1){a.stop();a.setStatic(!0);getObjectByCustomInfo("obstacle5").setStatic(!0);getObjectByCustomInfo("cover5").setStatic(!0);getObjectByCustomInfo("g3").currentFrame=1;var c=getObjectByCustomInfo("bridge2"),
f=getObjectByCustomInfo("cover6");handlers.moveBridge(c,"x",c.x+c.width,250,f,!1,function(){c.setStatic(!0);f.setStatic(!0);levelsScripts[19].boss.level=3});var g=getObjectByCustomInfo("lift"),h=getObjectByCustomInfo("cover7");handlers.moveBridge(g,"y",g.y+90,3E3,f,!1,function(){h.setStatic(!1);deleteObject(g)})}};a.play()}getObjectByCustomInfo("red_btn4").onclick=function(c){function d(){var c=levelsScripts[19];c.lightBulb&&10>getDistance(g,c.lightBulb)&&(stage.removeEventListener("pretick",d),stage.clearTimeout(v),
c.processRemoveBubble(),a())}var e=c.target;if(!e.busy){e.busy=!0;var f=getObjectByCustomInfo("obstacle5"),g=getObjectByCustomInfo("push_btn2"),h=getObjectByCustomInfo("cover5"),k=f.y,l=g.y,q=new Sprite(bitmaps.button_temp_cover,26,26);e.addChild(q);handlers.moveBridge(f,"y",k-30,300,h,!1);handlers.moveBridge(g,"y",l-30,300,h,!1);var v=stage.setTimeout(function(){stage.removeEventListener("pretick",d);handlers.moveBridge(f,"y",k,300,h,!1,function(){f.setStatic(!0);g.setStatic(!0);q.destroy=!0;e.busy=
!1});handlers.moveBridge(g,"y",l,300,h,!1)},2E3);stage.addEventListener("pretick",d);return!1}}},setBtn5Handler:function(){function a(){var e=c.lightBulb;if(e&&!e.reversed){var f=new Sprite(null,1,1);f.setPosition(e.x,e.y);f.destroy=!0;stage.addChild(f);stage.hitTest(f,d)&&(playSound("Whoosh3(SnailBob3)"),e.reversed=!0,e.removeTweens(),e.moveTo(c.boss.x,c.boss.y,3E3,null,function(){c.processRemoveBubble()}),c.setBossBulbHitListener(),stage.removeEventListener("pretick",a))}}var c=levelsScripts[19],
d=getObjectByCustomInfo("mirror");getObjectByCustomInfo("red_btn5").onclick=function(c){var f=c.target;if(!f.busy){var g=getObjectByCustomInfo("obstacle6"),h=getObjectByCustomInfo("cover7"),k=getObjectByCustomInfo("cover8");c=d.hidden?222:262;var l=d.hidden?220:220+g.height;d.hidden=!d.hidden;handlers.moveBridge(d,"y",c,250,h,!1,function(){d.setStatic(!1);h.setStatic(!1);f.busy=!1;d.hidden||stage.addEventListener("pretick",a)});handlers.moveBridge(g,"y",l,250,k,!1,function(){g.setStatic(!1);k.setStatic(!1)})}}},
setBossBulbHitListener:function(){function a(){var e=c.lightBulb;if(!e)stage.removeEventListener("pretick",a);else if(20>getDistance(d,e)){stage.removeEventListener("pretick",a);c.changeBossState("shocked");c.addBossSmoke();c.processRemoveBubble();deleteObject(getObjectByCustomInfo("inv_cover"));var f=getObjectByCustomInfo("mirror"),g=getObjectByCustomInfo("cover7");f.hidden=!0;handlers.moveBridge(f,"y",280,100,g,!1,function(){f.setStatic(!1);g.setStatic(!1)});c.addBobHitsBossListener();playSound("Mummy_hit(SnailBob3)")}}
var c=levelsScripts[19],d=c.boss;stage.addEventListener("pretick",a)},addBobHitsBossListener:function(){function a(){if(!(50<getDistance(bob,d))){var e=bob.box2dBody;e.ApplyImpulse(new b2Vec2(32,-3),e.GetPosition());d.box2dBody&&world.DestroyBody(d.box2dBody);bob.blockClick=!0;bob.speed=.5;c.addBossSmoke();c.changeBossState("defeat");c.setWinListener();playSound("WoodImpact(SnailBob3)");playSound("bob_yahoo(SnailBob3)");stage.removeEventListener("pretick",a)}}stage.addEventListener("pretick",a);var c=
levelsScripts[19],d=c.boss},setWinListener:function(){function a(){if(25>getDistance(bob,c)){stage.removeEventListener("pretick",a);var d=stage.createTween(bob,"width",bob.width,0,2E3);d.onfinish=function(){victory()};d.play()}}var c=getObjectByInfo("portal_lvl20");stage.addEventListener("pretick",a)},addBossSmoke:function(){var a=levelsScripts[19].boss,c=new TilesSprite(bitmaps.smoke_anim_lvl20,92,78,22,11,2);c.animDelay=2;c.onchangeframe=function(a){a=a.target;a.currentFrameX==a.framesCount-1&&
(a.destroy=!0)};c.setPosition(a.x,a.y);stage.addChild(c)},setBobOnBtnListener:function(){function a(){25<getDistance(bob,c)||(stage.removeEventListener("pretick",a),levelsScripts[19].boss.level=2,playSound("CorrectButton"),c.play())}var c=getObjectByCustomInfo("push_btn1");c.onchangeframe=function(a){var c=a.target;if(c.currentFrame==c.totalFrames-1){c.stop();c.setStatic(!0);getObjectByCustomInfo("g1").currentFrame=1;getObjectByCustomInfo("g2").currentFrame=1;var f=getObjectByCustomInfo("bridge1");
a=getObjectByCustomInfo("cover4");handlers.moveBridge(f,"x",f.x+f.width,250,a,!1,function(){c.locked=!1;f.setStatic(!0)})}};c.animDelay=3;stage.addEventListener("pretick",a)},moveUpperObstacles:function(a){var c=a.target;if(!c.locked){c.locked=!0;var d=getObjectByCustomInfo("cover1");a=getObjectByCustomInfo("obstacle1");var e=getObjectByCustomInfo("obstacle2"),f=getObjectByCustomInfo("obstacle3"),g=c.upPos?38:38-a.height;c.upPos=!c.upPos;c.upPos?playSound("DoorLeft"):playSound("DoorRight");[a,e,f].forEach(function(a){handlers.moveBridge(a,
"y",g,250,d,!1,function(){c.locked=!1;a.setStatic(!0)})});var h=getObjectByCustomInfo("lift");a=getObjectByInfo("boss_lvl20");if(1==h.level&&2==a.level){var k=getObjectByCustomInfo("cover7");h.level=2;field.bottomUIBack.setStatic(!1);handlers.moveBridge(h,"y",h.y+90,3E3,d,!1,function(){c.locked=!1;k.setStatic(!1);h.setStatic(!1)});var l=getObjectByCustomInfo("lift_star");l.received||(l.setStatic(!1),l.moveTo(l.x,l.y+90,3E3,null,function(){l.destroy=!0}))}}},getStateProps:function(a){switch(a){case "defeat":return{bitmap:bitmaps.boss_state_defeat,
w:102,h:60,r:5,c:4};case "shocked":return{bitmap:bitmaps.boss_state_shocked,w:102,h:60,r:6,c:3};case "shoot":return{bitmap:bitmaps.boss_state_shoot,w:102,h:60,r:6,c:4};case "stay":return{bitmap:bitmaps.boss_lvl20,w:102,h:60,r:6,c:4};case "victory":return{bitmap:bitmaps.boss_state_victory,w:102,h:60,r:5,c:3};default:console.log("Unknown boss state")}},checkObstacleHit:function(){var a=levelsScripts[19],c=a.lightBulb,d=stage.objects;if(c){var e=new Sprite(null,1,1);e.setPosition(c.x,c.y);e.destroy=
!0;stage.addChild(e);for(var c=0,f=d.length;c<f;c++){var g=d[c];if(g.custom&&-1!=g.custom.indexOf("obstacle")&&stage.hitTest(g,e)){a.processRemoveBubble();break}}}},processRemoveBubble:function(){var a=levelsScripts[19],c=a.lightBulb;c.destroy=!0;a.lightBulb=null;playSound("Ch3_L20_MagicBallThrowing(SnailBob3)");a=new TilesSprite(bitmaps.light_bulb_explode,82,82,16,4,4);a.setPosition(c.x,c.y);a.onchangeframe=function(a){a=a.target;a.currentFrameX==a.framesCount-2&&(a.destroy=!0)};stage.addChild(a)},
checkBobShot:function(){var a=levelsScripts[19],c=a.lightBulb;if(c){var d=new Sprite(null,1,1);d.setPosition(c.x,c.y);d.destroy=!0;stage.addChild(d);stage.hitTest(bob,d)&&a.processHitBob()}},processHitBob:function(){var a=levelsScripts[19];a.processRemoveBubble();a.changeBossState("victory");bob.changeState("magicHit");playSound("Mummy_shot(SnailBob3)");playSound("Ch3_L20_MummyImpact(SnailBob3)")},pretick:function(){var a=levelsScripts[19];a.checkObstacleHit();a.checkBobShot()}}],field={init:function(){field.setBack();
field.stopAnimations();field.setUI();field.hideInvisibleImg();field.setBackTube();field.setBobDestination();field.starsCount=0;field.lasers=[];field.bobs=[bob]},setBackTube:function(){var a=[],c,d,e,f,g,h;for(c=0;c<stage.objects.length;c++){var k=stage.objects[c];"tube"===k.info&&a.push(k)}for(c=0;c<a.length;c++){k=a[c];k.setZIndex(20);switch(k.bitmap){case bitmaps.tube1:d=35.5;e=0;f=8;g=57;h="backTube1";break;case bitmaps.tube2:d=-35.5;e=0;f=8;g=57;h="backTube2";break;case bitmaps.tube3:d=0;e=30;
f=56;g=8;h="backTube3";(function(a){stage.setTimeout(function(){a.setStatic(!0)},500)})(k);break;case bitmaps.tube4:e=d=0;f=38;g=42;h="backTube4";break;case bitmaps.tube5:d=1;e=28;f=64;g=8;h="backTube5";break;default:console.log("unknown bitmap")}var l=new Vector(d,e);l.rotate(-k.rotation);k.backTube=addSprite(h,f,g,k.x+l.x,k.y+l.y,!0);k.backTube.rotation=k.rotation}},setBack:function(){var a=1!=GET.debug?"Lvl"+(currentLevel+1)+"_back":"Lvl"+(editorLevel+1)+"_back";setCSSBack(bitmaps[a]);Utils.mobileCheckBrokenAndroid()&&
addSprite(a,570,320,240,160,!0).setZIndex(1)},setUI:function(){function a(a){var c,e,f;a.target.bitmap===bitmaps.SpeedFastBtn?(c=2,e="walk",f="run",playSound("SpeedFast")):(c=1,e="run",f="walk",playSound("SpeedStandard"));bob&&bob.selectedSpeed!==c&&(bob.selectedSpeed=c,d.gotoAndStop(c-1),bob.state===e&&bob.changeState(f),a.target.static&&stage.refreshBackground())}var c=addSprite("back_speed_panel",64,45,32,18,!0),d=addToContainer(c,"indicator",48,33,0,-3,!0,2);field.speedIndicator=d;var e=addToContainer(c,
"SspeedStandardBtn",17,17,-11,.8,!0,1,a),f=addToContainer(c,"SpeedFastBtn",17,17,11,.8,!0,1,a);e.hitArea=f.hitArea={x:0,y:0,width:22,height:22};this.speedPanel=c;c=addRelativeSprite("bottom_ui_back",570,31,0,15.5,"center","bottom",!0);c.setZIndex(16);showSpilLogo(75,0,c);field.bottomUIBack=c;c=addSprite("levelMap_ingame",50,34,25,304.5,!1,3,levelSelect);e=addSprite("restart_ingame",68,32,84,305.8,!1,3,restart);c.hitArea={x:0,y:-4,width:48,height:34};e.hitArea={x:0,y:-4,width:68,height:34};attachMouseEvents.call(c,
!0);attachMouseEvents.call(e,!0);c=addSprite("sound_lvlMap",28,28,400,306,!1,3);c.hitArea={x:0,y:-3,width:30,height:30};attachMouseEvents.call(c,!0);coverSoundSpr(c);field.levelTitle=addRelativeSprite("Lvl",38,10,40,12,"right","top",!0);field.levelTitle.setZIndex(20);c=new SimpleText(bitmaps.lvl_numbs,10,12);c.align=c.ALIGN_LEFT;c.parent=field.levelTitle;c.charSpacing=-2;c.static=!0;c.x=25;c.y=.8;c.write(currentLevel+1)},setBobDestination:function(){field.destination=getObjectByCustomInfo("destination");
field.destination&&(field.destination.setStatic(!0),stage.addEventListener("pretick",field.checkIfWin))},checkIfWin:function(){bob&&10>getDistance(bob,field.destination)&&victory()},stopAnimations:function(){for(var a=0;a<stage.objects.length;a++){var c=stage.objects[a];1<c.totalFrames&&c.gotoAndStop(0)}},hideInvisibleImg:function(){for(var a=0;a<stage.objects.length;a++){var c=stage.objects[a];c.info&&-1!=c.info.indexOf("invisible")&&(c.visible=!1)}},deStaticCover:function(a){for(var c=0;c<stage.objects.length;c++){var d=
stage.objects[c];if(d.bitmap&&-1!==d.bitmap.src.indexOf(a)){var e=stage.getMaxZIndexInStack(stage.objects);d.setZIndex(stage.objects[e].zIndex+1);d.setStatic(!1)}}}},SnailBob=function(){Utils.callSuperConstructor(SnailBob,this,bitmaps.Bob,48,39,1,1,1);this.speed=SnailBob.SPEED_WALK;this.init=function(){this.setZIndex(15);this.onbox2dsync=SnailBob.spritesSync;"left"===this.custom?(this.direction="left",this.scaleX=-1):(this.direction="right",this.scaleX=1);var a;0===field.speedIndicator.currentFrame?
(a="walk",this.selectedSpeed=1):(a="run",this.selectedSpeed=2);this.changeState(a);this.box2dBody.m_world.m_allowSleep=!1;stage.addEventListener("pretick",this.go);this.onclick=this.onclickAction;this.box2dBody.SetAngularDamping(1)}};Utils.extend(SnailBob,TilesSprite);SnailBob.SPEED_WALK=1;SnailBob.SPEED_RUN=2;SnailBob.spritesSync=function(a){a=a.target;a.rotation=0;a.x+=a.syncX?a.syncX:0;a.y+=a.syncY?a.syncY:0};
SnailBob.prototype.go=function(){!bob.cancelSpeed&&bob.speed&&bob.isContact()&&(bob.box2dBody.m_linearVelocity.x=bob.speed)};SnailBob.prototype.isContact=function(){for(var a=this.box2dBody.GetContactList();a;){if(a.contact.IsTouching())return!0;a=a.next}return!1};
SnailBob.prototype.changeState=function(a){var c=SnailBob.states[a];c||console.log("unknown state");this.bitmap=bitmaps[c.bitmap];this.width=c.width;this.height=c.height;this.animDelay=c.animDelay;this.framesCount=c.frames||1;this.totalLayers=c.columns||1;this.totalFrames=c.rows||this.framesCount;this.speed=c.speed*this.scaleX;0===this.speed&&(this.box2dBody.SetAngularVelocity(0),this.box2dBody.SetLinearVelocity(new b2Vec2(0,0)));if(this.syncX!==c.syncX*this.scaleX||this.syncY!==c.syncY){var d=box2d.getBodyPosition(this.box2dBody);
c.syncX=c.syncX||0;c.syncY=c.syncY||0;d.x+=this.syncX-c.syncX*this.scaleX;d.y+=this.syncY-c.syncY;box2d.setBodyPosition(this.box2dBody,d.x,d.y);this.syncX=c.syncX*this.scaleX;this.syncY=c.syncY}c.onchangeframe&&(this.onchangeframe=c.onchangeframe);this.previousState=this.state;this.state=a;c.init&&c.init.call(this)};SnailBob.prototype.onclickAction=function(){this.blockClick||("hide"===this.state?this.changeState("show"):this.changeState("hide"))};
SnailBob.prototype.turn=function(){"hide"===this.state?this.changeState("hideTurn"):this.changeState("turn")};SnailBob.prototype.changeDirection=function(){this.scaleX*=-1;this.direction="left"===this.direction?"right":"left"};
SnailBob.states={walk:{bitmap:"BobGo",width:50,height:40,frames:17,animDelay:3,speed:SnailBob.SPEED_WALK,init:function(){this.gotoAndPlay(3)},onchangeframe:function(a){16===a.target.currentFrameX&&a.target.gotoAndPlay(3)}},run:{bitmap:"BobRun",width:57,height:50,frames:19,animDelay:2,syncY:1,speed:SnailBob.SPEED_RUN,init:function(){this.gotoAndPlay(3)},onchangeframe:function(a){15===a.target.currentFrameX&&a.target.gotoAndPlay(3)}},hide:{bitmap:"BobHide",width:57,height:42,frames:11,animDelay:2,syncX:10,
speed:0,init:function(){this.blockClick=!0;this.gotoAndPlay(0);playSound("bob_hideshel(SnailBob3)")},onchangeframe:function(a){10===a.target.currentFrameX&&a.target.animated&&(a.target.gotoAndStop(10),a.target.blockClick=!1)}},show:{bitmap:"BobHide",width:57,height:42,frames:11,animDelay:2,speed:0,init:function(){this.animDirection=-1;this.gotoAndPlay(10);this.blockClick=!0;playSound("bob_outshell(SnailBob3)")},onchangeframe:function(a){a=a.target;var c;0===a.currentFrameX&&a.animated&&(a.animDirection=
1,a.gotoAndStop(0),a.blockClick=!1,c=1===a.selectedSpeed?"walk":"run",a.changeState(c))}},turn:{bitmap:"BobTurns",width:47,height:40,frames:14,animDelay:2,speed:0,syncY:0,init:function(){this.blockClick=!0;this.gotoAndPlay(0);this.animDirection=1},onchangeframe:function(a){a=a.target;if(13===a.currentFrameX){a.blockClick=!1;var c=1===a.selectedSpeed?"walk":"run";a.changeDirection();a.changeState(c)}}},hideTurn:{bitmap:"BobHideTurn",width:56,height:36,frames:14,animDelay:2,syncX:0,syncY:1,speed:0,
init:function(){this.blockClick=!0;this.gotoAndPlay(0)},onchangeframe:function(a){a=a.target;13===a.currentFrameX&&(a.changeDirection(),a.changeState("hide"),a.gotoAndStop(10),a.blockClick=!1)}},fall:{bitmap:"BobFall",width:50,height:174,animDelay:3,speed:0,frames:15,rows:5,columns:3,init:function(){field.bottomUIBack.setStatic(!1);this.gotoAndPlay(0);this.blockClick=!0;world.DestroyBody(this.box2dBody);this.y-=40;stage.createTween(this,"y",this.y,this.y+195,this.animDelay*this.framesCount*1E3/fps,
Easing.sine.easeIn).play();playSound("Fall")},onchangeframe:function(a){a=a.target;13===a.currentFrameX&&(a.destroy=!0,stage.setTimeout(showGameOverScreen,1E3))}},shocked:{bitmap:"shocked",width:94,height:102,animDelay:4,speed:0,frames:4,init:function(){world.DestroyBody(this.box2dBody);this.gotoAndPlay(0);this.blockClick=!0;this.y-=15;stage.setTimeout(function(){bob.changeState("shocked2")},1500);playSound("bob_electroshock(SnailBob3)")},onchangeframe:function(a){}},shocked2:{bitmap:"shocked2",width:94,
height:102,animDelay:6,speed:0,frames:7,init:function(){this.gotoAndPlay(0);this.blockClick=!0;this.y-=3;var a=new TilesSprite(bitmaps.bob_spirit,70,72,17,9,2);a.setPosition(this.x,this.y-10);stage.addChild(a);a.animDelay=2;a.moveTo(this.x,this.y-150,1E3,null,showGameOverScreen)},onchangeframe:function(a){a=a.target;a.currentFrame==a.totalFrames-1&&a.stop()}},smashed:{bitmap:"BobFlatten",width:78,height:44,animDelay:4,speed:0,frames:16,init:function(){world.DestroyBody(this.box2dBody);this.gotoAndPlay(0);
this.blockClick=!0;playSound("BobFlatten")},onchangeframe:function(a){a=a.target;a.currentFrame==a.totalFrames-1&&(a.stop(),stage.setTimeout(showGameOverScreen,1E3))}},onLaser:{bitmap:"BobOnLaser",width:56,height:62,animDelay:4,speed:0,frames:30,rows:6,columns:5,init:function(){this.gotoAndPlay(0);this.blockClick=!0;world.DestroyBody(this.box2dBody);this.y+=2;playSound("Anubis_scared(SnailBob3)")},onchangeframe:function(a){a=a.target;29===a.currentFrameX&&(a.gotoAndPlay(20),stage.setTimeout(showGameOverScreen,
1E3))}},burn:{bitmap:"bob_burn",width:60,height:124,animDelay:2,speed:0,frames:67,rows:8,columns:9,init:function(){this.gotoAndPlay(0);this.blockClick=!0;world.DestroyBody(this.box2dBody);this.y-=35;playSound("Burn")},onchangeframe:function(a){a=a.target;65===a.currentFrameX&&(a.gotoAndStop(66),showGameOverScreen())}},magicHit:{bitmap:"bob_hit_by_magic",width:76,height:56,animDelay:2,speed:0,frames:25,rows:5,columns:5,init:function(){this.gotoAndPlay(0);this.blockClick=!0;world.DestroyBody(this.box2dBody);
this.y-=5;playSound("ElectroShock")},onchangeframe:function(a){a=a.target;a.currentFrameX==a.framesCount-1&&(a.stop(),showGameOverScreen())}}};function addSprite(a,c,d,e,f,g,h,k){a=new Sprite(bitmaps[a],c,d,h);a.x=e;a.y=f;stage.addChild(a);a.onclick=k||null;a.setStatic(g);return a}function addTilesSprite(a,c,d,e,f,g,h,k,l,q){a=new TilesSprite(bitmaps[a],c,d,e,f,g);a.x=h;a.y=k;stage.addChild(a);a.onclick=q||null;a.animDelay=l||1;return a}
function addRelativeSprite(a,c,d,e,f,g,h,k,l,q){a=new Sprite(bitmaps[a],c,d,l);a.setStatic(k);stage.addChild(a);a.setRelativePosition(e||0,f||0,g,h);a.onclick=q||null;return a}function addToContainer(a,c,d,e,f,g,h,k,l){c=new Sprite(bitmaps[c],d,e,k);c.x=f||0;c.y=g||0;c.setStatic(h);k&&c.stop();c.onclick=l?l:null;a.addChild(c);return c}function returnFalse(){return!1}function randInt(a,c){a=a||9;c=c||0;return Math.floor(Math.random()*(a-c+1))+c}
function getDistance(a,c){return Math.sqrt((c.x-a.x)*(c.x-a.x)+(c.y-a.y)*(c.y-a.y))}var backgroundImage=null;function setCSSBack(a,c){var d=document.getElementById(Utils.DOMScreenBackgroundContainerId);a?(backgroundImage=a,d.style.backgroundImage="url("+a.src+")"):d.style.backgroundImage=null;c&&(d.style.backgroundColor=c);d.style.backgroundPosition="center top";d.style.backgroundRepeat="no-repeat";resizeCSSBack()}
function resizeCSSBack(){if(backgroundImage){Utils.getWindowRect();var a=document.getElementById(Utils.DOMScreenId).offsetHeight/backgroundImage.height,c=Math.floor(backgroundImage.width*a),a=Math.floor(backgroundImage.height*a);document.getElementById(Utils.DOMScreenBackgroundContainerId).style.backgroundSize=c+"px "+a+"px"}}function getGameDataId(){return"playtomax_"+GAME_ID+"_data"}
function loadGameData(){var a=Utils.getCookie(getGameDataId()),a=a?JSON.parse(a):{};a.scores||(a.scores=[]);for(var c=0;c<levels.length;c++)a.scores[c]||(a.scores[c]=0);return a}function saveGameData(a){Utils.setCookie(getGameDataId(),JSON.stringify(a))}function saveScores(a){a>gameData.scores[currentLevel]&&(gameData.scores[currentLevel]=a,saveGameData(gameData))}function getTotalScores(){for(var a=0,c=0;c<gameData.scores.length;c++)a+=gameData.scores[c];return a}
function getTotalNumOfStars(){for(var a=0,c=0;c<gameData.scores.length;c++)a+=~~(gameData.scores[c]/1E3);return a}function getLastLevel(){for(var a=0;a<gameData.scores.length;a++)if(0===gameData.scores[a])return a;return levels.length}function showMoreGames(){window.open(MORE_GAMES_URL,"_blank")}var showFirstBob,showSecondBob;function findObject(a){for(var c=0;c<objects.length;c++)if(objects[c].name==a)return objects[c];return!1}
function getObjectByInfo(a){for(var c=[],d=0,e=stage.objects.length;d<e;d++)stage.objects[d].info==a&&c.push(stage.objects[d]);return 1==c.length?c[0]:c}function getObjectByCustomInfo(a){for(var c=0,d=stage.objects.length;c<d;c++)if(stage.objects[c].custom==a)return stage.objects[c];return!1}
function attachMouseEvents(a){this.stop();this.onmouseover=function(c){gameState!==STATE_VICTORY&&gameState!==STATE_GAME_OVER&&(a?c.target.gotoAndStop(2):c.target.gotoAndStop(c.target.totalFrames-2))};this.onmouseout=function(a){gameState!==STATE_VICTORY&&gameState!==STATE_GAME_OVER&&a.target.gotoAndStop(0)};this.onmousedown=function(c){gameState!==STATE_VICTORY&&gameState!==STATE_GAME_OVER&&(a?c.target.gotoAndStop(1):c.target.gotoAndStop(c.target.totalFrames-1),playSound("Button"))};this.onmouseup=
function(c){gameState!==STATE_VICTORY&&gameState!==STATE_GAME_OVER&&(a?c.target.gotoAndStop(2):c.target.gotoAndStop(c.target.totalFrames-2))}}function getBodyByPoint(a,c){var d=world.GetGroundBody();if(a&&(stack=stage.getObjectsStackByCoord(a.x,a.y,!1),0<stack.length))for(var e=stack.length-1;0<=e;e--)stack[e].box2dBody&&stack[e].box2dBody!=c&&(d=stack[e].box2dBody);return d}box2d.getBodyPosition=function(a){a=a.GetPosition();return new b2Vec2(a.x*box2d.SCALE,a.y*box2d.SCALE)};
function destroyMe(a){a.destroy=!0}function getTwoPointsObstacles(a,c){var d=[];box2d.rayCast(world,function(a){d.push(a.m_body.sprite)},a,c);return d}function deleteObject(a){a.destroy=!0;a.box2dBody&&world.DestroyBody(a.box2dBody)}function showSpilLogo(a,c,d,e){if(spilLogoAction){var f=new Sprite(bitmaps.SpilLogo,93,30);f.x=a;f.y=c;(d||stage).addChild(f);f.onclick=spilLogoAction;f.setStatic(!e);return f}}
var levels=[{objects:[{type:"invisible_wall_big",x:127,y:233,rotation:0},{type:"invisible_wall_big",x:277,y:233,rotation:0},{type:"invisible_wall_big",x:424,y:233,rotation:0},{type:"invisible_wall_big",x:51,y:160,rotation:1.5707963267948966},{type:"lift_part2_lvl1",x:360,y:106,rotation:0},{type:"star1",x:360,y:163,rotation:.3,custom:"star1"},{type:"lift_part1_lvl1",x:360,y:154,rotation:0},{type:"portal_lvl1",x:202,y:63,rotation:0},{type:"billboard",x:338,y:56,rotation:0},{type:"button_red",x:180,
y:152,rotation:0},{type:"star2",x:75,y:135.8,rotation:0},{type:"star3",x:267,y:260,rotation:0},{type:"btn2",x:280,y:227,rotation:0},{type:"tube2",x:441,y:206,rotation:0,custom:"destination"},{type:"bridge_lvl1",x:143,y:207,rotation:0,custom:"bridge1"},{type:"bridge_lvl1",x:221,y:159,rotation:0,custom:"bridge2"},{type:"palm",x:73,y:140,rotation:0},{type:"earth_portal",x:247,y:91,rotation:0},{type:"earth1_lvl1",x:143,y:157.8,rotation:0,custom:"earth_bridge1"},{type:"earth2_lvl1",x:221,y:157.8,rotation:0,
custom:"earth_bridge2"},{type:"earth_lift",x:360.8,y:103.8,rotation:0,custom:"earth_lift"}],joints:[]},{objects:[{type:"invisible_wall_big",x:98,y:135,rotation:0},{type:"invisible_wall_small",x:-2,y:135,rotation:0},{type:"tube1",x:44,y:108,rotation:0,custom:"start_tube"},{type:"Bob",x:30,y:114,rotation:0},{type:"invisible_wall_small",x:343,y:136,rotation:0},{type:"btn2",x:148,y:132,rotation:0},{type:"tube1",x:44,y:193,rotation:0,custom:"destination"},{type:"invisible_wall_big",x:98,y:220,rotation:0},
{type:"invisible_wall_small",x:-2,y:220,rotation:0},{type:"invisible_wall_big",x:429,y:154,rotation:1.5707963267948966},{type:"invisible_wall_big",x:395,y:221,rotation:0},{type:"bridge2_lvl2",x:133,y:192,rotation:0},{type:"bridge1_lvl2",x:393.8,y:141,rotation:0,custom:"bridge1"},{type:"bridge1_lvl2",x:393.8,y:225,rotation:0,custom:"bridge2"},{type:"star5",x:416,y:60,rotation:0,custom:"star_palm"},{type:"star6",x:171,y:254,rotation:.4,custom:"star_middle"},{type:"star4",x:340,y:155,rotation:0,custom:"star_left"},
{type:"cover1_lvl2",x:393,y:140,rotation:0,custom:"cover_bridge1"},{type:"cover2_lvl2",x:393.8,y:224.8,rotation:0,custom:"cover_bridge2"},{type:"cover3_lvl2",x:133,y:240.8,rotation:0,custom:"cover_bridge"},{type:"cover4_lvl2",x:417,y:59,rotation:0},{type:"cover5_lvl2",x:341.8,y:148,rotation:0},{type:"cover6_lvl2",x:166,y:255.8,rotation:0},{type:"button_red",x:129,y:252,rotation:0,custom:"btn_bridge"},{type:"baraban",x:394,y:228,rotation:0},{type:"cover_baraban",x:394,y:253,rotation:0},{type:"button_red",
x:394,y:265,rotation:0,custom:"btnBaraban"}],joints:[]},{objects:[{type:"tube1",x:32,y:60.8,rotation:0,custom:"start_tube"},{type:"tube1",x:32,y:219.8,rotation:0,custom:"destination"},{type:"invisible_wall_big",x:30,y:88,rotation:0},{type:"Bob",x:25,y:65,rotation:0},{type:"invisible_wall_big",x:71,y:246,rotation:0},{type:"invisible_wall_small",x:100,y:116,rotation:1.5707963267948966},{type:"invisible_wall_big",x:415,y:76,rotation:1.5707963267948966},{type:"baraban",x:379,y:119,rotation:0},{type:"invisible_wall_big",
x:410,y:112,rotation:0},{type:"invisible_wall_small",x:142,y:273,rotation:1.5707963267948966},{type:"cover_baraban",x:378,y:146,rotation:0},{type:"button_red",x:377.8,y:157.8,rotation:0,custom:"btnBaraban"},{type:"invisible_wall_big",x:335,y:189,rotation:1.6},{type:"invisible_wall_small",x:333,y:289,rotation:1.5707963267948966},{type:"bridge_lvl3",x:216.8,y:104,rotation:0},{type:"spring_lvl3",x:124,y:152,rotation:0,custom:"spring_left"},{type:"spring_lvl3",x:305,y:230,rotation:0,custom:"spring_right"},
{type:"star7",x:58,y:172,rotation:.5499999999999999},{type:"cover1_lvl3",x:59,y:172.8,rotation:0},{type:"star1",x:374,y:256,rotation:0,custom:"starFlap"},{type:"bob_eyes",x:375,y:214,rotation:-.05},{type:"flap",x:374,y:256.8,rotation:0,custom:"bottomFlap"},{type:"flap",x:374,y:212,rotation:0,custom:"upFlap"},{type:"invisible_wall_small",x:220,y:270,rotation:1.5707963267948966},{type:"invisible_wall_small",x:213,y:270,rotation:1.5707963267948966},{type:"earth1_lvl3",x:216,y:51.8,rotation:0,custom:"earth1"},
{type:"earth2_lvl3",x:217,y:255,rotation:0,custom:"earth2"},{type:"button_red",x:216.8,y:34.8,rotation:0,custom:"btn_bridge"}],joints:[]},{objects:[{type:"tube2",x:440,y:182,rotation:0,custom:"destination"},{type:"invisible_wall_big",x:169,y:92,rotation:0},{type:"invisible_wall_big",x:471,y:209,rotation:0},{type:"invisible_wall_small",x:279,y:92,rotation:0},{type:"invisible_wall_big",x:19,y:92,rotation:0},{type:"invisible_wall_small",x:361,y:76,rotation:1.5707963267948966},{type:"button_green",x:68,
y:175.8,rotation:0,custom:"btn_up"},{type:"button_green",x:68,y:213.8,rotation:3.141592653589793,custom:"btn_down"},{type:"btn2",x:358,y:64,rotation:-1.5707963267948966},{type:"frog_laser",x:108,y:258,rotation:0},{type:"bridge1_lvl4",x:340,y:97.8,rotation:0,custom:"bridge1"},{type:"bridge2_lvl4",x:183,y:178,rotation:0,custom:"bridge2"},{type:"cover1_lvl4",x:392,y:97,rotation:0,custom:"cover1"},{type:"cover2_lvl4",x:183,y:234,rotation:0,custom:"cover2"},{type:"tube3",x:116,y:14,rotation:0},{type:"Bob",
x:116,y:11,rotation:0},{type:"mirrow",x:260.8,y:260,rotation:0},{type:"mirrow",x:342,y:260,rotation:0},{type:"lamp_check",x:331,y:19,rotation:0,custom:"lampCheck"},{type:"star1",x:408,y:35,rotation:0,custom:"star1"},{type:"star1",x:409,y:272,rotation:0,custom:"star2"},{type:"star_doors",x:408,y:35,rotation:0},{type:"lamp_green",x:184.8,y:215,rotation:0,custom:"lamp2"},{type:"lamp_green",x:367.8,y:98,rotation:0,custom:"lamp1"},{type:"stopLaser",x:331,y:35,rotation:0,custom:"laser_star1"},{type:"stopLaser",
x:413,y:263,rotation:1.5707963267948966,custom:"laser_star2"},{type:"wheel",x:208.8,y:210.8,rotation:0},{type:"wheel",x:223.8,y:210.8,rotation:0},{type:"wheel",x:238.8,y:210.8,rotation:0},{type:"wheel",x:257.8,y:210.8,rotation:0},{type:"wheel",x:273.8,y:210.8,rotation:0},{type:"wheel",x:289,y:210.8,rotation:0},{type:"wheel",x:304.8,y:210.8,rotation:0},{type:"wheel",x:320.8,y:210.8,rotation:0},{type:"wheel",x:339.8,y:210.8,rotation:0},{type:"wheel",x:355,y:210.8,rotation:0},{type:"wheel",x:371,y:210.8,
rotation:0},{type:"wheel",x:386.8,y:210.8,rotation:0},{type:"cover_conveyor",x:300,y:218,rotation:0},{type:"push_wall",x:208,y:178,rotation:0},{type:"star7",x:69,y:72,rotation:-.5},{type:"cover_star_lvl4",x:68,y:69,rotation:0},{type:"cover3_lvl4",x:419.8,y:273,rotation:0},{type:"earth2_lvl4",x:405,y:258,rotation:0},{type:"earth1_lvl4",x:405,y:271,rotation:0},{type:"earth3_lvl4",x:402,y:282.8,rotation:0}],joints:[]},{objects:[{type:"tube3",x:288.8,y:2,rotation:0},{type:"tube4",x:440,y:20,rotation:0,
custom:"tube4"},{type:"Bob",x:290,y:16,rotation:0},{type:"button_lvl5",x:292,y:261,rotation:0,custom:"buttonPillar"},{type:"star4",x:420,y:60,rotation:0,custom:"star1"},{type:"star4",x:219,y:158,rotation:0,custom:"star2"},{type:"bridge2_lvl5",x:151,y:170,rotation:0,custom:"bridge2"},{type:"cover2_lvl5",x:218,y:169,rotation:0,custom:"cover2"},{type:"spring2_lvl5",x:406,y:202.8,rotation:3.141592653589793,custom:"spring1"},{type:"spring2_lvl5",x:113,y:221.8,rotation:0,custom:"spring2"},{type:"bridge1_lvl5",
x:291,y:75,rotation:0,custom:"bridge1"},{type:"invisible_wall_small",x:319,y:46,rotation:1.5707963267948966},{type:"invisible_wall_big",x:456,y:64,rotation:-.08726646259971647},{type:"invisible_wall_small",x:407,y:81,rotation:0},{type:"invisible_wall_small",x:351,y:57,rotation:1.5707963267948966},{type:"button_green",x:229,y:18,rotation:1.5707963267948966,custom:"button_right"},{type:"button_green",x:143,y:18,rotation:-1.5707963267948966,custom:"button_left"},{type:"cover1_lvl5",x:348,y:74,rotation:0,
custom:"cover1"},{type:"btn2",x:62,y:143,rotation:1.5707963267948966,custom:"btn_star"},{type:"cover5_lvl5",x:76,y:221,rotation:0},{type:"cover5_lvl5",x:423,y:202,rotation:0},{type:"button_red",x:75.8,y:221.8,rotation:0,custom:"button_spring2"},{type:"button_red",x:422.8,y:202.8,rotation:0,custom:"button_spring1"},{type:"button_red",x:374,y:20,rotation:0,custom:"button_hedge"},{type:"cover6_lvl5",x:374,y:20,rotation:0},{type:"lamp_green",x:194,y:170,rotation:0,custom:"lamp1"},{type:"lamp_green",x:142,
y:260,rotation:0,custom:"lamp2"},{type:"star1",x:417,y:260,rotation:0,custom:"star3"},{type:"star_doors",x:417,y:260.8,rotation:0},{type:"invisible_wall_small",x:209,y:164,rotation:0},{type:"invisible_wall_small",x:242,y:164,rotation:0},{type:"invisible_wall_small",x:91,y:166,rotation:0},{type:"invisible_wall_big",x:186,y:247,rotation:0},{type:"btn2",x:141,y:244,rotation:0,custom:"btn_carriage"},{type:"invisible_wall_big",x:458,y:143,rotation:0},{type:"tube2",x:450,y:114,rotation:0,custom:"destination"},
{type:"hedge_lvl5",x:407,y:60,rotation:0},{type:"invisible_wall_small",x:323,y:270,rotation:1.5707963267948966},{type:"invisible_wall_small",x:259,y:270,rotation:1.5707963267948966},{type:"invisible_wall_small",x:347,y:270,rotation:1.5707963267948966},{type:"invisible_wall_small",x:386,y:264,rotation:1.5707963267948966},{type:"invisible_wall_small",x:405,y:227,rotation:-.65},{type:"cover3_lvl5",x:410,y:75,rotation:0,custom:"cover_hedge"},{type:"frog_platform",x:147,y:48,rotation:0},{type:"invisible_wall_very_small",
x:335,y:247,rotation:0},{type:"carriage",x:233,y:230,rotation:0},{type:"wheel_carriage",x:213,y:235,rotation:0},{type:"wheel_carriage",x:253,y:235,rotation:0,custom:"wheel"},{type:"invisible_wall_small",x:239,y:176,rotation:0},{type:"invisible_wall_big",x:269,y:102,rotation:1.5707963267948966},{type:"pillar_lvl5",x:291,y:256,rotation:0,custom:"pillar"},{type:"cover4_lvl5",x:291.8,y:264,rotation:0,custom:"cover4"},{type:"spring_lvl5",x:220,y:141,rotation:0},{type:"lamp_blue",x:292.8,y:279.8,rotation:0,
custom:"lampBlueDown"},{type:"lamp_blue",x:331,y:74,rotation:0,custom:"lampBlueUp"},{type:"invisible_wall_small",x:397,y:38,rotation:-.06981317007977318}],joints:[{type:0,point1:{x:253,y:235}},{type:0,point1:{x:213,y:235}}]},{objects:[{type:"tube1",x:46,y:100.8,rotation:0,custom:"startTube"},{type:"tube2",x:450,y:202,rotation:0,custom:"destination"},{type:"Bob",x:36,y:104,rotation:0},{type:"star7",x:107,y:192,rotation:1.0500000000000003},{type:"invisible_wall_big",x:76,y:128,rotation:0},{type:"invisible_wall_small",
x:176,y:128,rotation:0},{type:"invisible_wall_very_small",x:201,y:141,rotation:1.5707963267948966},{type:"invisible_wall_big",x:128,y:164,rotation:2.9707963267948934},{type:"invisible_wall_big",x:65,y:237,rotation:1.5707963267948966},{type:"invisible_wall_small",x:119,y:255,rotation:1.5707963267948966},{type:"invisible_wall_small",x:92,y:265,rotation:0},{type:"invisible_wall_big",x:194,y:229,rotation:0},{type:"invisible_wall_big",x:327,y:128,rotation:0},{type:"invisible_wall_big",x:327,y:136,rotation:0},
{type:"invisible_wall_big",x:344,y:229,rotation:0},{type:"invisible_wall_big",x:494,y:229,rotation:0},{type:"invisible_wall_small",x:315,y:100,rotation:1.5707963267948966},{type:"lamp_blue",x:90,y:278,rotation:0,custom:"lamp1"},{type:"lamp_blue",x:354,y:133,rotation:0,custom:"lamp2"},{type:"btn2",x:90,y:262,rotation:0,custom:"btnFire"},{type:"btn2",x:293.8,y:124,rotation:0,custom:"btnBridge"},{type:"resurrection",x:156,y:30,rotation:0},{type:"fire",x:353,y:201,rotation:3.141592653589793},{type:"frog_fire",
x:354,y:155,rotation:0},{type:"bridge1_lvl5",x:229,y:134,rotation:0},{type:"fan",x:188,y:230,rotation:0,custom:"fan1"},{type:"fan",x:281,y:230,rotation:0,custom:"fan2"},{type:"cover4_lvl6",x:201,y:253,rotation:0},{type:"cover5_lvl6",x:294,y:252,rotation:0},{type:"button_red",x:201.8,y:260.8,rotation:0,custom:"button1"},{type:"button_red",x:294,y:260,rotation:0,custom:"button2"},{type:"cover1_lvl6",x:281,y:134.8,rotation:0,custom:"coverBridge"},{type:"lamp_green",x:261.8,y:134,rotation:0,custom:"lampBridge"},
{type:"star7",x:389,y:153.8,rotation:-.05},{type:"cover2_lvl6",x:391,y:156,rotation:0},{type:"cover3_lvl6",x:101,y:196,rotation:0},{type:"star3",x:433,y:59,rotation:0}],joints:[]},{objects:[{type:"tube1",x:43,y:85,rotation:0,custom:"startTube"},{type:"tube2",x:464,y:189.8,rotation:0,custom:"destination"},{type:"Bob",x:31,y:78,rotation:0},{type:"bridge2_lvl7",x:379,y:181,rotation:0,custom:"bridge2"},{type:"invisible_wall_big",x:16,y:112,rotation:0},{type:"invisible_wall_big",x:87,y:186,rotation:1.5707963267948966},
{type:"invisible_wall_small",x:171,y:113,rotation:0},{type:"invisible_wall_small",x:221,y:113,rotation:0},{type:"invisible_wall_big",x:229,y:35,rotation:1.5707963267948966},{type:"invisible_wall_small",x:241,y:24,rotation:1.5707963267948966},{type:"invisible_wall_small",x:247,y:38,rotation:1.0500000000000003},{type:"invisible_wall_small",x:259,y:84,rotation:1.5533430342749532},{type:"invisible_wall_small",x:259,y:118,rotation:1.5533430342749532},{type:"invisible_wall_big",x:171,y:217,rotation:0},
{type:"invisible_wall_small",x:254,y:253,rotation:1.5707963267948966},{type:"invisible_wall_small",x:278,y:263,rotation:0},{type:"invisible_wall_small",x:304,y:241,rotation:1.5707963267948966},{type:"invisible_wall_big",x:312,y:292,rotation:1.5707963267948966},{type:"invisible_wall_big",x:372,y:290,rotation:1.5707963267948966},{type:"invisible_wall_big",x:446,y:217,rotation:0},{type:"invisible_wall_big",x:445,y:6,rotation:1.5707963267948966},{type:"invisible_wall_small",x:418,y:73,rotation:0},{type:"invisible_wall_small",
x:351,y:58,rotation:0},{type:"invisible_wall_small",x:395,y:71,rotation:.6},{type:"invisible_wall_small",x:326,y:52,rotation:.49999999999999994},{type:"invisible_wall_very_small",x:300,y:51,rotation:-1.1000000000000003},{type:"invisible_wall_small",x:296,y:85,rotation:1.5707963267948966},{type:"invisible_wall_big",x:374,y:116,rotation:0},{type:"invisible_wall_big",x:438,y:149,rotation:0},{type:"invisible_wall_small",x:364,y:123,rotation:1.5707963267948966},{type:"ball_lvl7",x:427,y:54,rotation:0},
{type:"face_rotate",x:244.8,y:123,rotation:0,custom:"face1"},{type:"face_rotate",x:387,y:257,rotation:-1.5707963267948966,custom:"face2"},{type:"fan",x:188,y:112,rotation:0,custom:"fan1"},{type:"fan",x:342,y:59,rotation:0,custom:"fan2"},{type:"fan",x:407,y:74,rotation:0,custom:"fan3"},{type:"cover2_lvl7",x:390,y:104,rotation:0},{type:"star2",x:393,y:63,rotation:0},{type:"star8",x:141,y:47,rotation:0},{type:"cover4_lvl7",x:130,y:49,rotation:0},{type:"star1",x:439,y:249,rotation:0,custom:"star"},{type:"star_doors",
x:438,y:249,rotation:0},{type:"bridge1_lvl7",x:125,y:118,rotation:0,custom:"bridge1"},{type:"cover1_lvl7",x:184,y:128,rotation:0},{type:"lamp_green",x:154,y:118,rotation:0,custom:"lampBridge1"},{type:"button_red",x:202,y:140,rotation:0,custom:"buttonFan1"},{type:"button_red",x:336.8,y:85,rotation:0,custom:"buttonFan2"},{type:"button_red",x:417.8,y:101.8,rotation:0,custom:"buttonFan3"},{type:"lamp_green",x:243.8,y:87.8,rotation:0,custom:"lampBtn1"},{type:"btn2",x:231,y:84,rotation:-1.5707963267948966,
custom:"btn1"},{type:"bridgeLever_lvl7",x:280,y:220,rotation:.01},{type:"cover3_lvl7",x:308.8,y:223.8,rotation:0},{type:"bridge3_lvl7",x:392,y:222,rotation:0,custom:"bridge3"},{type:"cover5_lvl7",x:391,y:223,rotation:0,custom:"cover5"},{type:"lamp_blue",x:374,y:221.8,rotation:0,custom:"lampBridge3"},{type:"lamp_blue",x:380,y:138.8,rotation:0,custom:"lampBridge2"},{type:"lever",x:335,y:258,rotation:0},{type:"btn2",x:278.8,y:260,rotation:0,custom:"btn2"},{type:"lamp_blue",x:280,y:275,rotation:0,custom:"lampBtn2"},
{type:"ad_lvl7",x:160,y:258,rotation:0}],joints:[]},{objects:[{type:"tube2",x:449.8,y:96,rotation:0,custom:"startTube"},{type:"tube2",x:454,y:232,rotation:0,custom:"destination"},{type:"invisible_wall_big",x:394,y:124,rotation:0},{type:"Bob",x:449,y:100,rotation:0,custom:"left"},{type:"invisible_wall_big",x:67,y:199,rotation:1.5707963267948966},{type:"baraban",x:98,y:264,rotation:0},{type:"invisible_wall_very_small",x:136,y:257,rotation:0},{type:"invisible_wall_small",x:386,y:281,rotation:1.5707963267948966},
{type:"invisible_wall_big",x:460,y:259,rotation:0},{type:"cover_baraban_lvl8",x:68,y:237,rotation:0},{type:"button_red",x:52.8,y:221.8,rotation:0,custom:"buttonBaraban"},{type:"btn2",x:71,y:159,rotation:1.5707963267948966},{type:"lamp_green",x:60,y:162.8,rotation:0},{type:"frog",x:125,y:100,rotation:-1.5707963267948966,custom:"frog1"},{type:"frog_platform",x:187,y:8,rotation:0},{type:"fire",x:274,y:81,rotation:0,custom:"fire1"},{type:"fire",x:181,y:144,rotation:-1.5707963267948966,custom:"fire2"},
{type:"lava",x:278,y:138,rotation:0},{type:"cover_lava",x:291,y:144,rotation:0},{type:"star9",x:263,y:268,rotation:0},{type:"star7",x:199.8,y:191,rotation:0,custom:"starEyes"},{type:"eyes_lvl8",x:200,y:198,rotation:0,custom:"eyes"},{type:"cover_stat",x:200,y:220,rotation:0,custom:"coverStat"},{type:"platform_lvl8",x:358,y:280,rotation:0},{type:"platform_lvl8",x:266,y:280,rotation:0},{type:"frog",x:267,y:172,rotation:0,custom:"frog2"},{type:"roll2",x:333,y:178,rotation:0,custom:"roll2"},{type:"star1",
x:330,y:177,rotation:0,custom:"starRoll"},{type:"cover_paper",x:323,y:181,rotation:0,custom:"coverPaper"},{type:"roll3",x:344,y:175,rotation:0,custom:"roll3"},{type:"roll1",x:344,y:176,rotation:0,custom:"roll1"},{type:"frog",x:415,y:180,rotation:1.5707963267948966,custom:"frogPaper"},{type:"button_green",x:139,y:22,rotation:-1.5707963267948966,custom:"button_left"},{type:"button_green",x:390,y:22,rotation:1.5707963267948966,custom:"button_right"},{type:"invisible_wall_big",x:305,y:149,rotation:0},
{type:"cover_roll",x:337,y:119,rotation:0,custom:"coverRoll"},{type:"invisible_wall_very_small",x:233,y:139,rotation:1.5707963267948966}],joints:[]},{objects:[{type:"tube1",x:53.8,y:201,rotation:0,custom:"startTube"},{type:"tube2",x:466,y:91,rotation:0,custom:"destination"},{type:"invisible_wall_big",x:81,y:228,rotation:0},{type:"Bob",x:47,y:203,rotation:0},{type:"invisible_wall_big",x:305,y:230,rotation:0},{type:"invisible_wall_big",x:261,y:117,rotation:0},{type:"invisible_wall_big",x:53,y:115,rotation:0},
{type:"lamp_lvl9",x:57,y:94,rotation:0},{type:"resurrection",x:155.8,y:33,rotation:0},{type:"star6",x:158,y:61,rotation:.65,custom:"starMouth"},{type:"invisible_wall_big",x:295,y:190,rotation:1.5707963267948966},{type:"invisible_wall_big",x:333,y:191,rotation:1.5707963267948966},{type:"invisible_wall_big",x:382,y:189,rotation:1.5707963267948966},{type:"invisible_wall_big",x:455,y:117,rotation:0},{type:"star3",x:423,y:263,rotation:.05},{type:"invisible_wall_big",x:233,y:305,rotation:1.5707963267948966},
{type:"bridge1_lvl9",x:98,y:123.8,rotation:0,custom:"bridge1"},{type:"coverBridge1_lvl9",x:97,y:123.8,rotation:0,custom:"cover1"},{type:"coverBridge2_lvl9",x:197.8,y:125.8,rotation:0,custom:"cover0"},{type:"lamp_green",x:119.8,y:123.8,rotation:0,custom:"lamp1"},{type:"bridge2_lvl9",x:392.8,y:69,rotation:0,custom:"bridge2"},{type:"coverWall_lvl9",x:394,y:19,rotation:0,custom:"cover2"},{type:"lamp_blue",x:393,y:25,rotation:0,custom:"lamp2"},{type:"btn2",x:271,y:225,rotation:0,custom:"btn1"},{type:"lamp_green",
x:272,y:240,rotation:0,custom:"lampBtn1"},{type:"btn2",x:359,y:226.8,rotation:0,custom:"btn2"},{type:"lamp_blue",x:359.8,y:241.8,rotation:0,custom:"lampBtn2"},{type:"fan",x:149,y:229,rotation:0,custom:"fan1"},{type:"coverFan1_lvl9",x:137,y:245,rotation:0},{type:"button_red",x:134.8,y:257,rotation:0,custom:"buttonFan1"},{type:"fan",x:329,y:118,rotation:0,custom:"fan2"},{type:"coverFan2_lvl9",x:316.8,y:133,rotation:0},{type:"button_red",x:315,y:145,rotation:0,custom:"buttonFan2"}],joints:[]},{objects:[{type:"tube3",
x:87,y:28,rotation:0},{type:"Bob",x:88,y:34,rotation:0,density:1,restitution:.05},{type:"invisible_wall_big",x:138,y:230,rotation:0},{type:"invisible_wall_big",x:-12,y:230,rotation:0},{type:"invisible_wall_small",x:237,y:276,rotation:0},{type:"invisible_wall_small",x:209,y:254,rotation:1.5707963267948966},{type:"invisible_wall_small",x:263,y:254,rotation:1.5707963267948966},{type:"invisible_wall_small",x:285,y:231,rotation:0},{type:"invisible_wall_small",x:311,y:231,rotation:0},{type:"invisible_wall_big",
x:364,y:240,rotation:0},{type:"invisible_wall_small",x:411,y:227,rotation:1.5707963267948966,friction:.01},{type:"invisible_wall_big",x:486,y:204,rotation:0},{type:"tube2",x:450,y:175.8,rotation:0,custom:"destination"},{type:"stick_lvl10",x:341,y:210,rotation:-.15000000000000002,density:1,friction:1},{type:"circle_lvl10",x:343,y:210,rotation:0},{type:"button_green",x:392,y:33,rotation:-1.5707963267948966,custom:"button_left"},{type:"button_green",x:429,y:33,rotation:1.5707963267948966,custom:"button_right"},
{type:"bridge2_lvl7",x:198,y:208,rotation:0},{type:"cover1_lvl10",x:199,y:257,rotation:0,custom:"cover1"},{type:"lamp_green",x:199,y:233.8,rotation:0,custom:"lamp1"},{type:"btn2",x:235,y:272,rotation:0},{type:"star2",x:277,y:159,rotation:0},{type:"cover3_lvl10",x:276,y:160,rotation:0},{type:"star1",x:417,y:121,rotation:0},{type:"bird_sit",x:417,y:120,rotation:0,custom:"right"},{type:"bird_sit",x:394,y:120,rotation:0,custom:"left"},{type:"star2",x:149,y:61,rotation:0},{type:"cover2_lvl10",x:154.8,
y:65.8,rotation:0},{type:"box_lvl10",x:150,y:204,rotation:0,density:100,friction:1},{type:"frog_magnet",x:150,y:80,rotation:0}],joints:[{type:0,point1:{x:343,y:210}}]},{objects:[{type:"tube1",x:32.8,y:219.8,rotation:0},{type:"tube2",x:470,y:223,rotation:0,custom:"destination"},{type:"Bob",x:27,y:223,rotation:0},{type:"invisible_wall_small",x:32,y:247,rotation:0},{type:"invisible_wall_small",x:101,y:249,rotation:0},{type:"invisible_wall_very_small",x:66,y:246.8,rotation:.08726646259971647},{type:"invisible_wall_big",
x:180,y:220,rotation:1.5707963267948966},{type:"invisible_wall_small",x:202,y:146,rotation:0},{type:"invisible_wall_small",x:234,y:146,rotation:0},{type:"invisible_wall_big",x:406,y:250,rotation:0},{type:"star2",x:202,y:240,rotation:0},{type:"star7",x:219,y:103,rotation:0},{type:"lift_lvl11",x:152,y:338,rotation:0},{type:"cover_lift_lvl11",x:150,y:279.8,rotation:0,custom:"coverLift"},{type:"lamp_green",x:153,y:270.8,rotation:0,custom:"lampLift"},{type:"bridge_lvl11",x:362,y:255,rotation:0},{type:"cover_bridge_lvl11",
x:365.8,y:256,rotation:0,custom:"coverBridge"},{type:"lamp_green",x:82,y:87,rotation:0,custom:"lampLaser1"},{type:"lamp_green",x:347,y:6,rotation:0,custom:"lampLaser2"},{type:"lamp_green",x:237,y:270,rotation:0,custom:"lampLaser3"},{type:"lava_lvl11",x:296,y:292,rotation:0},{type:"cover_lava_lvl11",x:296,y:287,rotation:0},{type:"cover_lava1_lvl11",x:255.8,y:275.8,rotation:0},{type:"cover_lava2_lvl11",x:338.8,y:279,rotation:0},{type:"lamp_green",x:337.8,y:255.8,rotation:0,custom:"lampBridge"},{type:"star_lvl11",
x:424,y:40.8,rotation:0,custom:"star"},{type:"stopLaser",x:103,y:86,rotation:1.5707963267948966,custom:"stopLaser1"},{type:"stopLaser",x:237,y:248,rotation:0,custom:"stopLaser2"},{type:"stopLaser",x:347,y:22,rotation:0,custom:"stopLaser3"},{type:"mirrow_lvl11",x:357.8,y:40,rotation:3.141592653589793,custom:"mirrow1"},{type:"mirrow_lvl11",x:414,y:174,rotation:0,custom:"mirrow3"},{type:"mirrow_lvl11",x:414,y:84,rotation:0,custom:"mirrow2"},{type:"mirrow_lvl11",x:225.8,y:225,rotation:3.141592653589793,
custom:"mirrow4"},{type:"cover_star_lvl11",x:204,y:250,rotation:0},{type:"cover_piramid_lvl11",x:219,y:114,rotation:0},{type:"stopLaser",x:351,y:249,rotation:0},{type:"stopLaser",x:349,y:41,rotation:1.0500000000000003,custom:"stopLaser5"},{type:"stopLaser",x:350,y:87,rotation:-.7853981633974483,custom:"stopLaser6"},{type:"stopLaser",x:350,y:177,rotation:-.7853981633974483,custom:"stopLaser7"},{type:"stopLaser",x:235,y:173,rotation:-.7853981633974483,custom:"stopLaser8"},{type:"stopLaser",x:101,y:166,
rotation:1.5707963267948966}],joints:[]},{objects:[{type:"tube1",x:44,y:239,rotation:0,custom:"startTube"},{type:"invisible_wall_big",x:60,y:266,rotation:0},{type:"invisible_wall_big",x:155,y:266,rotation:0},{type:"Bob",x:32,y:239,rotation:0},{type:"tube5",x:257.8,y:308,rotation:3.141592653589793,custom:"tubeDown"},{type:"invisible_wall_big",x:379,y:89,rotation:0},{type:"invisible_wall_small",x:479,y:89,rotation:0},{type:"invisible_wall_small",x:388,y:115,rotation:1.5707963267948966},{type:"invisible_wall_big",
x:383,y:140,rotation:-.39999999999999997},{type:"invisible_wall_big",x:148,y:105,rotation:0},{type:"invisible_wall_big",x:5,y:105,rotation:0},{type:"invisible_wall_big",x:459,y:267,rotation:0},{type:"invisible_wall_small",x:296,y:287,rotation:1.5707963267948966},{type:"invisible_wall_small",x:301,y:288,rotation:1.5707963267948966},{type:"button_green",x:105,y:49,rotation:-1.5707963267948966,custom:"button_left"},{type:"button_green",x:428.8,y:24.8,rotation:1.5707963267948966,custom:"button_right"},
{type:"button_red",x:136,y:176,rotation:0,custom:"buttonGlove"},{type:"boxing_glove",x:172,y:175,rotation:.25},{type:"arrow_lvl12",x:184,y:134,rotation:.25},{type:"btn2",x:193,y:101,rotation:0,custom:"btn1"},{type:"btn2",x:386,y:116,rotation:-1.5707963267948966,custom:"btn2"},{type:"lamp_green",x:400,y:119.8,rotation:0,custom:"lampBtn"},{type:"paw1",x:378,y:75,rotation:0},{type:"paw2",x:377,y:79,rotation:0},{type:"face_lvl12",x:407,y:55,rotation:0},{type:"star4",x:336,y:8.8,rotation:0},{type:"coverStar1_lvl12",
x:343,y:10,rotation:0},{type:"tube5",x:350,y:-3,rotation:0,custom:"tubeUp"},{type:"star2",x:348,y:100,rotation:-.6},{type:"coverStar2_lvl12",x:348,y:98,rotation:0},{type:"star2",x:308,y:275,rotation:0},{type:"coverStar3_lvl12",x:306,y:276,rotation:0,custom:"coverStar3"},{type:"invisible_wall_big",x:231,y:347,rotation:1.5707963267948966},{type:"invisible_wall_small",x:290,y:300,rotation:1.5707963267948966},{type:"invisible_wall_small",x:386,y:292,rotation:1.5707963267948966},{type:"bridge_lvl12",x:425,
y:271,rotation:0},{type:"coverBridge_lvl12",x:427,y:272.8,rotation:0,custom:"coverBridge"},{type:"lamp_green",x:392,y:271.8,rotation:0,custom:"lampBridge"},{type:"tube2",x:457,y:239,rotation:0,custom:"destination"},{type:"coverSpider_lvl12",x:454,y:63,rotation:0,custom:"coverSpider"},{type:"invisible_wall_small",x:283,y:310,rotation:1.5707963267948966}],joints:[]},{objects:[{type:"tube3",x:141,y:14,rotation:0},{type:"face_lvl12",x:94,y:101,rotation:0,custom:"face1"},{type:"Bob",x:145,y:16,rotation:0},
{type:"star1",x:287,y:178,rotation:-.09999999999999999},{type:"btn_stop",x:137,y:266,rotation:0,custom:"btn_mouth"},{type:"star1",x:137,y:207,rotation:.35},{type:"lava_corner",x:285,y:173,rotation:0,custom:"lava_corner"},{type:"invisible_wall_big",x:405,y:252,rotation:0},{type:"button_green",x:393,y:27,rotation:0,density:0,custom:"btn_up"},{type:"face_lvl12",x:388,y:101,rotation:0,custom:"face2"},{type:"button_green",x:348,y:269,rotation:1.5707963267948966,custom:"btn_platform"},{type:"lava_horizontal",
x:368,y:173,rotation:0,custom:"lava_hor"},{type:"tooth_u",x:153,y:187,rotation:0},{type:"button_green",x:393,y:61,rotation:3.141592653589793,custom:"btn_down"},{type:"tooth_d",x:153,y:233,rotation:0},{type:"lava_vertical",x:283,y:241,rotation:0,custom:"lava_vert"},{type:"cover_lvl13_2",x:142,y:210,rotation:0,custom:"cover1"},{type:"cover_lvl13_3",x:448,y:165,rotation:0},{type:"cover_lvl13_1",x:409,y:182,rotation:0,custom:"lava_cover"},{type:"platform_lvl13",x:142,y:80,rotation:0},{type:"electro_platform",
x:279,y:94,rotation:0},{type:"star_lvl13_1",x:65.5,y:230,rotation:0},{type:"star_lvl13_2",x:92.5,y:230,rotation:0},{type:"star_lvl13_3",x:65.5,y:256,rotation:0},{type:"star_lvl13_4",x:92.5,y:256,rotation:0},{type:"paw1",x:77,y:123,rotation:0,custom:"arm1"},{type:"paw2",x:72,y:130,rotation:0,custom:"arm2"},{type:"paw1",x:402,y:123,rotation:0,custom:"arm3"},{type:"paw2",x:407,y:130,rotation:0,custom:"arm4"},{type:"cover_lvl13_6",x:39,y:117,rotation:0,custom:"cover2"},{type:"cover_lvl13_5",x:56,y:120,
rotation:0,custom:"cover3"},{type:"cover_lvl13_7",x:442,y:117,rotation:0,custom:"cover5"},{type:"cover_lvl13_4",x:424,y:119,rotation:0,custom:"cover4"},{type:"destination_tube_lvl13",x:465,y:222,rotation:0,custom:"destination"}],joints:[]},{objects:[{type:"tube1",x:50,y:160,rotation:0,custom:"startTube"},{type:"tube2",x:447.8,y:63,rotation:0,custom:"destination"},{type:"invisible_wall_big",x:130,y:189,rotation:0},{type:"Bob",x:45,y:164,rotation:0},{type:"invisible_wall_small",x:54,y:187,rotation:0},
{type:"invisible_wall_small",x:362,y:123,rotation:0},{type:"invisible_wall_big",x:455,y:90,rotation:0},{type:"invisible_wall_small",x:382,y:112,rotation:1.5207963267948965},{type:"invisible_wall_small",x:338,y:115,rotation:1.5707963267948966},{type:"invisible_wall_very_small",x:323,y:90,rotation:0},{type:"invisible_wall_big",x:429,y:191,rotation:1.5707963267948966},{type:"invisible_wall_small",x:408,y:262,rotation:0},{type:"invisible_wall_small",x:383,y:284,rotation:1.4707963267948965},{type:"invisible_wall_big",
x:255,y:292,rotation:1.5707963267948966},{type:"platform_lvl14",x:342,y:198,rotation:0},{type:"star6",x:219,y:-1,rotation:0},{type:"coverStar1_lvl14",x:199,y:1,rotation:0},{type:"resurrection",x:159,y:31,rotation:0},{type:"star4",x:264,y:264,rotation:-.44999999999999996},{type:"coverStar3_lvl14",x:262.8,y:266.8,rotation:0},{type:"lift_lvl14",x:232,y:276,rotation:0},{type:"coverLift_lvl14",x:234,y:266,rotation:0,custom:"coverLift"},{type:"button_red",x:230.8,y:241,rotation:0,custom:"buttonLift"},{type:"btn2",
x:404,y:258,rotation:0},{type:"lamp_green",x:405,y:273.8,rotation:0,custom:"lampBtn"},{type:"star3",x:178,y:240.8,rotation:0},{type:"bridge_lvl14",x:339,y:96,rotation:0},{type:"coverBridge_lvl14",x:345,y:96,rotation:0,custom:"coverBridge"},{type:"lamp_green",x:318,y:96,rotation:0,custom:"lampBridge"},{type:"coverBut_lvl14",x:400,y:113,rotation:0},{type:"coverBut_lvl14",x:460,y:113,rotation:0},{type:"button_green",x:400,y:113,rotation:-1.5707963267948966,custom:"button_left"},{type:"button_green",
x:460,y:113,rotation:1.5707963267948966,custom:"button_right"}],joints:[]},{objects:[{type:"lamp_green",x:462,y:54,rotation:0,custom:"g2"},{type:"tube3",x:246,y:-7,rotation:0},{type:"Bob",x:248,y:-3,rotation:0},{type:"tube2",x:469,y:164.5,rotation:0,custom:"destination"},{type:"btn2",x:448,y:51,rotation:-1.5707963267948966,custom:"press_btn"},{type:"button_red",x:412,y:115,rotation:0,custom:"btn_conveyor"},{type:"star3",x:465,y:288,rotation:.2},{type:"star1",x:100,y:177,rotation:0},{type:"wall_big_lvl15",
x:194,y:39,rotation:0,custom:"obstacle1"},{type:"cover1_lvl15",x:194,y:11,rotation:0,custom:"cover1"},{type:"star_doors_lvl15",x:100,y:177,rotation:0,custom:"star_door"},{type:"star_rock_lvl15",x:100,y:93,rotation:0,custom:"sb1"},{type:"star_rock_lvl15",x:100,y:120,rotation:0,custom:"sb2"},{type:"star_rock_lvl15",x:100,y:147,rotation:0,custom:"sb3"},{type:"lamp_green",x:195,y:9,rotation:0,custom:"g1"},{type:"small_wall_lvl15",x:384,y:148,rotation:0,custom:"small_wall_green"},{type:"small_wall_lvl15",
x:384,y:179,rotation:0,custom:"small_wall_red"},{type:"cover2_lvl15",x:383,y:122,rotation:0,custom:"cover2"},{type:"down_wall_lvl15",x:387,y:217,rotation:0,custom:"cover3"},{type:"green_fish_lvl15",x:404,y:235,rotation:0,custom:"fish_green"},{type:"red_fish_lvl15",x:99,y:233,rotation:0,custom:"fish_red"},{type:"platform_lvl15",x:220,y:201,rotation:0,custom:"bridge"},{type:"invisible_wall_big",x:52,y:263,rotation:0},{type:"invisible_wall_big",x:449,y:263,rotation:0,friction:0},{type:"square_green_lvl15",
x:384,y:126,rotation:0,custom:"square_green"},{type:"square_red_lvl15",x:384,y:199,rotation:0,custom:"square_red"},{type:"tube_on_blue_lvl15",x:158,y:296,rotation:0,custom:"pipe_blue1"},{type:"tube_on_green_lvl15",x:280,y:296,rotation:0,custom:"pipe_green"},{type:"tube_on_red_lvl15",x:219,y:296,rotation:0,custom:"pipe_red"},{type:"tube_on_blue_lvl15",x:341,y:296,rotation:0,custom:"pipe_blue2"},{type:"invisible_wall_small",x:126,y:295,rotation:1.5707963267948966},{type:"invisible_wall_small",x:187,
y:295,rotation:1.5707963267948966},{type:"invisible_wall_small",x:250,y:295,rotation:1.5707963267948966},{type:"invisible_wall_small",x:310,y:295,rotation:1.5707963267948966},{type:"invisible_wall_small",x:372,y:295,rotation:1.5707963267948966},{type:"conv_circle2_lvl15",x:205,y:76,rotation:0},{type:"conv_circle2_lvl15",x:219,y:76,rotation:0},{type:"conv_circle2_lvl15",x:233,y:76,rotation:0},{type:"conv_circle2_lvl15",x:247,y:76,rotation:0},{type:"conv_circle2_lvl15",x:262,y:76,rotation:0},{type:"conv_circle2_lvl15",
x:276,y:76,rotation:0,custom:"star_wheel"},{type:"conv_circle2_lvl15",x:291,y:76,rotation:0},{type:"conv_circle1_lvl15",x:306,y:76,rotation:0},{type:"conv_circle2_lvl15",x:320,y:76,rotation:0},{type:"conv_circle2_lvl15",x:334,y:76,rotation:0},{type:"conv_circle2_lvl15",x:350,y:76,rotation:0},{type:"conv_circle2_lvl15",x:349,y:76,rotation:0},{type:"conv_circle2_lvl15",x:364,y:76,rotation:0},{type:"conv_circle1_lvl15",x:378,y:76,rotation:0},{type:"conv_circle2_lvl15",x:392,y:76,rotation:0},{type:"conv_circle2_lvl15",
x:406,y:76,rotation:0},{type:"conv_circle2_lvl15",x:421,y:76,rotation:0},{type:"conv_circle2_lvl15",x:436,y:76,rotation:0},{type:"button_green",x:47,y:235,rotation:-1.5707963267948966,custom:"button_left"},{type:"conveyor_lvl15",x:322,y:83,rotation:0},{type:"button_green",x:457,y:235,rotation:1.5707963267948966,custom:"button_right"},{type:"down_lighting",x:345,y:77,rotation:0},{type:"invisible_wall_big",x:123,y:124,rotation:1.5707963267948966},{type:"invisible_wall_small",x:69,y:234,rotation:1.5707963267948966},
{type:"invisible_wall_small",x:431,y:234,rotation:1.5707963267948966},{type:"invisible_wall_big",x:453,y:192,rotation:0},{type:"invisible_wall_small",x:379,y:164,rotation:1.5707963267948966,custom:"win_wall"}],joints:[]},{objects:[{type:"tube1",x:51.8,y:70,rotation:0,custom:"startTube"},{type:"tube2",x:461.8,y:215.8,rotation:0,custom:"destination"},{type:"star7",x:341,y:266,rotation:0},{type:"star9",x:371,y:21,rotation:0},{type:"coverStar_lvl16",x:368,y:24,rotation:0},{type:"star9",x:110,y:245,rotation:0},
{type:"coverStar2_lvl16",x:113.8,y:243.8,rotation:0},{type:"coverStar3_lvl16",x:339,y:256.8,rotation:0},{type:"invisible_wall_big",x:119,y:98,rotation:0},{type:"invisible_wall_big",x:-31,y:98,rotation:0},{type:"Bob",x:38,y:72,rotation:0},{type:"invisible_wall_big",x:401,y:107,rotation:1.5707963267948966},{type:"invisible_wall_small",x:263,y:87,rotation:1.5707963267948966},{type:"invisible_wall_very_small",x:259,y:100,rotation:1.5707963267948966},{type:"invisible_wall_very_small",x:169,y:127,rotation:1.7207963267948967},
{type:"invisible_wall_very_small",x:158,y:145,rotation:-.65},{type:"invisible_wall_small",x:126,y:150,rotation:0},{type:"invisible_wall_big",x:102,y:220,rotation:1.5707963267948966},{type:"invisible_wall_big",x:427,y:243,rotation:0},{type:"invisible_wall_big",x:355,y:317,rotation:1.5707963267948966},{type:"ad_lvl16",x:317,y:29,rotation:0},{type:"blind_lvl16",x:322,y:26,rotation:0,custom:"coverAd"},{type:"button_red",x:231.8,y:25,rotation:0,custom:"buttonAd"},{type:"platform_lvl16",x:156,y:179,rotation:0,
custom:"platform1"},{type:"platform_lvl16",x:156,y:250,rotation:0,custom:"platform2"},{type:"lamp_green2",x:270,y:78,rotation:0,custom:"lamp_btn"},{type:"btn2",x:259,y:75,rotation:-1.5707963267948966,custom:"btn"},{type:"bridge2_lvl16",x:163,y:104,rotation:0,custom:"bridge"},{type:"coverBridge2_lvl16",x:162,y:105,rotation:0,custom:"coverBridge"},{type:"wall_lvl16",x:408,y:213,rotation:0,custom:"wall"},{type:"coverWall_lvl16",x:408.8,y:150,rotation:0,custom:"coverWall"},{type:"lamp_green2",x:408,y:137,
rotation:0,custom:"lampGreen"},{type:"lamp_red2",x:408,y:155,rotation:0,custom:"lampRed"},{type:"lamp_blue2",x:408,y:173,rotation:0,custom:"lampBlue"},{type:"button_red",x:148,y:128,rotation:0,custom:"buttonBridge"},{type:"coverBut_lvl14",x:64,y:178,rotation:0},{type:"coverBut_lvl14",x:435,y:167,rotation:0,custom:"coverBut"},{type:"coverBut_lvl14",x:380,y:265,rotation:0},{type:"coverBut_lvl14",x:64,y:251,rotation:0},{type:"button_green",x:64,y:178,rotation:-1.5707963267948966,custom:"button_left1"},
{type:"button_green",x:64,y:251,rotation:-1.5707963267948966,custom:"button_left2"},{type:"button_green",x:435,y:167,rotation:1.5707963267948966,custom:"button_right1"},{type:"button_green",x:380,y:265,rotation:1.5707963267948966,custom:"button_right2"},{type:"light_lvl16",x:382,y:241,rotation:1.5533430342749532}],joints:[]},{objects:[{type:"bridge_green_lvl17_1",x:302,y:117,rotation:0,custom:"bridge1"},{type:"tube1",x:60,y:220,rotation:0},{type:"Bob",x:84,y:228,rotation:0},{type:"tube2",x:475,y:220,
rotation:0,custom:"destination"},{type:"bridge_lvl17",x:197,y:322,rotation:0,custom:"lift"},{type:"cover_lvl17_3",x:199,y:274,rotation:0,custom:"cover3"},{type:"invisible_wall_big",x:96,y:249,rotation:0},{type:"button_red",x:199,y:270,rotation:0,custom:"lift_btn"},{type:"invisible_wall_big",x:225,y:185,rotation:1.5707963267948966},{type:"cover_lvl17_1",x:250,y:119,rotation:0,custom:"cover1"},{type:"invisible_wall_small",x:250,y:111,rotation:0},{type:"lamp_green_lvl17",x:270,y:117,rotation:0,custom:"g1"},
{type:"star1",x:251,y:222,rotation:0},{type:"bridge_green_lvl17_2",x:304,y:252,rotation:0,custom:"bridge2"},{type:"doors_lvl17",x:251,y:221,rotation:0},{type:"button_red",x:252,y:149,rotation:0,custom:"bridge_btn"},{type:"cover_lvl17_2",x:361,y:254,rotation:0,custom:"cover2"},{type:"lamp_green_lvl17",x:338,y:253,rotation:0,custom:"g2"},{type:"eye_triangle_lvl17",x:89,y:136,rotation:0,custom:"t1"},{type:"eye_triangle_lvl17",x:158,y:38,rotation:0,custom:"t2"},{type:"eye_triangle_lvl17",x:244,y:38,rotation:0,
custom:"t3"},{type:"eye_triangle_lvl17",x:348,y:38,rotation:0,custom:"t4"},{type:"eye_triangle_lvl17",x:405,y:136,rotation:0,custom:"t5"},{type:"head_lvl17",x:251,y:195,rotation:-3.141592653589793,custom:"head_1"},{type:"head_lvl17",x:251,y:250,rotation:-1.5707963267948966,custom:"head_2"},{type:"star_lvl17",x:327,y:217,rotation:0},{type:"invisible_wall_big",x:420,y:248,rotation:0}],joints:[]},{objects:[{type:"btn2",x:278,y:123,rotation:0,custom:"press_btn2"},{type:"btn2",x:357,y:71,rotation:0,custom:"press_btn3"},
{type:"press_lvl18",x:360,y:135,rotation:0,custom:"press"},{type:"hoover_lvl18",x:200,y:25,rotation:0,custom:"hoover"},{type:"cover4_lvl18",x:361,y:121,rotation:0,custom:"cover_press"},{type:"tube1",x:56,y:222,rotation:0},{type:"bridge_lvl18",x:125,y:255,rotation:0,custom:"bridge"},{type:"Bob",x:61,y:228,rotation:0},{type:"lever2",x:187,y:62,rotation:3.141592653589793,custom:"handle"},{type:"cover1_lvl18",x:125,y:256,rotation:0},{type:"btn2",x:213,y:151,rotation:0,custom:"press_btn1"},{type:"lamp_green",
x:153,y:255,rotation:0,custom:"g2"},{type:"star1",x:362,y:172,rotation:0},{type:"invisible_wall_big",x:85,y:252,rotation:0},{type:"invisible_wall_big",x:293,y:251,rotation:0},{type:"invisible_wall_big",x:431,y:251,rotation:0},{type:"star1",x:392,y:24,rotation:0,custom:"star_umb"},{type:"invisible_wall_big",x:122,y:124,rotation:0},{type:"invisible_wall_big",x:-21,y:124,rotation:0},{type:"invisible_wall_big",x:302,y:125,rotation:0,friction:0},{type:"invisible_wall_very_small",x:198,y:138,rotation:1.5707963267948966},
{type:"invisible_wall_very_small",x:229,y:137,rotation:1.5707963267948966},{type:"invisible_wall_big",x:343,y:73,rotation:0},{type:"invisible_wall_big",x:486,y:74,rotation:0},{type:"ball_lvl18",x:176,y:109,rotation:0},{type:"cover3_lvl18",x:412,y:54,rotation:0,custom:"umb_cover"},{type:"lamp_green",x:180,y:142,rotation:0,custom:"g1"},{type:"lamp_green",x:366,y:131,rotation:0,custom:"g3"},{type:"invisible_wall_very_small",x:212,y:150,rotation:0},{type:"tube2",x:464,y:222,rotation:0,custom:"destination"},
{type:"umbrella_lvl18",x:394,y:29,rotation:0},{type:"hoover_end",x:286,y:54,rotation:0,custom:"hoover_out"},{type:"hoover_end",x:138,y:96,rotation:1.5707963267948966,custom:"hoover_in"},{type:"cover2_lvl18",x:354,y:103,rotation:0}],joints:[]},{objects:[{type:"tube3",x:92,y:9,rotation:0},{type:"Bob",x:101,y:28,rotation:0},{type:"invisible_wall_big",x:71,y:85,rotation:0},{type:"invisible_wall_big",x:141,y:159,rotation:1.5707963267948966},{type:"invisible_wall_big",x:195,y:262,rotation:0},{type:"bridge_lvl20",
x:356,y:268,rotation:0,custom:"bridge2"},{type:"bridge_lvl20",x:323,y:92,rotation:0,custom:"bridge1"},{type:"cover_lvl19_2",x:357,y:268,rotation:0,custom:"cover2"},{type:"invisible_wall_small",x:202,y:107,rotation:1.5707963267948966},{type:"invisible_wall_small",x:202,y:156,rotation:1.5707963267948966},{type:"invisible_wall_very_small",x:201,y:191,rotation:1.5707963267948966},{type:"invisible_wall_big",x:369,y:85,rotation:0},{type:"invisible_wall_small",x:470,y:85,rotation:0},{type:"invisible_wall_small",
x:213,y:153,rotation:1.5707963267948966},{type:"invisible_wall_small",x:236,y:91,rotation:1.5707963267948966},{type:"baraban",x:247,y:167,rotation:0,custom:"platform"},{type:"invisible_wall_big",x:353,y:159,rotation:0},{type:"invisible_wall_big",x:483,y:159,rotation:0},{type:"tube2",x:463,y:131.5,rotation:0,custom:"destination"},{type:"cover_lvl19_1",x:324,y:91,rotation:0,custom:"cover1"},{type:"lever2",x:104,y:207,rotation:1.5707963267948966,custom:"handler"},{type:"cover_lvl19_5",x:82,y:207,rotation:0},
{type:"green_light_lvl19",x:78,y:189,rotation:0,custom:"g1"},{type:"green_light_lvl19",x:78,y:225,rotation:0,custom:"g2"},{type:"green_light_lvl19",x:301,y:91,rotation:0,custom:"g3"},{type:"star6",x:427,y:22,rotation:-.44999999999999996,custom:"star2"},{type:"star6",x:416.8,y:203,rotation:.39999999999999997,custom:"star3"},{type:"green_light_lvl19",x:333,y:267,rotation:0,custom:"g4"},{type:"cover_lvl19_3",x:454,y:46,rotation:0,custom:"head_out"},{type:"cover_lvl19_4",x:465,y:227,rotation:0,custom:"head_in"},
{type:"cover_lvl19_7",x:228,y:125,rotation:0},{type:"cover_lvl19_6",x:141,y:148,rotation:0,custom:"l1"},{type:"red_light_lvl19",x:134,y:149,rotation:0},{type:"cover_lvl19_6",x:386,y:200,rotation:1.5707963267948966,custom:"l4"},{type:"cover_lvl19_8",x:361,y:12,rotation:0,custom:"cover8"},{type:"cover_lvl19_6",x:380,y:97,rotation:1.5707963267948966,custom:"l3"},{type:"cover_lvl19_6",x:361,y:24,rotation:1.5707963267948966,custom:"l2"},{type:"red_light_lvl19",x:386,y:194,rotation:0},{type:"red_light_lvl19",
x:380,y:91,rotation:0},{type:"red_light_lvl19",x:361,y:18,rotation:0},{type:"button_red",x:220,y:96,rotation:0,custom:"btn_1"},{type:"button_red",x:333,y:182,rotation:0,custom:"btn_2"},{type:"star_lvl17",x:197,y:34,rotation:0,custom:"star1"},{type:"invisible_wall_big",x:404,y:261,rotation:0},{type:"invisible_wall_big",x:500,y:261,rotation:0},{type:"electro_ball_off",x:275,y:61,rotation:0,custom:"s1"},{type:"electro_ball_off",x:276,y:133,rotation:0,custom:"s2"},{type:"electro_ball_off",x:279,y:236,
rotation:0,custom:"s3"}],joints:[]},{objects:[{type:"Bob",x:103,y:-7,rotation:0},{type:"tube3",x:101,y:-9,rotation:0},{type:"star_lvl17",x:382,y:42,rotation:0,custom:"star1"},{type:"lift_star_lvl20",x:92,y:226,rotation:0,custom:"lift_star"},{type:"boss_lvl20",x:366,y:35,rotation:0},{type:"invisible_wall_big",x:71,y:84,rotation:1.5707963267948966},{type:"invisible_wall_big",x:71,y:236,rotation:1.5707963267948966},{type:"invisible_wall_big",x:200,y:69,rotation:0},{type:"invisible_wall_big",x:200,y:158,
rotation:0},{type:"invisible_wall_small",x:303,y:69,rotation:0},{type:"invisible_wall_very_small",x:326,y:53,rotation:1.5707963267948966},{type:"invisible_wall_very_small",x:338,y:62,rotation:0},{type:"invisible_wall_small",x:324,y:157,rotation:0},{type:"fan",x:290,y:68,rotation:0,custom:"mech"},{type:"cover_lvl20_2",x:305,y:84,rotation:0,custom:"cover2"},{type:"btn2",x:249,y:63,rotation:0,custom:"push_btn1"},{type:"lamp_green_lvl17",x:250,y:74,rotation:0,custom:"g1"},{type:"invisible_wall_big",x:196,
y:251,rotation:0},{type:"invisible_wall_big",x:350,y:251,rotation:0},{type:"invisible_wall_small",x:455,y:251,rotation:0},{type:"button_red",x:306,y:87,rotation:0,custom:"red_btn1"},{type:"bridge_lvl20",x:383,y:68,rotation:0,custom:"bridge1"},{type:"bridge_lvl20",x:383,y:163,rotation:0,custom:"bridge2"},{type:"cover_lvl20_3",x:439,y:68,rotation:0,custom:"cover4"},{type:"btn2",x:262,y:169,rotation:1.5707963267948966,custom:"push_btn2"},{type:"obstacle_lvl20",x:253,y:185,rotation:0,custom:"obstacle5"},
{type:"cover_lvl20_5",x:256,y:192,rotation:0,custom:"cover5"},{type:"cover_lvl20_6",x:438,y:163,rotation:0,custom:"cover6"},{type:"button_red",x:430,y:35,rotation:0,custom:"red_btn2"},{type:"lamp_green_lvl17",x:416,y:68,rotation:0,custom:"g2"},{type:"obstacle_lvl20",x:256,y:220,rotation:0,custom:"obstacle6"},{type:"lamp_green_lvl17",x:416,y:163,rotation:0,custom:"g3"},{type:"obstacle_lvl20",x:130,y:133,rotation:0,custom:"obstacle4"},{type:"cover_lvl20_4",x:130,y:201,rotation:0,custom:"cover4"},{type:"cover_lvl20_8",
x:256,y:269,rotation:0,custom:"cover8"},{type:"star_lvl20",x:124,y:85,rotation:-.5499999999999999,custom:"star_lvl20"},{type:"button_red",x:139,y:174,rotation:0,custom:"red_btn3"},{type:"lift_lvl_20",x:99,y:159,rotation:0,custom:"lift"},{type:"button_red",x:256,y:173,rotation:0,custom:"red_btn4"},{type:"button_red",x:194,y:266,rotation:0,custom:"red_btn5"},{type:"mirror_wall_lvl20",x:134,y:222,rotation:0,custom:"mirror"},{type:"cover_lvl20_7",x:109,y:268,rotation:0,custom:"cover7"},{type:"obstacle_lvl20",
x:140,y:38,rotation:0,custom:"obstacle1"},{type:"obstacle_lvl20",x:204,y:38,rotation:0,custom:"obstacle2"},{type:"obstacle_lvl20",x:275,y:38,rotation:0,custom:"obstacle3"},{type:"cover_lvl20_1",x:208,y:5,rotation:0,custom:"cover1"},{type:"invisible_wall_very_small",x:123,y:118,rotation:1.5707963267948966},{type:"invisible_wall_small",x:99,y:251,rotation:0},{type:"invisible_wall_very_small",x:125,y:217,rotation:1.5707963267948966,custom:"inv_cover"},{type:"star_cover_lvl20",x:132,y:84,rotation:0,custom:"star_cover"},
{type:"portal_lvl20",x:419,y:219,rotation:0},{type:"invisible_wall_very_small",x:415,y:247,rotation:-.2}],joints:[]}],loadData={images:[["hourglass","hourglass.png"],["Splash_Image","Splash_Image.png"],["SpilLogo","SpilLogo.png"],["LevelsMap","levelMap/LevelsMap.jpg"],["bee_lvlMap","levelMap/bee_lvlMap.png"],["lvlImage_lvlMap","levelMap/lvlImage_lvlMap.png"],["menu_lvlMap","levelMap/menu_lvlMap.png"],["num1_lvlMap","levelMap/num1_lvlMap.png"],["num2_lvlMap","levelMap/num2_lvlMap.png"],["num3_lvlMap",
"levelMap/num3_lvlMap.png"],["sound_lvlMap","levelMap/sound_lvlMap.png"],["star_lvlMap","levelMap/star_lvlMap.png"],["sound_off","levelMap/sound_off.png"],["gallery_lvlMap","levelMap/gallery_lvlMap.png"],["back_splash","splash/back_splash.png"],["bob1_splash","splash/bob1_splash.png"],["bob2_splash","splash/bob2_splash.png"],["hat_splash","splash/hat_splash.png"],["land_splash","splash/land_splash.png"],["mummy1_splash","splash/mummy1_splash.png"],["mummy2_splash","splash/mummy2_splash.png"],["play_splash",
"splash/play_splash.png"],["SnailBob1","transporant/SnailBob1.png"],["SnailBob2","transporant/SnailBob2.png"],["SnailBob1_final","transporant/SnailBob1_final.png"],["SnailBob2_final","transporant/SnailBob2_final.png"],["transporant1_menu","transporant/transporant1_menu.png"],["transporant2_menu","transporant/transporant2_menu.png"],["back_menu","menu/back_menu.png"],["bob_menu","menu/bob_menu.png"],["boss_menu","menu/boss_menu.png"],["credits_menu","menu/credits_menu.png"],["grandpa_menu","menu/grandpa_menu.png"],
["intro_menu","menu/intro_menu.png"],["logo_menu","menu/logo_menu.png"],["moreGames_menu","menu/moreGames_menu.png"],["play_menu","menu/play_menu.png"],["stars_menu","menu/stars_menu.png"],["gallery_menu","menu/gallery_menu.png"],["back_popup","popup/back_popup.png"],["backPart_popup","popup/backPart_popup.png"],["bobLose_popup","popup/bobLose_popup.png"],["bobWin0","popup/bobWin0.png"],["bobWin1","popup/bobWin1.png"],["bobWin2","popup/bobWin2.png"],["bobWin3","popup/bobWin3.png"],["bobWin4","popup/bobWin4.png"],
["bobWin5","popup/bobWin5.png"],["bobWin6","popup/bobWin6.png"],["bobWin7","popup/bobWin7.png"],["bobWin8","popup/bobWin8.png"],["bobWin9","popup/bobWin9.png"],["eyes_popup","popup/eyes_popup.png"],["levelMap_popup","popup/levelMap_popup.png"],["nextLevel_popup","popup/nextLevel_popup.png"],["num_popup","popup/num_popup.png"],["restart_popup","popup/restart_popup.png"],["score_popup","popup/score_popup.png"],["star_popup","popup/star_popup.png"],["tryAgain_popup","popup/tryAgain_popup.png"],["gameOver_popup",
"popup/gameOver_popup.png"],["gallery_popup","popup/gallery_popup.png"],["lvl_numbs","UI/lvl_numbs.png"],["bottom_ui_back","UI/bottom_ui_back.jpg"],["back_speed_panel","UI/back_speed_panel.png"],["Lvl","UI/Lvl.png"],["SpeedFastBtn","UI/SpeedFastBtn.png"],["SspeedStandardBtn","UI/SspeedStandardBtn.png"],["indicator","UI/indicator.png"],["levelMap_ingame","UI/levelMap_ingame.png"],["restart_ingame","UI/restart_ingame.png"],["BobGo","Bob/BobGo.png"],["BobOnLaser","Bob/BobOnLaser.png"],["BobRun","Bob/BobRun.png"],
["fly","Bob/fly.png"],["inTrap","Bob/bobtrapmovie2.png"],["BobTurns","Bob/BobTurns.png"],["BobHideTurn","Bob/BobHideTurn.png"],["BobHide","Bob/BobHide.png"],["BobGrowl","Bob/BobGrowl.png"],["BobFall","Bob/BobFall.png"],["BobFlatten","Bob/BobFlattenAnimMc.png"],["BobBurn","Bob/BobBurnAnimMc1.png"],["BobBurnAnimMc2","Bob/BobBurnAnimMc2.png"],["shocked","Bob/electroshock1.png"],["shocked2","Bob/electroshock2.png"],["bob_burn","Bob/bob_burn.png"],["bob_hit_by_magic","Bob/bob_hit_by_magic.png"],["bob_spirit",
"Bob/bob_spirit.png"],["resurrection_breath","resurrection/resurrection_breath.png"],["resurrection_btn","resurrection/resurrection_btn.png"],["resurrection_eyes","resurrection/resurrection_eyes.png"],["resurrection_mouth","resurrection/resurrection_mouth.png"],["backTube1","backTube1.png"],["backTube2","backTube2.png"],["backTube3","backTube3.png"],["backTube4","backTube4.png"],["backTube5","backTube5.png"],["laser","laser.png"],["fire_normal","fire_normal.png"],["fire_off","fire_off.png"],["GameOver",
"GameOver.png"],["levelCompleteNum","levelCompleteNum.png"],["LevelCompleteBobs","LevelCompleteBobs.png"],["star_anim","stars/star_anim.png"],["star_trail","stars/star_trail.png"],["star_finish","stars/star_finish.png"],["hint","hints/hint.png"],["arrow_white","hints/arrow_white.png"],["arrow_yellow","hints/arrow_yellow.png"],["hint1_lvl1","hints/hint1_lvl1.png"],["hint2_lvl1","hints/hint2_lvl1.png"],["tap","hints/tap.png"],["hint1_lvl2","hints/hint1_lvl2.png"],["hint2_lvl2","hints/hint2_lvl2.png"],
["hint3_lvl2","hints/hint3_lvl2.png"],["hint4_lvl2","hints/hint4_lvl2.png"]],sounds:["music1","music2","music3"],levels:[]};for(i=0;i<levels.length;i++)loadData.levels.push([]);for(i=0;i<levels.length;i++)loadData.levels[i].push(["Lvl"+(i+1)+"_back","levels/"+(10>i+1?"0"+(i+1):i+1)+"/Lvl"+(i+1)+"_back.png"]);loadData.levels[5].push(["bridge1_lvl5","levels/05/bridge1_lvl5.png"]);loadData.levels[6].push(["eyes_lvl7","levels/07/eyes_lvl7.png"],["light_lvl7","levels/07/light_lvl7.png"]);
loadData.levels[8].push(["lamp2_lvl9","levels/09/lamp2_lvl9.png"],["lamp3_lvl9","levels/09/lamp3_lvl9.png"]);loadData.levels[9].push(["bridge2_lvl7","levels/07/bridge2_lvl7.png"],["bird_fly","levels/10/bird_fly.png"],["magnet_normal","levels/10/magnet_normal.png"]);loadData.levels[12].push(["face_lvl12","levels/12/face_lvl12.png"]);
loadData.levels[14].push(["shock_lvl20","levels/18/shock_lvl20.png"],["btn_move_platform_lvl15","levels/15/btn_move_platform_lvl15.png"],["eye_blink_lvl15","levels/15/eye_blink_lvl15.png"],["tube_under","levels/15/tube_under.png"],["star_lvl15","levels/15/star_lvl15.png"]);loadData.levels[15].push(["coverBut_lvl14","levels/14/coverBut_lvl14.png"]);
loadData.levels[16].push(["eyes_light_lvl17","levels/17/eyes_light_lvl17.png"],["laser_lvl17_horizontal","levels/17/laser_lvl17_horizontal.png"],["laser_lvl17_long","levels/17/laser_lvl17_long.png"],["laser_lvl17_short","levels/17/laser_lvl17_short.png"],["star_lvl17_laser","levels/17/star_lvl17_laser.png"]);loadData.levels[17].push(["ant_received_anim","levels/18/ant_received_anim.png"],["bee_lvl18","levels/18/bee_lvl18.png"],["shock_lvl20","levels/18/shock_lvl20.png"]);
loadData.levels[18].push(["star_lvl17","levels/17/star_lvl17.png"],["electro_ball_off","levels/19/electro_ball_off.png"],["electro_ball_on","levels/19/electro_ball_on.png"],["laser_lvl19","levels/19/laser_lvl19.png"]);
loadData.levels[19].push(["star_lvl17","levels/17/star_lvl17.png"],["lamp_green_lvl17","levels/17/lamp_green_lvl17.png"],["boss_state_defeat","levels/20/boss_state_defeat.png"],["boss_state_shocked","levels/20/boss_state_shocked.png"],["boss_state_shoot","levels/20/boss_state_shoot.png"],["boss_state_victory","levels/20/boss_state_victory.png"],["button_temp_cover","levels/20/button_temp_cover.png"],["smoke_lvl20","levels/20/smoke_lvl20.png"],["light_bulb","levels/20/light_bulb.png"],["light_bulb_explode",
"levels/20/light_bulb_explode.png"],["portal_cover_lvl20","levels/20/portal_cover_lvl20.png"],["smoke_anim_lvl20","levels/20/smoke_anim_lvl20.png"]);loadData.gallery=[];
loadData.gallery.push(["back_gallery","gallery/back_gallery.png"],["backBtn_gallery","gallery/backBtn_gallery.png"],["cover1_gallery","gallery/cover1_gallery.png"],["cover2_gallery","gallery/cover2_gallery.png"],["cover3_gallery","gallery/cover3_gallery.png"],["fence_gallery","gallery/fence_gallery.png"],["lamp_gallery","gallery/lamp_gallery.png"],["prev_gallery","gallery/prev_gallery.png"],["next_gallery","gallery/next_gallery.png"],["page_gallery","gallery/page_gallery.png"],["pic3_gallery","gallery/pic1_gallery.png"],
["pic6_gallery","gallery/pic2_gallery.png"],["pic9_gallery","gallery/pic3_gallery.png"],["pic12_gallery","gallery/pic4_gallery.png"],["pic15_gallery","gallery/pic5_gallery.png"],["pic18_gallery","gallery/pic6_gallery.png"],["statue21_gallery","gallery/statue7_gallery.png"],["statue24_gallery","gallery/statue8_gallery.png"],["pic27_gallery","gallery/pic9_gallery.png"],["pic30_gallery","gallery/pic10_gallery.png"],["pic33_gallery","gallery/pic11_gallery.png"],["pic36_gallery","gallery/pic12_gallery.png"],
["pic39_gallery","gallery/pic13_gallery.png"],["pic42_gallery","gallery/pic14_gallery.png"],["statue45_gallery","gallery/statue15_gallery.png"],["statue48_gallery","gallery/statue16_gallery.png"],["pic51_gallery","gallery/pic17_gallery.png"],["pic54_gallery","gallery/pic18_gallery.png"],["pic57_gallery","gallery/pic19_gallery.png"],["pic60_gallery","gallery/pic20_gallery.png"],["picClose_gallery","gallery/picClose_gallery.png"],["plant_gallery","gallery/plant_gallery.png"],["star_gallery","gallery/star_gallery.png"],
["statueClose_gallery","gallery/statueClose_gallery.png"],["num_gallery","gallery/num_gallery.png"]);loadData.comics=[];loadData.comics.push(["comics1","comics/comics1.png"],["comics2","comics/comics2.png"],["comics3","comics/comics3.png"],["comics4","comics/comics4.png"],["comics5","comics/comics5.png"],["comics6","comics/comics6.png"],["comics7","comics/comics7.png"],["skip_comics","comics/skip_comics.png"]);loadData.finalScreen=[];
loadData.finalScreen.push(["back_final","final/back_final.png"],["curtain_final","final/curtain_final.png"],["fence_final","final/fence_final.png"],["lamp_final","final/lamp_final.png"],["menu_final","final/menu_final.png"],["num_final","final/num_final.png"],["title1_final","final/title1_final.png"],["title2_final","final/title2_final.png"],["title3_final","final/title3_final.png"],["portal_final","final/portal_final.png"],["portal2_final","final/portal2_final.png"],["gp1_final","final/gp1_final.png"],
["gp2_final","final/gp2_final.png"],["gp3_final","final/gp3_final.png"],["gp4_final","final/gp4_final.png"],["gp5_final","final/gp5_final.png"],["gp6_final","final/gp6_final.png"],["portalLight_final","final/portalLight_final.png"],["bob1_final","final/bob1_final.png"],["bob2_final","final/bob2_final.png"],["meet1_final","final/meet1_final.png"],["meet2_final","final/meet2_final.png"],["meet3_final","final/meet3_final.png"],["shawl_final","final/shawl_final.png"],["play_final","final/play_final.png"]);
loadData.credits=[];loadData.credits.push(["authors_credits","credits/authors_credits.png"],["close_creits","credits/close_creits.png"],["cloud_credits","credits/cloud_credits.png"],["facebook_credits","credits/facebook_credits.png"],["Jinn_credits","credits/Jinn_credits.png"],["logo_credits","credits/logo_credits.png"]);
var GAME_ID="SnailBob3",stage=null,world=null,fps=60,bitmaps={},GET={},LANDSCAPE_MODE=!0,STATE_SPLASH=0,STATE_LOGO=1,STATE_MENU=2,STATE_GAME=3,STATE_LEVEL_SELECT=4,STATE_VICTORY=5,STATE_GAME_OVER=6,STATE_COMICS=7,STATE_FINAL=8,STATE_CREDITS=9,STATE_GALLERY=10,gameState,prevState,gameData={},gameScore,totalScore,currentLevel=18,editorLevel=currentLevel,showDebugDraw=!1,spritesDrawing=!1,bob,mixer,isMusicOn=!0,isSoundOn=!0,loopSound,isWebAudioSupport=AudioMixer.isWebAudioSupport(),console={log:function(){}},
MORE_GAMES_URL="http://www.a10.com/";window.onload=function(){GET=Utils.parseGet();Utils.addMobileListeners(LANDSCAPE_MODE,!0);Utils.mobileCorrectPixelRatio();Utils.addFitLayoutListeners();Utils.switchToTimeMode(1E3/fps);setTimeout(startLoad,600)};
function startLoad(){var a=Utils.getMobileScreenResolution(LANDSCAPE_MODE);GET.debug&&(a=Utils.getScaleScreenResolution(2,LANDSCAPE_MODE));Utils.mobileCheckSlowDevice()&&(a=Utils.getScaleScreenResolution(1,LANDSCAPE_MODE));Utils.globalScale=a.scale;console.log("Scale = "+Utils.globalScale);Utils.createLayout(document.getElementById(Utils.DOMMainContainerId),a);Utils.addEventListener("fitlayout",function(){stage&&(stage.drawScene(stage.canvas),stage.drawScene(stage.backgroundCanvas,!0));world&&box2d.setDebugDrawScale(world);
resizeCSSBack()});Utils.addEventListener("lockscreen",function(){stage&&stage.started&&stage.stop()});Utils.addEventListener("unlockscreen",function(){stage&&!stage.started&&stage.start()});Utils.mobileHideAddressBar();GET.debug||Utils.checkOrientation(LANDSCAPE_MODE);var a=Utils.imagesRoot+"/"+Utils.globalScale+"/",c=new ImagesPreloader,d=[];for(i=0;i<objects.length;i++){var e=objects[i].image;-1!==e.indexOf("levels/")?(e=parseInt(e.substring(7,9))-1,loadData.levels[e].push([objects[i].name,objects[i].image])):
d.push({name:objects[i].name,src:a+objects[i].image})}for(i=0;i<loadData.images.length;i++)e=loadData.images[i],d.push({name:e[0],src:a+e[1]});c.maxProgressVal=50;c.load(d,loadImagesEnd,Utils.showLoadProgress)}function loadImagesEnd(a){bitmaps=a;a=[];for(var c=0;c<loadData.sounds.length;c++)a.push("sounds/"+loadData.sounds[c]);a=new SoundsPreloader(a,loadSoundsEnd,Utils.showLoadProgress);a.maxProgressVal=50;a.minProgressVal=50;a.load()}
function loadSoundsEnd(){Utils.showMainLayoutContent();gameData=loadGameData();GET.debug||splashScreen()}Sprite.prototype.addHint=function(a,c){this.hint=addSprite("hint",33,33,this.x+(a||0),this.y+(c||0));this.hint.setZIndex(13);this.hint.onchangeframe=function(a){a.target.rotation+=.025}};Sprite.prototype.removeHint=function(){var a=stage.createTween(this.hint,"opacity",1,0,1E3);a.play();a.onfinish=function(){this.obj.destroy=!0}};
Sprite.prototype.destroyByOpacity=function(a){this.setStatic(!1);this.fadeTo(0,a||1E3,!1,function(a){a.target.obj.destroy=!0})};function showSplashLogo(){createScene();addSprite("Splash_Image",351,130,240,160,!0,1,showMoreGames);stage.setTimeout(splashScreen,3E3)}function showMenu(){gameState=STATE_MENU;createScene()}function splashScreen(){gameState=STATE_SPLASH;createScene()}function intro(){preloadScene("comics",function(){gameState=STATE_COMICS;createScene()})}
function preloadScene(a,c){function d(a){for(var d in a)bitmaps[d]=a[d];c()}(function(){if(stage){var e=new Sprite(bitmaps.hourglass,100,150,1);e.x=240;e.y=130;stage.addChild(e)}if(0!==loadData[a].length){for(var e=Utils.imagesRoot+"/"+Utils.globalScale+"/",f=[],g=0;g<loadData[a].length;g++){var h=loadData[a][g];f.push({name:h[0],src:e+h[1]})}loadData[a]=[];(new ImagesPreloader).load(f,d,Utils.showLoadProgress)}else c()})()}
function showFinal(){preloadScene("finalScreen",function(){gameState=STATE_FINAL;createScene()})}function credits(){preloadScene("credits",function(){for(var a=0;a<stage.objects.length;a++)if(stage.objects[a].bitmap===bitmaps.hourglass){stage.objects[a].destroy=!0;break}showCredits()})}
function showCredits(){function a(){addToContainer(g,"authors_credits",252,216);var a=addToContainer(g,"close_creits",30,30,100,-68,!1,3,c);attachMouseEvents.call(a);a=addToContainer(g,null,160,12,-5,-90);a.onclick=function(){window.open("https://www.facebook.com/SnailBobGame","_blank")};var f=addToContainer(g,null,160,12,-5,-78);f.onclick=function(){window.open("https://twitter.com/SnailBobGame","_blank")};var l=addToContainer(g,null,115,12,-5,-66);l.onclick=function(){window.open("http://hunter-hamster.com/",
"_blank")};addToContainer(g,null,30,30,-107,-48).onclick=a.onclick;addToContainer(g,null,30,30,-75,-48).onclick=f.onclick;d=addSprite("Jinn_credits",76,142,g.x-90,g.y-10);d.setZIndex(g.zIndex-1);d.moveTo(g.x-160,g.y-14,200,!1,function(){d.setZIndex(g.zIndex+1);e=addSprite("logo_credits",202,90,202,320);e.onclick=l.onclick;e.anchor={x:101,y:45};e.rotation=-.3;e.rotateTo(0,200)})}function c(){e.rotateTo(-.3,200,!1,function(){e.destroy=!0;d.setZIndex(g.zIndex-1);d.moveTo(g.x-90,g.y-10,200,!1,function(){d.destroy=
!0;g.scaleTo(0,400);g.moveTo(194,246,400,!1,function(){g.destroy=f.destroy=!0;gameState=STATE_MENU})})})}if(gameState!==STATE_CREDITS){gameState=STATE_CREDITS;var d,e,f=addRelativeSprite(null,480,320);f.setStatic(!0);f.onclick=returnFalse;var g=addSprite("cloud_credits",295,244,194,246);g.setPropScale(0);g.scaleTo(1,400);g.moveTo(290,154,400);stage.setTimeout(a,400)}}
function addPopup(a){GameAPI.GameBreak.request(pauseGame,resumeGame);var c=addRelativeSprite(null,480,320);c.setStatic(!0);c.onclick=returnFalse;var d=addSprite("back_popup",220,0,240,150),e=addToContainer(d,"backPart_popup",0,16,0,-2);e.scaleY=-1;var f=addToContainer(d,"backPart_popup",0,16,0,10),c=[{tweens:[{prop:"width",to:218}],duration:200}],g=[{tweens:[{prop:"height",to:262,onchange:function(){20<d.height&&(e.y=-d.height/2+8,123>f.y&&(f.y=d.height/2))}}],duration:400,onfinish:function(){f.y=
123;a(d)}}];Animation.play(e,c);Animation.play(f,c);stage.setTimeout(function(){Animation.play(d,g)},200)}function showGameOverScreen(){function a(a){addPopupEyes(a.zIndex-1);var d=new TilesSprite(bitmaps.bobLose_popup,116,88,47,8,6);d.x=0;d.y=-50;d.animDelay=2;a.addChild(d);addToContainer(a,"gameOver_popup",119,18,0,20);a=addToContainer(a,"tryAgain_popup",90,32,0,70,!1,3,restart);attachMouseEvents.call(a,!0)}gameState==STATE_GAME&&(gameState=STATE_GAME_OVER,addPopup(a))}
function showFinalScreen(){function a(){function a(d){d=d.target;if(d.currentFrameX===d.framesCount-1)switch(d.state){case 1:c(d,"gp5_final",112,128,18,3,6);d.state++;break;case 2:c(d,"gp6_final",112,128,42,7,6);d.state++;break;case 3:c(d,"gp4_final",112,128,48,6,8),d.state=1}}d();l.visible=q.visible=!0;c(l,"bob2_final",82,64,36,12,3,-32);c(q,"gp3_final",136,128,12,6,2,36,-20);q.onchangeframe=function(d){11===d.target.currentFrameX&&(c(q,"gp4_final",112,128,48,6,8,0,-7),q.onchangeframe=a,q.state=
1)}}function c(a,c,d,e,f,g,h,k,l){a.bitmap=bitmaps[c];a.width=d;a.height=e;a.framesCount=f;a.totalFrames=g;a.totalLayers=h;k&&(a.x+=k);l&&(a.y+=l);a.gotoAndPlay(0)}function d(){var a=addSprite("title1_final",146,26,-70,20),c=addSprite("title2_final",182,26,570,50),d=addSprite("title3_final",234,40,-70,90);a.opacity=c.opacity=d.opacity=0;var k=new SimpleText(bitmaps.num_final,16,18);k.parent=d;k.align=k.ALIGN_LEFT;k.charSpacing=-2;k.x=42;k.y=0;k.write(getTotalScores());var l=[{tweens:[{prop:"x",to:240},
{prop:"opacity",to:1,ease:Easing.exponential.easeIn}],duration:1E3},{tweens:[{prop:"skewY",to:-.5}],duration:100},{tweens:[{prop:"skewY",to:0}],duration:100}],n=[{tweens:[{prop:"x",to:240},{prop:"opacity",to:1,ease:Easing.exponential.easeIn}],duration:1E3},{tweens:[{prop:"skewY",to:.5}],duration:100},{tweens:[{prop:"skewY",to:0}],duration:100}];Animation.play(a,l);stage.setTimeout(function(){Animation.play(c,n)},1E3);stage.setTimeout(function(){Animation.play(d,l)},2E3);stage.setTimeout(function(){var a=
addSprite("menu_final",60,28,240,d.y,!1,3,showMenu);a.setZIndex(1);attachMouseEvents.call(a,!0);a=stage.createTween(a,"y",d.y,d.y+40,500);a.play();a.onfinish=function(){g.setStatic(!1);h.setStatic(!1);g.play();h.play();e.onclick=showFirstBob;f.onclick=showSecondBob;var a=addTransporant(e.x,-10,1,!0),c=addTransporant(f.x,-10,2,!0);a.moveTo(e.x,e.y-55,1E3);c.moveTo(f.x,f.y-55,1E3);a=addSprite("play_final",34,16,e.x,e.y+45,!0);c=addSprite("play_final",34,16,f.x,f.y+45,!0);a.setZIndex(e.zIndex+1);c.setZIndex(f.zIndex+
1)}},3E3)}setCSSBack(bitmaps.back_final);Utils.mobileCheckBrokenAndroid()&&addSprite("back_final",570,320,240,160,!0).setZIndex(0);playMusic("music3");addSprite("lamp_final",138,86,80,28,!0);addSprite("lamp_final",138,86,400,28,!0);var e=addSprite("SnailBob1_final",102,104,75,150,!0),f=addSprite("SnailBob2_final",102,104,405,150,!0);addSprite("fence_final",94,28,85,265,!0);addSprite("fence_final",94,28,405,265,!0);var g=addTilesSprite("curtain_final",92,170,14,2,7,75,195,2),h=addTilesSprite("curtain_final",
92,170,14,2,7,405,195,2);g.stop();h.stop();g.setStatic(!0);h.setStatic(!0);g.animDelay=h.animDelay=2;g.onchangeframe=h.onchangeframe=function(a){a=a.target;13===a.currentFrameX&&(a.stop(),a.setStatic(!0),stage.setTimeout(function(){k.setStatic(!0)},1),a.onchangeframe=null)};var k=addSprite("portal_final",32,76,427,240,!1,2);k.gotoAndStop(0);var l,q,v;q=addTilesSprite("gp1_final",94,86,13,7,2,207,249,5);stage.setTimeout(function(){k.gotoAndStop(1);var d=addTilesSprite("portalLight_final",26,70,20,
2,10,k.x+31,k.y-41,2),e=addTilesSprite("portalLight_final",26,70,20,2,10,k.x+36,k.y,2),f=addTilesSprite("portalLight_final",26,70,20,2,10,k.x+28,k.y+43,2);d.rotation=1;e.rotation=Math.PI/2;f.rotation=-1;var g=addTilesSprite("portal2_final",114,62,21,11,2,k.x-61,k.y,2);c(q,"gp2_final",108,100,50,10,5,3,2.8);q.onchangeframe=function(h){19===h.target.currentFrameX&&(l=addTilesSprite("bob1_final",104,76,30,10,3,k.x-57,k.y+10,5),l.onchangeframe=function(a){29===a.target.currentFrameX&&(a.target.stop(),
a.target.visible=!1,a.target.onchangeframe=null)});49===h.target.currentFrameX&&(h.target.onchangeframe=null,h.target.stop(),h.target.visible=!1,v=addTilesSprite("meet1_final",260,86,30,10,3,283,250,5),v.gotoAndPlay(1),addSprite("shawl_final",22,6,v.x-61,v.y+36.8,!0).setPropScale(1.1),v.onchangeframe=function(h){29===h.target.currentFrameX&&(h.target.bitmap=bitmaps.meet2_final,h.target.gotoAndPlay(0),h.target.onchangeframe=function(h){29===h.target.currentFrameX&&(d.destroyByOpacity(),e.destroyByOpacity(),
f.destroyByOpacity(),g.destroyByOpacity(),stage.setTimeout(function(){k.gotoAndStop(0)},1E3),c(h.target,"meet3_final",176,90,16,8,2,7.8,1.8),h.target.onchangeframe=function(){13===h.target.currentFrameX&&(h.target.destroy=!0,a())})})})}},2500)}
function victory(){function a(a){function c(e){var f=new TilesSprite(bitmaps.star_popup,40,42,20,4,5);f.x=-27+27*e;f.y=-20;f.animDelay=3;f.onchangeframe=function(a){19===a.target.currentFrameX&&(a.target.stop(),a.target.onchangeframe=null)};a.addChild(f);f.stop();~~(gameScore/1E3)>e&&stage.setTimeout(function(){f.play();playSound("star"+(e+1)+"(SnailBob3)")},900*e+1)}addToContainer(a,"bobWin"+randInt(),96,102,50,-73);showSpilLogo(-40,-60,a,!0);addToContainer(a,"score_popup",58,16,0,5);var f=new SimpleText(bitmaps.num_popup,
18,20);f.align=f.ALIGN_CENTER;f.parent=a;f.x=0;f.y=27;f.write(gameScore);c(0);c(1);c(2);var f=addToContainer(a,"nextLevel_popup",88,32,43,85,!1,3,nextLevel),g=addToContainer(a,"levelMap_popup",58,42,-45,61,!1,3,levelSelect),h=addToContainer(a,"restart_popup",66,30,-45,98,!1,3,restart);attachMouseEvents.call(f,!0);attachMouseEvents.call(g,!0);attachMouseEvents.call(h,!0);addPopupEyes(a.zIndex-1)}if(gameState===STATE_GAME){gameState=STATE_VICTORY;var c=getTotalNumOfStars();saveScores(gameScore);currentLevel<
levels.length-1?(addPopup(a),playSound("bob_levelfinish(SnailBob3)"),~~(getTotalNumOfStars()/3)>~~(c/3)&&(c=addSprite("gallery_popup",306,84,210,-50),c.moveTo(210,40,500),c.hitArea={x:-95,y:13,width:100,height:40},c.onclick=gallery)):showFinal()}}
function addPopupEyes(a){function c(){var e,f,g,h=new Vector(0,50);switch(d){case 0:e=.3;f=180;g=243;break;case 1:e=-Math.PI/2-.3;f=305;g=80;break;case 2:e=Math.PI/2;f=174;g=225;break;case 3:e=Math.PI/2;f=174;g=90;break;case 4:e=-Math.PI/2,f=305,g=225}var k=addSprite("eyes_popup",39,53,f,g);k.rotation=e;k.setZIndex(a);h.rotate(-e);var l=[{tweens:[{prop:"x",to:f},{prop:"y",to:g}],duration:700,onfinish:function(){k.destroy=!0;stage.setTimeout(c,1E3)}}];Animation.play(k,[{tweens:[{prop:"x",to:f+h.x},
{prop:"y",to:g+h.y}],duration:700,onfinish:function(){stage.setTimeout(function(){Animation.play(k,l)},1E3)}}]);4>d?d++:d=0}var d=0;c()}function levelSelect(){gameState=STATE_LEVEL_SELECT;createScene()}function gallery(){preloadScene("gallery",function(){prevState=gameState;gameState=STATE_GALLERY;createScene()})}
function createStage(){stage&&(stage.destroy(),stage.stop());stage=new Stage("screen",480,320,!1);stage.setBackgroundCanvas("screen_background");stage.delay=1E3/fps;stage.allowDebugDrawing=spritesDrawing;stage.onpretick=preTick;stage.onposttick=postTick;stage.ceilSizes=!0;stage.showFPS=!1}
function createScene(){createStage();switch(gameState){case STATE_MENU:showMainMenu();break;case STATE_LEVEL_SELECT:showLevelSelect();break;case STATE_SPLASH:showSplashScreen();break;case STATE_COMICS:showComics();break;case STATE_FINAL:showFinalScreen();break;case STATE_GALLERY:showGallery()}stage.start();stage.refreshBackground()}
function addTransporant(a,c,d,e){e?(d="transporant"+d+"_menu",e=42):(d="transporant"+d+"_final",e=40);a=addTilesSprite(d,102,e,30,10,3,a,c,2);a.onchangeframe=function(a){29===a.target.currentFrameX&&a.target.gotoAndPlay(1)};return a}
function showSplashScreen(){setCSSBack(bitmaps.back_splash,"#000");Utils.mobileCheckBrokenAndroid()&&addSprite("back_splash",570,320,240,160,!0);addSprite("land_splash",193,190,240,200,!0);addSprite("logo_menu",272,78,255,38,!0);addSprite("SnailBob1",94,100,75,250,!0,1,showFirstBob);addSprite("SnailBob2",94,100,405,250,!0,1,showSecondBob);addTransporant(78,196,1,!0);addTransporant(408,196,2,!0);var a=addSprite("play_splash",88,41,234,220,!1,3,showMenu);attachMouseEvents.call(a,!0);a.onmousedown=function(a){a.target.gotoAndStop(1)};
addTilesSprite("bob1_splash",76,58,40,10,4,255,123,3).onchangeframe=function(a){a=a.target;39===a.currentFrameX&&(a.onchangeframe=null,a.bitmap=bitmaps.bob2_splash,a.width=34,a.height=38,a.framesCount=20,a.totalFrames=20,a.totalLayers=1,a.x-=14,a.gotoAndPlay(0))};addTilesSprite("mummy1_splash",62,68,17,9,2,214,129,3).onchangeframe=function(a){a=a.target;if(16===a.currentFrameX){a.bitmap=bitmaps.mummy2_splash;a.width=106;a.height=206;a.framesCount=24;a.totalFrames=4;a.totalLayers=6;a.animDelay=3;a.x-=
19;a.y+=72;a.gotoAndPlay(0);a.onchangeframe=function(a){var c=a.target;23===c.currentFrameX&&(c.stop(),c.onchangeframe=null,a=stage.createTween(c,"y",c.y,c.y+105,400,Easing.sine.easeIn),a.play(),a.onfinish=function(){c.destroy=!0})};var d=addSprite("hat_splash",18,18,214,107);d.rotation=-.6;d.rotateTo(-2.9,1E3,Easing.exponential.easeOut,function(){d.destroy=!0});(new PathTween(d,[{x:206,y:103},{x:185,y:113},{x:170,y:128},{x:165,y:149},{x:163,y:191},{x:161,y:232},{x:162,y:272},{x:163,y:310},{x:163,
y:330}],!0)).start(1E3)}}}
function showComics(){function a(d,e){var h;e&&e.fadeTo(1,1E3,!1,function(){e.destroy=!0});h=0===d?addSprite("logo_menu",272,78,240,160):addSprite("comics"+d,449,320,240,160);h.opacity=0;h.setZIndex(1);h.fadeTo(1,1E3);stage.setTimeout(function(){7>d?(d++,a(d,h)):c()},4E3)}function c(){for(var a=0;a<stage.objects.length;a++){var c=stage.objects[a];c!==d&&c.fadeTo(0,1E3)}stage.setTimeout(showMenu,1E3)}setCSSBack(null,"#fff");if(Utils.mobileCheckBrokenAndroid()){var d=addSprite(null,570,320,240,160,
!0);d.fillColor="#fff"}var e=addSprite("skip_comics",46,30,450,20,!1,3,c);e.setZIndex(2);attachMouseEvents.call(e,!0);a(0);playMusic("music1")}
function showMainMenu(){function a(a,c){a.opacity=0;var d=[{tweens:[{prop:"y",to:a.y-5},{prop:"opacity",to:1}],duration:500}];c?stage.setTimeout(function(){Animation.play(a,d)},c):Animation.play(a,d)}mixer||(mixer=new AudioMixer("sounds",10),checkSoundStatus(),playMusic("music2"));setCSSBack(bitmaps.back_menu,"#000");Utils.mobileCheckBrokenAndroid()&&addSprite("back_menu",570,320,240,160,!0);showSpilLogo(58,286);addSprite("logo_menu",272,78,268,38,!0);addTilesSprite("boss_menu",124,94,46,7,7,272,
99,3);addTilesSprite("grandpa_menu",76,86,110,10,11,155,260,2);addTilesSprite("bob_menu",52,66,16,4,4,355,262,3);addSprite("stars_menu",66,50,335,273);var c=addSprite("SnailBob1",94,100,0,170,!1,1,showFirstBob),d=addSprite("SnailBob2",94,100,480,170,!1,1,showSecondBob);c.opacity=d.opacity=0;var e=[{tweens:[{prop:"x",to:405},{prop:"opacity",to:1,ease:Easing.exponential.easeIn}],duration:1E3,onfinish:function(){d.setStatic(!0);h.play()}}];Animation.play(c,[{tweens:[{prop:"x",to:75},{prop:"opacity",
to:1,ease:Easing.exponential.easeIn}],duration:1E3,onfinish:function(){c.setStatic(!0);g.play()}}]);Animation.play(d,e);var e=addTransporant(78,-30,1,!0),f=addTransporant(408,-30,2,!0),g=stage.createTween(e,"y",-30,116,1E3),h=stage.createTween(f,"y",-30,116,1E3),e=addSprite("sound_lvlMap",28,28,407,307,!1,3);attachMouseEvents.call(e,!0);coverSoundSpr(e);e=addSprite("intro_menu",40,20,455,15,!1,3,intro);attachMouseEvents.call(e);e=addSprite("play_menu",60,34,250,160,!1,3,levelSelect);attachMouseEvents.call(e,
!0);a(e);e=addSprite("credits_menu",84,36,250,197,!1,3,credits);attachMouseEvents.call(e,!0);a(e,500);e=addSprite("moreGames_menu",102,36,250,235,!1,3,spilMoreGames);attachMouseEvents.call(e,!0);a(e,1E3);var k=addSprite("gallery_menu",74,74,253,360,!1,1,gallery);stage.setTimeout(function(){k.moveTo(253,283,500,!1,function(){k.setStatic(!0)})},1500);playMusic("music2")}
function showGallery(){function a(a){a.target.index!==l&&a.target.gotoAndStop(1)}function c(a){a.target.index!==l&&a.target.gotoAndStop(0)}function d(a){if(-1!==a.target.bitmap.src.indexOf("next")){if(4===l)return;l++}else{if(0===l)return;l--}e()}function e(a){if(a){if(l===a.target.index)return;l=a.target.index}for(a=0;a<v.length;a++)v[a].gotoAndStop(v[a].index===l?2:0);for(a=0;a<q.length;a++)q[a].destroyByOpacity(1E3);q=[];for(a=0;3>a;a++){var c=addSprite("plant_gallery",38,52,30+210*a,w[l][a]);
q.push(c)}for(a=0;4>a;a++){var d=a%2?340:140,e=1<a?200:85,c=3*(a+1)+12*l;if(g>=c)switch(c){case 21:d=addSprite("statue"+c+"_gallery",50,128,d-1,214);break;case 24:d=addSprite("statue"+c+"_gallery",54,136,d-2,210);break;case 45:d=addSprite("statue"+c+"_gallery",60,134,d-4,211);break;case 48:d=addSprite("statue"+c+"_gallery",76,132,d-13,212);break;default:d=addSprite("pic"+c+"_gallery",103,106,d,e)}else{21===c||24===c||45===c||48===c?(d=addSprite("statueClose_gallery",66,136,d,210),e=0,addToContainer(d,
"star_gallery",20,20,3,-45)):(d=addSprite("picClose_gallery",108,112,d,e),e=10,addToContainer(d,"star_gallery",20,20,-15,-20));var f=new SimpleText(bitmaps.num_gallery,16,18);f.parent=d;f.align=f.ALIGN_CENTER;f.charSpacing=-2;f.x=e;f.y=-20;f.write(c)}d.setZIndex(1);q.push(d)}for(a=0;a<q.length;a++)q[a].opacity=0,q[a].fadeTo(1,1E3)}setCSSBack(bitmaps.back_gallery);Utils.mobileCheckBrokenAndroid()&&addSprite("back_gallery",570,320,240,160,!0);stage.onmousedown=function(a){a.target.down={x:a.x,y:a.y}};
stage.onmousemove=function(a){var c=a.target.down;if(!(!c||290<c.y||10>Math.abs(c.x-a.x))){if(a.x<c.x){if(4===l)return;l++}else{if(0===l)return;l--}playSound("Button");e();a.target.down=null}};addSprite("cover1_gallery",76,34,37,304,!0);var f=addSprite("backBtn_gallery",50,33,37,306,!1,3,function(){gameState=prevState===STATE_MENU?STATE_MENU:STATE_LEVEL_SELECT;createScene()});attachMouseEvents.call(f,!0);f.hitArea={x:0,y:-6,width:50,height:33};addSprite("lamp_gallery",138,86,80,20,!0);addSprite("lamp_gallery",
138,86,400,20,!0);addSprite("fence_gallery",94,28,140,265);addSprite("fence_gallery",94,28,340,265);f=addSprite("cover2_gallery",86,64,240,-3,!0);addToContainer(f,"star_lvlMap",20,18,-28,14,!0);var g=getTotalNumOfStars(),h=new SimpleText(bitmaps.num1_lvlMap,12,16);h.parent=f;h.align=h.ALIGN_RIGHT;h.charSpacing=-2.5;h.charMap.push("/");h.x=37;h.y=15;h.static=!0;h.write(g+"/60");var f=addSprite("cover3_gallery",140,34,240,305,!0),h=addToContainer(f,"prev_gallery",36,36,-50,2,!1,3,d),k=addToContainer(f,
"next_gallery",36,36,50,2,!1,3,d);attachMouseEvents.call(h);attachMouseEvents.call(k);h.hitArea=k.hitArea={x:0,y:-5,width:36,height:30};var l;l=prevState===STATE_VICTORY?~~((g-1)/12):0;for(var q=[],v=[],w=[],h=0;5>h;h++){for(var k=[],y=0;3>y;y++)k.push(randInt(200,70));w.push(k)}for(h=0;5>h;h++)k=addToContainer(f,"page_gallery",12,12,-25+13*h,1,!1,3,e),k.index=h,k.onmouseover=a,k.onmouseout=c,v.push(k);e()}
function showLevelSelect(){function a(a,c){function d(a){prepareLevel(a.target.index);return!1}var l=addSprite("lvlImage_lvlMap",52,50,a,c,!0,3);l.index=e;if(e>f)l.gotoAndStop(0);else{e<f&&l.gotoAndStop(2);e===f&&l.gotoAndStop(1);l.onclick=d;var q=new SimpleText(bitmaps.num3_lvlMap,18,20);q.align=q.ALIGN_CENTER;q.parent=l;q.scale=.8;q.charSpacing=-2;q.x=-8;q.y=-10;q.static=!0;q.write(e+1);for(var q=~~(gameData.scores[e]/1E3),v=0;v<q;v++)addToContainer(l,"star_lvlMap",20,18,-18.8+11.3*v,6.8,!0).setPropScale(.6)}e++}
function c(a,c){var d=new TilesSprite(bitmaps.bee_lvlMap,16,20,12,4,3);d.x=a;d.y=c;d.animDelay=2;stage.addChild(d);d.gotoAndPlay(~~(12*Math.random()))}setCSSBack(bitmaps.LevelsMap);Utils.mobileCheckBrokenAndroid()&&addSprite("LevelsMap",570,320,240,160,!0);showSpilLogo(223,17);var d=addSprite("gallery_lvlMap",104,36,190,303,!1,3,gallery);attachMouseEvents.call(d,!0);d.hitArea={x:0,y:-3,width:110,height:30};d=new SimpleText(bitmaps.num2_lvlMap,10,14);d.align=d.ALIGN_LEFT;d.scale=.95;d.charSpacing=
-2;d.x=358.8;d.y=16.8;d.static=!0;d.write(getTotalScores());addSprite("star_lvlMap",20,18,105,14,!0);d=new SimpleText(bitmaps.num1_lvlMap,12,16);d.align=d.ALIGN_RIGHT;d.charSpacing=-2.5;d.charMap.push("/");d.x=170.8;d.y=14.8;d.static=!0;d.write(getTotalNumOfStars()+"/60");d=addSprite("sound_lvlMap",28,28,402,308,!1,3);d.stop();attachMouseEvents.call(d,!0);coverSoundSpr(d);d=addSprite("menu_lvlMap",70,38,45,295,!1,3,showMenu);attachMouseEvents.call(d,!0);var e=0,f=getLastLevel();a(127,83);a(182,118);
a(240,137);a(300,123);a(356,105);a(418,95);a(425,140);a(410,195);a(335,175);a(270,190);a(200,190);a(140,170);a(80,184);a(85,235);a(122,270);a(165,237);a(210,255);a(258,270);a(305,240);a(365,252);c(120,205);c(230,90);c(370,140);c(290,280)}
function createObject(a,c,d){function e(a){a=a.target;21===a.currentFrameX&&(a.onchangeframe=null,a.animDelay=2,a.bitmap=bitmaps.fire_normal,a.framesCount=30,a.totalLayers=15,a.totalFrames=2,a.width=22,a.height=96)}function f(a){a=a.target;a.animDirection*=-1;a.play();playSound("LeverDouble")}var g,h,k,l,q,v,w,y,r;"Bob"===c.name?bob=r=new SnailBob:r=c.columns?new TilesSprite(bitmaps[c.name],c.width,c.height,c.frames,c.rows,c.columns):new Sprite(bitmaps[c.name],c.width,c.height,c.frames);r.x=a.x;r.y=
a.y;r.rotation=a.rotation||0;r.setZIndex(10);(d||stage).addChild(r);r.info=c.info;r.custom=a.custom;c.bodyType!=NONE&&(l="undefined"!=typeof a.fixed?a.fixed:c.fixed,d="undefined"!=typeof a.density?a.density:c.density,h="undefined"!=typeof a.restitution?a.restitution:c.restitution,k="undefined"!=typeof a.friction?a.friction:c.friction,0>=d&&(l=!0),w=c.bodyWidth?c.bodyWidth:c.width,y=c.bodyHeight?c.bodyHeight:c.height,q=a.x,v=a.y,c.bodyPosCorrect&&(q+=c.bodyPosCorrect.x,v+=c.bodyPosCorrect.y,r.syncX=
c.bodyPosCorrect.x,r.syncY=c.bodyPosCorrect.y,r.onbox2dsync=spritesSync),c.bodyType==BOX&&(g=box2d.createBox(world,{x:q,y:v,width:w,height:y,rotation:a.rotation,bodyType:l?box2d.bodyType.static:box2d.bodyType.dynamic,density:d,restitution:h,friction:k})),c.bodyType==CIRCLE&&(g=box2d.createCircle(world,{x:q,y:v,radius:w/2,rotation:a.rotation,bodyType:l?box2d.bodyType.static:box2d.bodyType.dynamic,density:d,restitution:h,friction:k})),c.bodyType==POLY&&(g=box2d.createPoly(world,{x:q,y:v,points:c.points,
rotation:a.rotation,bodyType:l?box2d.bodyType.static:box2d.bodyType.dynamic,density:d,restitution:h,friction:k})),g.sprite=r,r.box2dBody=g);"lamp"===c.info&&r.setStatic(!0);"resurrection"===c.info&&handlers.setResurretion.call(r);"frog_platform"===c.info&&(r.setZIndex(17),r.frog=createObject({type:"frog",x:0,y:14},findObject("frog"),r),r.frog.stop());if("frog"===c.info){var z=new Vector(-.5,48);z.rotate(-r.rotation);g=r.localToGlobal().x+z.x;d=r.localToGlobal().y+z.y;r.animDelay=3;r.setZIndex(17);
r.onclick=function(a){a=a.target;a.tongue.visible?playSound("FrogTest4(SnailBob3)"):(playSound("FrogTest2(SnailBob3)"),playSound("FrogTest3(SnailBob3)"));if(0===a.currentFrameX||7===a.currentFrameX)a.play(),a.tongue.visible=!0,a.tongue.play()};r.onchangeframe=function(a){a=a.target;6===a.currentFrameX&&a.gotoAndStop(7);14===a.currentFrameX&&a.gotoAndStop(0)};g=createObject({type:"frog_tongue",x:g,y:d},findObject("frog_tongue"));g.setZIndex(16);g.visible=!1;g.stop();g.rotation=r.rotation;g.animDelay=
2;r.parent!==stage&&(g.onprerender=function(a){a=a.target;a.x=r.localToGlobal().x+z.x;a.y=r.localToGlobal().y+z.y});g.onchangeframe=function(a){a=a.target;4===a.currentFrameX&&1===a.animDirection&&(a.gotoAndStop(5),a.animDirection=-1);0===a.currentFrameX&&a.animated&&-1===a.animDirection&&(a.gotoAndStop(0),a.visible=!1,a.animDirection=1)};r.tongue=g}"fire"===c.info&&(r.animDelay=3,r.switchOn=function(a){this.onchangeframe=e;this.gotoAndPlay(0);playSound("FlameStarts(SnailBob3)")},r.switchOff=function(){this.bitmap=
bitmaps.fire_off;this.framesCount=20;this.totalLayers=10;this.totalFrames=2;this.width=36;this.height=96;this.gotoAndPlay(0);this.onchangeframe=function(a){a=a.target;18===a.currentFrameX&&a.gotoAndStop(19)};playSound("FlameStop(SnailBob3)")},r.appear=function(){this.animDelay=3;this.bitmap=bitmaps.fire;this.framesCount=22;this.totalLayers=11;this.totalFrames=2;this.width=36;this.height=99;this.switchOn()});"star"===c.info&&handlers.getStar.call(r);"star_doors"===c.info&&(r.onchangeframe=function(a){7===
a.target.currentFrameX&&(a.target.gotoAndStop(8),a.target.setStatic(!0))});-1!==c.info.indexOf("stopLaser")&&(r.stopLaser=!0);"mirrow"===c.info&&(d=new Vector(-10,0),h=new Vector(6,0),g=new Vector(-2,13),d.rotate(-r.rotation),h.rotate(-r.rotation),g.rotate(-r.rotation),d=createObject({type:"stopLaser",x:r.x+d.x,y:r.y+d.y,rotation:r.rotation-1.05},findObject("stopLaser")),h=createObject({type:"stopLaser",x:r.x+h.x,y:r.y+h.y,rotation:r.rotation+1.05},findObject("stopLaser")),g=createObject({type:"stopLaser",
x:r.x+g.x,y:r.y+g.y,rotation:r.rotation},findObject("stopLaser")),r.lasers=[d,h,g],r.setStatic(!0));"button"===c.info&&(attachMouseEvents.call(r),"hint"===a.custom&&r.addHint());"cover"!==c.info&&-1===c.info.indexOf("lift")&&-1===c.info.indexOf("bridge")||r.setStatic(!0);"lever"===c.info&&(r.addEventListener("click",f),r.animDelay=2,r.animDirection=-1,r.onchangeframe=function(a){a=a.target;a.animated&&(0===a.currentFrameX&&-1===a.animDirection||7===a.currentFrameX&&1===a.animDirection)&&a.stop()});
"lever2"===c.info&&(r.addEventListener("click",f),r.animDelay=2,r.animDirection=-1,r.onchangeframe=function(a){a=a.target;a.animated&&(0===a.currentFrame&&-1===a.animDirection||6===a.currentFrame&&1===a.animDirection)&&a.stop()});r.obType=c.type;return r}function restart(){prepareLevel(currentLevel)}function nextLevel(){prepareLevel(currentLevel+1)}
function prepareLevel(a){function c(a){for(var c in a)bitmaps[c]=a[c];d()}function d(){setTimeout(function(){startLevel(a)},1E3/fps*2)}(function(){if(stage){var e=new Sprite(bitmaps.hourglass,100,150,1);e.x=240;e.y=130;stage.addChild(e)}if(0!==loadData.levels[a].length){for(var e=Utils.imagesRoot+"/"+Utils.globalScale+"/",f=[],g=0;g<loadData.levels[a].length;g++){var h=loadData.levels[a][g];f.push({name:h[0],src:e+h[1]})}loadData.levels[a]=[];(new ImagesPreloader).load(f,c,Utils.showLoadProgress)}else d()})()}
function startLevel(a,c){world=box2d.createWorld();box2d.setDebugDraw(world,document.getElementById(Utils.DOMScreenId));createStage();bob=null;var d,e;c&&(a=0,levels=[c]);d=levels[a].objects;e=levels[a].joints;currentLevel=a;gameScore=1E3;for(var f=stage.setInterval(function(){gameState===STATE_GAME&&0<gameScore?gameScore--:stage.clearInterval(f)},1E3),g,h,k=0;k<d.length;k++)g=d[k],h=findObject(g.type),createObject(g,h);if(e)for(k=0;k<e.length;k++){d=e[k];g=getBodyByPoint(d.point1);h=getBodyByPoint(d.point2?
d.point2:d.point1,g);if(0===d.type){var l={body1:g,body2:h,point:d.point1};"undefined"!=typeof d.custom&&(l.enableMotor=!0,l.motorSpeed=d.custom,l.maxMotorTorque=NaN);box2d.createRevoluteJoint(world,l)}1==d.type&&box2d.createDistanceJoint(world,{body1:g,body2:h,point1:d.point1,point2:d.point2})}gameState=STATE_GAME;field.init();bob&&bob.init();e=1!=GET.debug?levelsScripts[currentLevel]:levelsScripts[editorLevel];e.init();e.pretick&&stage.addEventListener("pretick",e.pretick);e.posttick&&stage.addEventListener("posttick",
e.posttick);stage.start();stage.refreshBackground()}function leverOnenterframe(a){var c=a.target;5==c.currentFrame&&c.animated&&(c.stop(),c.removeHint(),c.custom||(c.setStatic(!0),stage.setTimeout(function(){c.cover.setStatic(!0)},1)))}function preTick(a){gameState==STATE_GAME&&(a=Math.min(a.delta/1E3,.05),world.Step(a,10,10),box2d.syncStage(world))}function postTick(){world&&showDebugDraw&&world.DrawDebugData()}
function animateStarReceive(a){function c(a,c,d){var h=randInt(10,-10);randY=randInt(10,-10);var k=addSprite("star_trail",13,12,a+h,c+randY);k.setZIndex(d);k.scaleTo(0,300,!1,function(){k.destroy=!0})}var d=181+24*field.starsCount;1===field.starsCount&&(d+=.8);a.onclick=null;d=[{tweens:[{prop:"y",to:a.y-15},{prop:"rotation",to:0}],duration:300},{tweens:[{prop:"y",to:305.5},{prop:"x",to:d,onchange:function(a){a=a.target.obj;var d=a.getAbsolutePosition();c(d.x,d.y,a.zIndex-1)}},{prop:"rotation",to:4*
Math.PI}],duration:500},{tweens:[{prop:"scaleX",to:.8},{prop:"scaleY",to:.8},{prop:"rotation",to:6*Math.PI}],duration:500,onfinish:function(){a.bitmap=bitmaps.star_finish;a.height++;a.y++;a.totalFrames=10;a.animDelay=3;a.play();a.onchangeframe=function(a){9===a.target.currentFrame&&a.target.gotoAndStop(0)}}}];a.collected||(gameScore+=1E3,playSound("get_star"+Math.ceil(5*Math.random())+"(SnailBob3)"),a.collected=!0,a.bitmap=bitmaps.star1,a.width=28,a.height=27,a.gotoAndStop(0),a.setZIndex(stage.findMaxZIndex().zIndex+
1),a.setStatic(!1),Animation.play(a,d),field.starsCount++,d=new TilesSprite(bitmaps.star_anim,78,78,18,9,2),d.x=a.x,d.y=a.y,d.animDelay=4,d.setZIndex(a.zIndex-1),d.onchangeframe=function(a){16===a.target.currentFrameX&&(a.target.destroy=!0)},stage.addChild(d))}function changeParent(a,c,d){if(a.parent&&c)return d&&setNewRelativePosition(a,c),a.parent.objects=Utils.removeFromArray(a.parent.objects,a),c.addChild(a),a}
function setNewRelativePosition(a,c){var d=a.getAbsoluteCenter();a.setPosition(d.x-c.x,d.y-c.y)}function playMusic(a){mixer.channels[0].audioWrapper&&mixer.channels[0].audioWrapper.fileName==a||isMusicOn&&mixer.play(a,!0,!1,0)}function playSound(a){isSoundOn&&isWebAudioSupport&&mixer.play(a,!1,!0)}function coverSoundSpr(a){a.onclick=soundBtnHandler;a.bitmap=isMusicOn?bitmaps.sound_lvlMap:bitmaps.sound_off}
function soundBtnHandler(){(isSoundOn=isMusicOn=!isMusicOn)?(playMusic("music2"),this.bitmap=bitmaps.sound_lvlMap):(mixer.stop(0),this.bitmap=bitmaps.sound_off);stage.refreshBackground();saveSoundStatus()}function checkSoundStatus(){isSoundOn=isMusicOn="off"!=Utils.getCookie("bob3_sound")}function saveSoundStatus(){Utils.setCookie("bob3_sound",isMusicOn?"on":"off")};